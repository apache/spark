-- Automatically generated by SQLQueryTestSuite
-- !query
set spark.sql.parser.quotedRegexColumnNames=false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.parser.quotedRegexColumnNames	false


-- !query
CREATE OR REPLACE TEMPORARY VIEW testData AS SELECT * FROM VALUES
(1, "1", "11"), (2, "2", "22"), (3, "3", "33"), (4, "4", "44"), (5, "5", "55"), (6, "6", "66")
AS testData(key, value1, value2)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW testData2 AS SELECT * FROM VALUES
(1, 1, 1, 2), (1, 2, 1, 2), (2, 1, 2, 3), (2, 2, 2, 3), (3, 1, 3, 4), (3, 2, 3, 4)
AS testData2(A, B, c, d)
-- !query schema
struct<>
-- !query output



-- !query
SELECT `(a)?+.+` FROM testData2 WHERE a = 1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a)?+.+`",
    "proposal" : "`A`, `B`, `c`, `d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "`(a)?+.+`"
  } ]
}


-- !query
SELECT t.`(a)?+.+` FROM testData2 t WHERE a = 1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`t`.`(a)?+.+`",
    "proposal" : "`t`.`A`, `t`.`B`, `t`.`c`, `t`.`d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 18,
    "fragment" : "t.`(a)?+.+`"
  } ]
}


-- !query
SELECT `(a|b)` FROM testData2 WHERE a = 2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a|b)`",
    "proposal" : "`A`, `B`, `c`, `d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 14,
    "fragment" : "`(a|b)`"
  } ]
}


-- !query
SELECT `(a|b)?+.+` FROM testData2 WHERE a = 2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a|b)?+.+`",
    "proposal" : "`A`, `B`, `c`, `d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 18,
    "fragment" : "`(a|b)?+.+`"
  } ]
}


-- !query
SELECT SUM(`(a|b)?+.+`) FROM testData2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a|b)?+.+`",
    "proposal" : "`A`, `B`, `c`, `d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 12,
    "stopIndex" : 22,
    "fragment" : "`(a|b)?+.+`"
  } ]
}


-- !query
SELECT SUM(`(a)`) FROM testData2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a)`",
    "proposal" : "`A`, `B`, `c`, `d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 12,
    "stopIndex" : 16,
    "fragment" : "`(a)`"
  } ]
}


-- !query
set spark.sql.parser.quotedRegexColumnNames=true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.parser.quotedRegexColumnNames	true


-- !query
SELECT `(a)?+.+` FROM testData2 WHERE a = 1
-- !query schema
struct<B:int,c:int,d:int>
-- !query output
1	1	2
2	1	2


-- !query
SELECT `(A)?+.+` FROM testData2 WHERE a = 1
-- !query schema
struct<B:int,c:int,d:int>
-- !query output
1	1	2
2	1	2


-- !query
SELECT t.`(a)?+.+` FROM testData2 t WHERE a = 1
-- !query schema
struct<B:int,c:int,d:int>
-- !query output
1	1	2
2	1	2


-- !query
SELECT t.`(A)?+.+` FROM testData2 t WHERE a = 1
-- !query schema
struct<B:int,c:int,d:int>
-- !query output
1	1	2
2	1	2


-- !query
SELECT `(a|B)` FROM testData2 WHERE a = 2
-- !query schema
struct<A:int,B:int>
-- !query output
2	1
2	2


-- !query
SELECT `(A|b)` FROM testData2 WHERE a = 2
-- !query schema
struct<A:int,B:int>
-- !query output
2	1
2	2


-- !query
SELECT `(a|B)?+.+` FROM testData2 WHERE a = 2
-- !query schema
struct<c:int,d:int>
-- !query output
2	3
2	3


-- !query
SELECT `(A|b)?+.+` FROM testData2 WHERE a = 2
-- !query schema
struct<c:int,d:int>
-- !query output
2	3
2	3


-- !query
SELECT `(e|f)` FROM testData2
-- !query schema
struct<>
-- !query output



-- !query
SELECT t.`(e|f)` FROM testData2 t
-- !query schema
struct<>
-- !query output



-- !query
SELECT p.`(KEY)?+.+`, b, testdata2.`(b)?+.+` FROM testData p join testData2 ON p.key = testData2.a WHERE key < 3
-- !query schema
struct<value1:string,value2:string,b:int,A:int,c:int,d:int>
-- !query output
1	11	1	1	1	2
1	11	2	1	1	2
2	22	1	2	2	3
2	22	2	2	2	3


-- !query
SELECT p.`(key)?+.+`, b, testdata2.`(b)?+.+` FROM testData p join testData2 ON p.key = testData2.a WHERE key < 3
-- !query schema
struct<value1:string,value2:string,b:int,A:int,c:int,d:int>
-- !query output
1	11	1	1	1	2
1	11	2	1	1	2
2	22	1	2	2	3
2	22	2	2	2	3


-- !query
set spark.sql.caseSensitive=true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.caseSensitive	true


-- !query
CREATE OR REPLACE TEMPORARY VIEW testdata3 AS SELECT * FROM VALUES
(0, 1), (1, 2), (2, 3), (3, 4)
AS testdata3(a, b)
-- !query schema
struct<>
-- !query output



-- !query
SELECT `(A)?+.+` FROM testdata3
-- !query schema
struct<a:int,b:int>
-- !query output
0	1
1	2
2	3
3	4


-- !query
SELECT `(a)?+.+` FROM testdata3
-- !query schema
struct<b:int>
-- !query output
1
2
3
4


-- !query
SELECT `(A)?+.+` FROM testdata3 WHERE a > 1
-- !query schema
struct<a:int,b:int>
-- !query output
2	3
3	4


-- !query
SELECT `(a)?+.+` FROM testdata3 where `a` > 1
-- !query schema
struct<b:int>
-- !query output
3
4


-- !query
SELECT SUM(`a`) FROM testdata3
-- !query schema
struct<sum(a):bigint>
-- !query output
6


-- !query
SELECT SUM(`(a)`) FROM testdata3
-- !query schema
struct<sum(a):bigint>
-- !query output
6


-- !query
SELECT SUM(`(a)?+.+`) FROM testdata3
-- !query schema
struct<sum(b):bigint>
-- !query output
10


-- !query
SELECT SUM(a) FROM testdata3 GROUP BY `a`
-- !query schema
struct<sum(a):bigint>
-- !query output
0
1
2
3


-- !query
SELECT SUM(a) FROM testdata3 GROUP BY `(a)`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a)`",
    "proposal" : "`a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 39,
    "stopIndex" : 43,
    "fragment" : "`(a)`"
  } ]
}


-- !query
SELECT SUM(a) FROM testdata3 GROUP BY `(a)?+.+`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`(a)?+.+`",
    "proposal" : "`a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 39,
    "stopIndex" : 47,
    "fragment" : "`(a)?+.+`"
  } ]
}
