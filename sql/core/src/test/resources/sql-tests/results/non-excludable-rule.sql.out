-- Automatically generated by SQLQueryTestSuite
-- !query
SET spark.sql.optimizer.excludedRules=org.apache.spark.sql.catalyst.optimizer.ReplaceCTERefWithRepartition
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.excludedRules	org.apache.spark.sql.catalyst.optimizer.ReplaceCTERefWithRepartition


-- !query
SELECT
  (SELECT min(id) FROM range(10)),
  (SELECT sum(id) FROM range(10)),
  (SELECT count(distinct id) FROM range(10))
-- !query schema
struct<scalarsubquery():bigint,scalarsubquery():bigint,scalarsubquery():bigint>
-- !query output
0	45	10


-- !query
SET spark.sql.optimizer.excludedRules=org.apache.spark.sql.catalyst.optimizer.Optimizer$OptimizeSubqueries
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.excludedRules	org.apache.spark.sql.catalyst.optimizer.Optimizer$OptimizeSubqueries


-- !query
WITH tmp AS (
  SELECT id FROM range(2)
  INTERSECT
  SELECT id FROM range(4)
)
SELECT id FROM range(3) WHERE id > (SELECT max(id) FROM tmp)
-- !query schema
struct<id:bigint>
-- !query output
2


-- !query
SET spark.sql.optimizer.excludedRules=org.apache.spark.sql.catalyst.optimizer.RewriteLateralSubquery
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.excludedRules	org.apache.spark.sql.catalyst.optimizer.RewriteLateralSubquery


-- !query
SELECT * FROM testData, LATERAL (SELECT * FROM testData) LIMIT 1
-- !query schema
struct<key:int,value:string,key:int,value:string>
-- !query output
1	1	1	1
