-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMP VIEW x(x1, x2) AS VALUES
    (2, 1),
    (1, 1),
    (3, 4)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMP VIEW y(y1, y2) AS VALUES
    (0, 2),
    (1, 4),
    (4, 11)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMP VIEW z(z1, z2) AS VALUES
    (4, 2),
    (3, 3),
    (8, 1)
-- !query schema
struct<>
-- !query output



-- !query
select * from x inner join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4


-- !query
select * from x inner join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output



-- !query
select * from x inner join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output



-- !query
select * from x inner join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4


-- !query
select * from x left join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x left join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	NULL	NULL
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x left join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	NULL	NULL
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x left join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x right join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	4	11
1	1	1	4


-- !query
select * from x right join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	1	4
NULL	NULL	4	11


-- !query
select * from x right join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	1	4
NULL	NULL	4	11


-- !query
select * from x right join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	4	11
1	1	1	4


-- !query
select * from x right join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	4	11
1	1	1	4


-- !query
select * from x right join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	1	4
NULL	NULL	4	11


-- !query
select * from x right join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	1	4
NULL	NULL	4	11


-- !query
select * from x right join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	4	11
1	1	1	4


-- !query
select * from x left semi join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output
1	1


-- !query
select * from x left semi join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output



-- !query
select * from x left semi join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output



-- !query
select * from x left semi join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output
1	1


-- !query
select * from x left anti join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output
2	1
3	4


-- !query
select * from x left anti join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output
1	1
2	1
3	4


-- !query
select * from x left anti join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output
1	1
2	1
3	4


-- !query
select * from x left anti join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2
-- !query schema
struct<x1:int,x2:int>
-- !query output
2	1
3	4


-- !query
select * from x full outer join y on x1 = y1 and exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	4	11
1	1	1	4
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x full outer join y on x1 = y1 and not exists (select * from z where z2 = x2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	1	4
NULL	NULL	4	11
1	1	NULL	NULL
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x full outer join y on x1 = y1 and exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	1	4
NULL	NULL	4	11
1	1	NULL	NULL
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x full outer join y on x1 = y1 and not exists (select * from z where z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
NULL	NULL	0	2
NULL	NULL	4	11
1	1	1	4
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x inner join y on x1 = y1 or exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
3	4	0	2
3	4	1	4
3	4	4	11


-- !query
select * from x inner join y on x1 = y1 or not exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	0	2
1	1	1	4
1	1	4	11
2	1	0	2
2	1	1	4
2	1	4	11


-- !query
select * from x left join y on x1 = y1 or exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
2	1	NULL	NULL
3	4	0	2
3	4	1	4
3	4	4	11


-- !query
select * from x left join y on x1 = y1 or not exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	0	2
1	1	1	4
1	1	4	11
2	1	0	2
2	1	1	4
2	1	4	11
3	4	NULL	NULL


-- !query
select * from x inner join y on x1 = y1 or exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
1	1	4	11
2	1	4	11
3	4	4	11


-- !query
select * from x inner join y on x1 = y1 or not exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	0	2
1	1	1	4
2	1	0	2
2	1	1	4
3	4	0	2
3	4	1	4


-- !query
select * from x left join y on x1 = y1 or exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
1	1	4	11
2	1	4	11
3	4	4	11


-- !query
select * from x left join y on x1 = y1 or not exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	0	2
1	1	1	4
2	1	0	2
2	1	1	4
3	4	0	2
3	4	1	4


-- !query
select * from x inner join y on x1 = y1 and exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output



-- !query
select * from x inner join y on x1 = y1 and not exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4


-- !query
select * from x left join y on x1 = y1 and exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	NULL	NULL
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x left join y on x1 = y1 and not exists (select * from z where z1 = x1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x inner join y on x1 = y1 and exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output



-- !query
select * from x inner join y on x1 = y1 and not exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4


-- !query
select * from x left join y on x1 = y1 and exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	NULL	NULL
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x left join y on x1 = y1 and not exists (select * from z where z1 = y1) order by x1, x2, y1, y2
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	1	1	4
2	1	NULL	NULL
3	4	NULL	NULL


-- !query
select * from x join y on x1 = y1 and exists (select * from z where z2 = x2 AND z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNSUPPORTED_SUBQUERY_EXPRESSION_CATEGORY.UNSUPPORTED_CORRELATED_EXPRESSION_IN_JOIN_CONDITION",
  "sqlState" : "0A000",
  "messageParameters" : {
    "subqueryExpression" : "exists(x.x2, y.y2, (z.z2 = x.x2), (z.z2 = y.y2))"
  }
}


-- !query
select * from x join y on x1 = y1 and not exists (select * from z where z2 = x2 AND z2 = y2) order by x1, x2, y1, y2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNSUPPORTED_SUBQUERY_EXPRESSION_CATEGORY.UNSUPPORTED_CORRELATED_EXPRESSION_IN_JOIN_CONDITION",
  "sqlState" : "0A000",
  "messageParameters" : {
    "subqueryExpression" : "exists(x.x2, y.y2, (z.z2 = x.x2), (z.z2 = y.y2))"
  }
}
