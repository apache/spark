-- Automatically generated by SQLQueryTestSuite
-- !query
create temporary view t1 as select * from values
  ("val1a", 6S, 8, 10L, float(15.0), 20D, 20E2BD, timestamp '2014-04-04 01:00:00.000', date '2014-04-04'),
  ("val1b", 8S, 16, 19L, float(17.0), 25D, 26E2BD, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),
  ("val1a", 16S, 12, 21L, float(15.0), 20D, 20E2BD, timestamp '2014-06-04 01:02:00.001', date '2014-06-04'),
  ("val1a", 16S, 12, 10L, float(15.0), 20D, 20E2BD, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),
  ("val1c", 8S, 16, 19L, float(17.0), 25D, 26E2BD, timestamp '2014-05-04 01:02:00.001', date '2014-05-05'),
  ("val1d", null, 16, 22L, float(17.0), 25D, 26E2BD, timestamp '2014-06-04 01:01:00.000', null),
  ("val1d", null, 16, 19L, float(17.0), 25D, 26E2BD, timestamp '2014-07-04 01:02:00.001', null),
  ("val1e", 10S, null, 25L, float(17.0), 25D, 26E2BD, timestamp '2014-08-04 01:01:00.000', date '2014-08-04'),
  ("val1e", 10S, null, 19L, float(17.0), 25D, 26E2BD, timestamp '2014-09-04 01:02:00.001', date '2014-09-04'),
  ("val1d", 10S, null, 12L, float(17.0), 25D, 26E2BD, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),
  ("val1a", 6S, 8, 10L, float(15.0), 20D, 20E2BD, timestamp '2014-04-04 01:02:00.001', date '2014-04-04'),
  ("val1e", 10S, null, 19L, float(17.0), 25D, 26E2BD, timestamp '2014-05-04 01:01:00.000', date '2014-05-04')
  as t1(t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i)
-- !query schema
struct<>
-- !query output



-- !query
create temporary view t2 as select * from values
  ("val2a", 6S, 12, 14L, float(15), 20D, 20E2BD, timestamp '2014-04-04 01:01:00.000', date '2014-04-04'),
  ("val1b", 10S, 12, 19L, float(17), 25D, 26E2BD, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),
  ("val1b", 8S, 16, 119L, float(17), 25D, 26E2BD, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),
  ("val1c", 12S, 16, 219L, float(17), 25D, 26E2BD, timestamp '2016-05-04 01:01:00.000', date '2016-05-04'),
  ("val1b", null, 16, 319L, float(17), 25D, 26E2BD, timestamp '2017-05-04 01:01:00.000', null),
  ("val2e", 8S, null, 419L, float(17), 25D, 26E2BD, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),
  ("val1f", 19S, null, 519L, float(17), 25D, 26E2BD, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),
  ("val1b", 10S, 12, 19L, float(17), 25D, 26E2BD, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),
  ("val1b", 8S, 16, 19L, float(17), 25D, 26E2BD, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),
  ("val1c", 12S, 16, 19L, float(17), 25D, 26E2BD, timestamp '2014-08-04 01:01:00.000', date '2014-08-05'),
  ("val1e", 8S, null, 19L, float(17), 25D, 26E2BD, timestamp '2014-09-04 01:01:00.000', date '2014-09-04'),
  ("val1f", 19S, null, 19L, float(17), 25D, 26E2BD, timestamp '2014-10-04 01:01:00.000', date '2014-10-04'),
  ("val1b", null, 16, 19L, float(17), 25D, 26E2BD, timestamp '2014-05-04 01:01:00.000', null)
  as t2(t2a, t2b, t2c, t2d, t2e, t2f, t2g, t2h, t2i)
-- !query schema
struct<>
-- !query output



-- !query
create temporary view t3 as select * from values
  ("val3a", 6S, 12, 110L, float(15), 20D, 20E2BD, timestamp '2014-04-04 01:02:00.000', date '2014-04-04'),
  ("val3a", 6S, 12, 10L, float(15), 20D, 20E2BD, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),
  ("val1b", 10S, 12, 219L, float(17), 25D, 26E2BD, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),
  ("val1b", 10S, 12, 19L, float(17), 25D, 26E2BD, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),
  ("val1b", 8S, 16, 319L, float(17), 25D, 26E2BD, timestamp '2014-06-04 01:02:00.000', date '2014-06-04'),
  ("val1b", 8S, 16, 19L, float(17), 25D, 26E2BD, timestamp '2014-07-04 01:02:00.000', date '2014-07-04'),
  ("val3c", 17S, 16, 519L, float(17), 25D, 26E2BD, timestamp '2014-08-04 01:02:00.000', date '2014-08-04'),
  ("val3c", 17S, 16, 19L, float(17), 25D, 26E2BD, timestamp '2014-09-04 01:02:00.000', date '2014-09-05'),
  ("val1b", null, 16, 419L, float(17), 25D, 26E2BD, timestamp '2014-10-04 01:02:00.000', null),
  ("val1b", null, 16, 19L, float(17), 25D, 26E2BD, timestamp '2014-11-04 01:02:00.000', null),
  ("val3b", 8S, null, 719L, float(17), 25D, 26E2BD, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),
  ("val3b", 8S, null, 19L, float(17), 25D, 26E2BD, timestamp '2015-05-04 01:02:00.000', date '2015-05-04')
  as t3(t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i)
-- !query schema
struct<>
-- !query output



-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d)
LIMIT  2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1b	8	16	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d
               LIMIT 10)
LIMIT  2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1b	8	16	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d)
LIMIT  2
OFFSET 1
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d
               LIMIT 10
               OFFSET 2)
LIMIT  2
OFFSET 1
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d)
OFFSET 1
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d
               OFFSET 2)
OFFSET 1
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1c IN (SELECT t2c
               FROM   t2
               WHERE  t2b >= 8
               LIMIT  2)
LIMIT 4
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1b	8	16	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d IN (SELECT t2d
               FROM   t2
               ORDER  BY t2c, t2d
               LIMIT 2)
GROUP  BY t1b
ORDER  BY t1b DESC NULLS FIRST
LIMIT  1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
1	NULL


-- !query
SELECT *
FROM   t1
WHERE  t1c IN (SELECT t2c
               FROM   t2
               WHERE  t2b <= t1d
               LIMIT  2)
LIMIT 4
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04


-- !query
SELECT *
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b > 6
                   LIMIT  2)
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:00:00	2014-04-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:02:00.001	2014-04-04


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d NOT IN (SELECT t2d
                   FROM   t2
                   ORDER  BY t2b DESC nulls first, t2d
                   LIMIT 1)
GROUP  BY t1b
ORDER BY t1b NULLS last
LIMIT  1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
1	6


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d IN (SELECT t2d
               FROM   t2
               WHERE t2b <= t1d
               ORDER  BY t2c, t2d
               LIMIT 2)
GROUP  BY t1b
ORDER  BY t1b DESC NULLS FIRST
LIMIT  1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
1	NULL


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d)
LIMIT  2
OFFSET 2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d > t2d
               ORDER BY t2a DESC
               LIMIT 3)
LIMIT  2
OFFSET 2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output



-- !query
SELECT *
FROM   t1
WHERE  t1c IN (SELECT t2c
               FROM   t2
               WHERE  t2b >= 8
               LIMIT  2
               OFFSET 2)
LIMIT 4
OFFSET 2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1d	NULL	16	19	17.0	25.0	2600	2014-07-04 01:02:00.001	NULL
val1d	NULL	16	22	17.0	25.0	2600	2014-06-04 01:01:00	NULL


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d IN (SELECT t2d
               FROM   t2
               ORDER  BY t2c, t2d
               LIMIT 2)
GROUP  BY t1b
ORDER  BY t1b DESC NULLS FIRST
LIMIT  1
OFFSET 1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
1	10


-- !query
SELECT *
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b > 6
                   LIMIT  2
                   OFFSET 2)
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:00:00	2014-04-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:02:00.001	2014-04-04
val1d	10	NULL	12	17.0	25.0	2600	2015-05-04 01:01:00	2015-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04
val1e	10	NULL	25	17.0	25.0	2600	2014-08-04 01:01:00	2014-08-04


-- !query
SELECT *
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b <= t1d
                   LIMIT  2)
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1b	8	16	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1c	8	16	19	17.0	25.0	2600	2014-05-04 01:02:00.001	2014-05-05


-- !query
SELECT *
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b = t1b
                   LIMIT  2
                   OFFSET 2)
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:00:00	2014-04-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:02:00.001	2014-04-04
val1d	10	NULL	12	17.0	25.0	2600	2015-05-04 01:01:00	2015-05-04
val1d	NULL	16	19	17.0	25.0	2600	2014-07-04 01:02:00.001	NULL
val1d	NULL	16	22	17.0	25.0	2600	2014-06-04 01:01:00	NULL
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04
val1e	10	NULL	25	17.0	25.0	2600	2014-08-04 01:01:00	2014-08-04


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d NOT IN (SELECT t2d
                   FROM   t2
                   ORDER  BY t2b DESC nulls first, t2d
                   LIMIT 1
                   OFFSET 1)
GROUP  BY t1b
ORDER BY t1b NULLS last
LIMIT  1
OFFSET 1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
2	8


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d NOT IN (SELECT t2d
                   FROM   t2
                   WHERE t2b > t1b
                   ORDER  BY t2b DESC nulls first, t2d
                   LIMIT 1
                   OFFSET 1)
GROUP  BY t1b
ORDER BY t1b NULLS last
LIMIT  1
OFFSET 1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
2	8


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d)
OFFSET 2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1a IN (SELECT t2a
               FROM   t2
               WHERE  t1d = t2d
               ORDER BY t2a
               OFFSET 2)
OFFSET 2
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04


-- !query
SELECT *
FROM   t1
WHERE  t1c IN (SELECT t2c
               FROM   t2
               WHERE  t2b >= 8
               OFFSET 2)
OFFSET 4
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1d	NULL	16	19	17.0	25.0	2600	2014-07-04 01:02:00.001	NULL
val1d	NULL	16	22	17.0	25.0	2600	2014-06-04 01:01:00	NULL


-- !query
SELECT *
FROM   t1
WHERE  t1c IN (SELECT t2c
               FROM   t2
               WHERE  t2b < t1b
               ORDER BY t2c
               OFFSET 2)
OFFSET 1
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d IN (SELECT t2d
               FROM   t2
               ORDER  BY t2c, t2d
               OFFSET 2)
GROUP  BY t1b
ORDER  BY t1b DESC NULLS FIRST
OFFSET 1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
1	10
2	8


-- !query
SELECT *
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b > 6
                   OFFSET 2)
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:00:00	2014-04-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:02:00.001	2014-04-04


-- !query
SELECT count(*)
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b < t1b
                   OFFSET 2)
-- !query schema
struct<count(1):bigint>
-- !query output
12


-- !query
SELECT Count(DISTINCT( t1a )),
       t1b
FROM   t1
WHERE  t1d NOT IN (SELECT t2d
                   FROM   t2
                   ORDER  BY t2b DESC nulls first, t2d
                   OFFSET 1)
GROUP  BY t1b
ORDER BY t1b NULLS last
OFFSET 1
-- !query schema
struct<count(DISTINCT t1a):bigint,t1b:smallint>
-- !query output
2	10
1	16
1	NULL


-- !query
SELECT COUNT(DISTINCT(t1a))
FROM t1
WHERE t1d IN (SELECT t2d
              FROM   t2
              WHERE t1a IS NOT NULL
              LIMIT 10)
-- !query schema
struct<count(DISTINCT t1a):bigint>
-- !query output
4


-- !query
SELECT COUNT(DISTINCT(t1a))
FROM t1
WHERE t1d IN (SELECT MAX(t2d)
              FROM   t2
              WHERE t1a IS NOT NULL
              LIMIT 10)
-- !query schema
struct<count(DISTINCT t1a):bigint>
-- !query output
0


-- !query
SELECT COUNT(DISTINCT(t1a))
FROM t1
WHERE t1d IN (SELECT DISTINCT t2d
              FROM   t2
              WHERE t1a IS NOT NULL
              LIMIT 10)
-- !query schema
struct<count(DISTINCT t1a):bigint>
-- !query output
4


-- !query
set spark.sql.optimizer.decorrelateExistsIn.enabled = false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.decorrelateExistsIn.enabled	false


-- !query
SELECT *
FROM   t1
WHERE  t1b NOT IN (SELECT t2b
                   FROM   t2
                   WHERE  t2b = t1b
                   LIMIT  2
                   OFFSET 2)
-- !query schema
struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1e:float,t1f:double,t1g:decimal(4,0),t1h:timestamp,t1i:date>
-- !query output
val1a	16	12	10	15.0	20.0	2000	2014-07-04 01:01:00	2014-07-04
val1a	16	12	21	15.0	20.0	2000	2014-06-04 01:02:00.001	2014-06-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:00:00	2014-04-04
val1a	6	8	10	15.0	20.0	2000	2014-04-04 01:02:00.001	2014-04-04
val1d	10	NULL	12	17.0	25.0	2600	2015-05-04 01:01:00	2015-05-04
val1d	NULL	16	19	17.0	25.0	2600	2014-07-04 01:02:00.001	NULL
val1d	NULL	16	22	17.0	25.0	2600	2014-06-04 01:01:00	NULL
val1e	10	NULL	19	17.0	25.0	2600	2014-05-04 01:01:00	2014-05-04
val1e	10	NULL	19	17.0	25.0	2600	2014-09-04 01:02:00.001	2014-09-04
val1e	10	NULL	25	17.0	25.0	2600	2014-08-04 01:01:00	2014-08-04


-- !query
set spark.sql.optimizer.decorrelateExistsIn.enabled = true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.decorrelateExistsIn.enabled	true
