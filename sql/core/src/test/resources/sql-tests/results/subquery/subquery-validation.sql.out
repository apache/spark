-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t2_subq(col1 INT, col2 STRING) AS VALUES (1, 'a'), (2, 'b')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
CREATE TEMPORARY VIEW t3_subq(col1 INT) AS VALUES (1), (2), (3)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
CREATE TEMPORARY VIEW t4_subq(col1 INT, col2 STRING) AS VALUES (1, 'x'), (2, 'y')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
SELECT *
FROM (
    SELECT (
        SELECT t2_subq.col1
        FROM t2_subq
        WHERE t4_subq.col1 = t2_subq.col2
        LIMIT 1
    )
    FROM t4_subq
    GROUP BY (
        SELECT t2_subq.col1
        FROM t2_subq
        WHERE t4_subq.col1 = t2_subq.col2
        LIMIT 1
    )
)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t4_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 152,
    "stopIndex" : 158,
    "fragment" : "t4_subq"
  } ]
}


-- !query
SELECT *
FROM (
    SELECT 1 IN (
        SELECT t2_subq.col1
        FROM t2_subq
        WHERE t4_subq.col1 = t2_subq.col2
        LIMIT 1
    )
    FROM t4_subq
    GROUP BY 1 IN (
        SELECT t2_subq.col1
        FROM t2_subq
        WHERE t4_subq.col1 = t2_subq.col2
        LIMIT 1
    )
)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t4_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 157,
    "stopIndex" : 163,
    "fragment" : "t4_subq"
  } ]
}


-- !query
SELECT *
FROM (
    SELECT EXISTS (
        SELECT t2_subq.col1
        FROM t2_subq
        WHERE t4_subq.col1 = t2_subq.col2
        LIMIT 1
    )
    FROM t4_subq
    GROUP BY EXISTS (
        SELECT t2_subq.col1
        FROM t2_subq
        WHERE t4_subq.col1 = t2_subq.col2
        LIMIT 1
    )
)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t4_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 159,
    "stopIndex" : 165,
    "fragment" : "t4_subq"
  } ]
}


-- !query
SELECT col1 IN (SELECT col1 FROM t3_subq)
FROM t3_subq
GROUP BY col1 IN (SELECT col1 FROM t3_subq), col1
ORDER BY col1 IN (SELECT col1 FROM t3_subq)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t3_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 48,
    "stopIndex" : 54,
    "fragment" : "t3_subq"
  } ]
}


-- !query
SELECT col1 FROM t3_subq GROUP BY col1 IN (SELECT col1 FROM t3_subq), col1 ORDER BY col1 IN (SELECT col1 FROM t3_subq)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t3_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 18,
    "stopIndex" : 24,
    "fragment" : "t3_subq"
  } ]
}


-- !query
SELECT col1 FROM t3_subq GROUP BY col1 ORDER BY 1 IN (SELECT 1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t3_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 18,
    "stopIndex" : 24,
    "fragment" : "t3_subq"
  } ]
}


-- !query
SELECT col1 AS a, a + 1 FROM t3_subq GROUP BY col1 ORDER BY 1 IN (SELECT 1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t3_subq`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 36,
    "fragment" : "t3_subq"
  } ]
}


-- !query
SELECT (
    SELECT (
        SELECT LOWER('str':col)
    )
)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "UNEXPECTED_USE_OF_PARAMETER_MARKER",
  "sqlState" : "XX000",
  "messageParameters" : {
    "parameterMarker" : ":col"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 44,
    "stopIndex" : 52,
    "fragment" : "'str':col"
  } ]
}


-- !query
SELECT (
    SELECT 'a' IN (
        SELECT LOWER('str':col)
    )
)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "UNEXPECTED_USE_OF_PARAMETER_MARKER",
  "sqlState" : "XX000",
  "messageParameters" : {
    "parameterMarker" : ":col"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 51,
    "stopIndex" : 59,
    "fragment" : "'str':col"
  } ]
}


-- !query
SELECT (
    SELECT EXISTS (
        SELECT LCASE('str':col)
    )
)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "UNEXPECTED_USE_OF_PARAMETER_MARKER",
  "sqlState" : "XX000",
  "messageParameters" : {
    "parameterMarker" : ":col"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 51,
    "stopIndex" : 59,
    "fragment" : "'str':col"
  } ]
}


-- !query
DROP VIEW t2_subq
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`t2_subq`"
  }
}


-- !query
DROP VIEW t3_subq
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`t3_subq`"
  }
}


-- !query
DROP VIEW t4_subq
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`t4_subq`"
  }
}
