-- Automatically generated by SQLQueryTestSuite
-- !query
create temporary view t1(c1, c2) as values (0, 1), (1, 2)
-- !query schema
struct<>
-- !query output



-- !query
create temporary view t2(c1, c2) as values (0, 2), (0, 3)
-- !query schema
struct<>
-- !query output



-- !query
create temporary view t3(c1, c2) as values (0, 3), (1, 4), (2, 5)
-- !query schema
struct<>
-- !query output



-- !query
select * from t1 where exists (select count(*) from t2 where t2.c1 = t1.c1)
-- !query schema
struct<c1:int,c2:int>
-- !query output
0	1
1	2


-- !query
select * from t1 where not exists (select count(*) from t2 where t2.c1 = t1.c1)
-- !query schema
struct<c1:int,c2:int>
-- !query output



-- !query
select *, exists (select count(*) from t2 where t2.c1 = t1.c1) from t1
-- !query schema
struct<c1:int,c2:int,exists(c1):boolean>
-- !query output
0	1	true
1	2	true


-- !query
select *, not exists (select count(*) from t2 where t2.c1 = t1.c1) from t1
-- !query schema
struct<c1:int,c2:int,(NOT exists(c1)):boolean>
-- !query output
0	1	false
1	2	false


-- !query
select * from t1 where
 exists(select count(*) + 1 from t2 where t2.c1 = t1.c1) OR
 not exists (select count(*) - 1 from t2 where t2.c1 = t1.c1)
-- !query schema
struct<c1:int,c2:int>
-- !query output
0	1
1	2


-- !query
select * from t1 where
 (exists(select count(*) + 1 from t2 where t2.c1 = t1.c1) OR
 not exists(select count(*) - 1 from t2 where t2.c1 = t1.c1)) AND
 exists(select count(*) from t2 where t2.c1 = t1.c2)
-- !query schema
struct<c1:int,c2:int>
-- !query output
0	1
1	2


-- !query
select * from t1 where exists (select count(*) from t2 where t1.c1 = 100)
-- !query schema
struct<c1:int,c2:int>
-- !query output
0	1
1	2


-- !query
set spark.sql.optimizer.decorrelateExistsSubqueryLegacyIncorrectCountHandling.enabled = true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.decorrelateExistsSubqueryLegacyIncorrectCountHandling.enabled	true


-- !query
select * from t1 where exists (select count(*) from t2 where t2.c1 = t1.c1)
-- !query schema
struct<c1:int,c2:int>
-- !query output
0	1


-- !query
select * from t1 where not exists (select count(*) from t2 where t2.c1 = t1.c1)
-- !query schema
struct<c1:int,c2:int>
-- !query output
1	2


-- !query
select *, exists (select count(*) from t2 where t2.c1 = t1.c1) from t1
-- !query schema
struct<c1:int,c2:int,exists(c1):boolean>
-- !query output
0	1	true
1	2	false


-- !query
select *, not exists (select count(*) from t2 where t2.c1 = t1.c1) from t1
-- !query schema
struct<c1:int,c2:int,(NOT exists(c1)):boolean>
-- !query output
0	1	false
1	2	true


-- !query
select * from t1 where
 exists(select count(*) + 1 from t2 where t2.c1 = t1.c1) OR
 not exists (select count(*) - 1 from t2 where t2.c1 = t1.c1)
-- !query schema
struct<c1:int,c2:int>
-- !query output
0	1
1	2


-- !query
select * from t1 where exists (select count(*) from t2 where t1.c1 = 100)
-- !query schema
struct<c1:int,c2:int>
-- !query output



-- !query
set spark.sql.optimizer.decorrelateExistsSubqueryLegacyIncorrectCountHandling.enabled = false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.optimizer.decorrelateExistsSubqueryLegacyIncorrectCountHandling.enabled	false
