-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 7


-- !query 0
create temporary view tab_a as select * from values (1, 1) as tab_a(a1, b1)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
create temporary view tab_b as select * from values (1, 1) as tab_b(a2, b2)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
create temporary view struct_tab as select struct(col1 as a, col2 as b) as record from
 values (1, 1), (1, 2), (2, 1), (2, 2)
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
select 1 from tab_a where (a1, b1) not in (select a2, b2 from tab_b)
-- !query 3 schema
struct<1:int>
-- !query 3 output



-- !query 4
select 1 from tab_a where (a1, b1) not in (select (a2, b2) from tab_b)
-- !query 4 schema
struct<>
-- !query 4 output
org.apache.spark.sql.AnalysisException
cannot resolve '(named_struct('a1', tab_a.`a1`, 'b1', tab_a.`b1`) IN (listquery()))' due to data type mismatch: 
The number of columns in the left hand side of an IN subquery does not match the
number of columns in the output of subquery.
#columns in left hand side: 2.
#columns in right hand side: 1.
Left side columns:
[tab_a.`a1`, tab_a.`b1`].
Right side columns:
[`named_struct(a2, a2, b2, b2)`].;


-- !query 5
select count(*) from struct_tab where record in
  (select (a2 as a, b2 as b) from tab_b)
-- !query 5 schema
struct<count(1):bigint>
-- !query 5 output
1


-- !query 6
select count(*) from struct_tab where record not in
  (select (a2 as a, b2 as b) from tab_b)
-- !query 6 schema
struct<count(1):bigint>
-- !query 6 output
3
