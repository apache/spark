-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW tbl_x AS VALUES
  (1, NAMED_STRUCT('C', 'gamma', 'D', 'delta')),
  (2, NAMED_STRUCT('C', 'epsilon', 'D', 'eta')),
  (3, NAMED_STRUCT('C', 'theta', 'D', 'iota'))
  AS T(ID, ST)
-- !query schema
struct<>
-- !query output



-- !query
SELECT STRUCT('alpha', 'beta') ST
-- !query schema
struct<ST:struct<col1:string,col2:string>>
-- !query output
{"col1":"alpha","col2":"beta"}


-- !query
SELECT STRUCT('alpha' AS A, 'beta' AS B) ST
-- !query schema
struct<ST:struct<A:string,B:string>>
-- !query output
{"A":"alpha","B":"beta"}


-- !query
SELECT ID, STRUCT(ST.*) NST FROM tbl_x
-- !query schema
struct<ID:int,NST:struct<C:string,D:string>>
-- !query output
1	{"C":"gamma","D":"delta"}
2	{"C":"epsilon","D":"eta"}
3	{"C":"theta","D":"iota"}


-- !query
SELECT ID, STRUCT(ST.*,CAST(ID AS STRING) AS E) NST FROM tbl_x
-- !query schema
struct<ID:int,NST:struct<C:string,D:string,E:string>>
-- !query output
1	{"C":"gamma","D":"delta","E":"1"}
2	{"C":"epsilon","D":"eta","E":"2"}
3	{"C":"theta","D":"iota","E":"3"}


-- !query
SELECT ID, STRUCT(CAST(ID AS STRING) AS AA, ST.*) NST FROM tbl_x
-- !query schema
struct<ID:int,NST:struct<AA:string,C:string,D:string>>
-- !query output
1	{"AA":"1","C":"gamma","D":"delta"}
2	{"AA":"2","C":"epsilon","D":"eta"}
3	{"AA":"3","C":"theta","D":"iota"}


-- !query
SELECT ID, STRUCT(ST.*).C NST FROM tbl_x
-- !query schema
struct<ID:int,NST:string>
-- !query output
1	gamma
2	epsilon
3	theta


-- !query
SELECT ID, STRUCT(ST.C, ST.D).D NST FROM tbl_x
-- !query schema
struct<ID:int,NST:string>
-- !query output
1	delta
2	eta
3	iota


-- !query
SELECT ID, STRUCT(ST.C as STC, ST.D as STD).STD FROM tbl_x
-- !query schema
struct<ID:int,struct(ST.C AS STC, ST.D AS STD).STD:string>
-- !query output
1	delta
2	eta
3	iota
