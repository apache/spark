-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT * FROM testdata LIMIT 2
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2


-- !query
SELECT * FROM arraydata LIMIT 2
-- !query schema
struct<arraycol:array<int>,nestedarraycol:array<array<int>>>
-- !query output
[1,2,3]	[[1,2,3]]
[2,3,4]	[[2,3,4]]


-- !query
SELECT * FROM mapdata LIMIT 2
-- !query schema
struct<mapcol:map<int,string>>
-- !query output
{1:"a1",2:"b1",3:"c1",4:"d1",5:"e1"}
{1:"a2",2:"b2",3:"c2",4:"d2"}


-- !query
SELECT * FROM testdata LIMIT 2 + 1
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2
3	3


-- !query
SELECT * FROM testdata LIMIT CAST(1 AS int)
-- !query schema
struct<key:int,value:string>
-- !query output
1	1


-- !query
SELECT * FROM testdata LIMIT -1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_LIMIT_LIKE_EXPRESSION.IS_NEGATIVE",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "expr" : "\"-1\"",
    "name" : "limit",
    "v" : "-1"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 31,
    "fragment" : "-1"
  } ]
}


-- !query
SELECT * FROM testData TABLESAMPLE (-1 ROWS)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_LIMIT_LIKE_EXPRESSION.IS_NEGATIVE",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "expr" : "\"-1\"",
    "name" : "limit",
    "v" : "-1"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 37,
    "stopIndex" : 38,
    "fragment" : "-1"
  } ]
}


-- !query
SELECT * FROM testdata LIMIT CAST(1 AS INT)
-- !query schema
struct<key:int,value:string>
-- !query output
1	1


-- !query
SELECT * FROM testdata LIMIT CAST(NULL AS INT)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_LIMIT_LIKE_EXPRESSION.IS_NULL",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "expr" : "\"CAST(NULL AS INT)\"",
    "name" : "limit"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 46,
    "fragment" : "CAST(NULL AS INT)"
  } ]
}


-- !query
SELECT * FROM testdata LIMIT key > 3
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_LIMIT_LIKE_EXPRESSION.IS_UNFOLDABLE",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "expr" : "\"(key > 3)\"",
    "name" : "limit"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 36,
    "fragment" : "key > 3"
  } ]
}


-- !query
SELECT * FROM testdata LIMIT true
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_LIMIT_LIKE_EXPRESSION.DATA_TYPE",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "dataType" : "\"BOOLEAN\"",
    "expr" : "\"true\"",
    "name" : "limit"
  }
}


-- !query
SELECT * FROM testdata LIMIT 'a'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_LIMIT_LIKE_EXPRESSION.DATA_TYPE",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "dataType" : "\"STRING\"",
    "expr" : "\"a\"",
    "name" : "limit"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 32,
    "fragment" : "'a'"
  } ]
}


-- !query
SELECT * FROM (SELECT * FROM range(10) LIMIT 5) WHERE id > 3
-- !query schema
struct<id:bigint>
-- !query output
4


-- !query
SELECT * FROM testdata WHERE key < 3 LIMIT ALL
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2
