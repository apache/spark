-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT * FROM testdata LIMIT 2
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2


-- !query
SELECT * FROM arraydata LIMIT 2
-- !query schema
struct<arraycol:array<int>,nestedarraycol:array<array<int>>>
-- !query output
[1,2,3]	[[1,2,3]]
[2,3,4]	[[2,3,4]]


-- !query
SELECT * FROM mapdata LIMIT 2
-- !query schema
struct<mapcol:map<int,string>>
-- !query output
{1:"a1",2:"b1",3:"c1",4:"d1",5:"e1"}
{1:"a2",2:"b2",3:"c2",4:"d2"}


-- !query
SELECT * FROM testdata LIMIT 2 + 1
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2
3	3


-- !query
SELECT * FROM testdata LIMIT CAST(1 AS int)
-- !query schema
struct<key:int,value:string>
-- !query output
1	1


-- !query
SELECT * FROM testdata LIMIT -1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_2403",
  "messageParameters" : {
    "name" : "limit",
    "v" : "-1"
  }
}


-- !query
SELECT * FROM testData TABLESAMPLE (-1 ROWS)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_2403",
  "messageParameters" : {
    "name" : "limit",
    "v" : "-1"
  }
}


-- !query
SELECT * FROM testdata LIMIT CAST(1 AS INT)
-- !query schema
struct<key:int,value:string>
-- !query output
1	1


-- !query
SELECT * FROM testdata LIMIT CAST(NULL AS INT)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_2402",
  "messageParameters" : {
    "limitExpr" : "CAST(NULL AS INT)",
    "name" : "limit"
  }
}


-- !query
SELECT * FROM testdata LIMIT key > 3
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_2400",
  "messageParameters" : {
    "limitExpr" : "(spark_catalog.default.testdata.key > 3)",
    "name" : "limit"
  }
}


-- !query
SELECT * FROM testdata LIMIT true
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_2401",
  "messageParameters" : {
    "dataType" : "boolean",
    "name" : "limit"
  }
}


-- !query
SELECT * FROM testdata LIMIT 'a'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_2401",
  "messageParameters" : {
    "dataType" : "string",
    "name" : "limit"
  }
}


-- !query
SELECT * FROM (SELECT * FROM range(10) LIMIT 5) WHERE id > 3
-- !query schema
struct<id:bigint>
-- !query output
4


-- !query
SELECT * FROM testdata WHERE key < 3 LIMIT ALL
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2
