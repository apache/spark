-- Automatically generated by SQLQueryTestSuite
-- !query
create temporary view nt1 as select * from values
  ("one", 1),
  ("two", 2),
  ("three", 3)
  as nt1(k, v1)
-- !query schema
struct<>
-- !query output



-- !query
create temporary view nt2 as select * from values
  ("one", 1),
  ("two", 22),
  ("one", 5),
  ("four", 4)
  as nt2(k, v2)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM nt1 left outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,v2:int>
-- !query output
one	1	1
one	1	5
three	3	NULL
two	2	22


-- !query
SELECT k FROM nt1 left outer join nt2 using (k)
-- !query schema
struct<k:string>
-- !query output
one
one
three
two


-- !query
SELECT nt1.*, nt2.* FROM nt1 left outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,k:string,v2:int>
-- !query output
one	1	one	1
one	1	one	5
three	3	NULL	NULL
two	2	two	22


-- !query
SELECT nt1.k, nt2.k FROM nt1 left outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
one	one
three	NULL
two	two


-- !query
SELECT k FROM (SELECT nt2.k FROM nt1 left outer join nt2 using (k))
-- !query schema
struct<k:string>
-- !query output
NULL
one
one
two


-- !query
SELECT nt2.k AS key FROM nt1 left outer join nt2 using (k) ORDER BY key
-- !query schema
struct<key:string>
-- !query output
NULL
one
one
two


-- !query
SELECT nt1.k, nt2.k FROM nt1 left outer join nt2 using (k) ORDER BY nt2.k
-- !query schema
struct<k:string,k:string>
-- !query output
three	NULL
one	one
one	one
two	two


-- !query
SELECT k, nt1.k FROM nt1 left outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
one	one
three	three
two	two


-- !query
SELECT k, nt2.k FROM nt1 left outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
one	one
three	NULL
two	two


-- !query
SELECT * FROM nt1 left semi join nt2 using (k)
-- !query schema
struct<k:string,v1:int>
-- !query output
one	1
two	2


-- !query
SELECT k FROM nt1 left semi join nt2 using (k)
-- !query schema
struct<k:string>
-- !query output
one
two


-- !query
SELECT nt1.* FROM nt1 left semi join nt2 using (k)
-- !query schema
struct<k:string,v1:int>
-- !query output
one	1
two	2


-- !query
SELECT nt1.k FROM nt1 left semi join nt2 using (k)
-- !query schema
struct<k:string>
-- !query output
one
two


-- !query
SELECT k, nt1.k FROM nt1 left semi join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
two	two


-- !query
SELECT * FROM nt1 right outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,v2:int>
-- !query output
four	NULL	4
one	1	1
one	1	5
two	2	22


-- !query
SELECT k FROM nt1 right outer join nt2 using (k)
-- !query schema
struct<k:string>
-- !query output
four
one
one
two


-- !query
SELECT nt1.*, nt2.* FROM nt1 right outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,k:string,v2:int>
-- !query output
NULL	NULL	four	4
one	1	one	1
one	1	one	5
two	2	two	22


-- !query
SELECT nt1.k, nt2.k FROM nt1 right outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
NULL	four
one	one
one	one
two	two


-- !query
SELECT k FROM (SELECT nt1.k FROM nt1 right outer join nt2 using (k))
-- !query schema
struct<k:string>
-- !query output
NULL
one
one
two


-- !query
SELECT nt1.k AS key FROM nt1 right outer join nt2 using (k) ORDER BY key
-- !query schema
struct<key:string>
-- !query output
NULL
one
one
two


-- !query
SELECT k, nt1.k FROM nt1 right outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
four	NULL
one	one
one	one
two	two


-- !query
SELECT k, nt2.k FROM nt1 right outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
four	four
one	one
one	one
two	two


-- !query
SELECT * FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,v2:int>
-- !query output
four	NULL	4
one	1	1
one	1	5
three	3	NULL
two	2	22


-- !query
SELECT k FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string>
-- !query output
four
one
one
three
two


-- !query
SELECT nt1.*, nt2.* FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,k:string,v2:int>
-- !query output
NULL	NULL	four	4
one	1	one	1
one	1	one	5
three	3	NULL	NULL
two	2	two	22


-- !query
SELECT nt1.k, nt2.k FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
NULL	four
one	one
one	one
three	NULL
two	two


-- !query
SELECT k FROM (SELECT nt2.k FROM nt1 full outer join nt2 using (k))
-- !query schema
struct<k:string>
-- !query output
NULL
four
one
one
two


-- !query
SELECT nt2.k AS key FROM nt1 full outer join nt2 using (k) ORDER BY key
-- !query schema
struct<key:string>
-- !query output
NULL
four
one
one
two


-- !query
SELECT k, nt1.k FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
four	NULL
one	one
one	one
three	three
two	two


-- !query
SELECT k, nt2.k FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
four	four
one	one
one	one
three	NULL
two	two


-- !query
SELECT * FROM nt1 full outer join nt2 using (k)
-- !query schema
struct<k:string,v1:int,v2:int>
-- !query output
four	NULL	4
one	1	1
one	1	5
three	3	NULL
two	2	22


-- !query
SELECT k FROM nt1 inner join nt2 using (k)
-- !query schema
struct<k:string>
-- !query output
one
one
two


-- !query
SELECT nt1.*, nt2.* FROM nt1 inner join nt2 using (k)
-- !query schema
struct<k:string,v1:int,k:string,v2:int>
-- !query output
one	1	one	1
one	1	one	5
two	2	two	22


-- !query
SELECT nt1.k, nt2.k FROM nt1 inner join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
one	one
two	two


-- !query
SELECT k FROM (SELECT nt2.k FROM nt1 inner join nt2 using (k))
-- !query schema
struct<k:string>
-- !query output
one
one
two


-- !query
SELECT nt2.k AS key FROM nt1 inner join nt2 using (k) ORDER BY key
-- !query schema
struct<key:string>
-- !query output
one
one
two


-- !query
SELECT k, nt1.k FROM nt1 inner join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
one	one
two	two


-- !query
SELECT k, nt2.k FROM nt1 inner join nt2 using (k)
-- !query schema
struct<k:string,k:string>
-- !query output
one	one
one	one
two	two


-- !query
WITH
  t1 AS (select key from values ('a') t(key)),
  t2 AS (select key from values ('a') t(key))
SELECT t1.key
FROM t1 FULL OUTER JOIN t2 USING (key)
WHERE t1.key NOT LIKE 'bb.%'
-- !query schema
struct<key:string>
-- !query output
a


-- !query
CREATE TEMPORARY VIEW using_t1(col1 BOOLEAN) AS VALUES (true), (false)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
SELECT *
FROM
    ( SELECT col1 FROM using_t1 ) LEFT JOIN ( SELECT col1 FROM using_t1 ) b USING(col1)
WHERE b.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`using_t1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 38,
    "stopIndex" : 45,
    "fragment" : "using_t1"
  } ]
}


-- !query
CREATE TEMPORARY VIEW using_t2(col1 TIMESTAMP, col2 STRING) AS SELECT CURRENT_TIMESTAMP(), 'str'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
SELECT col2 AS alias FROM using_t2 as t1_1 LEFT ANTI JOIN using_t2 as t1_2 ON t1_1.col1 = t1_2.col1 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`using_t2`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 27,
    "stopIndex" : 34,
    "fragment" : "using_t2"
  } ]
}


-- !query
SELECT col2 AS alias FROM using_t2 as t1_1 LEFT SEMI JOIN using_t2 as t1_2 ON t1_1.col1 = t1_2.col1 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`using_t2`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 27,
    "stopIndex" : 34,
    "fragment" : "using_t2"
  } ]
}


-- !query
SELECT col1 FROM using_t2 as t1_1 LEFT SEMI JOIN using_t2 as t1_2 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`using_t2`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 18,
    "stopIndex" : 25,
    "fragment" : "using_t2"
  } ]
}


-- !query
SELECT col1 FROM using_t2 as t1_1 LEFT SEMI JOIN using_t2 as t1_2 GROUP BY ALL HAVING MIN(col2) > ''
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`using_t2`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 18,
    "stopIndex" : 25,
    "fragment" : "using_t2"
  } ]
}


-- !query
DROP VIEW using_t1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`using_t1`"
  }
}


-- !query
DROP VIEW using_t2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`using_t2`"
  }
}
