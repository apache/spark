-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT 1 AS one
-- !query schema
struct<one:int>
-- !query output
1


-- !query
SELECT true AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT false AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('t') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('   f           ') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('true') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('test') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'test'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "boolean('test')"
  } ]
}


-- !query
SELECT boolean('false') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('foo') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'foo'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 21,
    "fragment" : "boolean('foo')"
  } ]
}


-- !query
SELECT boolean('y') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('yes') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('yeah') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'yeah'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "boolean('yeah')"
  } ]
}


-- !query
SELECT boolean('n') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('no') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('nay') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'nay'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 21,
    "fragment" : "boolean('nay')"
  } ]
}


-- !query
SELECT boolean('on') AS true
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'on'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "boolean('on')"
  } ]
}


-- !query
SELECT boolean('off') AS `false`
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'off'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 21,
    "fragment" : "boolean('off')"
  } ]
}


-- !query
SELECT boolean('of') AS `false`
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'of'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "boolean('of')"
  } ]
}


-- !query
SELECT boolean('o') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'o'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 19,
    "fragment" : "boolean('o')"
  } ]
}


-- !query
SELECT boolean('on_') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'on_'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 21,
    "fragment" : "boolean('on_')"
  } ]
}


-- !query
SELECT boolean('off_') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'off_'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "boolean('off_')"
  } ]
}


-- !query
SELECT boolean('1') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('11') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'11'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "boolean('11')"
  } ]
}


-- !query
SELECT boolean('0') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('000') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'000'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 21,
    "fragment" : "boolean('000')"
  } ]
}


-- !query
SELECT boolean('') AS error
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "''",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 18,
    "fragment" : "boolean('')"
  } ]
}


-- !query
SELECT boolean('t') or boolean('f') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('t') and boolean('f') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT not boolean('f') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('t') = boolean('f') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
SELECT boolean('t') <> boolean('f') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('t') > boolean('f') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('t') >= boolean('f') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('f') < boolean('t') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean('f') <= boolean('t') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT boolean(string('TrUe')) AS true, boolean(string('fAlse')) AS `false`
-- !query schema
struct<true:boolean,false:boolean>
-- !query output
true	false


-- !query
SELECT boolean(string('    true   ')) AS true,
       boolean(string('     FALSE')) AS `false`
-- !query schema
struct<true:boolean,false:boolean>
-- !query output
true	false


-- !query
SELECT string(boolean(true)) AS true, string(boolean(false)) AS `false`
-- !query schema
struct<true:string,false:string>
-- !query output
true	false


-- !query
SELECT boolean(string('  tru e ')) AS invalid
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'  tru e '",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 34,
    "fragment" : "boolean(string('  tru e '))"
  } ]
}


-- !query
SELECT boolean(string('')) AS invalid
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "''",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BOOLEAN\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 26,
    "fragment" : "boolean(string(''))"
  } ]
}


-- !query
CREATE TABLE BOOLTBL1 (f1 boolean) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL1 VALUES (cast('t' as boolean))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL1 VALUES (cast('True' as boolean))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL1 VALUES (cast('true' as boolean))
-- !query schema
struct<>
-- !query output



-- !query
SELECT '' AS t_3, BOOLTBL1.* FROM BOOLTBL1
-- !query schema
struct<t_3:string,f1:boolean>
-- !query output
	true
	true
	true


-- !query
SELECT '' AS t_3, BOOLTBL1.*
   FROM BOOLTBL1
   WHERE f1 = boolean('true')
-- !query schema
struct<t_3:string,f1:boolean>
-- !query output
	true
	true
	true


-- !query
SELECT '' AS t_3, BOOLTBL1.*
   FROM BOOLTBL1
   WHERE f1 <> boolean('false')
-- !query schema
struct<t_3:string,f1:boolean>
-- !query output
	true
	true
	true


-- !query
SELECT '' AS zero, BOOLTBL1.*
   FROM BOOLTBL1
   WHERE booleq(boolean('false'), f1)
-- !query schema
struct<zero:string,f1:boolean>
-- !query output



-- !query
INSERT INTO BOOLTBL1 VALUES (boolean('f'))
-- !query schema
struct<>
-- !query output



-- !query
SELECT '' AS f_1, BOOLTBL1.*
   FROM BOOLTBL1
   WHERE f1 = boolean('false')
-- !query schema
struct<f_1:string,f1:boolean>
-- !query output
	false


-- !query
CREATE TABLE BOOLTBL2 (f1 boolean) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL2 VALUES (boolean('f'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL2 VALUES (boolean('false'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL2 VALUES (boolean('False'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL2 VALUES (boolean('FALSE'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL2
   VALUES (boolean('XXX'))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_INLINE_TABLE.FAILED_SQL_EXPRESSION_EVALUATION",
  "sqlState" : "42000",
  "messageParameters" : {
    "sqlExpr" : "\"XXX\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 25,
    "stopIndex" : 47,
    "fragment" : "VALUES (boolean('XXX'))"
  } ]
}


-- !query
SELECT '' AS f_4, BOOLTBL2.* FROM BOOLTBL2
-- !query schema
struct<f_4:string,f1:boolean>
-- !query output
	false
	false
	false
	false


-- !query
SELECT '' AS tf_12, BOOLTBL1.*, BOOLTBL2.*
   FROM BOOLTBL1, BOOLTBL2
   WHERE BOOLTBL2.f1 <> BOOLTBL1.f1
-- !query schema
struct<tf_12:string,f1:boolean,f1:boolean>
-- !query output
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false


-- !query
SELECT '' AS tf_12, BOOLTBL1.*, BOOLTBL2.*
   FROM BOOLTBL1, BOOLTBL2
   WHERE boolne(BOOLTBL2.f1,BOOLTBL1.f1)
-- !query schema
struct<tf_12:string,f1:boolean,f1:boolean>
-- !query output
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false


-- !query
SELECT '' AS ff_4, BOOLTBL1.*, BOOLTBL2.*
   FROM BOOLTBL1, BOOLTBL2
   WHERE BOOLTBL2.f1 = BOOLTBL1.f1 and BOOLTBL1.f1 = boolean('false')
-- !query schema
struct<ff_4:string,f1:boolean,f1:boolean>
-- !query output
	false	false
	false	false
	false	false
	false	false


-- !query
SELECT '' AS tf_12_ff_4, BOOLTBL1.*, BOOLTBL2.*
   FROM BOOLTBL1, BOOLTBL2
   WHERE BOOLTBL2.f1 = BOOLTBL1.f1 or BOOLTBL1.f1 = boolean('true')
   ORDER BY BOOLTBL1.f1, BOOLTBL2.f1
-- !query schema
struct<tf_12_ff_4:string,f1:boolean,f1:boolean>
-- !query output
	false	false
	false	false
	false	false
	false	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false
	true	false


-- !query
SELECT '' AS True, f1
   FROM BOOLTBL1
   WHERE f1 IS TRUE
-- !query schema
struct<True:string,f1:boolean>
-- !query output
	true
	true
	true


-- !query
SELECT '' AS `Not False`, f1
   FROM BOOLTBL1
   WHERE f1 IS NOT FALSE
-- !query schema
struct<Not False:string,f1:boolean>
-- !query output
	true
	true
	true


-- !query
SELECT '' AS `False`, f1
   FROM BOOLTBL1
   WHERE f1 IS FALSE
-- !query schema
struct<False:string,f1:boolean>
-- !query output
	false


-- !query
SELECT '' AS `Not True`, f1
   FROM BOOLTBL1
   WHERE f1 IS NOT TRUE
-- !query schema
struct<Not True:string,f1:boolean>
-- !query output
	false


-- !query
SELECT '' AS `True`, f1
   FROM BOOLTBL2
   WHERE f1 IS TRUE
-- !query schema
struct<True:string,f1:boolean>
-- !query output



-- !query
SELECT '' AS `Not False`, f1
   FROM BOOLTBL2
   WHERE f1 IS NOT FALSE
-- !query schema
struct<Not False:string,f1:boolean>
-- !query output



-- !query
SELECT '' AS `False`, f1
   FROM BOOLTBL2
   WHERE f1 IS FALSE
-- !query schema
struct<False:string,f1:boolean>
-- !query output
	false
	false
	false
	false


-- !query
SELECT '' AS `Not True`, f1
   FROM BOOLTBL2
   WHERE f1 IS NOT TRUE
-- !query schema
struct<Not True:string,f1:boolean>
-- !query output
	false
	false
	false
	false


-- !query
CREATE TABLE BOOLTBL3 (d string, b boolean, o int) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL3 VALUES ('true', true, 1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL3 VALUES ('false', false, 2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO BOOLTBL3 VALUES ('null', null, 3)
-- !query schema
struct<>
-- !query output



-- !query
SELECT
    d,
    b IS TRUE AS istrue,
    b IS NOT TRUE AS isnottrue,
    b IS FALSE AS isfalse,
    b IS NOT FALSE AS isnotfalse,
    b IS UNKNOWN AS isunknown,
    b IS NOT UNKNOWN AS isnotunknown
FROM booltbl3 ORDER BY o
-- !query schema
struct<d:string,istrue:boolean,isnottrue:boolean,isfalse:boolean,isnotfalse:boolean,isunknown:boolean,isnotunknown:boolean>
-- !query output
true	true	false	false	true	false	true
false	false	true	true	false	false	true
null	false	true	false	true	true	false


-- !query
CREATE TABLE booltbl4(isfalse boolean, istrue boolean, isnul boolean) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO booltbl4 VALUES (false, true, null)
-- !query schema
struct<>
-- !query output



-- !query
SELECT istrue AND isnul AND istrue FROM booltbl4
-- !query schema
struct<((istrue AND isnul) AND istrue):boolean>
-- !query output
NULL


-- !query
SELECT istrue AND istrue AND isnul FROM booltbl4
-- !query schema
struct<((istrue AND istrue) AND isnul):boolean>
-- !query output
NULL


-- !query
SELECT isnul AND istrue AND istrue FROM booltbl4
-- !query schema
struct<((isnul AND istrue) AND istrue):boolean>
-- !query output
NULL


-- !query
SELECT isfalse AND isnul AND istrue FROM booltbl4
-- !query schema
struct<((isfalse AND isnul) AND istrue):boolean>
-- !query output
false


-- !query
SELECT istrue AND isfalse AND isnul FROM booltbl4
-- !query schema
struct<((istrue AND isfalse) AND isnul):boolean>
-- !query output
false


-- !query
SELECT isnul AND istrue AND isfalse FROM booltbl4
-- !query schema
struct<((isnul AND istrue) AND isfalse):boolean>
-- !query output
false


-- !query
SELECT isfalse OR isnul OR isfalse FROM booltbl4
-- !query schema
struct<((isfalse OR isnul) OR isfalse):boolean>
-- !query output
NULL


-- !query
SELECT isfalse OR isfalse OR isnul FROM booltbl4
-- !query schema
struct<((isfalse OR isfalse) OR isnul):boolean>
-- !query output
NULL


-- !query
SELECT isnul OR isfalse OR isfalse FROM booltbl4
-- !query schema
struct<((isnul OR isfalse) OR isfalse):boolean>
-- !query output
NULL


-- !query
SELECT isfalse OR isnul OR istrue FROM booltbl4
-- !query schema
struct<((isfalse OR isnul) OR istrue):boolean>
-- !query output
true


-- !query
SELECT istrue OR isfalse OR isnul FROM booltbl4
-- !query schema
struct<((istrue OR isfalse) OR isnul):boolean>
-- !query output
true


-- !query
SELECT isnul OR istrue OR isfalse FROM booltbl4
-- !query schema
struct<((isnul OR istrue) OR isfalse):boolean>
-- !query output
true


-- !query
DROP TABLE  BOOLTBL1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE  BOOLTBL2
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE  BOOLTBL3
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE  BOOLTBL4
-- !query schema
struct<>
-- !query output

