-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE test_missing_target (a int, b int, c string, d string) using parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (0, 1, 'XXXX', 'A')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (1, 2, 'ABAB', 'b')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (2, 2, 'ABAB', 'c')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (3, 3, 'BBBB', 'D')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (4, 3, 'BBBB', 'e')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (5, 3, 'bbbb', 'F')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (6, 4, 'cccc', 'g')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (7, 4, 'cccc', 'h')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (8, 4, 'CCCC', 'I')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO test_missing_target VALUES (9, 4, 'CCCC', 'j')
-- !query schema
struct<>
-- !query output



-- !query
SELECT c, count(*) FROM test_missing_target GROUP BY test_missing_target.c ORDER BY c
-- !query schema
struct<c:string,count(1):bigint>
-- !query output
ABAB	2
BBBB	2
CCCC	2
XXXX	1
bbbb	1
cccc	2


-- !query
SELECT count(*) FROM test_missing_target GROUP BY test_missing_target.c ORDER BY c
-- !query schema
struct<count(1):bigint>
-- !query output
2
2
2
1
1
2


-- !query
SELECT count(*) FROM test_missing_target GROUP BY a ORDER BY b
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`b`",
    "proposal" : "`count(1)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 62,
    "stopIndex" : 62,
    "fragment" : "b"
  } ]
}


-- !query
SELECT count(*) FROM test_missing_target GROUP BY b ORDER BY b
-- !query schema
struct<count(1):bigint>
-- !query output
1
2
3
4


-- !query
SELECT test_missing_target.b, count(*)
  FROM test_missing_target GROUP BY b ORDER BY b
-- !query schema
struct<b:int,count(1):bigint>
-- !query output
1	1
2	2
3	3
4	4


-- !query
SELECT c FROM test_missing_target ORDER BY a
-- !query schema
struct<c:string>
-- !query output
XXXX
ABAB
ABAB
BBBB
BBBB
bbbb
cccc
cccc
CCCC
CCCC


-- !query
SELECT count(*) FROM test_missing_target GROUP BY b ORDER BY b desc
-- !query schema
struct<count(1):bigint>
-- !query output
4
3
2
1


-- !query
SELECT count(*) FROM test_missing_target ORDER BY 1 desc
-- !query schema
struct<count(1):bigint>
-- !query output
10


-- !query
SELECT c, count(*) FROM test_missing_target GROUP BY 1 ORDER BY 1
-- !query schema
struct<c:string,count(1):bigint>
-- !query output
ABAB	2
BBBB	2
CCCC	2
XXXX	1
bbbb	1
cccc	2


-- !query
SELECT c, count(*) FROM test_missing_target GROUP BY 3
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "GROUP_BY_POS_OUT_OF_RANGE",
  "sqlState" : "42805",
  "messageParameters" : {
    "index" : "3",
    "size" : "2"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 54,
    "stopIndex" : 54,
    "fragment" : "3"
  } ]
}


-- !query
SELECT count(*) FROM test_missing_target x, test_missing_target y
	WHERE x.a = y.a
	GROUP BY b ORDER BY b
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`b`",
    "referenceNames" : "[`x`.`b`, `y`.`b`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 94,
    "stopIndex" : 94,
    "fragment" : "b"
  } ]
}


-- !query
SELECT a, a FROM test_missing_target
	ORDER BY a
-- !query schema
struct<a:int,a:int>
-- !query output
0	0
1	1
2	2
3	3
4	4
5	5
6	6
7	7
8	8
9	9


-- !query
SELECT a/2, a/2 FROM test_missing_target
	ORDER BY a/2
-- !query schema
struct<(a / 2):double,(a / 2):double>
-- !query output
0.0	0.0
0.5	0.5
1.0	1.0
1.5	1.5
2.0	2.0
2.5	2.5
3.0	3.0
3.5	3.5
4.0	4.0
4.5	4.5


-- !query
SELECT a/2, a/2 FROM test_missing_target
	GROUP BY a/2 ORDER BY a/2
-- !query schema
struct<(a / 2):double,(a / 2):double>
-- !query output
0.0	0.0
0.5	0.5
1.0	1.0
1.5	1.5
2.0	2.0
2.5	2.5
3.0	3.0
3.5	3.5
4.0	4.0
4.5	4.5


-- !query
SELECT x.b, count(*) FROM test_missing_target x, test_missing_target y
	WHERE x.a = y.a
	GROUP BY x.b ORDER BY x.b
-- !query schema
struct<b:int,count(1):bigint>
-- !query output
1	1
2	2
3	3
4	4


-- !query
SELECT count(*) FROM test_missing_target x, test_missing_target y
	WHERE x.a = y.a
	GROUP BY x.b ORDER BY x.b
-- !query schema
struct<count(1):bigint>
-- !query output
1
2
3
4


-- !query
SELECT a%2, count(b) FROM test_missing_target
GROUP BY test_missing_target.a%2
ORDER BY test_missing_target.a%2
-- !query schema
struct<(a % 2):int,count(b):bigint>
-- !query output
0	5
1	5


-- !query
SELECT count(c) FROM test_missing_target
GROUP BY lower(test_missing_target.c)
ORDER BY lower(test_missing_target.c)
-- !query schema
struct<count(c):bigint>
-- !query output
2
3
4
1


-- !query
SELECT count(a) FROM test_missing_target GROUP BY a ORDER BY b
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`b`",
    "proposal" : "`count(a)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 62,
    "stopIndex" : 62,
    "fragment" : "b"
  } ]
}


-- !query
SELECT count(b) FROM test_missing_target GROUP BY b/2 ORDER BY b/2
-- !query schema
struct<count(b):bigint>
-- !query output
1
2
3
4


-- !query
SELECT lower(test_missing_target.c), count(c)
  FROM test_missing_target GROUP BY lower(c) ORDER BY lower(c)
-- !query schema
struct<lower(c):string,count(c):bigint>
-- !query output
abab	2
bbbb	3
cccc	4
xxxx	1


-- !query
SELECT a FROM test_missing_target ORDER BY upper(d)
-- !query schema
struct<a:int>
-- !query output
0
1
2
3
4
5
6
7
8
9


-- !query
SELECT count(b) FROM test_missing_target
	GROUP BY (b + 1) / 2 ORDER BY (b + 1) / 2 desc
-- !query schema
struct<count(b):bigint>
-- !query output
4
3
2
1


-- !query
SELECT count(x.a) FROM test_missing_target x, test_missing_target y
	WHERE x.a = y.a
	GROUP BY b/2 ORDER BY b/2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`b`",
    "referenceNames" : "[`x`.`b`, `y`.`b`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 96,
    "stopIndex" : 96,
    "fragment" : "b"
  } ]
}


-- !query
SELECT x.b/2, count(x.b) FROM test_missing_target x, test_missing_target y
	WHERE x.a = y.a
	GROUP BY x.b/2 ORDER BY x.b/2
-- !query schema
struct<(b / 2):double,count(b):bigint>
-- !query output
0.5	1
1.0	2
1.5	3
2.0	4


-- !query
SELECT count(b) FROM test_missing_target x, test_missing_target y
	WHERE x.a = y.a
	GROUP BY x.b/2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`b`",
    "referenceNames" : "[`x`.`b`, `y`.`b`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 14,
    "stopIndex" : 14,
    "fragment" : "b"
  } ]
}


-- !query
DROP TABLE test_missing_target
-- !query schema
struct<>
-- !query output

