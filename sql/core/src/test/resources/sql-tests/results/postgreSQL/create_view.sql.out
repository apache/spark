-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 195


-- !query 0
CREATE TABLE emp (
  name string,
  age int,
  salary int,
  manager string
) USING parquet
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE VIEW toyemp AS
   SELECT name, age, /* location ,*/ 12*salary AS annualsal
   FROM emp
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
DROP VIEW toyemp
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
DROP TABLE emp
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
CREATE TABLE view_base_table (key int /* PRIMARY KEY */, data varchar(20))
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
CREATE VIEW key_dependent_view AS
   SELECT * FROM view_base_table GROUP BY key
-- !query 5 schema
struct<>
-- !query 5 output
org.apache.spark.sql.AnalysisException
expression 'default.view_base_table.`data`' is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) if you don't care which value you get.;


-- !query 6
CREATE VIEW key_dependent_view_no_cols AS
   SELECT FROM view_base_table GROUP BY key HAVING length(data) > 0
-- !query 6 schema
struct<>
-- !query 6 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'FROM'(line 2, pos 10)

== SQL ==
CREATE VIEW key_dependent_view_no_cols AS
   SELECT FROM view_base_table GROUP BY key HAVING length(data) > 0
----------^^^


-- !query 7
CREATE TABLE viewtest_tbl (a int, b int) using parquet
-- !query 7 schema
struct<>
-- !query 7 output



-- !query 8
INSERT INTO viewtest_tbl VALUES (5, 10), (10, 15), (15, 20), (20, 25)
-- !query 8 schema
struct<>
-- !query 8 output



-- !query 9
CREATE OR REPLACE VIEW viewtest AS
	SELECT * FROM viewtest_tbl
-- !query 9 schema
struct<>
-- !query 9 output



-- !query 10
CREATE OR REPLACE VIEW viewtest AS
	SELECT * FROM viewtest_tbl WHERE a > 10
-- !query 10 schema
struct<>
-- !query 10 output



-- !query 11
SELECT * FROM viewtest
-- !query 11 schema
struct<a:int,b:int>
-- !query 11 output
15	20
20	25


-- !query 12
CREATE OR REPLACE VIEW viewtest AS
	SELECT a, b FROM viewtest_tbl WHERE a > 5 ORDER BY b DESC
-- !query 12 schema
struct<>
-- !query 12 output



-- !query 13
SELECT * FROM viewtest
-- !query 13 schema
struct<a:int,b:int>
-- !query 13 output
20	25
15	20
10	15


-- !query 14
CREATE OR REPLACE VIEW viewtest AS
	SELECT a FROM viewtest_tbl WHERE a <> 20
-- !query 14 schema
struct<>
-- !query 14 output



-- !query 15
CREATE OR REPLACE VIEW viewtest AS
	SELECT 1, * FROM viewtest_tbl
-- !query 15 schema
struct<>
-- !query 15 output



-- !query 16
CREATE OR REPLACE VIEW viewtest AS
	SELECT a, decimal(b) FROM viewtest_tbl
-- !query 16 schema
struct<>
-- !query 16 output



-- !query 17
CREATE OR REPLACE VIEW viewtest AS
	SELECT a, b, 0 AS c FROM viewtest_tbl
-- !query 17 schema
struct<>
-- !query 17 output



-- !query 18
DROP VIEW viewtest
-- !query 18 schema
struct<>
-- !query 18 output



-- !query 19
DROP TABLE viewtest_tbl
-- !query 19 schema
struct<>
-- !query 19 output



-- !query 20
CREATE SCHEMA temp_view_test
-- !query 20 schema
struct<>
-- !query 20 output



-- !query 21
CREATE TABLE temp_view_test.base_table (a int, id int) using parquet
-- !query 21 schema
struct<>
-- !query 21 output



-- !query 22
CREATE TABLE temp_view_test.base_table2 (a int, id int) using parquet
-- !query 22 schema
struct<>
-- !query 22 output



-- !query 23
USE temp_view_test
-- !query 23 schema
struct<>
-- !query 23 output



-- !query 24
CREATE TEMPORARY VIEW temp_table AS SELECT * FROM VALUES
  (1, 1) as temp_table(a, id)
-- !query 24 schema
struct<>
-- !query 24 output



-- !query 25
CREATE VIEW v1 AS SELECT * FROM base_table
-- !query 25 schema
struct<>
-- !query 25 output



-- !query 26
DESC TABLE EXTENDED v1
-- !query 26 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 26 output
a                   	int                 	                    
id                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v1                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM base_table	                    
View Original Text  	SELECT * FROM base_table	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[a, id]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=id, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 27
CREATE VIEW v1_temp AS SELECT * FROM temp_table
-- !query 27 schema
struct<>
-- !query 27 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v1_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 28
CREATE TEMP VIEW v2_temp AS SELECT * FROM base_table
-- !query 28 schema
struct<>
-- !query 28 output



-- !query 29
DESC TABLE EXTENDED v2_temp
-- !query 29 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 29 output
a                   	int                 	                    
id                  	int


-- !query 30
CREATE VIEW temp_view_test.v2 AS SELECT * FROM base_table
-- !query 30 schema
struct<>
-- !query 30 output



-- !query 31
DESC TABLE EXTENDED temp_view_test.v2
-- !query 31 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 31 output
a                   	int                 	                    
id                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v2                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM base_table	                    
View Original Text  	SELECT * FROM base_table	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[a, id]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=id, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 32
CREATE VIEW temp_view_test.v3_temp AS SELECT * FROM temp_table
-- !query 32 schema
struct<>
-- !query 32 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `temp_view_test`.`v3_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 33
CREATE VIEW v3 AS
    SELECT t1.a AS t1_a, t2.a AS t2_a
    FROM base_table t1, base_table2 t2
    WHERE t1.id = t2.id
-- !query 33 schema
struct<>
-- !query 33 output



-- !query 34
DESC TABLE EXTENDED v3
-- !query 34 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 34 output
t1_a                	int                 	                    
t2_a                	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v3                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT t1.a AS t1_a, t2.a AS t2_a
    FROM base_table t1, base_table2 t2
    WHERE t1.id = t2.id	                    
View Original Text  	SELECT t1.a AS t1_a, t2.a AS t2_a
    FROM base_table t1, base_table2 t2
    WHERE t1.id = t2.id	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[t1_a, t2_a]        	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=t1_a, view.query.out.numCols=2, view.query.out.col.1=t2_a, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 35
CREATE VIEW v4_temp AS
    SELECT t1.a AS t1_a, t2.a AS t2_a
    FROM base_table t1, temp_table t2
    WHERE t1.id = t2.id
-- !query 35 schema
struct<>
-- !query 35 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v4_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 36
CREATE VIEW v5_temp AS
    SELECT t1.a AS t1_a, t2.a AS t2_a, t3.a AS t3_a
    FROM base_table t1, base_table2 t2, temp_table t3
    WHERE t1.id = t2.id and t2.id = t3.id
-- !query 36 schema
struct<>
-- !query 36 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v5_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 37
CREATE VIEW v4 AS SELECT * FROM base_table WHERE id IN (SELECT id FROM base_table2)
-- !query 37 schema
struct<>
-- !query 37 output



-- !query 38
DESC TABLE EXTENDED v4
-- !query 38 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 38 output
a                   	int                 	                    
id                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v4                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM base_table WHERE id IN (SELECT id FROM base_table2)	                    
View Original Text  	SELECT * FROM base_table WHERE id IN (SELECT id FROM base_table2)	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[a, id]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=id, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 39
CREATE VIEW v5 AS SELECT t1.id, t2.a FROM base_table t1, (SELECT * FROM base_table2) t2
-- !query 39 schema
struct<>
-- !query 39 output



-- !query 40
DESC TABLE EXTENDED v5
-- !query 40 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 40 output
id                  	int                 	                    
a                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v5                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT t1.id, t2.a FROM base_table t1, (SELECT * FROM base_table2) t2	                    
View Original Text  	SELECT t1.id, t2.a FROM base_table t1, (SELECT * FROM base_table2) t2	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[id, a]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=id, view.query.out.numCols=2, view.query.out.col.1=a, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 41
CREATE VIEW v6 AS SELECT * FROM base_table WHERE EXISTS (SELECT 1 FROM base_table2)
-- !query 41 schema
struct<>
-- !query 41 output



-- !query 42
DESC TABLE EXTENDED v6
-- !query 42 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 42 output
a                   	int                 	                    
id                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v6                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM base_table WHERE EXISTS (SELECT 1 FROM base_table2)	                    
View Original Text  	SELECT * FROM base_table WHERE EXISTS (SELECT 1 FROM base_table2)	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[a, id]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=id, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 43
CREATE VIEW v7 AS SELECT * FROM base_table WHERE NOT EXISTS (SELECT 1 FROM base_table2)
-- !query 43 schema
struct<>
-- !query 43 output



-- !query 44
DESC TABLE EXTENDED v7
-- !query 44 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 44 output
a                   	int                 	                    
id                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v7                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM base_table WHERE NOT EXISTS (SELECT 1 FROM base_table2)	                    
View Original Text  	SELECT * FROM base_table WHERE NOT EXISTS (SELECT 1 FROM base_table2)	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[a, id]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=id, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 45
CREATE VIEW v8 AS SELECT * FROM base_table WHERE EXISTS (SELECT 1)
-- !query 45 schema
struct<>
-- !query 45 output



-- !query 46
DESC TABLE EXTENDED v8
-- !query 46 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 46 output
a                   	int                 	                    
id                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	temp_view_test      	                    
Table               	v8                  	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM base_table WHERE EXISTS (SELECT 1)	                    
View Original Text  	SELECT * FROM base_table WHERE EXISTS (SELECT 1)	                    
View Catalog and Namespace	spark_catalog.temp_view_test	                    
View Query Output Columns	[a, id]             	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=id, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=temp_view_test]


-- !query 47
CREATE VIEW v6_temp AS SELECT * FROM base_table WHERE id IN (SELECT id FROM temp_table)
-- !query 47 schema
struct<>
-- !query 47 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v6_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 48
CREATE VIEW v7_temp AS SELECT t1.id, t2.a FROM base_table t1, (SELECT * FROM temp_table) t2
-- !query 48 schema
struct<>
-- !query 48 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v7_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 49
CREATE VIEW v8_temp AS SELECT * FROM base_table WHERE EXISTS (SELECT 1 FROM temp_table)
-- !query 49 schema
struct<>
-- !query 49 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v8_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 50
CREATE VIEW v9_temp AS SELECT * FROM base_table WHERE NOT EXISTS (SELECT 1 FROM temp_table)
-- !query 50 schema
struct<>
-- !query 50 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `v9_temp` by referencing a temporary view temp_table. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 51
CREATE VIEW v10_temp AS SELECT * FROM v7_temp
-- !query 51 schema
struct<>
-- !query 51 output
org.apache.spark.sql.AnalysisException
Table or view not found: v7_temp; line 1 pos 38


-- !query 52
CREATE VIEW v11_temp AS SELECT t1.id, t2.a FROM base_table t1, v10_temp t2
-- !query 52 schema
struct<>
-- !query 52 output
org.apache.spark.sql.AnalysisException
Table or view not found: v10_temp; line 1 pos 63


-- !query 53
CREATE VIEW v12_temp AS SELECT true FROM v11_temp
-- !query 53 schema
struct<>
-- !query 53 output
org.apache.spark.sql.AnalysisException
Table or view not found: v11_temp; line 1 pos 41


-- !query 54
CREATE SCHEMA testviewschm2
-- !query 54 schema
struct<>
-- !query 54 output



-- !query 55
USE testviewschm2
-- !query 55 schema
struct<>
-- !query 55 output



-- !query 56
CREATE TABLE t1 (num int, name string) using parquet
-- !query 56 schema
struct<>
-- !query 56 output



-- !query 57
CREATE TABLE t2 (num2 int, value string) using parquet
-- !query 57 schema
struct<>
-- !query 57 output



-- !query 58
CREATE TEMP VIEW tt AS SELECT * FROM VALUES
  (1, 'a') AS tt(num2, value)
-- !query 58 schema
struct<>
-- !query 58 output



-- !query 59
CREATE VIEW nontemp1 AS SELECT * FROM t1 CROSS JOIN t2
-- !query 59 schema
struct<>
-- !query 59 output



-- !query 60
DESC TABLE EXTENDED nontemp1
-- !query 60 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 60 output
num                 	int                 	                    
name                	string              	                    
num2                	int                 	                    
value               	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	testviewschm2       	                    
Table               	nontemp1            	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t1 CROSS JOIN t2	                    
View Original Text  	SELECT * FROM t1 CROSS JOIN t2	                    
View Catalog and Namespace	spark_catalog.testviewschm2	                    
View Query Output Columns	[num, name, num2, value]	                    
Table Properties    	[view.query.out.col.3=value, view.catalogAndNamespace.numParts=2, view.query.out.col.0=num, view.query.out.numCols=4, view.query.out.col.1=name, view.catalogAndNamespace.part.0=spark_catalog, view.query.out.col.2=num2, view.catalogAndNamespace.part.1=testviewschm2]


-- !query 61
CREATE VIEW temporal1 AS SELECT * FROM t1 CROSS JOIN tt
-- !query 61 schema
struct<>
-- !query 61 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `temporal1` by referencing a temporary view tt. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 62
CREATE VIEW nontemp2 AS SELECT * FROM t1 INNER JOIN t2 ON t1.num = t2.num2
-- !query 62 schema
struct<>
-- !query 62 output



-- !query 63
DESC TABLE EXTENDED nontemp2
-- !query 63 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 63 output
num                 	int                 	                    
name                	string              	                    
num2                	int                 	                    
value               	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	testviewschm2       	                    
Table               	nontemp2            	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t1 INNER JOIN t2 ON t1.num = t2.num2	                    
View Original Text  	SELECT * FROM t1 INNER JOIN t2 ON t1.num = t2.num2	                    
View Catalog and Namespace	spark_catalog.testviewschm2	                    
View Query Output Columns	[num, name, num2, value]	                    
Table Properties    	[view.query.out.col.3=value, view.catalogAndNamespace.numParts=2, view.query.out.col.0=num, view.query.out.numCols=4, view.query.out.col.1=name, view.catalogAndNamespace.part.0=spark_catalog, view.query.out.col.2=num2, view.catalogAndNamespace.part.1=testviewschm2]


-- !query 64
CREATE VIEW temporal2 AS SELECT * FROM t1 INNER JOIN tt ON t1.num = tt.num2
-- !query 64 schema
struct<>
-- !query 64 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `temporal2` by referencing a temporary view tt. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 65
CREATE VIEW nontemp3 AS SELECT * FROM t1 LEFT JOIN t2 ON t1.num = t2.num2
-- !query 65 schema
struct<>
-- !query 65 output



-- !query 66
DESC TABLE EXTENDED nontemp3
-- !query 66 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 66 output
num                 	int                 	                    
name                	string              	                    
num2                	int                 	                    
value               	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	testviewschm2       	                    
Table               	nontemp3            	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t1 LEFT JOIN t2 ON t1.num = t2.num2	                    
View Original Text  	SELECT * FROM t1 LEFT JOIN t2 ON t1.num = t2.num2	                    
View Catalog and Namespace	spark_catalog.testviewschm2	                    
View Query Output Columns	[num, name, num2, value]	                    
Table Properties    	[view.query.out.col.3=value, view.catalogAndNamespace.numParts=2, view.query.out.col.0=num, view.query.out.numCols=4, view.query.out.col.1=name, view.catalogAndNamespace.part.0=spark_catalog, view.query.out.col.2=num2, view.catalogAndNamespace.part.1=testviewschm2]


-- !query 67
CREATE VIEW temporal3 AS SELECT * FROM t1 LEFT JOIN tt ON t1.num = tt.num2
-- !query 67 schema
struct<>
-- !query 67 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `temporal3` by referencing a temporary view tt. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 68
CREATE VIEW nontemp4 AS SELECT * FROM t1 LEFT JOIN t2 ON t1.num = t2.num2 AND t2.value = 'xxx'
-- !query 68 schema
struct<>
-- !query 68 output



-- !query 69
DESC TABLE EXTENDED nontemp4
-- !query 69 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 69 output
num                 	int                 	                    
name                	string              	                    
num2                	int                 	                    
value               	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	testviewschm2       	                    
Table               	nontemp4            	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t1 LEFT JOIN t2 ON t1.num = t2.num2 AND t2.value = 'xxx'	                    
View Original Text  	SELECT * FROM t1 LEFT JOIN t2 ON t1.num = t2.num2 AND t2.value = 'xxx'	                    
View Catalog and Namespace	spark_catalog.testviewschm2	                    
View Query Output Columns	[num, name, num2, value]	                    
Table Properties    	[view.query.out.col.3=value, view.catalogAndNamespace.numParts=2, view.query.out.col.0=num, view.query.out.numCols=4, view.query.out.col.1=name, view.catalogAndNamespace.part.0=spark_catalog, view.query.out.col.2=num2, view.catalogAndNamespace.part.1=testviewschm2]


-- !query 70
CREATE VIEW temporal4 AS SELECT * FROM t1 LEFT JOIN tt ON t1.num = tt.num2 AND tt.value = 'xxx'
-- !query 70 schema
struct<>
-- !query 70 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `temporal4` by referencing a temporary view tt. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 71
CREATE VIEW temporal5 AS SELECT * FROM t1 WHERE num IN (SELECT num FROM t1 WHERE EXISTS (SELECT 1 FROM tt))
-- !query 71 schema
struct<>
-- !query 71 output
org.apache.spark.sql.AnalysisException
Not allowed to create a permanent view `temporal5` by referencing a temporary view tt. Please create a temp view instead by CREATE TEMP VIEW;


-- !query 72
CREATE TABLE tbl1 ( a int, b int) using parquet
-- !query 72 schema
struct<>
-- !query 72 output



-- !query 73
CREATE TABLE tbl2 (c int, d int) using parquet
-- !query 73 schema
struct<>
-- !query 73 output



-- !query 74
CREATE TABLE tbl3 (e int, f int) using parquet
-- !query 74 schema
struct<>
-- !query 74 output



-- !query 75
CREATE TABLE tbl4 (g int, h int) using parquet
-- !query 75 schema
struct<>
-- !query 75 output



-- !query 76
CREATE TABLE tmptbl (i int, j int) using parquet
-- !query 76 schema
struct<>
-- !query 76 output



-- !query 77
INSERT INTO tmptbl VALUES (1, 1)
-- !query 77 schema
struct<>
-- !query 77 output



-- !query 78
CREATE   VIEW  pubview AS SELECT * FROM tbl1 WHERE tbl1.a
BETWEEN (SELECT d FROM tbl2 WHERE c = 1) AND (SELECT e FROM tbl3 WHERE f = 2)
AND EXISTS (SELECT g FROM tbl4 LEFT JOIN tbl3 ON tbl4.h = tbl3.f)
-- !query 78 schema
struct<>
-- !query 78 output



-- !query 79
DESC TABLE EXTENDED pubview
-- !query 79 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 79 output
a                   	int                 	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	testviewschm2       	                    
Table               	pubview             	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM tbl1 WHERE tbl1.a
BETWEEN (SELECT d FROM tbl2 WHERE c = 1) AND (SELECT e FROM tbl3 WHERE f = 2)
AND EXISTS (SELECT g FROM tbl4 LEFT JOIN tbl3 ON tbl4.h = tbl3.f)	                    
View Original Text  	SELECT * FROM tbl1 WHERE tbl1.a
BETWEEN (SELECT d FROM tbl2 WHERE c = 1) AND (SELECT e FROM tbl3 WHERE f = 2)
AND EXISTS (SELECT g FROM tbl4 LEFT JOIN tbl3 ON tbl4.h = tbl3.f)	                    
View Catalog and Namespace	spark_catalog.testviewschm2	                    
View Query Output Columns	[a, b]              	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=b, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=testviewschm2]


-- !query 80
CREATE   VIEW  mytempview AS SELECT * FROM tbl1 WHERE tbl1.a
BETWEEN (SELECT d FROM tbl2 WHERE c = 1) AND (SELECT e FROM tbl3 WHERE f = 2)
AND EXISTS (SELECT g FROM tbl4 LEFT JOIN tbl3 ON tbl4.h = tbl3.f)
AND NOT EXISTS (SELECT g FROM tbl4 LEFT JOIN tmptbl ON tbl4.h = tmptbl.j)
-- !query 80 schema
struct<>
-- !query 80 output



-- !query 81
DESC TABLE EXTENDED mytempview
-- !query 81 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 81 output
a                   	int                 	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	testviewschm2       	                    
Table               	mytempview          	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM tbl1 WHERE tbl1.a
BETWEEN (SELECT d FROM tbl2 WHERE c = 1) AND (SELECT e FROM tbl3 WHERE f = 2)
AND EXISTS (SELECT g FROM tbl4 LEFT JOIN tbl3 ON tbl4.h = tbl3.f)
AND NOT EXISTS (SELECT g FROM tbl4 LEFT JOIN tmptbl ON tbl4.h = tmptbl.j)	                    
View Original Text  	SELECT * FROM tbl1 WHERE tbl1.a
BETWEEN (SELECT d FROM tbl2 WHERE c = 1) AND (SELECT e FROM tbl3 WHERE f = 2)
AND EXISTS (SELECT g FROM tbl4 LEFT JOIN tbl3 ON tbl4.h = tbl3.f)
AND NOT EXISTS (SELECT g FROM tbl4 LEFT JOIN tmptbl ON tbl4.h = tmptbl.j)	                    
View Catalog and Namespace	spark_catalog.testviewschm2	                    
View Query Output Columns	[a, b]              	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.query.out.col.0=a, view.query.out.numCols=2, view.query.out.col.1=b, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=testviewschm2]


-- !query 82
CREATE VIEW tt1 AS
  SELECT * FROM (
    VALUES
       ('abc', '0123456789', 42, 'abcd'),
       ('0123456789', 'abc', 42.12, 'abc')
  ) vv(a,b,c,d)
-- !query 82 schema
struct<>
-- !query 82 output



-- !query 83
SELECT * FROM tt1
-- !query 83 schema
struct<a:string,b:string,c:decimal(12,2),d:string>
-- !query 83 output
0123456789	abc	42.12	abc
abc	0123456789	42.00	abcd


-- !query 84
SELECT string(a) FROM tt1
-- !query 84 schema
struct<a:string>
-- !query 84 output
0123456789
abc


-- !query 85
DROP VIEW tt1
-- !query 85 schema
struct<>
-- !query 85 output



-- !query 86
CREATE TABLE tt1 (f1 int, f2 int, f3 string) using parquet
-- !query 86 schema
struct<>
-- !query 86 output



-- !query 87
CREATE TABLE tx1 (x1 int, x2 int, x3 string) using parquet
-- !query 87 schema
struct<>
-- !query 87 output



-- !query 88
CREATE TABLE temp_view_test.tt1 (y1 int, f2 int, f3 string) using parquet
-- !query 88 schema
struct<>
-- !query 88 output



-- !query 89
CREATE VIEW aliased_view_1 AS
  select * from tt1
    where exists (select 1 from tx1 where tt1.f1 = tx1.x1)
-- !query 89 schema
struct<>
-- !query 89 output



-- !query 90
CREATE VIEW aliased_view_2 AS
  select * from tt1 a1
    where exists (select 1 from tx1 where a1.f1 = tx1.x1)
-- !query 90 schema
struct<>
-- !query 90 output



-- !query 91
CREATE VIEW aliased_view_3 AS
  select * from tt1
    where exists (select 1 from tx1 a2 where tt1.f1 = a2.x1)
-- !query 91 schema
struct<>
-- !query 91 output



-- !query 92
CREATE VIEW aliased_view_4 AS
  select * from temp_view_test.tt1
    where exists (select 1 from tt1 where temp_view_test.tt1.y1 = tt1.f1)
-- !query 92 schema
struct<>
-- !query 92 output



-- !query 93
DESC TABLE aliased_view_1
-- !query 93 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 93 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 94
DESC TABLE aliased_view_2
-- !query 94 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 94 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 95
DESC TABLE aliased_view_3
-- !query 95 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 95 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 96
DESC TABLE aliased_view_4
-- !query 96 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 96 output
y1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 97
ALTER TABLE tx1 RENAME TO a1
-- !query 97 schema
struct<>
-- !query 97 output



-- !query 98
DESC TABLE aliased_view_1
-- !query 98 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 98 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 99
DESC TABLE aliased_view_2
-- !query 99 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 99 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 100
DESC TABLE aliased_view_3
-- !query 100 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 100 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 101
DESC TABLE aliased_view_4
-- !query 101 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 101 output
y1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 102
ALTER TABLE tt1 RENAME TO a2
-- !query 102 schema
struct<>
-- !query 102 output



-- !query 103
DESC TABLE aliased_view_1
-- !query 103 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 103 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 104
DESC TABLE aliased_view_2
-- !query 104 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 104 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 105
DESC TABLE aliased_view_3
-- !query 105 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 105 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 106
DESC TABLE aliased_view_4
-- !query 106 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 106 output
y1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 107
ALTER TABLE a1 RENAME TO tt1
-- !query 107 schema
struct<>
-- !query 107 output



-- !query 108
DESC TABLE aliased_view_1
-- !query 108 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 108 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 109
DESC TABLE aliased_view_2
-- !query 109 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 109 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 110
DESC TABLE aliased_view_3
-- !query 110 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 110 output
f1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 111
DESC TABLE aliased_view_4
-- !query 111 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 111 output
y1                  	int                 	                    
f2                  	int                 	                    
f3                  	string


-- !query 112
ALTER TABLE a2 RENAME TO tx1
-- !query 112 schema
struct<>
-- !query 112 output



-- !query 113
create view view_of_joins as
select * from
  (select * from (tbl1 cross join tbl2) same) ss,
  (tbl3 cross join tbl4) same
-- !query 113 schema
struct<>
-- !query 113 output



-- !query 114
create table tt2 (a int, b int, c int) using parquet
-- !query 114 schema
struct<>
-- !query 114 output



-- !query 115
create table tt3 (ax bigint, b short, c decimal) using parquet
-- !query 115 schema
struct<>
-- !query 115 output



-- !query 116
create table tt4 (ay int, b int, q int) using parquet
-- !query 116 schema
struct<>
-- !query 116 output



-- !query 117
create view v1 as select * from tt2 natural join tt3
-- !query 117 schema
struct<>
-- !query 117 output



-- !query 118
create view v1a as select * from (tt2 natural join tt3) j
-- !query 118 schema
struct<>
-- !query 118 output



-- !query 119
create view v2 as select * from tt2 join tt3 using (b,c) join tt4 using (b)
-- !query 119 schema
struct<>
-- !query 119 output



-- !query 120
create view v2a as select * from (tt2 join tt3 using (b,c) join tt4 using (b)) j
-- !query 120 schema
struct<>
-- !query 120 output



-- !query 121
create view v3 as select * from tt2 join tt3 using (b,c) full join tt4 using (b)
-- !query 121 schema
struct<>
-- !query 121 output



-- !query 122
DESC TABLE v1
-- !query 122 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 122 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint


-- !query 123
DESC TABLE v1a
-- !query 123 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 123 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint


-- !query 124
DESC TABLE v2
-- !query 124 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 124 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 125
DESC TABLE v2a
-- !query 125 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 125 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 126
DESC TABLE v3
-- !query 126 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 126 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 127
alter table tt2 add column d int
-- !query 127 schema
struct<>
-- !query 127 output



-- !query 128
alter table tt2 add column e int
-- !query 128 schema
struct<>
-- !query 128 output



-- !query 129
DESC TABLE v1
-- !query 129 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 129 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint


-- !query 130
DESC TABLE v1a
-- !query 130 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 130 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint


-- !query 131
DESC TABLE v2
-- !query 131 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 131 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 132
DESC TABLE v2a
-- !query 132 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 132 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 133
DESC TABLE v3
-- !query 133 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 133 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 134
drop table tt3
-- !query 134 schema
struct<>
-- !query 134 output



-- !query 135
create table tt3 (ax bigint, b short, d decimal) using parquet
-- !query 135 schema
struct<>
-- !query 135 output



-- !query 136
alter table tt3 add column c int
-- !query 136 schema
struct<>
-- !query 136 output



-- !query 137
alter table tt3 add column e int
-- !query 137 schema
struct<>
-- !query 137 output



-- !query 138
DESC TABLE v1
-- !query 138 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 138 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint


-- !query 139
DESC TABLE v1a
-- !query 139 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 139 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint


-- !query 140
DESC TABLE v2
-- !query 140 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 140 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 141
DESC TABLE v2a
-- !query 141 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 141 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 142
DESC TABLE v3
-- !query 142 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 142 output
b                   	int                 	                    
c                   	int                 	                    
a                   	int                 	                    
ax                  	bigint              	                    
ay                  	int                 	                    
q                   	int


-- !query 143
create table tt5 (a int, b int) using parquet
-- !query 143 schema
struct<>
-- !query 143 output



-- !query 144
create table tt6 (c int, d int) using parquet
-- !query 144 schema
struct<>
-- !query 144 output



-- !query 145
create view vv1 as select * from (tt5 cross join tt6) j(aa,bb,cc,dd)
-- !query 145 schema
struct<>
-- !query 145 output



-- !query 146
DESC TABLE vv1
-- !query 146 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 146 output
aa                  	int                 	                    
bb                  	int                 	                    
cc                  	int                 	                    
dd                  	int


-- !query 147
alter table tt5 add column c int
-- !query 147 schema
struct<>
-- !query 147 output



-- !query 148
DESC TABLE vv1
-- !query 148 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 148 output
aa                  	int                 	                    
bb                  	int                 	                    
cc                  	int                 	                    
dd                  	int


-- !query 149
alter table tt5 add column cc int
-- !query 149 schema
struct<>
-- !query 149 output



-- !query 150
DESC TABLE vv1
-- !query 150 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 150 output
aa                  	int                 	                    
bb                  	int                 	                    
cc                  	int                 	                    
dd                  	int


-- !query 151
create table tt7 (x int, /* xx int, */ y int) using parquet
-- !query 151 schema
struct<>
-- !query 151 output



-- !query 152
create table tt8 (x int, z int) using parquet
-- !query 152 schema
struct<>
-- !query 152 output



-- !query 153
create view vv2 as
select * from (values(1,2,3,4,5)) v(a,b,c,d,e)
union all
select * from tt7 full join tt8 using (x), tt8 tt8x
-- !query 153 schema
struct<>
-- !query 153 output



-- !query 154
DESC TABLE vv2
-- !query 154 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 154 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
d                   	int                 	                    
e                   	int


-- !query 155
create view vv3 as
select * from (values(1,2,3,4,5,6)) v(a,b,c,x,e,f)
union all
select * from
  tt7 full join tt8 using (x),
  tt7 tt7x full join tt8 tt8x using (x)
-- !query 155 schema
struct<>
-- !query 155 output



-- !query 156
DESC TABLE vv3
-- !query 156 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 156 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
x                   	int                 	                    
e                   	int                 	                    
f                   	int


-- !query 157
create view vv4 as
select * from (values(1,2,3,4,5,6,7)) v(a,b,c,x,e,f,g)
union all
select * from
  tt7 full join tt8 using (x),
  tt7 tt7x full join tt8 tt8x using (x) full join tt8 tt8y using (x)
-- !query 157 schema
struct<>
-- !query 157 output



-- !query 158
DESC TABLE vv4
-- !query 158 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 158 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
x                   	int                 	                    
e                   	int                 	                    
f                   	int                 	                    
g                   	int


-- !query 159
alter table tt7 add column zz int
-- !query 159 schema
struct<>
-- !query 159 output



-- !query 160
alter table tt7 add column z int
-- !query 160 schema
struct<>
-- !query 160 output



-- !query 161
alter table tt8 add column z2 int
-- !query 161 schema
struct<>
-- !query 161 output



-- !query 162
DESC TABLE vv2
-- !query 162 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 162 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
d                   	int                 	                    
e                   	int


-- !query 163
DESC TABLE vv3
-- !query 163 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 163 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
x                   	int                 	                    
e                   	int                 	                    
f                   	int


-- !query 164
DESC TABLE vv4
-- !query 164 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 164 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
x                   	int                 	                    
e                   	int                 	                    
f                   	int                 	                    
g                   	int


-- !query 165
create table tt7a (x date, /* xx int, */ y int) using parquet
-- !query 165 schema
struct<>
-- !query 165 output



-- !query 166
create table tt8a (x timestamp, z int) using parquet
-- !query 166 schema
struct<>
-- !query 166 output



-- !query 167
create view vv2a as
select * from (values(now(),2,3,now(),5)) v(a,b,c,d,e)
union all
select * from tt7a left join tt8a using (x), tt8a tt8ax
-- !query 167 schema
struct<>
-- !query 167 output



-- !query 168
DESC TABLE vv4
-- !query 168 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 168 output
a                   	int                 	                    
b                   	int                 	                    
c                   	int                 	                    
x                   	int                 	                    
e                   	int                 	                    
f                   	int                 	                    
g                   	int


-- !query 169
DESC TABLE vv2a
-- !query 169 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 169 output
a                   	timestamp           	                    
b                   	int                 	                    
c                   	int                 	                    
d                   	timestamp           	                    
e                   	int


-- !query 170
create table tt9 (x int, xx int, y int) using parquet
-- !query 170 schema
struct<>
-- !query 170 output



-- !query 171
create table tt10 (x int, z int) using parquet
-- !query 171 schema
struct<>
-- !query 171 output



-- !query 172
create view vv5 as select x,y,z from tt9 join tt10 using(x)
-- !query 172 schema
struct<>
-- !query 172 output



-- !query 173
DESC TABLE vv5
-- !query 173 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 173 output
x                   	int                 	                    
y                   	int                 	                    
z                   	int


-- !query 174
DESC TABLE vv5
-- !query 174 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 174 output
x                   	int                 	                    
y                   	int                 	                    
z                   	int


-- !query 175
create table tt11 (x int, y int) using parquet
-- !query 175 schema
struct<>
-- !query 175 output



-- !query 176
create table tt12 (x int, z int) using parquet
-- !query 176 schema
struct<>
-- !query 176 output



-- !query 177
create table tt13 (z int, q int) using parquet
-- !query 177 schema
struct<>
-- !query 177 output



-- !query 178
create view vv6 as select x,y,z,q from
  (tt11 join tt12 using(x)) join tt13 using(z)
-- !query 178 schema
struct<>
-- !query 178 output



-- !query 179
DESC TABLE vv6
-- !query 179 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 179 output
x                   	int                 	                    
y                   	int                 	                    
z                   	int                 	                    
q                   	int


-- !query 180
alter table tt11 add column z int
-- !query 180 schema
struct<>
-- !query 180 output



-- !query 181
DESC TABLE vv6
-- !query 181 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 181 output
x                   	int                 	                    
y                   	int                 	                    
z                   	int                 	                    
q                   	int


-- !query 182
CREATE TABLE int8_tbl (q1 int, q2 int) USING parquet
-- !query 182 schema
struct<>
-- !query 182 output



-- !query 183
create view tt18v as
  select * from int8_tbl xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxy
  union all
  select * from int8_tbl xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxz
-- !query 183 schema
struct<>
-- !query 183 output



-- !query 184
DESC TABLE tt18v
-- !query 184 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 184 output
q1                  	int                 	                    
q2                  	int


-- !query 185
create view tt21v as
select * from tt5 natural inner join tt6
-- !query 185 schema
struct<>
-- !query 185 output



-- !query 186
DESC TABLE tt21v
-- !query 186 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 186 output
c                   	int                 	                    
a                   	int                 	                    
b                   	int                 	                    
cc                  	int                 	                    
d                   	int


-- !query 187
create view tt22v as
select * from tt5 natural left join tt6
-- !query 187 schema
struct<>
-- !query 187 output



-- !query 188
DESC TABLE tt22v
-- !query 188 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 188 output
c                   	int                 	                    
a                   	int                 	                    
b                   	int                 	                    
cc                  	int                 	                    
d                   	int


-- !query 189
create view tt23v (col_a, col_b) as
select q1 as other_name1, q2 as other_name2 from int8_tbl
union
select 42, 43
-- !query 189 schema
struct<>
-- !query 189 output



-- !query 190
DESC TABLE tt23v
-- !query 190 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 190 output
col_a               	int                 	                    
col_b               	int


-- !query 191
DROP SCHEMA temp_view_test CASCADE
-- !query 191 schema
struct<>
-- !query 191 output



-- !query 192
DROP SCHEMA testviewschm2 CASCADE
-- !query 192 schema
struct<>
-- !query 192 output



-- !query 193
DROP VIEW temp_table
-- !query 193 schema
struct<>
-- !query 193 output



-- !query 194
DROP VIEW tt
-- !query 194 schema
struct<>
-- !query 194 output

