-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE DATE_TBL (f1 date) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1957-04-09'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1957-06-13'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1996-02-28'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1996-02-29'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1996-03-01'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1996-03-02'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1997-02-28'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1997-03-01'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('1997-03-02'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('2000-04-01'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('2000-04-02'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('2000-04-03'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('2038-04-08'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('2039-04-09'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO DATE_TBL VALUES (date('2040-04-10'))
-- !query schema
struct<>
-- !query output



-- !query
SELECT f1 AS `Fifteen` FROM DATE_TBL
-- !query schema
struct<Fifteen:date>
-- !query output
1957-04-09
1957-06-13
1996-02-28
1996-02-29
1996-03-01
1996-03-02
1997-02-28
1997-03-01
1997-03-02
2000-04-01
2000-04-02
2000-04-03
2038-04-08
2039-04-09
2040-04-10


-- !query
SELECT f1 AS `Nine` FROM DATE_TBL WHERE f1 < '2000-01-01'
-- !query schema
struct<Nine:date>
-- !query output
1957-04-09
1957-06-13
1996-02-28
1996-02-29
1996-03-01
1996-03-02
1997-02-28
1997-03-01
1997-03-02


-- !query
SELECT f1 AS `Three` FROM DATE_TBL
  WHERE f1 BETWEEN '2000-01-01' AND '2001-01-01'
-- !query schema
struct<Three:date>
-- !query output
2000-04-01
2000-04-02
2000-04-03


-- !query
SELECT date '1999-01-08'
-- !query schema
struct<DATE '1999-01-08':date>
-- !query output
1999-01-08


-- !query
SELECT date '1999-01-18'
-- !query schema
struct<DATE '1999-01-18':date>
-- !query output
1999-01-18


-- !query
SELECT date '1999 Jan 08'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 Jan 08'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "date '1999 Jan 08'"
  } ]
}


-- !query
SELECT date '1999 08 Jan'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 08 Jan'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "date '1999 08 Jan'"
  } ]
}


-- !query
SELECT date '1999-01-08'
-- !query schema
struct<DATE '1999-01-08':date>
-- !query output
1999-01-08


-- !query
SELECT date '1999-08-01'
-- !query schema
struct<DATE '1999-08-01':date>
-- !query output
1999-08-01


-- !query
SELECT date '1999 01 08'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 01 08'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "date '1999 01 08'"
  } ]
}


-- !query
SELECT date '1999 08 01'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 08 01'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "date '1999 08 01'"
  } ]
}


-- !query
SELECT date '1999-01-08'
-- !query schema
struct<DATE '1999-01-08':date>
-- !query output
1999-01-08


-- !query
SELECT date '1999 Jan 08'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 Jan 08'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "date '1999 Jan 08'"
  } ]
}


-- !query
SELECT date '1999 08 Jan'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 08 Jan'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "date '1999 08 Jan'"
  } ]
}


-- !query
SELECT date '1999-01-08'
-- !query schema
struct<DATE '1999-01-08':date>
-- !query output
1999-01-08


-- !query
SELECT date '1999-08-01'
-- !query schema
struct<DATE '1999-08-01':date>
-- !query output
1999-08-01


-- !query
SELECT date '1999 01 08'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 01 08'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "date '1999 01 08'"
  } ]
}


-- !query
SELECT date '1999 08 01'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 08 01'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "date '1999 08 01'"
  } ]
}


-- !query
SELECT date '1999-01-08'
-- !query schema
struct<DATE '1999-01-08':date>
-- !query output
1999-01-08


-- !query
SELECT date '1999-01-18'
-- !query schema
struct<DATE '1999-01-18':date>
-- !query output
1999-01-18


-- !query
SELECT date '1999 Jan 08'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 Jan 08'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "date '1999 Jan 08'"
  } ]
}


-- !query
SELECT date '1999 08 Jan'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 08 Jan'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "date '1999 08 Jan'"
  } ]
}


-- !query
SELECT date '1999-01-08'
-- !query schema
struct<DATE '1999-01-08':date>
-- !query output
1999-01-08


-- !query
SELECT date '1999-08-01'
-- !query schema
struct<DATE '1999-08-01':date>
-- !query output
1999-08-01


-- !query
SELECT date '1999 01 08'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 01 08'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "date '1999 01 08'"
  } ]
}


-- !query
SELECT date '1999 08 01'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TYPED_LITERAL",
  "sqlState" : "42604",
  "messageParameters" : {
    "value" : "'1999 08 01'",
    "valueType" : "\"DATE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "date '1999 08 01'"
  } ]
}


-- !query
SELECT date '4714-11-24 BC'
-- !query schema
struct<DATE '4714-11-24':date>
-- !query output
4714-11-24


-- !query
SELECT date '4714-11-23 BC'
-- !query schema
struct<DATE '4714-11-23':date>
-- !query output
4714-11-23


-- !query
SELECT date '5874897-12-31'
-- !query schema
struct<DATE '+5874897-12-31':date>
-- !query output
+5874897-12-31


-- !query
SELECT date '5874898-01-01'
-- !query schema
struct<DATE '+5874898-01-01':date>
-- !query output
+5874898-01-01


-- !query
SELECT f1 - date '2000-01-01' AS `Days From 2K` FROM DATE_TBL
-- !query schema
struct<Days From 2K:interval>
-- !query output
-2 years -10 months
-2 years -10 months -1 days
-2 years -9 months -30 days
-3 years -10 months
-3 years -10 months -1 days
-3 years -10 months -2 days
-3 years -9 months -30 days
-42 years -6 months -18 days
-42 years -8 months -22 days
3 months
3 months 1 days
3 months 2 days
38 years 3 months 7 days
39 years 3 months 8 days
40 years 3 months 9 days


-- !query
SELECT f1 - date 'epoch' AS `Days From Epoch` FROM DATE_TBL
-- !query schema
struct<Days From Epoch:interval>
-- !query output
-12 years -6 months -18 days
-12 years -8 months -22 days
26 years 1 months 27 days
26 years 1 months 28 days
26 years 2 months
26 years 2 months 1 days
27 years 1 months 27 days
27 years 2 months
27 years 2 months 1 days
30 years 3 months
30 years 3 months 1 days
30 years 3 months 2 days
68 years 3 months 7 days
69 years 3 months 8 days
70 years 3 months 9 days


-- !query
SELECT date 'yesterday' - date 'today' AS `One day`
-- !query schema
struct<One day:interval>
-- !query output
-1 days


-- !query
SELECT date 'today' - date 'tomorrow' AS `One day`
-- !query schema
struct<One day:interval>
-- !query output
-1 days


-- !query
SELECT date 'yesterday' - date 'tomorrow' AS `Two days`
-- !query schema
struct<Two days:interval>
-- !query output
-2 days


-- !query
SELECT date 'tomorrow' - date 'today' AS `One day`
-- !query schema
struct<One day:interval>
-- !query output
1 days


-- !query
SELECT date 'today' - date 'yesterday' AS `One day`
-- !query schema
struct<One day:interval>
-- !query output
1 days


-- !query
SELECT date 'tomorrow' - date 'yesterday' AS `Two days`
-- !query schema
struct<Two days:interval>
-- !query output
2 days


-- !query
select make_date(2013, 7, 15)
-- !query schema
struct<make_date(2013, 7, 15):date>
-- !query output
2013-07-15


-- !query
select make_date(-44, 3, 15)
-- !query schema
struct<make_date(-44, 3, 15):date>
-- !query output
-0044-03-15


-- !query
select make_date(2013, 2, 30)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkDateTimeException
{
  "errorClass" : "DATETIME_FIELD_OUT_OF_BOUNDS",
  "sqlState" : "22023",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "rangeMessage" : "Invalid date 'FEBRUARY 30'"
  }
}


-- !query
select make_date(2013, 13, 1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkDateTimeException
{
  "errorClass" : "DATETIME_FIELD_OUT_OF_BOUNDS",
  "sqlState" : "22023",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "rangeMessage" : "Invalid value for MonthOfYear (valid values 1 - 12): 13"
  }
}


-- !query
select make_date(2013, 11, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkDateTimeException
{
  "errorClass" : "DATETIME_FIELD_OUT_OF_BOUNDS",
  "sqlState" : "22023",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "rangeMessage" : "Invalid value for DayOfMonth (valid values 1 - 28/31): -1"
  }
}


-- !query
DROP TABLE DATE_TBL
-- !query schema
struct<>
-- !query output

