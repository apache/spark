-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT string('this is a text string') = string('this is a text string') AS true
-- !query schema
struct<true:boolean>
-- !query output
true


-- !query
SELECT string('this is a text string') = string('this is a text strin') AS `false`
-- !query schema
struct<false:boolean>
-- !query output
false


-- !query
CREATE TABLE TEXT_TBL (f1 string) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TEXT_TBL VALUES ('doh!')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TEXT_TBL VALUES ('hi de ho neighbor')
-- !query schema
struct<>
-- !query output



-- !query
SELECT '' AS two, * FROM TEXT_TBL
-- !query schema
struct<two:string,f1:string>
-- !query output
	doh!
	hi de ho neighbor


-- !query
select length(42)
-- !query schema
struct<length(42):int>
-- !query output
2


-- !query
select string('four: ') || 2+2
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNumberFormatException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'four: 2'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BIGINT\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "string('four: ') || 2+2"
  } ]
}


-- !query
select 'four: ' || 2+2
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNumberFormatException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'four: 2'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BIGINT\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "'four: ' || 2+2"
  } ]
}


-- !query
select 3 || 4.0
-- !query schema
struct<concat(3, 4.0):string>
-- !query output
34.0


-- !query
/*
 * various string functions
 */
select concat('one')
-- !query schema
struct<concat(one):string>
-- !query output
one


-- !query
select concat(1,2,3,'hello',true, false, to_date('20100309','yyyyMMdd'))
-- !query schema
struct<concat(1, 2, 3, hello, true, false, to_date(20100309, yyyyMMdd)):string>
-- !query output
123hellotruefalse2010-03-09


-- !query
select concat_ws('#','one')
-- !query schema
struct<concat_ws(#, one):string>
-- !query output
one


-- !query
select concat_ws('#',1,2,3,'hello',true, false, to_date('20100309','yyyyMMdd'))
-- !query schema
struct<concat_ws(#, 1, 2, 3, hello, true, false, to_date(20100309, yyyyMMdd)):string>
-- !query output
1#x#x#hello#true#false#x-03-09


-- !query
select concat_ws(',',10,20,null,30)
-- !query schema
struct<concat_ws(,, 10, 20, NULL, 30):string>
-- !query output
10,20,30


-- !query
select concat_ws('',10,20,null,30)
-- !query schema
struct<concat_ws(, 10, 20, NULL, 30):string>
-- !query output
102030


-- !query
select concat_ws(NULL,10,20,null,30) is null
-- !query schema
struct<(concat_ws(NULL, 10, 20, NULL, 30) IS NULL):boolean>
-- !query output
true


-- !query
select reverse('abcde')
-- !query schema
struct<reverse(abcde):string>
-- !query output
edcba


-- !query
select i, left('ahoj', i), right('ahoj', i) from range(-5, 6) t(i) order by i
-- !query schema
struct<i:bigint,left(ahoj, i):string,right(ahoj, i):string>
-- !query output
-5		
-4		
-3		
-2		
-1		
0		
1	a	j
2	ah	oj
3	aho	hoj
4	ahoj	ahoj
5	ahoj	ahoj


-- !query
/*
 * format
 */
select format_string(NULL)
-- !query schema
struct<format_string(NULL):string>
-- !query output
NULL


-- !query
select format_string('Hello')
-- !query schema
struct<format_string(Hello):string>
-- !query output
Hello


-- !query
select format_string('Hello %s', 'World')
-- !query schema
struct<format_string(Hello %s, World):string>
-- !query output
Hello World


-- !query
select format_string('Hello %%')
-- !query schema
struct<format_string(Hello %%):string>
-- !query output
Hello %


-- !query
select format_string('Hello %%%%')
-- !query schema
struct<format_string(Hello %%%%):string>
-- !query output
Hello %%


-- !query
select format_string('Hello %s %s', 'World')
-- !query schema
struct<>
-- !query output
java.util.MissingFormatArgumentException
Format specifier '%s'


-- !query
select format_string('Hello %s')
-- !query schema
struct<>
-- !query output
java.util.MissingFormatArgumentException
Format specifier '%s'


-- !query
select format_string('Hello %x', 20)
-- !query schema
struct<format_string(Hello %x, 20):string>
-- !query output
Hello 14


-- !query
select format_string('%1$s %3$s', 1, 2, 3)
-- !query schema
struct<format_string(%1$s %3$s, 1, 2, 3):string>
-- !query output
1 3


-- !query
select format_string('%1$s %12$s', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)
-- !query schema
struct<format_string(%1$s %12$s, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12):string>
-- !query output
1 12


-- !query
select format_string('%1$s %4$s', 1, 2, 3)
-- !query schema
struct<>
-- !query output
java.util.MissingFormatArgumentException
Format specifier '%4$s'


-- !query
select format_string('%1$s %13$s', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)
-- !query schema
struct<>
-- !query output
java.util.MissingFormatArgumentException
Format specifier '%13$s'


-- !query
select format_string('%0$s', 'Hello')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_PARAMETER_VALUE.ZERO_INDEX",
  "sqlState" : "22023",
  "messageParameters" : {
    "functionName" : "`format_string`",
    "parameter" : "`strfmt`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 37,
    "fragment" : "format_string('%0$s', 'Hello')"
  } ]
}


-- !query
select format_string('Hello %s %1$s %s', 'World', 'Hello again')
-- !query schema
struct<format_string(Hello %s %1$s %s, World, Hello again):string>
-- !query output
Hello World World Hello again


-- !query
select format_string('Hello %s %s, %2$s %2$s', 'World', 'Hello again')
-- !query schema
struct<format_string(Hello %s %s, %2$s %2$s, World, Hello again):string>
-- !query output
Hello World Hello again, Hello again Hello again


-- !query
select format_string('>>%10s<<', 'Hello')
-- !query schema
struct<format_string(>>%10s<<, Hello):string>
-- !query output
>>     Hello<<


-- !query
select format_string('>>%10s<<', NULL)
-- !query schema
struct<format_string(>>%10s<<, NULL):string>
-- !query output
>>      null<<


-- !query
select format_string('>>%10s<<', '')
-- !query schema
struct<format_string(>>%10s<<, ):string>
-- !query output
>>          <<


-- !query
select format_string('>>%-10s<<', '')
-- !query schema
struct<format_string(>>%-10s<<, ):string>
-- !query output
>>          <<


-- !query
select format_string('>>%-10s<<', 'Hello')
-- !query schema
struct<format_string(>>%-10s<<, Hello):string>
-- !query output
>>Hello     <<


-- !query
select format_string('>>%-10s<<', NULL)
-- !query schema
struct<format_string(>>%-10s<<, NULL):string>
-- !query output
>>null      <<


-- !query
select format_string('>>%1$10s<<', 'Hello')
-- !query schema
struct<format_string(>>%1$10s<<, Hello):string>
-- !query output
>>     Hello<<


-- !query
DROP TABLE TEXT_TBL
-- !query schema
struct<>
-- !query output

