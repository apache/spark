-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE INT2_TBL(f1 smallint) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT2_TBL VALUES (smallint(trim('0   ')))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT2_TBL VALUES (smallint(trim('  1234 ')))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT2_TBL VALUES (smallint(trim('    -1234')))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT2_TBL VALUES (smallint('32767'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT2_TBL VALUES (smallint('-32767'))
-- !query schema
struct<>
-- !query output



-- !query
SELECT '' AS five, * FROM INT2_TBL
-- !query schema
struct<five:string,f1:smallint>
-- !query output
	-1234
	-32767
	0
	1234
	32767


-- !query
SELECT '' AS four, i.* FROM INT2_TBL i WHERE i.f1 <> smallint('0')
-- !query schema
struct<four:string,f1:smallint>
-- !query output
	-1234
	-32767
	1234
	32767


-- !query
SELECT '' AS four, i.* FROM INT2_TBL i WHERE i.f1 <> int('0')
-- !query schema
struct<four:string,f1:smallint>
-- !query output
	-1234
	-32767
	1234
	32767


-- !query
SELECT '' AS one, i.* FROM INT2_TBL i WHERE i.f1 = smallint('0')
-- !query schema
struct<one:string,f1:smallint>
-- !query output
	0


-- !query
SELECT '' AS one, i.* FROM INT2_TBL i WHERE i.f1 = int('0')
-- !query schema
struct<one:string,f1:smallint>
-- !query output
	0


-- !query
SELECT '' AS two, i.* FROM INT2_TBL i WHERE i.f1 < smallint('0')
-- !query schema
struct<two:string,f1:smallint>
-- !query output
	-1234
	-32767


-- !query
SELECT '' AS two, i.* FROM INT2_TBL i WHERE i.f1 < int('0')
-- !query schema
struct<two:string,f1:smallint>
-- !query output
	-1234
	-32767


-- !query
SELECT '' AS three, i.* FROM INT2_TBL i WHERE i.f1 <= smallint('0')
-- !query schema
struct<three:string,f1:smallint>
-- !query output
	-1234
	-32767
	0


-- !query
SELECT '' AS three, i.* FROM INT2_TBL i WHERE i.f1 <= int('0')
-- !query schema
struct<three:string,f1:smallint>
-- !query output
	-1234
	-32767
	0


-- !query
SELECT '' AS two, i.* FROM INT2_TBL i WHERE i.f1 > smallint('0')
-- !query schema
struct<two:string,f1:smallint>
-- !query output
	1234
	32767


-- !query
SELECT '' AS two, i.* FROM INT2_TBL i WHERE i.f1 > int('0')
-- !query schema
struct<two:string,f1:smallint>
-- !query output
	1234
	32767


-- !query
SELECT '' AS three, i.* FROM INT2_TBL i WHERE i.f1 >= smallint('0')
-- !query schema
struct<three:string,f1:smallint>
-- !query output
	0
	1234
	32767


-- !query
SELECT '' AS three, i.* FROM INT2_TBL i WHERE i.f1 >= int('0')
-- !query schema
struct<three:string,f1:smallint>
-- !query output
	0
	1234
	32767


-- !query
SELECT '' AS one, i.* FROM INT2_TBL i WHERE (i.f1 % smallint('2')) = smallint('1')
-- !query schema
struct<one:string,f1:smallint>
-- !query output
	32767


-- !query
SELECT '' AS three, i.* FROM INT2_TBL i WHERE (i.f1 % int('2')) = smallint('0')
-- !query schema
struct<three:string,f1:smallint>
-- !query output
	-1234
	0
	1234


-- !query
SELECT '' AS five, i.f1, i.f1 * smallint('2') AS x FROM INT2_TBL i
WHERE abs(f1) < 16384
-- !query schema
struct<five:string,f1:smallint,x:smallint>
-- !query output
	-1234	-2468
	0	0
	1234	2468


-- !query
SELECT '' AS five, i.f1, i.f1 * int('2') AS x FROM INT2_TBL i
-- !query schema
struct<five:string,f1:smallint,x:int>
-- !query output
	-1234	-2468
	-32767	-65534
	0	0
	1234	2468
	32767	65534


-- !query
SELECT '' AS five, i.f1, i.f1 + smallint('2') AS x FROM INT2_TBL i
WHERE f1 < 32766
-- !query schema
struct<five:string,f1:smallint,x:smallint>
-- !query output
	-1234	-1232
	-32767	-32765
	0	2
	1234	1236


-- !query
SELECT '' AS five, i.f1, i.f1 + int('2') AS x FROM INT2_TBL i
-- !query schema
struct<five:string,f1:smallint,x:int>
-- !query output
	-1234	-1232
	-32767	-32765
	0	2
	1234	1236
	32767	32769


-- !query
SELECT '' AS five, i.f1, i.f1 - smallint('2') AS x FROM INT2_TBL i
WHERE f1 > -32767
-- !query schema
struct<five:string,f1:smallint,x:smallint>
-- !query output
	-1234	-1236
	0	-2
	1234	1232
	32767	32765


-- !query
SELECT '' AS five, i.f1, i.f1 - int('2') AS x FROM INT2_TBL i
-- !query schema
struct<five:string,f1:smallint,x:int>
-- !query output
	-1234	-1236
	-32767	-32769
	0	-2
	1234	1232
	32767	32765


-- !query
SELECT '' AS five, i.f1, i.f1 / smallint('2') AS x FROM INT2_TBL i
-- !query schema
struct<five:string,f1:smallint,x:double>
-- !query output
	-1234	-617.0
	-32767	-16383.5
	0	0.0
	1234	617.0
	32767	16383.5


-- !query
SELECT '' AS five, i.f1, i.f1 / int('2') AS x FROM INT2_TBL i
-- !query schema
struct<five:string,f1:smallint,x:double>
-- !query output
	-1234	-617.0
	-32767	-16383.5
	0	0.0
	1234	617.0
	32767	16383.5


-- !query
SELECT string(shiftleft(smallint(-1), 15))
-- !query schema
struct<shiftleft(-1, 15):string>
-- !query output
-32768


-- !query
SELECT string(smallint(shiftleft(smallint(-1), 15))+1)
-- !query schema
struct<(shiftleft(-1, 15) + 1):string>
-- !query output
-32767


-- !query
SELECT smallint(-32768) % smallint(-1)
-- !query schema
struct<(-32768 % -1):smallint>
-- !query output
0


-- !query
SELECT x, smallint(x) AS int2_value
FROM (VALUES float(-2.5),
             float(-1.5),
             float(-0.5),
             float(0.0),
             float(0.5),
             float(1.5),
             float(2.5)) t(x)
-- !query schema
struct<x:float,int2_value:smallint>
-- !query output
-0.5	0
-1.5	-1
-2.5	-2
0.0	0
0.5	0
1.5	1
2.5	2


-- !query
SELECT x, smallint(x) AS int2_value
FROM (VALUES cast(-2.5 as decimal(38, 18)),
             cast(-1.5 as decimal(38, 18)),
             cast(-0.5 as decimal(38, 18)),
             cast(-0.0 as decimal(38, 18)),
             cast(0.5 as decimal(38, 18)),
             cast(1.5 as decimal(38, 18)),
             cast(2.5 as decimal(38, 18))) t(x)
-- !query schema
struct<x:decimal(38,18),int2_value:smallint>
-- !query output
-0.500000000000000000	0
-1.500000000000000000	-1
-2.500000000000000000	-2
0.000000000000000000	0
0.500000000000000000	0
1.500000000000000000	1
2.500000000000000000	2


-- !query
DROP TABLE INT2_TBL
-- !query schema
struct<>
-- !query output

