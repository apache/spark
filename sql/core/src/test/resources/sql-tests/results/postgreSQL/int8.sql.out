-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE INT8_TBL(q1 bigint, q2 bigint) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT8_TBL VALUES(bigint(trim('  123   ')),bigint(trim('  456')))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT8_TBL VALUES(bigint(trim('123   ')),bigint('4567890123456789'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT8_TBL VALUES(bigint('4567890123456789'),bigint('123'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT8_TBL VALUES(+4567890123456789,bigint('4567890123456789'))
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO INT8_TBL VALUES(bigint('+4567890123456789'),bigint('-4567890123456789'))
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM INT8_TBL
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 = 4567890123456789
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 <> 4567890123456789
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
4567890123456789	-4567890123456789
4567890123456789	123


-- !query
SELECT * FROM INT8_TBL WHERE q2 < 4567890123456789
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
4567890123456789	-4567890123456789
4567890123456789	123


-- !query
SELECT * FROM INT8_TBL WHERE q2 > 4567890123456789
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output



-- !query
SELECT * FROM INT8_TBL WHERE q2 <= 4567890123456789
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 >= 4567890123456789
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 = 456
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456


-- !query
SELECT * FROM INT8_TBL WHERE q2 <> 456
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 < 456
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
4567890123456789	-4567890123456789
4567890123456789	123


-- !query
SELECT * FROM INT8_TBL WHERE q2 > 456
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 <= 456
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
4567890123456789	-4567890123456789
4567890123456789	123


-- !query
SELECT * FROM INT8_TBL WHERE q2 >= 456
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE 123 = q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE 123 <> q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE 123 < q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE 123 > q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output



-- !query
SELECT * FROM INT8_TBL WHERE 123 <= q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE 123 >= q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 = smallint('456')
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456


-- !query
SELECT * FROM INT8_TBL WHERE q2 <> smallint('456')
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 < smallint('456')
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
4567890123456789	-4567890123456789
4567890123456789	123


-- !query
SELECT * FROM INT8_TBL WHERE q2 > smallint('456')
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE q2 <= smallint('456')
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
4567890123456789	-4567890123456789
4567890123456789	123


-- !query
SELECT * FROM INT8_TBL WHERE q2 >= smallint('456')
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE smallint('123') = q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE smallint('123') <> q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE smallint('123') < q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE smallint('123') > q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output



-- !query
SELECT * FROM INT8_TBL WHERE smallint('123') <= q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	4567890123456789


-- !query
SELECT * FROM INT8_TBL WHERE smallint('123') >= q1
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789


-- !query
SELECT '' AS five, q1 AS plus, -q1 AS `minus` FROM INT8_TBL
-- !query schema
struct<five:string,plus:bigint,minus:bigint>
-- !query output
	123	-123
	123	-123
	4567890123456789	-4567890123456789
	4567890123456789	-4567890123456789
	4567890123456789	-4567890123456789


-- !query
SELECT '' AS five, q1, q2, q1 + q2 AS plus FROM INT8_TBL
-- !query schema
struct<five:string,q1:bigint,q2:bigint,plus:bigint>
-- !query output
	123	456	579
	123	4567890123456789	4567890123456912
	4567890123456789	-4567890123456789	0
	4567890123456789	123	4567890123456912
	4567890123456789	4567890123456789	9135780246913578


-- !query
SELECT '' AS five, q1, q2, q1 - q2 AS `minus` FROM INT8_TBL
-- !query schema
struct<five:string,q1:bigint,q2:bigint,minus:bigint>
-- !query output
	123	456	-333
	123	4567890123456789	-4567890123456666
	4567890123456789	-4567890123456789	9135780246913578
	4567890123456789	123	4567890123456666
	4567890123456789	4567890123456789	0


-- !query
SELECT '' AS three, q1, q2, q1 * q2 AS multiply FROM INT8_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "alternative" : " Use 'try_multiply' to tolerate overflow and return NULL instead.",
    "config" : "\"spark.sql.ansi.enabled\"",
    "message" : "long overflow"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 29,
    "stopIndex" : 35,
    "fragment" : "q1 * q2"
  } ]
}


-- !query
SELECT '' AS three, q1, q2, q1 * q2 AS multiply FROM INT8_TBL
 WHERE q1 < 1000 or (q2 > 0 and q2 < 1000)
-- !query schema
struct<three:string,q1:bigint,q2:bigint,multiply:bigint>
-- !query output
	123	456	56088
	123	4567890123456789	561850485185185047
	4567890123456789	123	561850485185185047


-- !query
SELECT '' AS five, q1, q2, q1 / q2 AS divide, q1 % q2 AS mod FROM INT8_TBL
-- !query schema
struct<five:string,q1:bigint,q2:bigint,divide:double,mod:bigint>
-- !query output
	123	456	0.26973684210526316	123
	123	4567890123456789	2.6927092525360204E-14	123
	4567890123456789	-4567890123456789	-1.0	0
	4567890123456789	123	3.713731807688446E13	57
	4567890123456789	4567890123456789	1.0	0


-- !query
SELECT '' AS five, q1, double(q1) FROM INT8_TBL
-- !query schema
struct<five:string,q1:bigint,q1:double>
-- !query output
	123	123.0
	123	123.0
	4567890123456789	4.567890123456789E15
	4567890123456789	4.567890123456789E15
	4567890123456789	4.567890123456789E15


-- !query
SELECT '' AS five, q2, double(q2) FROM INT8_TBL
-- !query schema
struct<five:string,q2:bigint,q2:double>
-- !query output
	-4567890123456789	-4.567890123456789E15
	123	123.0
	456	456.0
	4567890123456789	4.567890123456789E15
	4567890123456789	4.567890123456789E15


-- !query
SELECT 37 + q1 AS plus4 FROM INT8_TBL
-- !query schema
struct<plus4:bigint>
-- !query output
160
160
4567890123456826
4567890123456826
4567890123456826


-- !query
SELECT 37 - q1 AS minus4 FROM INT8_TBL
-- !query schema
struct<minus4:bigint>
-- !query output
-4567890123456752
-4567890123456752
-4567890123456752
-86
-86


-- !query
SELECT '' AS five, 2 * q1 AS `twice int4` FROM INT8_TBL
-- !query schema
struct<five:string,twice int4:bigint>
-- !query output
	246
	246
	9135780246913578
	9135780246913578
	9135780246913578


-- !query
SELECT '' AS five, q1 * 2 AS `twice int4` FROM INT8_TBL
-- !query schema
struct<five:string,twice int4:bigint>
-- !query output
	246
	246
	9135780246913578
	9135780246913578
	9135780246913578


-- !query
SELECT q1 + int(42) AS `8plus4`, q1 - int(42) AS `8minus4`, q1 * int(42) AS `8mul4`, q1 / int(42) AS `8div4` FROM INT8_TBL
-- !query schema
struct<8plus4:bigint,8minus4:bigint,8mul4:bigint,8div4:double>
-- !query output
165	81	5166	2.9285714285714284
165	81	5166	2.9285714285714284
4567890123456831	4567890123456747	191851385185185138	1.0875928865373308E14
4567890123456831	4567890123456747	191851385185185138	1.0875928865373308E14
4567890123456831	4567890123456747	191851385185185138	1.0875928865373308E14


-- !query
SELECT int(246) + q1 AS `4plus8`, int(246) - q1 AS `4minus8`, int(246) * q1 AS `4mul8`, int(246) / q1 AS `4div8` FROM INT8_TBL
-- !query schema
struct<4plus8:bigint,4minus8:bigint,4mul8:bigint,4div8:double>
-- !query output
369	123	30258	2.0
369	123	30258	2.0
4567890123457035	-4567890123456543	1123700970370370094	5.385418505072041E-14
4567890123457035	-4567890123456543	1123700970370370094	5.385418505072041E-14
4567890123457035	-4567890123456543	1123700970370370094	5.385418505072041E-14


-- !query
SELECT q1 + smallint(42) AS `8plus2`, q1 - smallint(42) AS `8minus2`, q1 * smallint(42) AS `8mul2`, q1 / smallint(42) AS `8div2` FROM INT8_TBL
-- !query schema
struct<8plus2:bigint,8minus2:bigint,8mul2:bigint,8div2:double>
-- !query output
165	81	5166	2.9285714285714284
165	81	5166	2.9285714285714284
4567890123456831	4567890123456747	191851385185185138	1.0875928865373308E14
4567890123456831	4567890123456747	191851385185185138	1.0875928865373308E14
4567890123456831	4567890123456747	191851385185185138	1.0875928865373308E14


-- !query
SELECT smallint(246) + q1 AS `2plus8`, smallint(246) - q1 AS `2minus8`, smallint(246) * q1 AS `2mul8`, smallint(246) / q1 AS `2div8` FROM INT8_TBL
-- !query schema
struct<2plus8:bigint,2minus8:bigint,2mul8:bigint,2div8:double>
-- !query output
369	123	30258	2.0
369	123	30258	2.0
4567890123457035	-4567890123456543	1123700970370370094	5.385418505072041E-14
4567890123457035	-4567890123456543	1123700970370370094	5.385418505072041E-14
4567890123457035	-4567890123456543	1123700970370370094	5.385418505072041E-14


-- !query
SELECT q2, abs(q2) FROM INT8_TBL
-- !query schema
struct<q2:bigint,abs(q2):bigint>
-- !query output
-4567890123456789	4567890123456789
123	123
456	456
4567890123456789	4567890123456789
4567890123456789	4567890123456789


-- !query
SELECT min(q1), min(q2) FROM INT8_TBL
-- !query schema
struct<min(q1):bigint,min(q2):bigint>
-- !query output
123	-4567890123456789


-- !query
SELECT max(q1), max(q2) FROM INT8_TBL
-- !query schema
struct<max(q1):bigint,max(q2):bigint>
-- !query output
4567890123456789	4567890123456789


-- !query
SELECT '' AS to_char_1, to_char(q1, '9G999G999G999G999G999'), to_char(q2, '9,999,999,999,999,999')
FROM INT8_TBL
-- !query schema
struct<to_char_1:string,to_char(q1, 9G999G999G999G999G999):string,to_char(q2, 9,999,999,999,999,999):string>
-- !query output
	                  123	                  456
	                  123	4,567,890,123,456,789
	4,567,890,123,456,789	                  123
	4,567,890,123,456,789	4,567,890,123,456,789
	4,567,890,123,456,789	4,567,890,123,456,789


-- !query
SELECT '' AS to_char_3, to_char( (q1 * -1), '9999999999999999PR'), to_char( (q2 * -1), '9999999999999999.999PR')
FROM INT8_TBL
-- !query schema
struct<to_char_3:string,to_char((q1 * -1), 9999999999999999PR):string,to_char((q2 * -1), 9999999999999999.999PR):string>
-- !query output
	             <123>	             <456.000>
	             <123>	<4567890123456789.000>
	<4567890123456789>	             <123.000>
	<4567890123456789>	4567890123456789.000  
	<4567890123456789>	<4567890123456789.000>


-- !query
SELECT '' AS to_char_4, to_char( (q1 * -1), '9999999999999999S'), to_char( (q2 * -1), 'S9999999999999999')
FROM INT8_TBL
-- !query schema
struct<to_char_4:string,to_char((q1 * -1), 9999999999999999S):string,to_char((q2 * -1), S9999999999999999):string>
-- !query output
	             123-	             -456
	             123-	-4567890123456789
	4567890123456789-	             -123
	4567890123456789-	+4567890123456789
	4567890123456789-	-4567890123456789


-- !query
SELECT '' AS to_char_5,  to_char(q2, 'MI9999999999999999')     FROM INT8_TBL
-- !query schema
struct<to_char_5:string,to_char(q2, MI9999999999999999):string>
-- !query output
	              123
	              456
	 4567890123456789
	 4567890123456789
	-4567890123456789


-- !query
SELECT '' AS to_char_9,  to_char(q2, '0999999999999999')       FROM INT8_TBL
-- !query schema
struct<to_char_9:string,to_char(q2, 0999999999999999):string>
-- !query output
	0000000000000123
	0000000000000456
	4567890123456789
	4567890123456789
	4567890123456789


-- !query
SELECT '' AS to_char_10, to_char(q2, 'S0999999999999999')      FROM INT8_TBL
-- !query schema
struct<to_char_10:string,to_char(q2, S0999999999999999):string>
-- !query output
	+0000000000000123
	+0000000000000456
	+4567890123456789
	+4567890123456789
	-4567890123456789


-- !query
select bigint('9223372036854775800') / bigint('0')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "DIVIDE_BY_ZERO",
  "sqlState" : "22012",
  "messageParameters" : {
    "config" : "\"spark.sql.ansi.enabled\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 50,
    "fragment" : "bigint('9223372036854775800') / bigint('0')"
  } ]
}


-- !query
select bigint('-9223372036854775808') / smallint('0')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "DIVIDE_BY_ZERO",
  "sqlState" : "22012",
  "messageParameters" : {
    "config" : "\"spark.sql.ansi.enabled\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 53,
    "fragment" : "bigint('-9223372036854775808') / smallint('0')"
  } ]
}


-- !query
select smallint('100') / bigint('0')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "DIVIDE_BY_ZERO",
  "sqlState" : "22012",
  "messageParameters" : {
    "config" : "\"spark.sql.ansi.enabled\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 36,
    "fragment" : "smallint('100') / bigint('0')"
  } ]
}


-- !query
SELECT CAST(q1 AS int) FROM int8_tbl WHERE q2 = 456
-- !query schema
struct<q1:int>
-- !query output
123


-- !query
SELECT CAST(q1 AS int) FROM int8_tbl WHERE q2 <> 456
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "CAST_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "sourceType" : "\"BIGINT\"",
    "targetType" : "\"INT\"",
    "value" : "4567890123456789L"
  }
}


-- !query
SELECT CAST(q1 AS smallint) FROM int8_tbl WHERE q2 = 456
-- !query schema
struct<q1:smallint>
-- !query output
123


-- !query
SELECT CAST(q1 AS smallint) FROM int8_tbl WHERE q2 <> 456
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "CAST_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "sourceType" : "\"BIGINT\"",
    "targetType" : "\"SMALLINT\"",
    "value" : "4567890123456789L"
  }
}


-- !query
SELECT CAST(smallint('42') AS bigint), CAST(smallint('-37') AS bigint)
-- !query schema
struct<CAST(42 AS BIGINT):bigint,CAST(-37 AS BIGINT):bigint>
-- !query output
42	-37


-- !query
SELECT CAST(q1 AS float), CAST(q2 AS double) FROM INT8_TBL
-- !query schema
struct<q1:float,q2:double>
-- !query output
123.0	4.567890123456789E15
123.0	456.0
4.5678899E15	-4.567890123456789E15
4.5678899E15	123.0
4.5678899E15	4.567890123456789E15


-- !query
SELECT CAST(float('36854775807.0') AS bigint)
-- !query schema
struct<CAST(36854775807.0 AS BIGINT):bigint>
-- !query output
36854775808


-- !query
SELECT CAST(double('922337203685477580700.0') AS bigint)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "CAST_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "sourceType" : "\"DOUBLE\"",
    "targetType" : "\"BIGINT\"",
    "value" : "9.223372036854776E20D"
  }
}


-- !query
SELECT q1, q2, q1 & q2 AS `and`, q1 | q2 AS `or`, ~q1 AS `not` FROM INT8_TBL
-- !query schema
struct<q1:bigint,q2:bigint,and:bigint,or:bigint,not:bigint>
-- !query output
123	456	72	507	-124
123	4567890123456789	17	4567890123456895	-124
4567890123456789	-4567890123456789	1	-1	-4567890123456790
4567890123456789	123	17	4567890123456895	-4567890123456790
4567890123456789	4567890123456789	4567890123456789	4567890123456789	-4567890123456790


-- !query
SELECT * FROM range(bigint('+4567890123456789'), bigint('+4567890123456799'))
-- !query schema
struct<id:bigint>
-- !query output
4567890123456789
4567890123456790
4567890123456791
4567890123456792
4567890123456793
4567890123456794
4567890123456795
4567890123456796
4567890123456797
4567890123456798


-- !query
SELECT * FROM range(bigint('+4567890123456789'), bigint('+4567890123456799'), 0)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "FAILED_FUNCTION_CALL",
  "sqlState" : "38000",
  "messageParameters" : {
    "funcName" : "`range`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 80,
    "fragment" : "range(bigint('+4567890123456789'), bigint('+4567890123456799'), 0)"
  } ]
}


-- !query
SELECT * FROM range(bigint('+4567890123456789'), bigint('+4567890123456799'), 2)
-- !query schema
struct<id:bigint>
-- !query output
4567890123456789
4567890123456791
4567890123456793
4567890123456795
4567890123456797


-- !query
SELECT string(shiftleft(bigint(-1), 63))
-- !query schema
struct<shiftleft(-1, 63):string>
-- !query output
-9223372036854775808


-- !query
SELECT string(int(shiftleft(bigint(-1), 63))+1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "CAST_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "sourceType" : "\"BIGINT\"",
    "targetType" : "\"INT\"",
    "value" : "-9223372036854775808L"
  }
}


-- !query
SELECT bigint((-9223372036854775808)) * bigint((-1))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "alternative" : " Use 'try_multiply' to tolerate overflow and return NULL instead.",
    "config" : "\"spark.sql.ansi.enabled\"",
    "message" : "long overflow"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 52,
    "fragment" : "bigint((-9223372036854775808)) * bigint((-1))"
  } ]
}


-- !query
SELECT bigint((-9223372036854775808)) / bigint((-1))
-- !query schema
struct<(-9223372036854775808 / -1):double>
-- !query output
9.223372036854776E18


-- !query
SELECT bigint((-9223372036854775808)) % bigint((-1))
-- !query schema
struct<(-9223372036854775808 % -1):bigint>
-- !query output
0


-- !query
SELECT bigint((-9223372036854775808)) * int((-1))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "alternative" : " Use 'try_multiply' to tolerate overflow and return NULL instead.",
    "config" : "\"spark.sql.ansi.enabled\"",
    "message" : "long overflow"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 49,
    "fragment" : "bigint((-9223372036854775808)) * int((-1))"
  } ]
}


-- !query
SELECT bigint((-9223372036854775808)) / int((-1))
-- !query schema
struct<(-9223372036854775808 / -1):double>
-- !query output
9.223372036854776E18


-- !query
SELECT bigint((-9223372036854775808)) % int((-1))
-- !query schema
struct<(-9223372036854775808 % -1):bigint>
-- !query output
0


-- !query
SELECT bigint((-9223372036854775808)) * smallint((-1))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "alternative" : " Use 'try_multiply' to tolerate overflow and return NULL instead.",
    "config" : "\"spark.sql.ansi.enabled\"",
    "message" : "long overflow"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "bigint((-9223372036854775808)) * smallint((-1))"
  } ]
}


-- !query
SELECT bigint((-9223372036854775808)) / smallint((-1))
-- !query schema
struct<(-9223372036854775808 / -1):double>
-- !query output
9.223372036854776E18


-- !query
SELECT bigint((-9223372036854775808)) % smallint((-1))
-- !query schema
struct<(-9223372036854775808 % -1):bigint>
-- !query output
0


-- !query
SELECT x, bigint(x) AS int8_value
FROM (VALUES (double(-2.5)),
             (double(-1.5)),
             (double(-0.5)),
             (double(0.0)),
             (double(0.5)),
             (double(1.5)),
             (double(2.5))) t(x)
-- !query schema
struct<x:double,int8_value:bigint>
-- !query output
-0.5	0
-1.5	-1
-2.5	-2
0.0	0
0.5	0
1.5	1
2.5	2


-- !query
SELECT x, bigint(x) AS int8_value
FROM (VALUES cast(-2.5 as decimal(38, 18)),
             cast(-1.5 as decimal(38, 18)),
             cast(-0.5 as decimal(38, 18)),
             cast(-0.0 as decimal(38, 18)),
             cast(0.5 as decimal(38, 18)),
             cast(1.5 as decimal(38, 18)),
             cast(2.5 as decimal(38, 18))) t(x)
-- !query schema
struct<x:decimal(38,18),int8_value:bigint>
-- !query output
-0.500000000000000000	0
-1.500000000000000000	-1
-2.500000000000000000	-2
0.000000000000000000	0
0.500000000000000000	0
1.500000000000000000	1
2.500000000000000000	2


-- !query
DROP TABLE INT8_TBL
-- !query schema
struct<>
-- !query output

