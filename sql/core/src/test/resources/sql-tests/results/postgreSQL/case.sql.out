-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE CASE_TBL (
  i integer,
  f double
) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE CASE2_TBL (
  i integer,
  j integer
) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (1, 10.1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (2, 20.2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (3, -30.3)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE_TBL VALUES (4, NULL)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (1, -1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (2, -2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (3, -3)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (2, -4)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (1, NULL)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO CASE2_TBL VALUES (NULL, -6)
-- !query schema
struct<>
-- !query output



-- !query
SELECT '3' AS `One`,
  CASE
    WHEN 1 < 2 THEN 3
  END AS `Simple WHEN`
-- !query schema
struct<One:string,Simple WHEN:int>
-- !query output
3	3


-- !query
SELECT '<NULL>' AS `One`,
  CASE
    WHEN 1 > 2 THEN 3
  END AS `Simple default`
-- !query schema
struct<One:string,Simple default:int>
-- !query output
<NULL>	NULL


-- !query
SELECT '3' AS `One`,
  CASE
    WHEN 1 < 2 THEN 3
    ELSE 4
  END AS `Simple ELSE`
-- !query schema
struct<One:string,Simple ELSE:int>
-- !query output
3	3


-- !query
SELECT '4' AS `One`,
  CASE
    WHEN 1 > 2 THEN 3
    ELSE 4
  END AS `ELSE default`
-- !query schema
struct<One:string,ELSE default:int>
-- !query output
4	4


-- !query
SELECT '6' AS `One`,
  CASE
    WHEN 1 > 2 THEN 3
    WHEN 4 < 5 THEN 6
    ELSE 7
  END AS `Two WHEN with default`
-- !query schema
struct<One:string,Two WHEN with default:int>
-- !query output
6	6


-- !query
SELECT '7' AS `None`,
  CASE WHEN rand() < 0 THEN 1
  END AS `NULL on no matches`
-- !query schema
struct<None:string,NULL on no matches:int>
-- !query output
7	NULL


-- !query
SELECT CASE WHEN 1=0 THEN 1/0 WHEN 1=1 THEN 1 ELSE 2/0 END
-- !query schema
struct<CASE WHEN (1 = 0) THEN (1 / 0) WHEN (1 = 1) THEN 1 ELSE (2 / 0) END:double>
-- !query output
1.0


-- !query
SELECT CASE 1 WHEN 0 THEN 1/0 WHEN 1 THEN 1 ELSE 2/0 END
-- !query schema
struct<CASE WHEN (1 = 0) THEN (1 / 0) WHEN (1 = 1) THEN 1 ELSE (2 / 0) END:double>
-- !query output
1.0


-- !query
SELECT CASE WHEN i > 100 THEN 1/0 ELSE 0 END FROM case_tbl
-- !query schema
struct<CASE WHEN (i > 100) THEN (1 / 0) ELSE 0 END:double>
-- !query output
0.0
0.0
0.0
0.0


-- !query
SELECT CASE 'a' WHEN 'a' THEN 1 ELSE 2 END
-- !query schema
struct<CASE WHEN (a = a) THEN 1 ELSE 2 END:int>
-- !query output
1


-- !query
SELECT '' AS `Five`,
  CASE
    WHEN i >= 3 THEN i
  END AS `>= 3 or Null`
  FROM CASE_TBL
-- !query schema
struct<Five:string,>= 3 or Null:int>
-- !query output
	3
	4
	NULL
	NULL


-- !query
SELECT '' AS `Five`,
  CASE WHEN i >= 3 THEN (i + i)
       ELSE i
  END AS `Simplest Math`
  FROM CASE_TBL
-- !query schema
struct<Five:string,Simplest Math:int>
-- !query output
	1
	2
	6
	8


-- !query
SELECT '' AS `Five`, i AS `Value`,
  CASE WHEN (i < 0) THEN 'small'
       WHEN (i = 0) THEN 'zero'
       WHEN (i = 1) THEN 'one'
       WHEN (i = 2) THEN 'two'
       ELSE 'big'
  END AS `Category`
  FROM CASE_TBL
-- !query schema
struct<Five:string,Value:int,Category:string>
-- !query output
	1	one
	2	two
	3	big
	4	big


-- !query
SELECT '' AS `Five`,
  CASE WHEN ((i < 0) or (i < 0)) THEN 'small'
       WHEN ((i = 0) or (i = 0)) THEN 'zero'
       WHEN ((i = 1) or (i = 1)) THEN 'one'
       WHEN ((i = 2) or (i = 2)) THEN 'two'
       ELSE 'big'
  END AS `Category`
  FROM CASE_TBL
-- !query schema
struct<Five:string,Category:string>
-- !query output
	big
	big
	one
	two


-- !query
SELECT * FROM CASE_TBL WHERE COALESCE(f,i) = 4
-- !query schema
struct<i:int,f:double>
-- !query output
4	NULL


-- !query
SELECT * FROM CASE_TBL WHERE NULLIF(f,i) = 2
-- !query schema
struct<i:int,f:double>
-- !query output



-- !query
SELECT COALESCE(a.f, b.i, b.j)
  FROM CASE_TBL a, CASE2_TBL b
-- !query schema
struct<coalesce(f, i, j):double>
-- !query output
-30.3
-30.3
-30.3
-30.3
-30.3
-30.3
-6.0
1.0
1.0
10.1
10.1
10.1
10.1
10.1
10.1
2.0
2.0
20.2
20.2
20.2
20.2
20.2
20.2
3.0


-- !query
SELECT *
  FROM CASE_TBL a, CASE2_TBL b
  WHERE COALESCE(a.f, b.i, b.j) = 2
-- !query schema
struct<i:int,f:double,i:int,j:int>
-- !query output
4	NULL	2	-2
4	NULL	2	-4


-- !query
SELECT '' AS Five, NULLIF(a.i,b.i) AS `NULLIF(a.i,b.i)`,
  NULLIF(b.i, 4) AS `NULLIF(b.i,4)`
  FROM CASE_TBL a, CASE2_TBL b
-- !query schema
struct<Five:string,NULLIF(a.i,b.i):int,NULLIF(b.i,4):int>
-- !query output
	1	2
	1	2
	1	3
	1	NULL
	2	1
	2	1
	2	3
	2	NULL
	3	1
	3	1
	3	2
	3	2
	3	NULL
	4	1
	4	1
	4	2
	4	2
	4	3
	4	NULL
	NULL	1
	NULL	1
	NULL	2
	NULL	2
	NULL	3


-- !query
SELECT '' AS `Two`, *
  FROM CASE_TBL a, CASE2_TBL b
  WHERE COALESCE(f,b.i) = 2
-- !query schema
struct<Two:string,i:int,f:double,i:int,j:int>
-- !query output
	4	NULL	2	-2
	4	NULL	2	-4


-- !query
SELECT CASE
  (CASE vol('bar')
    WHEN 'foo' THEN 'it was foo!'
    WHEN vol(null) THEN 'null input'
    WHEN 'bar' THEN 'it was bar!' END
  )
  WHEN 'it was foo!' THEN 'foo recognized'
  WHEN 'it was bar!' THEN 'bar recognized'
  ELSE 'unrecognized' END
-- !query schema
struct<CASE WHEN (CASE WHEN (vol(bar) = foo) THEN it was foo! WHEN (vol(bar) = vol(NULL)) THEN null input WHEN (vol(bar) = bar) THEN it was bar! END = it was foo!) THEN foo recognized WHEN (CASE WHEN (vol(bar) = foo) THEN it was foo! WHEN (vol(bar) = vol(NULL)) THEN null input WHEN (vol(bar) = bar) THEN it was bar! END = it was bar!) THEN bar recognized ELSE unrecognized END:string>
-- !query output
bar recognized


-- !query
DROP TABLE CASE_TBL
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE CASE2_TBL
-- !query schema
struct<>
-- !query output

