-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE FUNCTION foo1a0() RETURNS INT RETURN 1
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo1a0()
-- !query schema
struct<spark_catalog.default.foo1a0():int>
-- !query output
1


-- !query
SELECT foo1a0(1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "1",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "0",
    "functionName" : "`spark_catalog`.`default`.`foo1a0`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "foo1a0(1)"
  } ]
}


-- !query
CREATE FUNCTION foo1a1(a INT) RETURNS INT RETURN 1
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo1a1(1)
-- !query schema
struct<spark_catalog.default.foo1a1(1):int>
-- !query output
1


-- !query
SELECT foo1a1(1, 2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "2",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "1",
    "functionName" : "`spark_catalog`.`default`.`foo1a1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 19,
    "fragment" : "foo1a1(1, 2)"
  } ]
}


-- !query
CREATE FUNCTION foo1a2(a INT, b INT, c INT, d INT) RETURNS INT RETURN 1
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo1a2(1, 2, 3, 4)
-- !query schema
struct<spark_catalog.default.foo1a2(1, 2, 3, 4):int>
-- !query output
1


-- !query
CREATE FUNCTION foo2_1a(a INT) RETURNS INT RETURN a
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_1a(5)
-- !query schema
struct<spark_catalog.default.foo2_1a(5):int>
-- !query output
5


-- !query
CREATE FUNCTION foo2_1b(a INT, b INT) RETURNS INT RETURN a + b
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_1b(5, 6)
-- !query schema
struct<spark_catalog.default.foo2_1b(5, 6):int>
-- !query output
11


-- !query
CREATE FUNCTION foo2_1c(a INT, b INT) RETURNS INT RETURN 10 * (a + b) + 100 * (a -b)
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_1c(5, 6)
-- !query schema
struct<spark_catalog.default.foo2_1c(5, 6):int>
-- !query output
10


-- !query
CREATE FUNCTION foo2_1d(a INT, b INT) RETURNS INT RETURN ABS(a) - LENGTH(CAST(b AS VARCHAR(10)))
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_1d(-5, 6)
-- !query schema
struct<spark_catalog.default.foo2_1d(-5, 6):int>
-- !query output
4


-- !query
CREATE FUNCTION foo2_2a(a INT) RETURNS INT RETURN SELECT a
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_2a(5)
-- !query schema
struct<spark_catalog.default.foo2_2a(5):int>
-- !query output
5


-- !query
CREATE FUNCTION foo2_2b(a INT) RETURNS INT RETURN 1 + (SELECT a)
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_2b(5)
-- !query schema
struct<spark_catalog.default.foo2_2b(5):int>
-- !query output
6


-- !query
CREATE FUNCTION foo2_2c(a INT) RETURNS INT RETURN 1 + (SELECT (SELECT a))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`a`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 21,
    "stopIndex" : 21,
    "fragment" : "a"
  } ]
}


-- !query
CREATE FUNCTION foo2_2d(a INT) RETURNS INT RETURN 1 + (SELECT (SELECT (SELECT (SELECT a))))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`a`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 37,
    "stopIndex" : 37,
    "fragment" : "a"
  } ]
}


-- !query
CREATE FUNCTION foo2_2e(a INT) RETURNS INT RETURN
SELECT a FROM (VALUES 1) AS V(c1) WHERE c1 = 2
UNION ALL
SELECT a + 1 FROM (VALUES 1) AS V(c1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE FUNCTION foo2_2f(a INT) RETURNS INT RETURN
SELECT a FROM (VALUES 1) AS V(c1)
EXCEPT
SELECT a + 1 FROM (VALUES 1) AS V(a)
-- !query schema
struct<>
-- !query output



-- !query
CREATE FUNCTION foo2_2g(a INT) RETURNS INT RETURN
SELECT a FROM (VALUES 1) AS V(c1)
INTERSECT
SELECT a FROM (VALUES 1) AS V(a)
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t2
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS ts
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS tm
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS ta
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS V1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS V2
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS t1
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS t2
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS ts
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS tm
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS ta
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS V1
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS V2
-- !query schema
struct<>
-- !query output



-- !query
CREATE FUNCTION foo2_3(a INT, b INT) RETURNS INT RETURN a + b
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW V1(c1, c2) AS VALUES (1, 2), (3, 4), (5, 6)
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW V2(c1, c2) AS VALUES (-1, -2), (-3, -4), (-5, -6)
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_3(c1, c2), foo2_3(c2, 1), foo2_3(c1, c2) - foo2_3(c2, c1 - 1) FROM V1 ORDER BY 1, 2, 3
-- !query schema
struct<spark_catalog.default.foo2_3(c1, c2):int,spark_catalog.default.foo2_3(c2, 1):int,(spark_catalog.default.foo2_3(c1, c2) - spark_catalog.default.foo2_3(c2, (c1 - 1))):int>
-- !query output
3	3	1
7	5	1
11	7	1


-- !query
SELECT * FROM V1 WHERE foo2_3(c1, 0) = c1 AND foo2_3(c1, c2) < 8
-- !query schema
struct<c1:int,c2:int>
-- !query output
1	2
3	4


-- !query
SELECT foo2_3(SUM(c1), SUM(c2)), SUM(c1) + SUM(c2), SUM(foo2_3(c1, c2) + foo2_3(c2, c1) - foo2_3(c2, c1))
FROM V1
-- !query schema
struct<spark_catalog.default.foo2_3(sum(c1), sum(c2)):int,(sum(c1) + sum(c2)):bigint,sum(((spark_catalog.default.foo2_3(c1, c2) + spark_catalog.default.foo2_3(c2, c1)) - spark_catalog.default.foo2_3(c2, c1))):bigint>
-- !query output
21	21	21


-- !query
CREATE FUNCTION foo2_4a(a ARRAY<STRING>) RETURNS STRING RETURN
SELECT array_sort(a, (i, j) -> rank[i] - rank[j])[0] FROM (SELECT MAP('a', 1, 'b', 2) rank)
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_4a(ARRAY('a', 'b'))
-- !query schema
struct<spark_catalog.default.foo2_4a(array(a, b)):string>
-- !query output
a


-- !query
CREATE FUNCTION foo2_4b(m MAP<STRING, STRING>, k STRING) RETURNS STRING RETURN
SELECT v || ' ' || v FROM (SELECT upper(m[k]) AS v)
-- !query schema
struct<>
-- !query output



-- !query
SELECT foo2_4b(map('a', 'hello', 'b', 'world'), 'a')
-- !query schema
struct<spark_catalog.default.foo2_4b(map(a, hello, b, world), a):string>
-- !query output
HELLO HELLO


-- !query
DROP VIEW V2
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW V1
-- !query schema
struct<>
-- !query output

