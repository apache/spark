-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t1 AS SELECT * FROM VALUES
  ("one", 1), ("two", 2), ("three", 3), ("one", 5) AS t1(col1, col2)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW t2 AS SELECT * FROM VALUES
  ("one", 1), ("two", 2), ("three", 3), ("one", 5) AS t1(col1, col2)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
LEFT JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
INNER JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
RIGHT JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
FULL OUTER JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
UNION
SELECT * FROM (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int>
-- !query output
one	1
one	5
three	3
two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
EXCEPT
SELECT * FROM (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int>
-- !query output



-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM t1)
INTERSECT
SELECT * FROM (WITH cte AS (SELECT * FROM t2) SELECT * FROM t2)
-- !query schema
struct<col1:string,col2:int>
-- !query output
one	1
one	5
three	3
two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
LEFT JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
INNER JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
RIGHT JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
FULL OUTER JOIN (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int,col1:string,col2:int>
-- !query output
one	1	one	1
one	1	one	5
one	1	three	3
one	1	two	2
one	5	one	1
one	5	one	5
one	5	three	3
one	5	two	2
three	3	one	1
three	3	one	5
three	3	three	3
three	3	two	2
two	2	one	1
two	2	one	5
two	2	three	3
two	2	two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
UNION
SELECT * FROM (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int>
-- !query output
one	1
one	5
three	3
two	2


-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
EXCEPT
SELECT * FROM (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int>
-- !query output



-- !query
SELECT * FROM (WITH cte AS (SELECT * FROM t1) SELECT * FROM cte)
INTERSECT
SELECT * FROM (WITH cte AS (SELECT * FROM t2) SELECT * FROM cte)
-- !query schema
struct<col1:string,col2:int>
-- !query output
one	1
one	5
three	3
two	2
