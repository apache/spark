-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT rand(0)
-- !query schema
struct<rand(0):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(cast(3 / 7 AS int))
-- !query schema
struct<rand(CAST((3 / 7) AS INT)):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(NULL)
-- !query schema
struct<rand(NULL):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(cast(NULL AS int))
-- !query schema
struct<rand(CAST(NULL AS INT)):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(1.0)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "messageParameters" : {
    "inputSql" : "\"1.0\"",
    "inputType" : "\"DECIMAL(2,1)\"",
    "paramIndex" : "1",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"rand(1.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "rand(1.0)"
  } ]
}


-- !query
SELECT randn(0L)
-- !query schema
struct<randn(0):double>
-- !query output
1.6034991609278433


-- !query
SELECT randn(cast(3 / 7 AS long))
-- !query schema
struct<randn(CAST((3 / 7) AS BIGINT)):double>
-- !query output
1.6034991609278433


-- !query
SELECT randn(NULL)
-- !query schema
struct<randn(NULL):double>
-- !query output
1.6034991609278433


-- !query
SELECT randn(cast(NULL AS long))
-- !query schema
struct<randn(CAST(NULL AS BIGINT)):double>
-- !query output
1.6034991609278433


-- !query
SELECT rand('1')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "1",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"rand(1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "rand('1')"
  } ]
}
