-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT rand(0)
-- !query schema
struct<rand(0):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(cast(3 / 7 AS int))
-- !query schema
struct<rand(CAST((3 / 7) AS INT)):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(NULL)
-- !query schema
struct<rand(NULL):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(cast(NULL AS int))
-- !query schema
struct<rand(CAST(NULL AS INT)):double>
-- !query output
0.7604953758285915


-- !query
SELECT rand(1.0)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1.0\"",
    "inputType" : "\"DECIMAL(2,1)\"",
    "paramIndex" : "first",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"rand(1.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "rand(1.0)"
  } ]
}


-- !query
SELECT randn(0L)
-- !query schema
struct<randn(0):double>
-- !query output
1.6034991609278433


-- !query
SELECT randn(cast(3 / 7 AS long))
-- !query schema
struct<randn(CAST((3 / 7) AS BIGINT)):double>
-- !query output
1.6034991609278433


-- !query
SELECT randn(NULL)
-- !query schema
struct<randn(NULL):double>
-- !query output
1.6034991609278433


-- !query
SELECT randn(cast(NULL AS long))
-- !query schema
struct<randn(CAST(NULL AS BIGINT)):double>
-- !query output
1.6034991609278433


-- !query
SELECT rand('1')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"rand(1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "rand('1')"
  } ]
}


-- !query
SELECT uniform(0, 1, 0) AS result
-- !query schema
struct<result:int>
-- !query output
0


-- !query
SELECT uniform(0, 10, 0) AS result
-- !query schema
struct<result:int>
-- !query output
7


-- !query
SELECT uniform(0L, 10L, 0) AS result
-- !query schema
struct<result:bigint>
-- !query output
7


-- !query
SELECT uniform(0, 10L, 0) AS result
-- !query schema
struct<result:bigint>
-- !query output
7


-- !query
SELECT uniform(0, cast(10 as tinyint), 0) AS result
-- !query schema
struct<result:int>
-- !query output
7


-- !query
SELECT uniform(0, cast(10 as smallint), 0) AS result
-- !query schema
struct<result:int>
-- !query output
7


-- !query
SELECT uniform(0, 10S, 0) AS result
-- !query schema
struct<result:int>
-- !query output
7


-- !query
SELECT uniform(10, 20, 0) AS result
-- !query schema
struct<result:int>
-- !query output
17


-- !query
SELECT uniform(10.0F, 20.0F, 0) AS result
-- !query schema
struct<result:float>
-- !query output
17.604954


-- !query
SELECT uniform(cast(10 as decimal(10, 3)), cast(20 as decimal(10, 3)), 0) AS result
-- !query schema
struct<result:decimal(10,3)>
-- !query output
17.605


-- !query
SELECT uniform(cast(10 as decimal(10, 3)), cast(20 as decimal(11, 4)), 0) AS result
-- !query schema
struct<result:decimal(11,4)>
-- !query output
17.6050


-- !query
SELECT uniform(10, cast(20 as decimal(10, 3)), 0) AS result
-- !query schema
struct<result:decimal(10,3)>
-- !query output
17.605


-- !query
SELECT uniform(cast(10 as decimal(10, 3)), 20, 0) AS result
-- !query schema
struct<result:decimal(10,3)>
-- !query output
17.605


-- !query
SELECT uniform(10.0D, 20.0D, CAST(3 / 7 AS LONG)) AS result
-- !query schema
struct<result:double>
-- !query output
17.604953758285916


-- !query
SELECT uniform(10, 20.0F, 0) AS result
-- !query schema
struct<result:float>
-- !query output
17.604954


-- !query
SELECT uniform(10, 20, 0) AS result FROM VALUES (0), (1), (2) tab(col)
-- !query schema
struct<result:int>
-- !query output
15
16
17


-- !query
SELECT uniform(10, 20.0F) IS NOT NULL AS result
-- !query schema
struct<result:boolean>
-- !query output
true


-- !query
SELECT uniform(-10L, 10L, 0) AS result
-- !query schema
struct<result:bigint>
-- !query output
5


-- !query
SELECT uniform(-20L, -10L, 0) AS result
-- !query schema
struct<result:bigint>
-- !query output
-12


-- !query
SELECT uniform(-20L, -10L, -10) AS result
-- !query schema
struct<result:bigint>
-- !query output
-17


-- !query
SELECT uniform(NULL, 1, 0) AS result
-- !query schema
struct<result:double>
-- !query output
NULL


-- !query
SELECT uniform(cast(NULL AS int), 1, 0) AS result
-- !query schema
struct<result:int>
-- !query output
NULL


-- !query
SELECT uniform(cast(NULL AS float), 1, 0) AS result
-- !query schema
struct<result:float>
-- !query output
NULL


-- !query
SELECT uniform(0, NULL, 0) AS result
-- !query schema
struct<result:double>
-- !query output
NULL


-- !query
SELECT uniform(0, cast(NULL AS int), 0) AS result
-- !query schema
struct<result:int>
-- !query output
NULL


-- !query
SELECT uniform(0, cast(NULL AS float), 0) AS result
-- !query schema
struct<result:float>
-- !query output
NULL


-- !query
SELECT uniform(0, 1, NULL) AS result
-- !query schema
struct<result:int>
-- !query output
0


-- !query
SELECT uniform(NULL, NULL, 0) AS result
-- !query schema
struct<result:double>
-- !query output
NULL


-- !query
SELECT uniform(NULL, NULL, NULL) AS result
-- !query schema
struct<result:double>
-- !query output
NULL


-- !query
SELECT uniform(0, 1, cast(NULL as int)) AS result
-- !query schema
struct<result:int>
-- !query output
0


-- !query
SELECT uniform(0, 1, cast(NULL as float)) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"CAST(NULL AS FLOAT)\"",
    "inputType" : "\"FLOAT\"",
    "paramIndex" : "third",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"uniform(0, 1, CAST(NULL AS FLOAT))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 41,
    "fragment" : "uniform(0, 1, cast(NULL as float))"
  } ]
}


-- !query
SELECT uniform(10, 20, col) AS result FROM VALUES (0), (1), (2) tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "\"col\"",
    "inputName" : "`seed`",
    "inputType" : "integer or floating-point",
    "sqlExpr" : "\"uniform(10, 20, col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 27,
    "fragment" : "uniform(10, 20, col)"
  } ]
}


-- !query
SELECT uniform(col, 10, 0) AS result FROM VALUES (0), (1), (2) tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "\"col\"",
    "inputName" : "`min`",
    "inputType" : "integer or floating-point",
    "sqlExpr" : "\"uniform(col, 10, 0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 26,
    "fragment" : "uniform(col, 10, 0)"
  } ]
}


-- !query
SELECT uniform(10) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "1",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "[2, 3]",
    "functionName" : "`uniform`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 18,
    "fragment" : "uniform(10)"
  } ]
}


-- !query
SELECT uniform(10, 20, 30, 40) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "4",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "[2, 3]",
    "functionName" : "`uniform`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "uniform(10, 20, 30, 40)"
  } ]
}


-- !query
SELECT uniform(10.0F, 20.0F, 0.0F) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"0.0\"",
    "inputType" : "\"FLOAT\"",
    "paramIndex" : "third",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"uniform(10.0, 20.0, 0.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 34,
    "fragment" : "uniform(10.0F, 20.0F, 0.0F)"
  } ]
}


-- !query
SELECT uniform(10.0F, 20.0F, 0.0D) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"0.0\"",
    "inputType" : "\"DOUBLE\"",
    "paramIndex" : "third",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"uniform(10.0, 20.0, 0.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 34,
    "fragment" : "uniform(10.0F, 20.0F, 0.0D)"
  } ]
}


-- !query
SELECT uniform(cast(10 as decimal(10, 3)), cast(20 as decimal(10, 3)), cast(0 as decimal(10, 3)))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"CAST(0 AS DECIMAL(10,3))\"",
    "inputType" : "\"DECIMAL(10,3)\"",
    "paramIndex" : "third",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"uniform(CAST(10 AS DECIMAL(10,3)), CAST(20 AS DECIMAL(10,3)), CAST(0 AS DECIMAL(10,3)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "uniform(cast(10 as decimal(10, 3)), cast(20 as decimal(10, 3)), cast(0 as decimal(10, 3)))"
  } ]
}


-- !query
SELECT uniform('abc', 10, 0) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"abc\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"NUMERIC\"",
    "sqlExpr" : "\"uniform(abc, 10, 0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 28,
    "fragment" : "uniform('abc', 10, 0)"
  } ]
}


-- !query
SELECT uniform(0, 'def', 0) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"def\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"NUMERIC\"",
    "sqlExpr" : "\"uniform(0, def, 0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 27,
    "fragment" : "uniform(0, 'def', 0)"
  } ]
}


-- !query
SELECT uniform(0, 10, 'ghi') AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"ghi\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "third",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"uniform(0, 10, ghi)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 28,
    "fragment" : "uniform(0, 10, 'ghi')"
  } ]
}


-- !query
SELECT randstr(1, 0) AS result
-- !query schema
struct<result:string>
-- !query output
c


-- !query
SELECT randstr(5, 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0P


-- !query
SELECT randstr(10, 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(10S, 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(CAST(10 AS TINYINT), 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(CAST(10 AS BIGINT), 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(1.0F, 0) AS result
-- !query schema
struct<result:string>
-- !query output
c


-- !query
SELECT randstr(1.0D, 0) AS result
-- !query schema
struct<result:string>
-- !query output
c


-- !query
SELECT randstr(cast(1 AS DECIMAL(10, 2)), 0) AS result
-- !query schema
struct<result:string>
-- !query output
c


-- !query
SELECT randstr(10, 0) AS result FROM VALUES (0), (1), (2) tab(col)
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I
fYxVfArnv7
iSIv0VT2XL


-- !query
SELECT randstr(10) IS NOT NULL AS result
-- !query schema
struct<result:boolean>
-- !query output
true


-- !query
SELECT randstr(1, -1) AS result
-- !query schema
struct<result:string>
-- !query output
S


-- !query
SELECT randstr(10L, 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(10.0F, 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(10.0D, 0) AS result
-- !query schema
struct<result:string>
-- !query output
ceV0PXaR2I


-- !query
SELECT randstr(NULL, 0) AS result
-- !query schema
struct<result:string>
-- !query output



-- !query
SELECT randstr(0, NULL) AS result
-- !query schema
struct<result:string>
-- !query output



-- !query
SELECT randstr(col, 0) AS result FROM VALUES (0), (1), (2) tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "\"col\"",
    "inputName" : "`length`",
    "inputType" : "integer",
    "sqlExpr" : "\"randstr(col, 0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "randstr(col, 0)"
  } ]
}


-- !query
SELECT randstr(10, col) AS result FROM VALUES (0), (1), (2) tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "\"col\"",
    "inputName" : "`seed`",
    "inputType" : "integer",
    "sqlExpr" : "\"randstr(10, col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 23,
    "fragment" : "randstr(10, col)"
  } ]
}


-- !query
SELECT randstr(10, 0, 1) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "3",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "[1, 2]",
    "functionName" : "`randstr`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "randstr(10, 0, 1)"
  } ]
}


-- !query
SELECT randstr(-1, 0) AS result
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_PARAMETER_VALUE.LENGTH",
  "sqlState" : "22023",
  "messageParameters" : {
    "functionName" : "`randstr`",
    "length" : "-1",
    "parameter" : "`length`"
  }
}


-- !query
SELECT randstr(10, "a") AS result FROM VALUES (0) tab(a)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"a\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"randstr(10, a)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 23,
    "fragment" : "randstr(10, \"a\")"
  } ]
}


-- !query
SELECT randstr(10, 1.5) AS result FROM VALUES (0) tab(a)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1.5\"",
    "inputType" : "\"DECIMAL(2,1)\"",
    "paramIndex" : "second",
    "requiredType" : "(\"INT\" or \"BIGINT\")",
    "sqlExpr" : "\"randstr(10, 1.5)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 23,
    "fragment" : "randstr(10, 1.5)"
  } ]
}
