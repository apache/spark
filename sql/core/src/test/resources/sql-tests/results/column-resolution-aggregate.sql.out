-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW v1 AS VALUES (1, 1, 1), (2, 2, 1) AS t(a, b, k)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v2 AS VALUES (1, 1, 1), (2, 2, 1) AS t(x, y, all)
-- !query schema
struct<>
-- !query output



-- !query
SELECT max(a) AS b, b FROM v1 GROUP BY k
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "MISSING_AGGREGATION",
  "sqlState" : "42803",
  "messageParameters" : {
    "expression" : "\"b\"",
    "expressionAnyValue" : "\"any_value(b)\""
  }
}


-- !query
SELECT a FROM v1 WHERE (12, 13) IN (SELECT max(x + 10) AS a, a + 1 FROM v2)
-- !query schema
struct<a:int>
-- !query output
1
2


-- !query
SELECT a AS k FROM v1 GROUP BY k
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "MISSING_AGGREGATION",
  "sqlState" : "42803",
  "messageParameters" : {
    "expression" : "\"a\"",
    "expressionAnyValue" : "\"any_value(a)\""
  }
}


-- !query
SELECT x FROM v2 GROUP BY all
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "MISSING_AGGREGATION",
  "sqlState" : "42803",
  "messageParameters" : {
    "expression" : "\"x\"",
    "expressionAnyValue" : "\"any_value(x)\""
  }
}


-- !query
SELECT a AS all, b FROM v1 GROUP BY all
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "MISSING_AGGREGATION",
  "sqlState" : "42803",
  "messageParameters" : {
    "expression" : "\"b\"",
    "expressionAnyValue" : "\"any_value(b)\""
  }
}


-- !query
SELECT k AS lca, lca + 1 AS col FROM v1 GROUP BY k, col
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNSUPPORTED_FEATURE.LATERAL_COLUMN_ALIAS_IN_GROUP_BY",
  "sqlState" : "0A000"
}


-- !query
SELECT k AS lca, lca + 1 AS col FROM v1 GROUP BY all
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNSUPPORTED_FEATURE.LATERAL_COLUMN_ALIAS_IN_GROUP_BY",
  "sqlState" : "0A000"
}


-- !query
SELECT k AS lca, lca + 1 AS col FROM v1 GROUP BY lca
-- !query schema
struct<lca:int,col:int>
-- !query output
1	2


-- !query
SELECT * FROM v2 WHERE EXISTS (SELECT a, b FROM v1 GROUP BY all)
-- !query schema
struct<x:int,y:int,all:int>
-- !query output
1	1	1
2	2	1
