-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT ifnull(null, 'x'), ifnull('y', 'x'), ifnull(null, null)
-- !query schema
struct<ifnull(null, 'x'):string,ifnull('y', 'x'):string,ifnull(null, null):void>
-- !query output
x	y	NULL


-- !query
SELECT nullif('x', 'x'), nullif('x', 'y')
-- !query schema
struct<nullif('x', 'x'):string,nullif('x', 'y'):string>
-- !query output
NULL	x


-- !query
SELECT nvl(null, 'x'), nvl('y', 'x'), nvl(null, null)
-- !query schema
struct<nvl(null, 'x'):string,nvl('y', 'x'):string,nvl(null, null):void>
-- !query output
x	y	NULL


-- !query
SELECT nvl2(null, 'x', 'y'), nvl2('n', 'x', 'y'), nvl2(null, null, null)
-- !query schema
struct<nvl2(null, 'x', 'y'):string,nvl2('n', 'x', 'y'):string,nvl2(null, null, null):void>
-- !query output
y	x	NULL


-- !query
SELECT ifnull(1, 2.1d), ifnull(null, 2.1d)
-- !query schema
struct<ifnull(1, 2.1d):double,ifnull(null, 2.1d):double>
-- !query output
1.0	2.1


-- !query
SELECT nullif(1, 2.1d), nullif(1, 1.0d)
-- !query schema
struct<nullif(1, 2.1d):int,nullif(1, 1.0d):int>
-- !query output
1	NULL


-- !query
SELECT nvl(1, 2.1d), nvl(null, 2.1d)
-- !query schema
struct<nvl(1, 2.1d):double,nvl(null, 2.1d):double>
-- !query output
1.0	2.1


-- !query
SELECT nvl2(null, 1, 2.1d), nvl2('n', 1, 2.1d)
-- !query schema
struct<nvl2(null, 1, 2.1d):double,nvl2('n', 1, 2.1d):double>
-- !query output
2.1	1.0


-- !query
SELECT boolean(1), tinyint(1), smallint(1), int(1), bigint(1)
-- !query schema
struct<boolean(1):boolean,tinyint(1):tinyint,smallint(1):smallint,int(1):int,bigint(1):bigint>
-- !query output
true	1	1	1	1


-- !query
SELECT float(1), double(1), decimal(1)
-- !query schema
struct<float(1):float,double(1):double,decimal(1):decimal(10,0)>
-- !query output
1.0	1.0	1


-- !query
SELECT date("2014-04-04"), timestamp(date("2014-04-04"))
-- !query schema
struct<date("2014-04-04"):date,timestamp(date("2014-04-04")):timestamp>
-- !query output
2014-04-04	2014-04-04 00:00:00


-- !query
SELECT string(1, 2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITH_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "2",
    "expectedNum" : "1",
    "functionName" : "`string`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 19,
    "fragment" : "string(1, 2)"
  } ]
}


-- !query
CREATE TEMPORARY VIEW tempView1 AS VALUES (1, NAMED_STRUCT('col1', 'gamma', 'col2', 'delta')) AS T(id, st)
-- !query schema
struct<>
-- !query output



-- !query
SELECT nvl(st.col1, "value"), count(*) FROM from tempView1 GROUP BY nvl(st.col1, "value")
-- !query schema
struct<nvl(st.col1, "value"):string,FROM:bigint>
-- !query output
gamma	1
