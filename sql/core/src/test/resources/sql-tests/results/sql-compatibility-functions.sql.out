-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT ifnull(null, 'x'), ifnull('y', 'x'), ifnull(null, null)
-- !query schema
struct<ifnull(NULL, x):string,ifnull(y, x):string,ifnull(NULL, NULL):void>
-- !query output
x	y	NULL


-- !query
SELECT nullif('x', 'x'), nullif('x', 'y')
-- !query schema
struct<nullif(x, x):string,nullif(x, y):string>
-- !query output
NULL	x


-- !query
SELECT nvl(null, 'x'), nvl('y', 'x'), nvl(null, null)
-- !query schema
struct<nvl(NULL, x):string,nvl(y, x):string,nvl(NULL, NULL):void>
-- !query output
x	y	NULL


-- !query
SELECT nvl2(null, 'x', 'y'), nvl2('n', 'x', 'y'), nvl2(null, null, null)
-- !query schema
struct<nvl2(NULL, x, y):string,nvl2(n, x, y):string,nvl2(NULL, NULL, NULL):void>
-- !query output
y	x	NULL


-- !query
SELECT ifnull(1, 2.1d), ifnull(null, 2.1d)
-- !query schema
struct<ifnull(1, 2.1):double,ifnull(NULL, 2.1):double>
-- !query output
1.0	2.1


-- !query
SELECT nullif(1, 2.1d), nullif(1, 1.0d)
-- !query schema
struct<nullif(1, 2.1):int,nullif(1, 1.0):int>
-- !query output
1	NULL


-- !query
SELECT nvl(1, 2.1d), nvl(null, 2.1d)
-- !query schema
struct<nvl(1, 2.1):double,nvl(NULL, 2.1):double>
-- !query output
1.0	2.1


-- !query
SELECT nvl2(null, 1, 2.1d), nvl2('n', 1, 2.1d)
-- !query schema
struct<nvl2(NULL, 1, 2.1):double,nvl2(n, 1, 2.1):double>
-- !query output
2.1	1.0


-- !query
SELECT boolean(1), tinyint(1), smallint(1), int(1), bigint(1)
-- !query schema
struct<1:boolean,1:tinyint,1:smallint,1:int,1:bigint>
-- !query output
true	1	1	1	1


-- !query
SELECT float(1), double(1), decimal(1)
-- !query schema
struct<1:float,1:double,1:decimal(10,0)>
-- !query output
1.0	1.0	1


-- !query
SELECT date("2014-04-04"), timestamp(date("2014-04-04"))
-- !query schema
struct<2014-04-04:date,2014-04-04:timestamp>
-- !query output
2014-04-04	2014-04-04 00:00:00


-- !query
SELECT string(1, 2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "2",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "1",
    "functionName" : "`string`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 19,
    "fragment" : "string(1, 2)"
  } ]
}


-- !query
CREATE TEMPORARY VIEW tempView1 AS VALUES (1, NAMED_STRUCT('col1', 'gamma', 'col2', 'delta')) AS T(id, st)
-- !query schema
struct<>
-- !query output



-- !query
SELECT nvl(st.col1, "value"), count(*) FROM from tempView1 GROUP BY nvl(st.col1, "value")
-- !query schema
struct<nvl(st.col1, value):string,FROM:bigint>
-- !query output
gamma	1


-- !query
SELECT nullif(SUM(id), 0) from range(5)
-- !query schema
struct<nullif(sum(id), 0):bigint>
-- !query output
10
