-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE DATABASE mydb1
-- !query schema
struct<>
-- !query output



-- !query
USE mydb1
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t1 USING parquet AS SELECT 1 AS i1
-- !query schema
struct<>
-- !query output



-- !query
CREATE DATABASE mydb2
-- !query schema
struct<>
-- !query output



-- !query
USE mydb2
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t1 USING parquet AS SELECT 20 AS i1
-- !query schema
struct<>
-- !query output



-- !query
USE mydb1
-- !query schema
struct<>
-- !query output



-- !query
SELECT i1 FROM t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT i1 FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t1.i1 FROM t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t1.i1 FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT mydb1.t1.i1 FROM t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT mydb1.t1.i1 FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
USE mydb2
-- !query schema
struct<>
-- !query output



-- !query
SELECT i1 FROM t1
-- !query schema
struct<i1:int>
-- !query output
20


-- !query
SELECT i1 FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t1.i1 FROM t1
-- !query schema
struct<i1:int>
-- !query output
20


-- !query
SELECT t1.i1 FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT mydb1.t1.i1 FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
USE mydb1
-- !query schema
struct<>
-- !query output



-- !query
SELECT t1.* FROM t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT mydb1.t1.* FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t1.* FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
USE mydb2
-- !query schema
struct<>
-- !query output



-- !query
SELECT t1.* FROM t1
-- !query schema
struct<i1:int>
-- !query output
20


-- !query
SELECT mydb1.t1.* FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t1.* FROM mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT a.* FROM mydb1.t1 AS a
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
USE mydb1
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t3 USING parquet AS SELECT * FROM VALUES (4,1), (3,1) AS t3(c1, c2)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t4 USING parquet AS SELECT * FROM VALUES (4,1), (2,1) AS t4(c2, c3)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM t3 WHERE c1 IN (SELECT c2 FROM t4 WHERE t4.c3 = t3.c2)
-- !query schema
struct<c1:int,c2:int>
-- !query output
4	1


-- !query
SELECT * FROM mydb1.t3 WHERE c1 IN
  (SELECT mydb1.t4.c2 FROM mydb1.t4 WHERE mydb1.t4.c3 = mydb1.t3.c2)
-- !query schema
struct<c1:int,c2:int>
-- !query output
4	1


-- !query
SET spark.sql.crossJoin.enabled = true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.crossJoin.enabled	true


-- !query
SELECT mydb1.t1.i1 FROM t1, mydb2.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT mydb1.t1.i1 FROM mydb1.t1, mydb2.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
USE mydb2
-- !query schema
struct<>
-- !query output



-- !query
SELECT mydb1.t1.i1 FROM t1, mydb1.t1
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SET spark.sql.crossJoin.enabled = false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.crossJoin.enabled	false


-- !query
USE mydb1
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t5(i1 INT, t5 STRUCT<i1:INT, i2:INT>) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t5 VALUES(1, (2, 3))
-- !query schema
struct<>
-- !query output



-- !query
SELECT t5.i1 FROM t5
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t5.t5.i1 FROM t5
-- !query schema
struct<i1:int>
-- !query output
2


-- !query
SELECT t5.t5.i1 FROM mydb1.t5
-- !query schema
struct<i1:int>
-- !query output
2


-- !query
SELECT t5.i1 FROM mydb1.t5
-- !query schema
struct<i1:int>
-- !query output
1


-- !query
SELECT t5.* FROM mydb1.t5
-- !query schema
struct<i1:int,t5:struct<i1:int,i2:int>>
-- !query output
1	{"i1":2,"i2":3}


-- !query
SELECT t5.t5.* FROM mydb1.t5
-- !query schema
struct<i1:int,i2:int>
-- !query output
2	3


-- !query
SELECT mydb1.t5.t5.i1 FROM mydb1.t5
-- !query schema
struct<i1:int>
-- !query output
2


-- !query
SELECT mydb1.t5.t5.i2 FROM mydb1.t5
-- !query schema
struct<i2:int>
-- !query output
3


-- !query
SELECT mydb1.t5.* FROM mydb1.t5
-- !query schema
struct<i1:int,t5:struct<i1:int,i2:int>>
-- !query output
1	{"i1":2,"i2":3}


-- !query
SELECT mydb1.t5.* FROM t5
-- !query schema
struct<i1:int,t5:struct<i1:int,i2:int>>
-- !query output
1	{"i1":2,"i2":3}


-- !query
USE default
-- !query schema
struct<>
-- !query output



-- !query
DROP DATABASE mydb1 CASCADE
-- !query schema
struct<>
-- !query output



-- !query
DROP DATABASE mydb2 CASCADE
-- !query schema
struct<>
-- !query output

