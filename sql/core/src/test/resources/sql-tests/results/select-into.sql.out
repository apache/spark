-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW tbl_view AS SELECT * FROM VALUES
  (10, 'name1'),
  (20, 'name2'),
  (30, 'name3')
AS tbl_view(id, name)
-- !query schema
struct<>
-- !query output



-- !query
SELECT id INTO res_id FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


BEGIN
  DECLARE outer_id INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT (SELECT id INTO outer_id FROM tbl_view WHERE id = 10) as nested
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_IN_NESTED_QUERY",
  "sqlState" : "42601"
}


BEGIN
  DECLARE res_id INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id INTO res_id FROM tbl_view WHERE id = 10
  UNION
  SELECT id FROM tbl_view WHERE id = 20
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_IN_SET_OPERATION",
  "sqlState" : "42601"
}

BEGIN
  DECLARE res_id INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id INTO res_id FROM tbl_view WHERE id = 10
  INTERSECT
  SELECT id FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_IN_SET_OPERATION",
  "sqlState" : "42601"
}

BEGIN
  DECLARE res_id INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id INTO res_id FROM tbl_view WHERE id = 10
  EXCEPT
  SELECT id FROM tbl_view WHERE id = 20
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_IN_SET_OPERATION",
  "sqlState" : "42601"
}


BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE v2 STRING
-- !query schema
struct<>
-- !query output



-- !query
DECLARE v3 INT
-- !query schema
struct<>
-- !query output



-- !query
SELECT id, name INTO v1, v2, v3 FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_VARIABLE_COUNT_MISMATCH",
  "sqlState" : "21000",
  "messageParameters" : {
    "numCols" : "2",
    "numVars" : "3"
  }
}

BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id, name INTO v1 FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_VARIABLE_COUNT_MISMATCH",
  "sqlState" : "21000",
  "messageParameters" : {
    "numCols" : "2",
    "numVars" : "1"
  }
}

BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE v2 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "VARIABLE_ALREADY_EXISTS",
  "sqlState" : "42723",
  "messageParameters" : {
    "variableName" : "`system`.`session`.`v2`"
  }
}


-- !query
DECLARE v3 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "VARIABLE_ALREADY_EXISTS",
  "sqlState" : "42723",
  "messageParameters" : {
    "variableName" : "`system`.`session`.`v3`"
  }
}


-- !query
SELECT id + 10, id * 2 INTO v1, v2, v3 FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_VARIABLE_COUNT_MISMATCH",
  "sqlState" : "21000",
  "messageParameters" : {
    "numCols" : "2",
    "numVars" : "3"
  }
}


BEGIN
  DECLARE result_struct STRUCT<f1: INT, f2: STRING>
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id, name, id + 10 INTO result_struct FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_STRUCT_FIELD_MISMATCH",
  "sqlState" : "21000",
  "messageParameters" : {
    "numCols" : "3",
    "numFields" : "2",
    "structType" : "\"STRUCT<f1: INT, f2: STRING>\""
  }
}


BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id INTO v1 FROM tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<>
org.apache.spark.SparkException
{
  "errorClass" : "ROW_SUBQUERY_TOO_MANY_ROWS",
  "sqlState" : "21000"
}


BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id INTO v1 FROM tbl_view WHERE id = 30
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<v1:int>
30

BEGIN
  DECLARE var1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE var2 STRING
-- !query schema
struct<>
-- !query output



-- !query
SELECT id, name INTO var1, var2 FROM tbl_view WHERE id = 20
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT var1, var2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`var1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "var1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<var1:int,var2:string>
20	name2

BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE v2 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "VARIABLE_ALREADY_EXISTS",
  "sqlState" : "42723",
  "messageParameters" : {
    "variableName" : "`system`.`session`.`v2`"
  }
}


-- !query
SELECT id + 10, id * 2 INTO v1, v2 FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT v1, v2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<v1:int,v2:int>
20	20

BEGIN
  DECLARE result_struct STRUCT<field1: INT, field2: STRING>
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id, name INTO result_struct FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT result_struct
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`result_struct`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "result_struct"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<result_struct:struct<field1:int,field2:string>>
{"field1":10,"field2":"name1"}

BEGIN
  DECLARE my_struct STRUCT<a: INT, b: STRING>
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT id, name INTO my_struct FROM tbl_view WHERE id = 20
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT my_struct.a, my_struct.b
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`my_struct`.`a`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 18,
    "fragment" : "my_struct.a"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<a:int,b:string>
20	name2


BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE v2 STRING
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "VARIABLE_ALREADY_EXISTS",
  "sqlState" : "42723",
  "messageParameters" : {
    "variableName" : "`system`.`session`.`v2`"
  }
}


-- !query
SET VAR v1 = 99
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_VARIABLE",
  "sqlState" : "42883",
  "messageParameters" : {
    "searchPath" : "`SYSTEM`.`SESSION`",
    "variableName" : "`v1`"
  }
}


-- !query
SET VAR v2 = 'initial'
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1, v2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
SELECT id, name INTO v1, v2 FROM tbl_view WHERE id = 999
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT v1, v2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<v1:int,v2:string>
99	initial
99	initial

BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SET VAR v1 = 42
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_VARIABLE",
  "sqlState" : "42883",
  "messageParameters" : {
    "searchPath" : "`SYSTEM`.`SESSION`",
    "variableName" : "`v1`"
  }
}


-- !query
SELECT v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
SELECT id INTO v1 FROM tbl_view WHERE 1=0
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<v1:int>
42
42

BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SELECT v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
SELECT id INTO v1 FROM tbl_view WHERE FALSE
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<v1:int>
NULL
NULL

BEGIN
  DECLARE my_struct STRUCT<x: INT, y: STRING>
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
SET VAR my_struct = named_struct('x', 100, 'y', 'original')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_VARIABLE",
  "sqlState" : "42883",
  "messageParameters" : {
    "searchPath" : "`SYSTEM`.`SESSION`",
    "variableName" : "`my_struct`"
  }
}


-- !query
SELECT my_struct
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`my_struct`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "my_struct"
  } ]
}


-- !query
SELECT id, name INTO my_struct FROM tbl_view WHERE id < 0
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT my_struct
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`my_struct`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 16,
    "fragment" : "my_struct"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<my_struct:struct<x:int,y:string>>
{"x":100,"y":"original"}
{"x":100,"y":"original"}


BEGIN
  DECLARE v1 INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE v2 STRING
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "VARIABLE_ALREADY_EXISTS",
  "sqlState" : "42723",
  "messageParameters" : {
    "variableName" : "`system`.`session`.`v2`"
  }
}


-- !query
SELECT * INTO v1, v2 FROM tbl_view WHERE id = 10
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT v1, v2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 9,
    "fragment" : "v1"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<v1:int,v2:string>
10	name1

BEGIN
  DECLARE a INT
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}


-- !query
DECLARE b STRING
-- !query schema
struct<>
-- !query output



-- !query
SELECT id AS my_id, name AS my_name INTO a, b FROM tbl_view WHERE id = 30
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "SELECT_INTO_NOT_IN_SQL_SCRIPT",
  "sqlState" : "42601"
}


-- !query
SELECT a, b
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`a`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 8,
    "fragment" : "a"
  } ]
}


-- !query
END
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'END'",
    "hint" : ""
  }
}


-- !query
struct<a:int,b:string>
30	name3

DROP VIEW tbl_view
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'struct'",
    "hint" : ""
  }
}
