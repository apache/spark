-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT * FROM variant_explode(input => parse_json('["hello", "world"]'))
-- !query schema
struct<pos:int,key:string,value:variant>
-- !query output
0	NULL	"hello"
1	NULL	"world"


-- !query
SELECT * FROM variant_explode_outer(input => parse_json('{"a": true, "b": 3.14}'))
-- !query schema
struct<pos:int,key:string,value:variant>
-- !query output
0	a	true
1	b	3.14


-- !query
SELECT * FROM variant_explode(parse_json('["hello", "world"]')), variant_explode(parse_json('{"a": true, "b": 3.14}'))
-- !query schema
struct<pos:int,key:string,value:variant,pos:int,key:string,value:variant>
-- !query output
0	NULL	"hello"	0	a	true
0	NULL	"hello"	1	b	3.14
1	NULL	"world"	0	a	true
1	NULL	"world"	1	b	3.14


-- !query
SELECT * FROM variant_explode(parse_json('{"a": ["hello", "world"], "b": {"x": true, "y": 3.14}}')) AS t, LATERAL variant_explode(t.value)
-- !query schema
struct<pos:int,key:string,value:variant,pos:int,key:string,value:variant>
-- !query output
0	a	["hello","world"]	0	NULL	"hello"
0	a	["hello","world"]	1	NULL	"world"
1	b	{"x":true,"y":3.14}	0	x	true
1	b	{"x":true,"y":3.14}	1	y	3.14


-- !query
SELECT num, key, val, 'Spark' FROM variant_explode(parse_json('["hello", "world"]')) AS t(num, key, val)
-- !query schema
struct<num:int,key:string,val:variant,Spark:string>
-- !query output
0	NULL	"hello"	Spark
1	NULL	"world"	Spark
