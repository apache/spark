-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 26


-- !query 0
CREATE TEMPORARY VIEW desc_col_temp_view (key int COMMENT 'column_comment') USING PARQUET
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
DESC desc_col_temp_view key
-- !query 1 schema
struct<info_name:string,info_value:string>
-- !query 1 output
col_name	key
data_type	int
comment	column_comment


-- !query 2
DESC EXTENDED desc_col_temp_view key
-- !query 2 schema
struct<info_name:string,info_value:string>
-- !query 2 output
col_name	key
data_type	int
comment	column_comment
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query 3
DESC FORMATTED desc_col_temp_view key
-- !query 3 schema
struct<info_name:string,info_value:string>
-- !query 3 output
col_name	key
data_type	int
comment	column_comment
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query 4
DESC FORMATTED desc_col_temp_view desc_col_temp_view.key
-- !query 4 schema
struct<info_name:string,info_value:string>
-- !query 4 output
col_name	key
data_type	int
comment	column_comment
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query 5
DESC desc_col_temp_view key1
-- !query 5 schema
struct<>
-- !query 5 output
org.apache.spark.sql.AnalysisException
Column key1 does not exist;


-- !query 6
CREATE TABLE desc_col_table (key int COMMENT 'column_comment') USING PARQUET
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
ANALYZE TABLE desc_col_table COMPUTE STATISTICS FOR COLUMNS key
-- !query 7 schema
struct<>
-- !query 7 output



-- !query 8
DESC desc_col_table key
-- !query 8 schema
struct<info_name:string,info_value:string>
-- !query 8 output
col_name	key
data_type	int
comment	column_comment


-- !query 9
DESC EXTENDED desc_col_table key
-- !query 9 schema
struct<info_name:string,info_value:string>
-- !query 9 output
col_name	key
data_type	int
comment	column_comment
min	NULL
max	NULL
num_nulls	0
distinct_count	0
avg_col_len	4
max_col_len	4
histogram	NULL


-- !query 10
DESC FORMATTED desc_col_table key
-- !query 10 schema
struct<info_name:string,info_value:string>
-- !query 10 output
col_name	key
data_type	int
comment	column_comment
min	NULL
max	NULL
num_nulls	0
distinct_count	0
avg_col_len	4
max_col_len	4
histogram	NULL


-- !query 11
SET spark.sql.statistics.histogram.enabled=true
-- !query 11 schema
struct<key:string,value:string>
-- !query 11 output
spark.sql.statistics.histogram.enabled	true


-- !query 12
SET spark.sql.statistics.histogram.numBins=2
-- !query 12 schema
struct<key:string,value:string>
-- !query 12 output
spark.sql.statistics.histogram.numBins	2


-- !query 13
INSERT INTO desc_col_table values(1)
-- !query 13 schema
struct<>
-- !query 13 output



-- !query 14
INSERT INTO desc_col_table values(2)
-- !query 14 schema
struct<>
-- !query 14 output



-- !query 15
INSERT INTO desc_col_table values(3)
-- !query 15 schema
struct<>
-- !query 15 output



-- !query 16
INSERT INTO desc_col_table values(4)
-- !query 16 schema
struct<>
-- !query 16 output



-- !query 17
ANALYZE TABLE desc_col_table COMPUTE STATISTICS FOR COLUMNS key
-- !query 17 schema
struct<>
-- !query 17 output



-- !query 18
DESC EXTENDED desc_col_table key
-- !query 18 schema
struct<info_name:string,info_value:string>
-- !query 18 output
col_name	key
data_type	int
comment	column_comment
min	1
max	4
num_nulls	0
distinct_count	4
avg_col_len	4
max_col_len	4
histogram	height: 2.0, num_of_bins: 2
	lower_bound: 1.0, upper_bound: 2.0, distinct_count: 2
	lower_bound: 2.0, upper_bound: 4.0, distinct_count: 2


-- !query 19
CREATE TABLE desc_complex_col_table (`a.b` int, col struct<x:int, y:string>) USING PARQUET
-- !query 19 schema
struct<>
-- !query 19 output



-- !query 20
DESC FORMATTED desc_complex_col_table `a.b`
-- !query 20 schema
struct<info_name:string,info_value:string>
-- !query 20 output
col_name	a.b
data_type	int
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query 21
DESC FORMATTED desc_complex_col_table col
-- !query 21 schema
struct<info_name:string,info_value:string>
-- !query 21 output
col_name	col
data_type	struct<x:int,y:string>
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query 22
DESC FORMATTED desc_complex_col_table col.x
-- !query 22 schema
struct<>
-- !query 22 output
org.apache.spark.sql.AnalysisException
DESC TABLE COLUMN command does not support nested data types: col.x;


-- !query 23
DROP VIEW desc_col_temp_view
-- !query 23 schema
struct<>
-- !query 23 output



-- !query 24
DROP TABLE desc_col_table
-- !query 24 schema
struct<>
-- !query 24 output



-- !query 25
DROP TABLE desc_complex_col_table
-- !query 25 schema
struct<>
-- !query 25 output

