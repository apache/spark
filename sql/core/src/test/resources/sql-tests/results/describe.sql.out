-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE t (a STRING, b INT, c STRING, d STRING) USING parquet
  OPTIONS (a '1', b '2', password 'password')
  PARTITIONED BY (c, d) CLUSTERED BY (a) SORTED BY (b ASC) INTO 2 BUCKETS
  COMMENT 'table_comment'
  TBLPROPERTIES (t 'test', password 'password')
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW temp_v AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW temp_Data_Source_View
  USING org.apache.spark.sql.sources.DDLScanSource
  OPTIONS (
    From '1',
    To '10',
    Table 'test1')
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE t SET TBLPROPERTIES (e = '3')
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE t ADD PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output



-- !query
DESCRIBE t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESCRIBE EXTENDED t AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"t","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.t","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"bucket_columns":["a"],"sort_columns":["b"],"location": "[not included in comparison]/{warehouse_dir}/t","storage_properties":{"a":"1","b":"2","password":"*********(redacted)"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment","table_properties":{"e":"3","password":"*********(redacted)","t":"test"},"partition_provider":"Catalog","partition_columns":["c","d"]}


-- !query
DESCRIBE t AS JSON
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "DESCRIBE_JSON_NOT_EXTENDED",
  "sqlState" : "0A000"
}


-- !query
DESC FORMATTED t a AS JSON
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "UNSUPPORTED_FEATURE.DESC_TABLE_COLUMN_JSON",
  "sqlState" : "0A000"
}


-- !query
DESC default.t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC TABLE t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[e=3, password=*********(redacted), t=test]	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Partition Provider  	Catalog


-- !query
DESC FORMATTED t AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"t","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.t","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"bucket_columns":["a"],"sort_columns":["b"],"location": "[not included in comparison]/{warehouse_dir}/t","storage_properties":{"a":"1","b":"2","password":"*********(redacted)"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment","table_properties":{"e":"3","password":"*********(redacted)","t":"test"},"partition_provider":"Catalog","partition_columns":["c","d"]}


-- !query
DESC EXTENDED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[e=3, password=*********(redacted), t=test]	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Partition Provider  	Catalog


-- !query
DESC EXTENDED t AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"t","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.t","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"bucket_columns":["a"],"sort_columns":["b"],"location": "[not included in comparison]/{warehouse_dir}/t","storage_properties":{"a":"1","b":"2","password":"*********(redacted)"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment","table_properties":{"e":"3","password":"*********(redacted)","t":"test"},"partition_provider":"Catalog","partition_columns":["c","d"]}


-- !query
ALTER TABLE t UNSET TBLPROPERTIES (e)
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[password=*********(redacted), t=test]	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Partition Provider  	Catalog


-- !query
ALTER TABLE t UNSET TBLPROPERTIES (comment)
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Table Properties    	[password=*********(redacted), t=test]	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Partition Provider  	Catalog


-- !query
DESC t PARTITION (c='Us', d=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC EXTENDED t PARTITION (c='Us', d=1) AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"t","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.t","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"partition_values":{"c":"Us","d":"1"},"location": "[not included in comparison]/{warehouse_dir}/t/c=Us/d=1","storage_properties":{"a":"1","b":"2","password":"*********(redacted)"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","bucket_columns":["a"],"sort_columns":["b"],"table_properties":{"password":"*********(redacted)","t":"test"},"partition_provider":"Catalog","partition_columns":["c","d"]}


-- !query
DESC EXTENDED t PARTITION (c='Us', d=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]/{warehouse_dir}/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]


-- !query
DESC FORMATTED t PARTITION (c='Us', d=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]/{warehouse_dir}/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]


-- !query
DESC EXTENDED t PARTITION (C='Us', D=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]/{warehouse_dir}/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2, password=*********(redacted)]


-- !query
DESC EXTENDED t PARTITION (C='Us', D=1) AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"t","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.t","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"partition_values":{"c":"Us","d":"1"},"location": "[not included in comparison]/{warehouse_dir}/t/c=Us/d=1","storage_properties":{"a":"1","b":"2","password":"*********(redacted)"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","bucket_columns":["a"],"sort_columns":["b"],"table_properties":{"password":"*********(redacted)","t":"test"},"partition_provider":"Catalog","partition_columns":["c","d"]}


-- !query
DESC t PARTITION (c='Us', d=2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
{
  "errorClass" : "PARTITIONS_NOT_FOUND",
  "sqlState" : "428FT",
  "messageParameters" : {
    "partitionList" : "PARTITION (`c` = Us, `d` = 2)",
    "tableName" : "`default`.`t`"
  }
}


-- !query
DESC t PARTITION (c='Us')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1232",
  "messageParameters" : {
    "partitionColumnNames" : "c, d",
    "specKeys" : "c",
    "tableName" : "`spark_catalog`.`default`.`t`"
  }
}


-- !query
DESC t PARTITION (c='Us', d)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_SQL_SYNTAX.EMPTY_PARTITION_VALUE",
  "sqlState" : "42000",
  "messageParameters" : {
    "partKey" : "`d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 1,
    "stopIndex" : 28,
    "fragment" : "DESC t PARTITION (c='Us', d)"
  } ]
}


-- !query
DESC temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC EXTENDED temp_v AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}]}


-- !query
DESC TABLE temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC EXTENDED temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC temp_Data_Source_View
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
intType             	int                 	test comment test1  
stringType          	string              	                    
dateType            	date                	                    
timestampType       	timestamp           	                    
doubleType          	double              	                    
bigintType          	bigint              	                    
tinyintType         	tinyint             	                    
decimalType         	decimal(10,0)       	                    
fixedDecimalType    	decimal(5,1)        	                    
binaryType          	binary              	                    
booleanType         	boolean             	                    
smallIntType        	smallint            	                    
floatType           	float               	                    
mapType             	map<string,string>  	                    
arrayType           	array<string>       	                    
structType          	struct<f1:string,f2:int>


-- !query
DESC temp_v PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "FORBIDDEN_OPERATION",
  "sqlState" : "42809",
  "messageParameters" : {
    "objectName" : "`temp_v`",
    "objectType" : "TEMPORARY VIEW",
    "statement" : "DESC PARTITION"
  }
}


-- !query
DESC v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC TABLE v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[a, b, c, d]


-- !query
DESC FORMATTED v AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"v","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.v","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"VIEW","view_text":"SELECT * FROM t","view_original_text":"SELECT * FROM t","view_schema_mode":"COMPENSATION","view_catalog_and_namespace":"spark_catalog.default","view_query_output_columns":["a","b","c","d"]}


-- !query
DESC EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[a, b, c, d]


-- !query
DESC v PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "FORBIDDEN_OPERATION",
  "sqlState" : "42809",
  "messageParameters" : {
    "objectName" : "`v`",
    "objectType" : "VIEW",
    "statement" : "DESC PARTITION"
  }
}


-- !query
EXPLAIN DESC t
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `spark_catalog`.`default`.`t`, false, [col_name#x, data_type#x, comment#x]


-- !query
EXPLAIN DESC EXTENDED t AS JSON
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableJsonCommand
   +- DescribeTableJsonCommand `spark_catalog`.`default`.`t`, true


-- !query
EXPLAIN DESC EXTENDED t
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `spark_catalog`.`default`.`t`, true, [col_name#x, data_type#x, comment#x]


-- !query
EXPLAIN EXTENDED DESC t
-- !query schema
struct<plan:string>
-- !query output
== Parsed Logical Plan ==
'DescribeRelation false, false, [col_name#x, data_type#x, comment#x]
+- 'UnresolvedTableOrView [t], DESCRIBE TABLE, true

== Analyzed Logical Plan ==
col_name: string, data_type: string, comment: string
DescribeTableCommand `spark_catalog`.`default`.`t`, false, [col_name#x, data_type#x, comment#x]

== Optimized Logical Plan ==
DescribeTableCommand `spark_catalog`.`default`.`t`, false, [col_name#x, data_type#x, comment#x]

== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `spark_catalog`.`default`.`t`, false, [col_name#x, data_type#x, comment#x]


-- !query
EXPLAIN DESCRIBE t b
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeColumnCommand
   +- DescribeColumnCommand `spark_catalog`.`default`.`t`, [spark_catalog, default, t, b], false, [info_name#x, info_value#x]


-- !query
EXPLAIN DESCRIBE t PARTITION (c='Us', d=2)
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `spark_catalog`.`default`.`t`, [c=Us, d=2], false, [col_name#x, data_type#x, comment#x]


-- !query
EXPLAIN DESCRIBE EXTENDED t PARTITION (c='Us', d=2) AS JSON
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableJsonCommand
   +- DescribeTableJsonCommand `spark_catalog`.`default`.`t`, [c=Us, d=2], true


-- !query
DROP TABLE t
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW temp_v
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW temp_Data_Source_View
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW v
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE d (a STRING DEFAULT 'default-value', b INT DEFAULT 42) USING parquet COMMENT 'table_comment'
-- !query schema
struct<>
-- !query output



-- !query
DESC d
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	'default-value'     
b                   	int                 	42


-- !query
DESC EXTENDED d
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	d                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Comment             	table_comment       	                    
Location [not included in comparison]/{warehouse_dir}/d	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	'default-value'     
b                   	int                 	42


-- !query
DESC TABLE EXTENDED d
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	d                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Comment             	table_comment       	                    
Location [not included in comparison]/{warehouse_dir}/d	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	'default-value'     
b                   	int                 	42


-- !query
DESC TABLE EXTENDED d AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"d","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.d","columns":[{"id":1,"name":"a","type":{"type":"string"},"default_value":"'default-value'"},{"id":2,"name":"b","type":{"type":"integer"},"default_value":"42"}],"location": "[not included in comparison]/{warehouse_dir}/d","created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment"}


-- !query
DESC FORMATTED d
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	d                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Comment             	table_comment       	                    
Location [not included in comparison]/{warehouse_dir}/d	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	'default-value'     
b                   	int                 	42


-- !query
CREATE TABLE e (a STRING DEFAULT CONCAT('a\n b\n ', 'c\n d'), b INT DEFAULT 42) USING parquet COMMENT 'table_comment'
-- !query schema
struct<>
-- !query output



-- !query
DESC e
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	CONCAT('a\n b\n ', 'c\n d')
b                   	int                 	42


-- !query
DESC EXTENDED e AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"e","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.e","columns":[{"id":1,"name":"a","type":{"type":"string"},"default_value":"CONCAT('a\n b\n ', 'c\n d')"},{"id":2,"name":"b","type":{"type":"integer"},"default_value":"42"}],"location": "[not included in comparison]/{warehouse_dir}/e","created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment"}


-- !query
DESC EXTENDED e
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	e                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Comment             	table_comment       	                    
Location [not included in comparison]/{warehouse_dir}/e	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	CONCAT('a\n b\n ', 'c\n d')
b                   	int                 	42


-- !query
DESC TABLE EXTENDED e
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	e                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Comment             	table_comment       	                    
Location [not included in comparison]/{warehouse_dir}/e	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	CONCAT('a\n b\n ', 'c\n d')
b                   	int                 	42


-- !query
DESC FORMATTED e
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	e                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Comment             	table_comment       	                    
Location [not included in comparison]/{warehouse_dir}/e	                    
                    	                    	                    
# Column Default Values	                    	                    
a                   	string              	CONCAT('a\n b\n ', 'c\n d')
b                   	int                 	42


-- !query
DESC TABLE FORMATTED e AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"e","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.e","columns":[{"id":1,"name":"a","type":{"type":"string"},"default_value":"CONCAT('a\n b\n ', 'c\n d')"},{"id":2,"name":"b","type":{"type":"integer"},"default_value":"42"}],"location": "[not included in comparison]/{warehouse_dir}/e","created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment"}


-- !query
CREATE TABLE t2 (
    a STRING,
    b INT,
    c STRING,
    d STRING
)
USING parquet
OPTIONS (
    a '1',
    b '2',
    password 'password'
)
PARTITIONED BY (c, d)
CLUSTERED BY (a) SORTED BY (b ASC) INTO 2 BUCKETS
COMMENT 'table_comment'
TBLPROPERTIES (
    t 'test',
    password 'password'
)
-- !query schema
struct<>
-- !query output



-- !query
DESC t2
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED t2 as json
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"t2","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.t2","columns":[{"id":1,"name":"a","type":{"type":"string"}},{"id":2,"name":"b","type":{"type":"integer"}},{"id":3,"name":"c","type":{"type":"string"}},{"id":4,"name":"d","type":{"type":"string"}}],"bucket_columns":["a"],"sort_columns":["b"],"location": "[not included in comparison]/{warehouse_dir}/t2","storage_properties":{"a":"1","b":"2","password":"*********(redacted)"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"table_comment","table_properties":{"password":"*********(redacted)","t":"test"},"partition_provider":"Catalog","partition_columns":["c","d"]}


-- !query
DROP TABLE t2
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE c (
  id STRING,
  nested_struct STRUCT<
    name: STRING,
    age: INT,
    contact: STRUCT<
      email: STRING,
      phone_numbers: ARRAY<STRING>,
      addresses: ARRAY<STRUCT<
        street: STRING,
        city: STRING,
        zip: INT
      >>
    >
  >,
  preferences MAP<STRING, ARRAY<STRING>>
) USING parquet
  OPTIONS (option1 'value1', option2 'value2')
  PARTITIONED BY (id)
  COMMENT 'A table with nested complex types'
  TBLPROPERTIES ('property1' = 'value1', 'password' = 'password')
-- !query schema
struct<>
-- !query output



-- !query
DESC FORMATTED c AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"c","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.c","columns":[{"id":1,"name":"nested_struct","type":{"type":"struct","fields":[{"name":"name","type":{"type":"string"},"nullable":true},{"name":"age","type":{"type":"integer"},"nullable":true},{"name":"contact","type":{"type":"struct","fields":[{"name":"email","type":{"type":"string"},"nullable":true},{"name":"phone_numbers","type":{"type":"array","elementType":{"type":"string"},"containsNull":true},"nullable":true},{"name":"addresses","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"street","type":{"type":"string"},"nullable":true},{"name":"city","type":{"type":"string"},"nullable":true},{"name":"zip","type":{"type":"integer"},"nullable":true}]},"containsNull":true},"nullable":true}]},"nullable":true}]}},{"id":2,"name":"preferences","type":{"type":"map","keyType":{"type":"string"},"valueType":{"type":"array","elementType":{"type":"string"},"containsNull":true},"valueContainsNull":true}},{"id":3,"name":"id","type":{"type":"string"}}],"location": "[not included in comparison]/{warehouse_dir}/c","storage_properties":{"option1":"value1","option2":"value2"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"A table with nested complex types","table_properties":{"password":"*********(redacted)","property1":"value1"},"partition_provider":"Catalog","partition_columns":["id"]}


-- !query
DROP TABLE c
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE special_types_table (
  id STRING,
  salary DECIMAL(10, 2),
  short_description VARCHAR(255),
  char_code CHAR(10),
  timestamp_with_time_zone TIMESTAMP,
  timestamp_without_time_zone TIMESTAMP_NTZ,
  interval_year_to_month INTERVAL YEAR TO MONTH,
  interval_day_to_hour INTERVAL DAY TO HOUR,
  nested_struct STRUCT<
    detail: STRING,
    metrics: STRUCT<
      precision: DECIMAL(5, 2),
      scale: CHAR(5)
    >,
    time_info: STRUCT<
      timestamp_ltz: TIMESTAMP,
      timestamp_ntz: TIMESTAMP_NTZ
    >
  >,
  preferences MAP<STRING, ARRAY<VARCHAR(50)>>
) USING parquet
  OPTIONS ('compression' = 'snappy')
  COMMENT 'Table testing all special types'
  TBLPROPERTIES ('test_property' = 'test_value')
-- !query schema
struct<>
-- !query output



-- !query
DESC FORMATTED special_types_table AS JSON
-- !query schema
struct<json_metadata:string,:string,:string>
-- !query output
{"table_name":"special_types_table","catalog_name":"spark_catalog","database_names":["default"],"qualified_name":"spark_catalog.default.special_types_table","columns":[{"id":1,"name":"id","type":{"type":"string"}},{"id":2,"name":"salary","type":{"type":"decimal","precision":10,"scale":2}},{"id":3,"name":"short_description","type":{"type":"varchar","length":255}},{"id":4,"name":"char_code","type":{"type":"char","length":10}},{"id":5,"name":"timestamp_with_time_zone","type":{"type":"timestamp_ltz"}},{"id":6,"name":"timestamp_without_time_zone","type":{"type":"timestamp_ntz"}},{"id":7,"name":"interval_year_to_month","type":{"type":"interval","start_unit":"year","end_unit":"month"}},{"id":8,"name":"interval_day_to_hour","type":{"type":"interval","start_unit":"day","end_unit":"day"}},{"id":9,"name":"nested_struct","type":{"type":"struct","fields":[{"name":"detail","type":{"type":"string"},"nullable":true},{"name":"metrics","type":{"type":"struct","fields":[{"name":"precision","type":{"type":"decimal","precision":5,"scale":2},"nullable":true},{"name":"scale","type":{"type":"char","length":5},"nullable":true}]},"nullable":true},{"name":"time_info","type":{"type":"struct","fields":[{"name":"timestamp_ltz","type":{"type":"timestamp_ltz"},"nullable":true},{"name":"timestamp_ntz","type":{"type":"timestamp_ntz"},"nullable":true}]},"nullable":true}]}},{"id":10,"name":"preferences","type":{"type":"map","keyType":{"type":"string"},"valueType":{"type":"array","elementType":{"type":"varchar","length":50},"containsNull":true},"valueContainsNull":true}}],"location": "[not included in comparison]/{warehouse_dir}/special_types_table","storage_properties":{"compression":"snappy"},"created_time [not included in comparison]":"None","last_access [not included in comparison]":"None","created_by [not included in comparison]":"None","type":"MANAGED","provider":"parquet","comment":"Table testing all special types","table_properties":{"test_property":"test_value"}}


-- !query
DROP TABLE special_types_table
-- !query schema
struct<>
-- !query output

