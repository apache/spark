-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 41


-- !query 0
CREATE TABLE t (a STRING, b INT, c STRING, d STRING) USING parquet
  OPTIONS (a '1', b '2')
  PARTITIONED BY (c, d) CLUSTERED BY (a) SORTED BY (b ASC) INTO 2 BUCKETS
  COMMENT 'table_comment'
  TBLPROPERTIES (t 'test')
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TEMPORARY VIEW temp_v AS SELECT * FROM t
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE TEMPORARY VIEW temp_Data_Source_View
  USING org.apache.spark.sql.sources.DDLScanSource
  OPTIONS (
    From '1',
    To '10',
    Table 'test1')
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE VIEW v AS SELECT * FROM t
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
ALTER TABLE t SET TBLPROPERTIES (e = '3')
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
ALTER TABLE t ADD PARTITION (c='Us', d=1)
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
DESCRIBE t
-- !query 6 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 6 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 7
DESC default.t
-- !query 7 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 7 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 8
DESC TABLE t
-- !query 8 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 8 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 9
DESC FORMATTED t
-- !query 9 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 9 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[t=test, e=3]       	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query 10
DESC EXTENDED t
-- !query 10 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 10 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[t=test, e=3]       	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query 11
ALTER TABLE t UNSET TBLPROPERTIES (e)
-- !query 11 schema
struct<>
-- !query 11 output



-- !query 12
DESC EXTENDED t
-- !query 12 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 12 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[t=test]            	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query 13
ALTER TABLE t UNSET TBLPROPERTIES (comment)
-- !query 13 schema
struct<>
-- !query 13 output



-- !query 14
DESC EXTENDED t
-- !query 14 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 14 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Table Properties    	[t=test]            	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query 15
DESC t PARTITION (c='Us', d=1)
-- !query 15 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 15 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 16
DESC EXTENDED t PARTITION (c='Us', d=1)
-- !query 16 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 16 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]sql/core/spark-warehouse/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2]          	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Storage Properties  	[a=1, b=2]


-- !query 17
DESC FORMATTED t PARTITION (c='Us', d=1)
-- !query 17 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 17 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]sql/core/spark-warehouse/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2]          	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Storage Properties  	[a=1, b=2]


-- !query 18
DESC t PARTITION (c='Us', d=2)
-- !query 18 schema
struct<>
-- !query 18 output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
Partition not found in table 't' database 'default':
c -> Us
d -> 2;


-- !query 19
DESC t PARTITION (c='Us')
-- !query 19 schema
struct<>
-- !query 19 output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (c) must match the partition spec (c, d) defined in table '`default`.`t`';


-- !query 20
DESC t PARTITION (c='Us', d)
-- !query 20 schema
struct<>
-- !query 20 output
org.apache.spark.sql.catalyst.parser.ParseException

PARTITION specification is incomplete: `d`(line 1, pos 0)

== SQL ==
DESC t PARTITION (c='Us', d)
^^^


-- !query 21
DESC temp_v
-- !query 21 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 21 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 22
DESC TABLE temp_v
-- !query 22 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 22 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 23
DESC FORMATTED temp_v
-- !query 23 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 23 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 24
DESC EXTENDED temp_v
-- !query 24 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 24 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 25
DESC temp_Data_Source_View
-- !query 25 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 25 output
intType             	int                 	test comment test1  
stringType          	string              	                    
dateType            	date                	                    
timestampType       	timestamp           	                    
doubleType          	double              	                    
bigintType          	bigint              	                    
tinyintType         	tinyint             	                    
decimalType         	decimal(10,0)       	                    
fixedDecimalType    	decimal(5,1)        	                    
binaryType          	binary              	                    
booleanType         	boolean             	                    
smallIntType        	smallint            	                    
floatType           	float               	                    
mapType             	map<string,string>  	                    
arrayType           	array<string>       	                    
structType          	struct<f1:string,f2:int>


-- !query 26
DESC temp_v PARTITION (c='Us', d=1)
-- !query 26 schema
struct<>
-- !query 26 output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a temporary view: temp_v;


-- !query 27
DESC v
-- !query 27 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 27 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 28
DESC TABLE v
-- !query 28 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 28 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 29
DESC FORMATTED v
-- !query 29 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 29 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Default Database	default             	                    
View Query Output Columns	[a, b, c, d]        	                    
Table Properties    	[view.query.out.col.3=d, view.query.out.col.0=a, view.query.out.numCols=4, view.default.database=default, view.query.out.col.1=b, view.query.out.col.2=c]


-- !query 30
DESC EXTENDED v
-- !query 30 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 30 output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Default Database	default             	                    
View Query Output Columns	[a, b, c, d]        	                    
Table Properties    	[view.query.out.col.3=d, view.query.out.col.0=a, view.query.out.numCols=4, view.default.database=default, view.query.out.col.1=b, view.query.out.col.2=c]


-- !query 31
DESC v PARTITION (c='Us', d=1)
-- !query 31 schema
struct<>
-- !query 31 output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a view: v;


-- !query 32
EXPLAIN DESC t
-- !query 32 schema
struct<plan:string>
-- !query 32 output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `t`, false


-- !query 33
EXPLAIN DESC EXTENDED t
-- !query 33 schema
struct<plan:string>
-- !query 33 output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `t`, true


-- !query 34
EXPLAIN EXTENDED DESC t
-- !query 34 schema
struct<plan:string>
-- !query 34 output
== Parsed Logical Plan ==
DescribeTableCommand `t`, false

== Analyzed Logical Plan ==
col_name: string, data_type: string, comment: string
DescribeTableCommand `t`, false

== Optimized Logical Plan ==
DescribeTableCommand `t`, false

== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `t`, false


-- !query 35
EXPLAIN DESCRIBE t b
-- !query 35 schema
struct<plan:string>
-- !query 35 output
== Physical Plan ==
Execute DescribeColumnCommand
   +- DescribeColumnCommand `t`, [b], false


-- !query 36
EXPLAIN DESCRIBE t PARTITION (c='Us', d=2)
-- !query 36 schema
struct<plan:string>
-- !query 36 output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `t`, Map(c -> Us, d -> 2), false


-- !query 37
DROP TABLE t
-- !query 37 schema
struct<>
-- !query 37 output



-- !query 38
DROP VIEW temp_v
-- !query 38 schema
struct<>
-- !query 38 output



-- !query 39
DROP VIEW temp_Data_Source_View
-- !query 39 schema
struct<>
-- !query 39 output



-- !query 40
DROP VIEW v
-- !query 40 schema
struct<>
-- !query 40 output

