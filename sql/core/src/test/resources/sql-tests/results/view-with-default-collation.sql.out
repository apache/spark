-- Automatically generated by SQLQueryTestSuite
-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION UNICODE AS SELECT 'a'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<'a' collate UNICODE:string collate UNICODE>
-- !query output
a


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION UTF8_LCASE AS SELECT 'a' AS c1
-- !query schema
struct<>
-- !query output



-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('a'), ('A')
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION SR_AI_CI AS SELECT c1 FROM t WHERE 'ć' = 'č'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COUNT(*) FROM v
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('ć'), ('č')
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION UNICODE AS SELECT CAST(c1 AS STRING COLLATE SR_AI) FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT DISTINCT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.sr_AI


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'c'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('ć'), ('č')
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION UNICODE AS SELECT CAST(c1 AS STRING COLLATE SR_AI) FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT DISTINCT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.sr_AI


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'c'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION UTF8_LCASE
AS SELECT 'a' AS c1, (SELECT (SELECT CASE 'a' = 'A' WHEN TRUE THEN 'a' ELSE 'b' END) WHERE (SELECT 'b' WHERE 'c' = 'C') = 'B') AS c2, 'c'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
SELECT COUNT(*) FROM v WHERE c2 = 'a'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
SELECT COUNT(*) FROM v WHERE c2 = 'b'
-- !query schema
struct<count(1):bigint>
-- !query output
0


-- !query
SELECT * FROM v
-- !query schema
struct<c1:string collate UTF8_LCASE,c2:string collate UTF8_LCASE,'c' collate UTF8_LCASE:string collate UTF8_LCASE>
-- !query output
a	a	c


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING, c2 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('a', 'a'), ('A', 'A'), ('b', 'b')
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE VIEW v DEFAULT COLLATION sr_ci_ai AS SELECT *, 'ć' AS c3 FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT DISTINCT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.UTF8_BINARY


-- !query
SELECT DISTINCT COLLATION(c2) FROM v
-- !query schema
struct<collation(c2):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
SELECT DISTINCT COLLATION(c3) FROM v
-- !query schema
struct<collation(c3):string>
-- !query output
SYSTEM.BUILTIN.sr_CI_AI


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
SELECT COUNT(*) FROM v WHERE c2 = 'a'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
SELECT COUNT(*) FROM v WHERE c3 = 'Č'
-- !query schema
struct<count(1):bigint>
-- !query output
3


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION UTF8_LCASE AS SELECT 1
-- !query schema
struct<>
-- !query output



-- !query
ALTER VIEW v AS SELECT 'a' AS c1, 'b' AS c2
-- !query schema
struct<>
-- !query output



-- !query
SELECT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
SELECT COLLATION(c2) FROM v
-- !query schema
struct<collation(c2):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
ALTER VIEW v AS SELECT 'c' AS c3 WHERE 'a' = 'A'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COLLATION(c3) FROM v
-- !query schema
struct<collation(c3):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE, c2 STRING, c3 INT)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('a', 'b', 1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v DEFAULT COLLATION sr_AI_CI AS SELECT 'a' AS c1
-- !query schema
struct<>
-- !query output



-- !query
ALTER VIEW v AS
    SELECT *, 'c' AS c4, (SELECT (SELECT CASE 'š' = 'S' WHEN TRUE THEN 'd' ELSE 'b' END)) AS c5
    FROM t
    WHERE c1 = 'A' AND 'ć' = 'Č'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COLLATION(c4) FROM v
-- !query schema
struct<collation(c4):string>
-- !query output
SYSTEM.BUILTIN.sr_CI_AI


-- !query
SELECT COLLATION(c5) FROM v
-- !query schema
struct<collation(c5):string>
-- !query output
SYSTEM.BUILTIN.sr_CI_AI


-- !query
SELECT c5 FROM v
-- !query schema
struct<c5:string collate sr_CI_AI>
-- !query output
d


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION UNICODE AS SELECT 'a'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<'a' collate UNICODE:string collate UNICODE>
-- !query output
a


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION UTF8_LCASE AS SELECT 'a' AS c1
-- !query schema
struct<>
-- !query output



-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('a'), ('A')
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION SR_AI_CI AS SELECT c1 FROM t WHERE 'ć' = 'č'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COUNT(*) FROM v
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('ć'), ('č')
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION UNICODE AS SELECT CAST(c1 AS STRING COLLATE SR_AI) FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT DISTINCT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.sr_AI


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'c'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('ć'), ('č')
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION UNICODE AS SELECT CAST(c1 AS STRING COLLATE SR_AI) FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT DISTINCT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.sr_AI


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'c'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION UTF8_LCASE
AS SELECT 'a' AS c1, (SELECT (SELECT CASE 'a' = 'A' WHEN TRUE THEN 'a' ELSE 'b' END) WHERE (SELECT 'b' WHERE 'c' = 'C') = 'B') AS c2, 'c'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
SELECT COUNT(*) FROM v WHERE c2 = 'a'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
SELECT COUNT(*) FROM v WHERE c2 = 'b'
-- !query schema
struct<count(1):bigint>
-- !query output
0


-- !query
SELECT * FROM v
-- !query schema
struct<c1:string collate UTF8_LCASE,c2:string collate UTF8_LCASE,'c' collate UTF8_LCASE:string collate UTF8_LCASE>
-- !query output
a	a	c


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING, c2 STRING COLLATE UTF8_LCASE)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('a', 'a'), ('A', 'A'), ('b', 'b')
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW v DEFAULT COLLATION sr_ci_ai AS SELECT *, 'ć' AS c3 FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT DISTINCT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.UTF8_BINARY


-- !query
SELECT DISTINCT COLLATION(c2) FROM v
-- !query schema
struct<collation(c2):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
SELECT DISTINCT COLLATION(c3) FROM v
-- !query schema
struct<collation(c3):string>
-- !query output
SYSTEM.BUILTIN.sr_CI_AI


-- !query
SELECT COUNT(*) FROM v WHERE c1 = 'A'
-- !query schema
struct<count(1):bigint>
-- !query output
1


-- !query
SELECT COUNT(*) FROM v WHERE c2 = 'a'
-- !query schema
struct<count(1):bigint>
-- !query output
2


-- !query
SELECT COUNT(*) FROM v WHERE c3 = 'Č'
-- !query schema
struct<count(1):bigint>
-- !query output
3


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION UTF8_LCASE AS SELECT 1
-- !query schema
struct<>
-- !query output



-- !query
ALTER VIEW v AS SELECT 'a' AS c1, 'b' AS c2
-- !query schema
struct<>
-- !query output



-- !query
SELECT COLLATION(c1) FROM v
-- !query schema
struct<collation(c1):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
SELECT COLLATION(c2) FROM v
-- !query schema
struct<collation(c2):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
ALTER VIEW v AS SELECT 'c' AS c3 WHERE 'a' = 'A'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COLLATION(c3) FROM v
-- !query schema
struct<collation(c3):string>
-- !query output
SYSTEM.BUILTIN.UTF8_LCASE


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t (c1 STRING COLLATE UTF8_LCASE, c2 STRING, c3 INT)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('a', 'b', 1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW v DEFAULT COLLATION sr_AI_CI AS SELECT 'a' AS c1
-- !query schema
struct<>
-- !query output



-- !query
ALTER VIEW v AS
    SELECT *, 'c' AS c4, (SELECT (SELECT CASE 'š' = 'S' WHEN TRUE THEN 'd' ELSE 'b' END)) AS c5
    FROM t
    WHERE c1 = 'A' AND 'ć' = 'Č'
-- !query schema
struct<>
-- !query output



-- !query
SELECT COLLATION(c4) FROM v
-- !query schema
struct<collation(c4):string>
-- !query output
SYSTEM.BUILTIN.sr_CI_AI


-- !query
SELECT COLLATION(c5) FROM v
-- !query schema
struct<collation(c5):string>
-- !query output
SYSTEM.BUILTIN.sr_CI_AI


-- !query
SELECT c5 FROM v
-- !query schema
struct<c5:string collate sr_CI_AI>
-- !query output
d


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output

