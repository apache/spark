-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW testRegression AS SELECT * FROM VALUES
(1, 10, null), (2, 10, 11), (2, 20, 22), (2, 25, null), (2, 30, 35), (2, null, 40)
AS testRegression(k, y, x)
-- !query schema
struct<>
-- !query output



-- !query
SELECT regr_count(y, x) FROM testRegression
-- !query schema
struct<regr_count(y, x):bigint>
-- !query output
3


-- !query
SELECT regr_count(y, x) FROM testRegression WHERE x IS NOT NULL
-- !query schema
struct<regr_count(y, x):bigint>
-- !query output
3


-- !query
SELECT k, count(*), regr_count(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,count(1):bigint,regr_count(y, x):bigint>
-- !query output
1	1	0
2	5	3


-- !query
SELECT k, count(*) FILTER (WHERE x IS NOT NULL), regr_count(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,count(1) FILTER (WHERE (x IS NOT NULL)):bigint,regr_count(y, x):bigint>
-- !query output
1	0	0
2	4	3


-- !query
SELECT regr_r2(y, x) FROM testRegression
-- !query schema
struct<regr_r2(y, x):double>
-- !query output
0.997690531177829


-- !query
SELECT regr_r2(y, x) FROM testRegression WHERE x IS NOT NULL
-- !query schema
struct<regr_r2(y, x):double>
-- !query output
0.997690531177829


-- !query
SELECT k, corr(y, x), regr_r2(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,corr(y, x):double,regr_r2(y, x):double>
-- !query output
1	NULL	NULL
2	0.9988445981121533	0.997690531177829


-- !query
SELECT k, corr(y, x) FILTER (WHERE x IS NOT NULL), regr_r2(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,corr(y, x) FILTER (WHERE (x IS NOT NULL)):double,regr_r2(y, x):double>
-- !query output
1	NULL	NULL
2	0.9988445981121533	0.997690531177829


-- !query
SELECT regr_avgx(y, x), regr_avgy(y, x) FROM testRegression
-- !query schema
struct<regr_avgx(y, x):double,regr_avgy(y, x):double>
-- !query output
22.666666666666668	20.0


-- !query
SELECT regr_avgx(y, x), regr_avgy(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL
-- !query schema
struct<regr_avgx(y, x):double,regr_avgy(y, x):double>
-- !query output
22.666666666666668	20.0


-- !query
SELECT k, avg(x), avg(y), regr_avgx(y, x), regr_avgy(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,avg(x):double,avg(y):double,regr_avgx(y, x):double,regr_avgy(y, x):double>
-- !query output
1	NULL	10.0	NULL	NULL
2	27.0	21.25	22.666666666666668	20.0


-- !query
SELECT k, avg(x) FILTER (WHERE x IS NOT NULL AND y IS NOT NULL), avg(y) FILTER (WHERE x IS NOT NULL AND y IS NOT NULL), regr_avgx(y, x), regr_avgy(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,avg(x) FILTER (WHERE ((x IS NOT NULL) AND (y IS NOT NULL))):double,avg(y) FILTER (WHERE ((x IS NOT NULL) AND (y IS NOT NULL))):double,regr_avgx(y, x):double,regr_avgy(y, x):double>
-- !query output
1	NULL	NULL	NULL	NULL
2	22.666666666666668	20.0	22.666666666666668	20.0


-- !query
SELECT regr_sxx(y, x) FROM testRegression
-- !query schema
struct<regr_sxx(y, x):double>
-- !query output
288.6666666666667


-- !query
SELECT regr_sxx(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL
-- !query schema
struct<regr_sxx(y, x):double>
-- !query output
288.6666666666667


-- !query
SELECT k, regr_sxx(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,regr_sxx(y, x):double>
-- !query output
1	NULL
2	288.6666666666667


-- !query
SELECT k, regr_sxx(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL GROUP BY k
-- !query schema
struct<k:int,regr_sxx(y, x):double>
-- !query output
2	288.6666666666667


-- !query
SELECT regr_sxy(y, x) FROM testRegression
-- !query schema
struct<regr_sxy(y, x):double>
-- !query output
240.0


-- !query
SELECT regr_sxy(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL
-- !query schema
struct<regr_sxy(y, x):double>
-- !query output
240.0


-- !query
SELECT k, regr_sxy(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,regr_sxy(y, x):double>
-- !query output
1	NULL
2	240.0


-- !query
SELECT k, regr_sxy(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL GROUP BY k
-- !query schema
struct<k:int,regr_sxy(y, x):double>
-- !query output
2	240.0


-- !query
SELECT regr_syy(y, x) FROM testRegression
-- !query schema
struct<regr_syy(y, x):double>
-- !query output
200.0


-- !query
SELECT regr_syy(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL
-- !query schema
struct<regr_syy(y, x):double>
-- !query output
200.0


-- !query
SELECT k, regr_syy(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,regr_syy(y, x):double>
-- !query output
1	NULL
2	200.0


-- !query
SELECT k, regr_syy(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL GROUP BY k
-- !query schema
struct<k:int,regr_syy(y, x):double>
-- !query output
2	200.0


-- !query
SELECT regr_slope(y, x) FROM testRegression
-- !query schema
struct<regr_slope(y, x):double>
-- !query output
0.8314087759815242


-- !query
SELECT regr_slope(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL
-- !query schema
struct<regr_slope(y, x):double>
-- !query output
0.8314087759815242


-- !query
SELECT k, regr_slope(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,regr_slope(y, x):double>
-- !query output
1	NULL
2	0.8314087759815242


-- !query
SELECT k, regr_slope(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL GROUP BY k
-- !query schema
struct<k:int,regr_slope(y, x):double>
-- !query output
2	0.8314087759815242


-- !query
SELECT regr_intercept(y, x) FROM testRegression
-- !query schema
struct<regr_intercept(y, x):double>
-- !query output
1.1547344110854496


-- !query
SELECT regr_intercept(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL
-- !query schema
struct<regr_intercept(y, x):double>
-- !query output
1.1547344110854496


-- !query
SELECT k, regr_intercept(y, x) FROM testRegression GROUP BY k
-- !query schema
struct<k:int,regr_intercept(y, x):double>
-- !query output
1	NULL
2	1.1547344110854496


-- !query
SELECT k, regr_intercept(y, x) FROM testRegression WHERE x IS NOT NULL AND y IS NOT NULL GROUP BY k
-- !query schema
struct<k:int,regr_intercept(y, x):double>
-- !query output
2	1.1547344110854496
