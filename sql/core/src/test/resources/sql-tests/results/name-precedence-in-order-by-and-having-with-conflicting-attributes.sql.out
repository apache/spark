-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS SELECT col1 FROM VALUES
  (42), (17), (99), (5), (42),
  (23), (8), (17), (76), (33),
  (99), (55), (3), (42), (8)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW v2 AS SELECT col1 FROM VALUES
  ('apple'), ('banana'), ('cherry'), ('date'), ('apple'),
  ('fig'), ('grape'), ('banana'), ('kiwi'), ('lemon'),
  ('cherry'), ('mango'), ('orange'), ('apple'), ('grape')
-- !query schema
struct<>
-- !query output



-- !query
SELECT 2 AS col1 FROM v1 ORDER BY col1
-- !query schema
struct<col1:int>
-- !query output
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2


-- !query
SELECT 2 AS col1 FROM v1 GROUP BY ALL ORDER BY col1
-- !query schema
struct<col1:int>
-- !query output
2


-- !query
SELECT 2 AS col1 FROM v1 GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<col1:int>
-- !query output



-- !query
SELECT col1 AS c, 2 AS col1 FROM v1 ORDER BY col1
-- !query schema
struct<c:int,col1:int>
-- !query output
42	2
17	2
99	2
5	2
42	2
23	2
8	2
17	2
76	2
33	2
99	2
55	2
3	2
42	2
8	2


-- !query
SELECT col1 AS c, 2 AS col1 FROM v1 GROUP BY ALL ORDER BY col1
-- !query schema
struct<c:int,col1:int>
-- !query output
42	2
17	2
99	2
23	2
5	2
8	2
76	2
55	2
33	2
3	2


-- !query
SELECT col1 AS c, 2 AS col1 FROM v1 GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<c:int,col1:int>
-- !query output
55	2
76	2
99	2


-- !query
SELECT 2 AS col1, 3 AS col1 FROM v1 ORDER BY col1
-- !query schema
struct<col1:int,col1:int>
-- !query output
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3
2	3


-- !query
SELECT 2 AS col1, 3 AS col1 FROM v1 GROUP BY ALL ORDER BY col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col1`",
    "proposal" : "`col1`, `col1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 59,
    "stopIndex" : 62,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT 2 AS col1, 3 AS col1 FROM v1 GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 57,
    "stopIndex" : 60,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT col1 AS c, 2 AS col1, 3 AS col1 FROM v1 ORDER BY col1
-- !query schema
struct<c:int,col1:int,col1:int>
-- !query output
3	2	3
5	2	3
8	2	3
8	2	3
17	2	3
17	2	3
23	2	3
33	2	3
42	2	3
42	2	3
42	2	3
55	2	3
76	2	3
99	2	3
99	2	3


-- !query
SELECT col1 AS c, 2 AS col1, 3 AS col1 FROM v1 GROUP BY ALL ORDER BY col1
-- !query schema
struct<c:int,col1:int,col1:int>
-- !query output
3	2	3
5	2	3
8	2	3
17	2	3
23	2	3
33	2	3
42	2	3
55	2	3
76	2	3
99	2	3


-- !query
SELECT col1 AS c, 2 AS col1, 3 AS col1 FROM v1 GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<c:int,col1:int,col1:int>
-- !query output
55	2	3
76	2	3
99	2	3


-- !query
SELECT col1, 2 AS col1 FROM v1 ORDER BY col1
-- !query schema
struct<col1:int,col1:int>
-- !query output
3	2
5	2
8	2
8	2
17	2
17	2
23	2
33	2
42	2
42	2
42	2
55	2
76	2
99	2
99	2


-- !query
SELECT col1, 2 AS col1 FROM v1 GROUP BY ALL ORDER BY col1
-- !query schema
struct<col1:int,col1:int>
-- !query output
3	2
5	2
8	2
17	2
23	2
33	2
42	2
55	2
76	2
99	2


-- !query
SELECT col1, 2 AS col1 FROM v1 GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<col1:int,col1:int>
-- !query output
55	2
76	2
99	2


-- !query
SELECT 3 AS col1 FROM (SELECT 1 AS col1, 2 AS col1) ORDER BY col1
-- !query schema
struct<col1:int>
-- !query output
3


-- !query
SELECT 3 AS col1 FROM (SELECT 1 AS col1, 2 AS col1) GROUP BY ALL ORDER BY col1
-- !query schema
struct<col1:int>
-- !query output
3


-- !query
SELECT 3 AS col1 FROM (SELECT 1 AS col1, 2 AS col1) GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<col1:int>
-- !query output



-- !query
SELECT col1 AS c, 3 AS col1 FROM (SELECT 1 AS col1, 2 AS col1) ORDER BY col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT col1 AS c, 3 AS col1 FROM (SELECT 1 AS col1, 2 AS col1) GROUP BY ALL ORDER BY col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT col1 AS c, 3 AS col1 FROM (SELECT 1 AS col1, 2 AS col1) GROUP BY ALL HAVING col1 > 50
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT 'col1' FROM v2 ORDER BY col1
-- !query schema
struct<col1:string>
-- !query output
col1
col1
col1
col1
col1
col1
col1
col1
col1
col1
col1
col1
col1
col1
col1


-- !query
SELECT 'col1' FROM v2 GROUP BY ALL ORDER BY col1
-- !query schema
struct<col1:string>
-- !query output
col1


-- !query
SELECT 'col1' FROM v2 GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<col1:string>
-- !query output
col1


-- !query
SELECT col1 AS c, 'col1' FROM v2 ORDER BY col1
-- !query schema
struct<c:string,col1:string>
-- !query output
apple	col1
banana	col1
cherry	col1
date	col1
apple	col1
fig	col1
grape	col1
banana	col1
kiwi	col1
lemon	col1
cherry	col1
mango	col1
orange	col1
apple	col1
grape	col1


-- !query
SELECT col1 AS c, 'col1' FROM v2 GROUP BY ALL ORDER BY col1
-- !query schema
struct<c:string,col1:string>
-- !query output
date	col1
cherry	col1
grape	col1
apple	col1
banana	col1
fig	col1
mango	col1
kiwi	col1
lemon	col1
orange	col1


-- !query
SELECT col1 AS c, 'col1' FROM v2 GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<c:string,col1:string>
-- !query output
cherry	col1
date	col1
fig	col1
grape	col1
kiwi	col1
lemon	col1
mango	col1
orange	col1


-- !query
SELECT 'col1', 'col1' FROM v2 ORDER BY col1
-- !query schema
struct<col1:string,col1:string>
-- !query output
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1
col1	col1


-- !query
SELECT 'col1', 'col1' FROM v2 GROUP BY ALL ORDER BY col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col1`",
    "proposal" : "`col1`, `col1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 53,
    "stopIndex" : 56,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT 'col1', 'col1' FROM v2 GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 51,
    "stopIndex" : 54,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT col1 AS c, 'col1', 'col1' FROM v2 ORDER BY col1
-- !query schema
struct<c:string,col1:string,col1:string>
-- !query output
apple	col1	col1
apple	col1	col1
apple	col1	col1
banana	col1	col1
banana	col1	col1
cherry	col1	col1
cherry	col1	col1
date	col1	col1
fig	col1	col1
grape	col1	col1
grape	col1	col1
kiwi	col1	col1
lemon	col1	col1
mango	col1	col1
orange	col1	col1


-- !query
SELECT col1 AS c, 'col1', 'col1' FROM v2 GROUP BY ALL ORDER BY col1
-- !query schema
struct<c:string,col1:string,col1:string>
-- !query output
apple	col1	col1
banana	col1	col1
cherry	col1	col1
date	col1	col1
fig	col1	col1
grape	col1	col1
kiwi	col1	col1
lemon	col1	col1
mango	col1	col1
orange	col1	col1


-- !query
SELECT col1 AS c, 'col1', 'col1' FROM v2 GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<c:string,col1:string,col1:string>
-- !query output
cherry	col1	col1
date	col1	col1
fig	col1	col1
grape	col1	col1
kiwi	col1	col1
lemon	col1	col1
mango	col1	col1
orange	col1	col1


-- !query
SELECT col1, 'col1' FROM v2 ORDER BY col1
-- !query schema
struct<col1:string,col1:string>
-- !query output
apple	col1
apple	col1
apple	col1
banana	col1
banana	col1
cherry	col1
cherry	col1
date	col1
fig	col1
grape	col1
grape	col1
kiwi	col1
lemon	col1
mango	col1
orange	col1


-- !query
SELECT col1, 'col1' FROM v2 GROUP BY ALL ORDER BY col1
-- !query schema
struct<col1:string,col1:string>
-- !query output
apple	col1
banana	col1
cherry	col1
date	col1
fig	col1
grape	col1
kiwi	col1
lemon	col1
mango	col1
orange	col1


-- !query
SELECT col1, 'col1' FROM v2 GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<col1:string,col1:string>
-- !query output
cherry	col1
date	col1
fig	col1
grape	col1
kiwi	col1
lemon	col1
mango	col1
orange	col1


-- !query
SELECT 'col1' FROM (SELECT 'a' AS col1, 'b' AS col1) ORDER BY col1
-- !query schema
struct<col1:string>
-- !query output
col1


-- !query
SELECT 'col1' FROM (SELECT 'a' AS col1, 'b' AS col1) GROUP BY ALL ORDER BY col1
-- !query schema
struct<col1:string>
-- !query output
col1


-- !query
SELECT 'col1' FROM (SELECT 'a' AS col1, 'b' AS col1) GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<col1:string>
-- !query output
col1


-- !query
SELECT col1 AS c, 'col1' FROM (SELECT 'a' AS col1, 'b' AS col1) ORDER BY col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT col1 AS c, 'col1' FROM (SELECT 'a' AS col1, 'b' AS col1) GROUP BY ALL ORDER BY col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT col1 AS c, 'col1' FROM (SELECT 'a' AS col1, 'b' AS col1) GROUP BY ALL HAVING col1 > 'banana'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`col1`",
    "referenceNames" : "[`col1`, `col1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 11,
    "fragment" : "col1"
  } ]
}


-- !query
DROP VIEW v2
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW v1
-- !query schema
struct<>
-- !query output

