-- Automatically generated by SQLQueryTestSuite
-- !query
SET spark.sql.ansi.double_quoted_identifiers = false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.ansi.double_quoted_identifiers	false


-- !query
SELECT 1 FROM "not_exist"
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
USE SCHEMA "not_exist"
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
ALTER TABLE "not_exist" ADD COLUMN not_exist int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
ALTER TABLE not_exist ADD COLUMN "not_exist" int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
SELECT 1 AS "not_exist" FROM not_exist
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
SELECT 1 FROM not_exist AS X("hello")
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"hello\"'",
    "hint" : ""
  }
}


-- !query
SELECT "not_exist"()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
SELECT "not_exist".not_exist()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"not_exist\"'",
    "hint" : ""
  }
}


-- !query
SELECT 1 FROM `hello`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: hello; line 1 pos 14


-- !query
USE SCHEMA `not_exist`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchDatabaseException
Database 'not_exist' not found


-- !query
ALTER TABLE `not_exist` ADD COLUMN not_exist int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: not_exist; line 1 pos 12


-- !query
ALTER TABLE not_exist ADD COLUMN `not_exist` int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: not_exist; line 1 pos 12


-- !query
SELECT 1 AS `not_exist` FROM `not_exist`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 29


-- !query
SELECT 1 FROM not_exist AS X(`hello`)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 14


-- !query
SELECT `not_exist`()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1242",
  "messageParameters" : {
    "fullName" : "spark_catalog.default.not_exist",
    "rawName" : "not_exist"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "`not_exist`()"
  } ]
}


-- !query
SELECT `not_exist`.not_exist()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1243",
  "messageParameters" : {
    "rawName" : "not_exist.not_exist"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "`not_exist`.not_exist()"
  } ]
}


-- !query
SELECT "hello"
-- !query schema
struct<hello:string>
-- !query output
hello


-- !query
CREATE TEMPORARY VIEW v(c1 COMMENT "hello") AS SELECT 1
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW v
-- !query schema
struct<>
-- !query output



-- !query
SELECT INTERVAL "1" YEAR
-- !query schema
struct<INTERVAL '1' YEAR:interval year>
-- !query output
1-0


-- !query
SET spark.sql.ansi.double_quoted_identifiers = true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.ansi.double_quoted_identifiers	true


-- !query
SELECT 1 FROM "not_exist"
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 14


-- !query
USE SCHEMA "not_exist"
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchDatabaseException
Database 'not_exist' not found


-- !query
ALTER TABLE "not_exist" ADD COLUMN not_exist int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: not_exist; line 1 pos 12


-- !query
ALTER TABLE not_exist ADD COLUMN "not_exist" int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: not_exist; line 1 pos 12


-- !query
SELECT 1 AS "not_exist" FROM not_exist
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 29


-- !query
SELECT 1 FROM not_exist AS X("hello")
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 14


-- !query
SELECT "not_exist"()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1242",
  "messageParameters" : {
    "fullName" : "spark_catalog.default.not_exist",
    "rawName" : "not_exist"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "\"not_exist\"()"
  } ]
}


-- !query
SELECT "not_exist".not_exist()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1243",
  "messageParameters" : {
    "rawName" : "not_exist.not_exist"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "\"not_exist\".not_exist()"
  } ]
}


-- !query
SELECT "hello"
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN",
  "errorSubClass" : "WITHOUT_SUGGESTION",
  "sqlState" : "42000",
  "messageParameters" : {
    "objectName" : "`hello`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 14,
    "fragment" : "\"hello\""
  } ]
}


-- !query
SELECT 1 FROM `hello`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: hello; line 1 pos 14


-- !query
USE SCHEMA `not_exist`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchDatabaseException
Database 'not_exist' not found


-- !query
ALTER TABLE `not_exist` ADD COLUMN not_exist int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: not_exist; line 1 pos 12


-- !query
ALTER TABLE not_exist ADD COLUMN `not_exist` int
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: not_exist; line 1 pos 12


-- !query
SELECT 1 AS `not_exist` FROM `not_exist`
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 29


-- !query
SELECT 1 FROM not_exist AS X(`hello`)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: not_exist; line 1 pos 14


-- !query
SELECT `not_exist`()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1242",
  "messageParameters" : {
    "fullName" : "spark_catalog.default.not_exist",
    "rawName" : "not_exist"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "`not_exist`()"
  } ]
}


-- !query
SELECT `not_exist`.not_exist()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1243",
  "messageParameters" : {
    "rawName" : "not_exist.not_exist"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "`not_exist`.not_exist()"
  } ]
}


-- !query
CREATE TEMPORARY VIEW v(c1 COMMENT "hello") AS SELECT 1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"hello\"'",
    "hint" : ""
  }
}


-- !query
DROP VIEW v
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1115",
  "messageParameters" : {
    "msg" : "Table spark_catalog.default.v not found"
  }
}


-- !query
SELECT INTERVAL "1" YEAR
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42000",
  "messageParameters" : {
    "error" : "'\"1\"'",
    "hint" : ""
  }
}


-- !query
SELECT 'hello'
-- !query schema
struct<hello:string>
-- !query output
hello


-- !query
CREATE TEMPORARY VIEW v(c1 COMMENT 'hello') AS SELECT 1
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW v
-- !query schema
struct<>
-- !query output



-- !query
SELECT INTERVAL '1' YEAR
-- !query schema
struct<INTERVAL '1' YEAR:interval year>
-- !query output
1-0


-- !query
CREATE SCHEMA "myschema"
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW "myview"("c1") AS
  WITH "v"("a") AS (SELECT 1) SELECT "a" FROM "v"
-- !query schema
struct<>
-- !query output



-- !query
SELECT "a1" AS "a2" FROM "myview" AS "atab"("a1")
-- !query schema
struct<a2:int>
-- !query output
1


-- !query
DROP TABLE "myview"
-- !query schema
struct<>
-- !query output



-- !query
DROP SCHEMA "myschema"
-- !query schema
struct<>
-- !query output

