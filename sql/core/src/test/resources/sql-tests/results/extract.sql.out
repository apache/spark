-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t AS select '2011-05-06 07:08:09.1234567' as c, to_timestamp_ntz('2011-05-06 07:08:09.1234567') as ntz, interval 10 year 20 month as i, interval 30 day 40 hour 50 minute 6.7890 second as j
-- !query schema
struct<>
-- !query output



-- !query
select extract(year from c), extract(year from ntz), extract(year from i) from t
-- !query schema
struct<extract(year FROM c):int,extract(year FROM ntz):int,extract(year FROM i):int>
-- !query output
2011	2011	11


-- !query
select extract(y from c), extract(y from ntz), extract(y from i) from t
-- !query schema
struct<extract(y FROM c):int,extract(y FROM ntz):int,extract(y FROM i):int>
-- !query output
2011	2011	11


-- !query
select extract(years from c), extract(years from ntz), extract(years from i) from t
-- !query schema
struct<extract(years FROM c):int,extract(years FROM ntz):int,extract(years FROM i):int>
-- !query output
2011	2011	11


-- !query
select extract(yr from c), extract(yr from ntz), extract(yr from i) from t
-- !query schema
struct<extract(yr FROM c):int,extract(yr FROM ntz):int,extract(yr FROM i):int>
-- !query output
2011	2011	11


-- !query
select extract(yrs from c), extract(yrs from ntz), extract(yrs from i) from t
-- !query schema
struct<extract(yrs FROM c):int,extract(yrs FROM ntz):int,extract(yrs FROM i):int>
-- !query output
2011	2011	11


-- !query
select extract(yearofweek from c), extract(yearofweek from ntz) from t
-- !query schema
struct<extract(yearofweek FROM c):int,extract(yearofweek FROM ntz):int>
-- !query output
2011	2011


-- !query
select extract(quarter from c), extract(quarter from ntz) from t
-- !query schema
struct<extract(quarter FROM c):int,extract(quarter FROM ntz):int>
-- !query output
2	2


-- !query
select extract(qtr from c), extract(qtr from ntz) from t
-- !query schema
struct<extract(qtr FROM c):int,extract(qtr FROM ntz):int>
-- !query output
2	2


-- !query
select extract(month from c), extract(month from ntz), extract(month from i) from t
-- !query schema
struct<extract(month FROM c):int,extract(month FROM ntz):int,extract(month FROM i):tinyint>
-- !query output
5	5	8


-- !query
select extract(mon from c), extract(mon from ntz), extract(mon from i) from t
-- !query schema
struct<extract(mon FROM c):int,extract(mon FROM ntz):int,extract(mon FROM i):tinyint>
-- !query output
5	5	8


-- !query
select extract(mons from c), extract(mons from ntz), extract(mons from i) from t
-- !query schema
struct<extract(mons FROM c):int,extract(mons FROM ntz):int,extract(mons FROM i):tinyint>
-- !query output
5	5	8


-- !query
select extract(months from c), extract(months from ntz), extract(months from i) from t
-- !query schema
struct<extract(months FROM c):int,extract(months FROM ntz):int,extract(months FROM i):tinyint>
-- !query output
5	5	8


-- !query
select extract(week from c), extract(week from ntz) from t
-- !query schema
struct<extract(week FROM c):int,extract(week FROM ntz):int>
-- !query output
18	18


-- !query
select extract(w from c), extract(w from ntz) from t
-- !query schema
struct<extract(w FROM c):int,extract(w FROM ntz):int>
-- !query output
18	18


-- !query
select extract(weeks from c), extract(weeks from ntz) from t
-- !query schema
struct<extract(weeks FROM c):int,extract(weeks FROM ntz):int>
-- !query output
18	18


-- !query
select extract(day from c), extract(day from ntz), extract(day from j) from t
-- !query schema
struct<extract(day FROM c):int,extract(day FROM ntz):int,extract(day FROM j):int>
-- !query output
6	6	31


-- !query
select extract(d from c), extract(d from ntz), extract(d from j) from t
-- !query schema
struct<extract(d FROM c):int,extract(d FROM ntz):int,extract(d FROM j):int>
-- !query output
6	6	31


-- !query
select extract(days from c), extract(days from ntz), extract(days from j) from t
-- !query schema
struct<extract(days FROM c):int,extract(days FROM ntz):int,extract(days FROM j):int>
-- !query output
6	6	31


-- !query
select extract(dayofweek from c), extract(dayofweek from ntz) from t
-- !query schema
struct<extract(dayofweek FROM c):int,extract(dayofweek FROM ntz):int>
-- !query output
6	6


-- !query
select extract(dow from c), extract(dow from ntz) from t
-- !query schema
struct<extract(dow FROM c):int,extract(dow FROM ntz):int>
-- !query output
6	6


-- !query
select extract(dayofweek_iso from c), extract(dayofweek_iso from ntz) from t
-- !query schema
struct<extract(dayofweek_iso FROM c):int,extract(dayofweek_iso FROM ntz):int>
-- !query output
5	5


-- !query
select extract(dow_iso from c), extract(dow_iso from ntz) from t
-- !query schema
struct<extract(dow_iso FROM c):int,extract(dow_iso FROM ntz):int>
-- !query output
5	5


-- !query
select extract(doy from c), extract(doy from ntz) from t
-- !query schema
struct<extract(doy FROM c):int,extract(doy FROM ntz):int>
-- !query output
126	126


-- !query
select extract(hour from c), extract(hour from ntz), extract(hour from j) from t
-- !query schema
struct<extract(hour FROM c):int,extract(hour FROM ntz):int,extract(hour FROM j):tinyint>
-- !query output
7	7	16


-- !query
select extract(h from c), extract(h from ntz), extract(h from j) from t
-- !query schema
struct<extract(h FROM c):int,extract(h FROM ntz):int,extract(h FROM j):tinyint>
-- !query output
7	7	16


-- !query
select extract(hours from c), extract(hours from ntz), extract(hours from j) from t
-- !query schema
struct<extract(hours FROM c):int,extract(hours FROM ntz):int,extract(hours FROM j):tinyint>
-- !query output
7	7	16


-- !query
select extract(hr from c), extract(hr from ntz), extract(hr from j) from t
-- !query schema
struct<extract(hr FROM c):int,extract(hr FROM ntz):int,extract(hr FROM j):tinyint>
-- !query output
7	7	16


-- !query
select extract(hrs from c), extract(hrs from ntz), extract(hrs from j) from t
-- !query schema
struct<extract(hrs FROM c):int,extract(hrs FROM ntz):int,extract(hrs FROM j):tinyint>
-- !query output
7	7	16


-- !query
select extract(minute from c), extract(minute from ntz), extract(minute from j) from t
-- !query schema
struct<extract(minute FROM c):int,extract(minute FROM ntz):int,extract(minute FROM j):tinyint>
-- !query output
8	8	50


-- !query
select extract(m from c), extract(m from ntz), extract(m from j) from t
-- !query schema
struct<extract(m FROM c):int,extract(m FROM ntz):int,extract(m FROM j):tinyint>
-- !query output
8	8	50


-- !query
select extract(min from c), extract(min from ntz), extract(min from j) from t
-- !query schema
struct<extract(min FROM c):int,extract(min FROM ntz):int,extract(min FROM j):tinyint>
-- !query output
8	8	50


-- !query
select extract(mins from c), extract(mins from ntz), extract(mins from j) from t
-- !query schema
struct<extract(mins FROM c):int,extract(mins FROM ntz):int,extract(mins FROM j):tinyint>
-- !query output
8	8	50


-- !query
select extract(minutes from c), extract(minutes from ntz), extract(minutes from j) from t
-- !query schema
struct<extract(minutes FROM c):int,extract(minutes FROM ntz):int,extract(minutes FROM j):tinyint>
-- !query output
8	8	50


-- !query
select extract(second from c), extract(second from ntz), extract(second from j) from t
-- !query schema
struct<extract(second FROM c):decimal(8,6),extract(second FROM ntz):decimal(8,6),extract(second FROM j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select extract(s from c), extract(s from ntz), extract(s from j) from t
-- !query schema
struct<extract(s FROM c):decimal(8,6),extract(s FROM ntz):decimal(8,6),extract(s FROM j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select extract(sec from c), extract(sec from ntz), extract(sec from j) from t
-- !query schema
struct<extract(sec FROM c):decimal(8,6),extract(sec FROM ntz):decimal(8,6),extract(sec FROM j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select extract(seconds from c), extract(seconds from ntz), extract(seconds from j) from t
-- !query schema
struct<extract(seconds FROM c):decimal(8,6),extract(seconds FROM ntz):decimal(8,6),extract(seconds FROM j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select extract(secs from c), extract(secs from ntz), extract(secs from j) from t
-- !query schema
struct<extract(secs FROM c):decimal(8,6),extract(secs FROM ntz):decimal(8,6),extract(secs FROM j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select extract(not_supported from c) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"c\"",
    "field" : "`not_supported`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 36,
    "fragment" : "extract(not_supported from c)"
  } ]
}


-- !query
select extract(not_supported from i) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"i\"",
    "field" : "`not_supported`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 36,
    "fragment" : "extract(not_supported from i)"
  } ]
}


-- !query
select extract(not_supported from j) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"j\"",
    "field" : "`not_supported`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 36,
    "fragment" : "extract(not_supported from j)"
  } ]
}


-- !query
select date_part('year', c), date_part('year', ntz), date_part('year', i) from t
-- !query schema
struct<date_part(year, c):int,date_part(year, ntz):int,date_part(year, i):int>
-- !query output
2011	2011	11


-- !query
select date_part('y', c), date_part('y', ntz), date_part('y', i) from t
-- !query schema
struct<date_part(y, c):int,date_part(y, ntz):int,date_part(y, i):int>
-- !query output
2011	2011	11


-- !query
select date_part('years', c), date_part('years', ntz), date_part('years', i) from t
-- !query schema
struct<date_part(years, c):int,date_part(years, ntz):int,date_part(years, i):int>
-- !query output
2011	2011	11


-- !query
select date_part('yr', c), date_part('yr', ntz), date_part('yr', i) from t
-- !query schema
struct<date_part(yr, c):int,date_part(yr, ntz):int,date_part(yr, i):int>
-- !query output
2011	2011	11


-- !query
select date_part('yrs', c), date_part('yrs', ntz), date_part('yrs', i) from t
-- !query schema
struct<date_part(yrs, c):int,date_part(yrs, ntz):int,date_part(yrs, i):int>
-- !query output
2011	2011	11


-- !query
select date_part('yearofweek', c), date_part('yearofweek', ntz) from t
-- !query schema
struct<date_part(yearofweek, c):int,date_part(yearofweek, ntz):int>
-- !query output
2011	2011


-- !query
select date_part('quarter', c), date_part('quarter', ntz) from t
-- !query schema
struct<date_part(quarter, c):int,date_part(quarter, ntz):int>
-- !query output
2	2


-- !query
select date_part('qtr', c), date_part('qtr', ntz) from t
-- !query schema
struct<date_part(qtr, c):int,date_part(qtr, ntz):int>
-- !query output
2	2


-- !query
select date_part('month', c), date_part('month', ntz), date_part('month', i) from t
-- !query schema
struct<date_part(month, c):int,date_part(month, ntz):int,date_part(month, i):tinyint>
-- !query output
5	5	8


-- !query
select date_part('mon', c), date_part('mon', ntz), date_part('mon', i) from t
-- !query schema
struct<date_part(mon, c):int,date_part(mon, ntz):int,date_part(mon, i):tinyint>
-- !query output
5	5	8


-- !query
select date_part('mons', c), date_part('mons', ntz), date_part('mons', i) from t
-- !query schema
struct<date_part(mons, c):int,date_part(mons, ntz):int,date_part(mons, i):tinyint>
-- !query output
5	5	8


-- !query
select date_part('months', c), date_part('months', ntz), date_part('months', i) from t
-- !query schema
struct<date_part(months, c):int,date_part(months, ntz):int,date_part(months, i):tinyint>
-- !query output
5	5	8


-- !query
select date_part('week', c), date_part('week', ntz) from t
-- !query schema
struct<date_part(week, c):int,date_part(week, ntz):int>
-- !query output
18	18


-- !query
select date_part('w', c), date_part('w', ntz) from t
-- !query schema
struct<date_part(w, c):int,date_part(w, ntz):int>
-- !query output
18	18


-- !query
select date_part('weeks', c), date_part('weeks', ntz) from t
-- !query schema
struct<date_part(weeks, c):int,date_part(weeks, ntz):int>
-- !query output
18	18


-- !query
select date_part('day', c), date_part('day', ntz), date_part('day', j) from t
-- !query schema
struct<date_part(day, c):int,date_part(day, ntz):int,date_part(day, j):int>
-- !query output
6	6	31


-- !query
select date_part('d', c), date_part('d', ntz), date_part('d', j) from t
-- !query schema
struct<date_part(d, c):int,date_part(d, ntz):int,date_part(d, j):int>
-- !query output
6	6	31


-- !query
select date_part('days', c), date_part('days', ntz), date_part('days', j) from t
-- !query schema
struct<date_part(days, c):int,date_part(days, ntz):int,date_part(days, j):int>
-- !query output
6	6	31


-- !query
select date_part('dayofweek', c), date_part('dayofweek', ntz) from t
-- !query schema
struct<date_part(dayofweek, c):int,date_part(dayofweek, ntz):int>
-- !query output
6	6


-- !query
select date_part('dow', c), date_part('dow', ntz) from t
-- !query schema
struct<date_part(dow, c):int,date_part(dow, ntz):int>
-- !query output
6	6


-- !query
select date_part('dayofweek_iso', c), date_part('dayofweek_iso', ntz) from t
-- !query schema
struct<date_part(dayofweek_iso, c):int,date_part(dayofweek_iso, ntz):int>
-- !query output
5	5


-- !query
select date_part('dow_iso', c), date_part('dow_iso', ntz) from t
-- !query schema
struct<date_part(dow_iso, c):int,date_part(dow_iso, ntz):int>
-- !query output
5	5


-- !query
select date_part('doy', c), date_part('doy', ntz) from t
-- !query schema
struct<date_part(doy, c):int,date_part(doy, ntz):int>
-- !query output
126	126


-- !query
select date_part('hour', c), date_part('hour', ntz), date_part('hour', j) from t
-- !query schema
struct<date_part(hour, c):int,date_part(hour, ntz):int,date_part(hour, j):tinyint>
-- !query output
7	7	16


-- !query
select date_part('h', c), date_part('h', ntz), date_part('h', j) from t
-- !query schema
struct<date_part(h, c):int,date_part(h, ntz):int,date_part(h, j):tinyint>
-- !query output
7	7	16


-- !query
select date_part('hours', c), date_part('hours', ntz), date_part('hours', j) from t
-- !query schema
struct<date_part(hours, c):int,date_part(hours, ntz):int,date_part(hours, j):tinyint>
-- !query output
7	7	16


-- !query
select date_part('hr', c), date_part('hr', ntz), date_part('hr', j) from t
-- !query schema
struct<date_part(hr, c):int,date_part(hr, ntz):int,date_part(hr, j):tinyint>
-- !query output
7	7	16


-- !query
select date_part('hrs', c), date_part('hrs', ntz), date_part('hrs', j) from t
-- !query schema
struct<date_part(hrs, c):int,date_part(hrs, ntz):int,date_part(hrs, j):tinyint>
-- !query output
7	7	16


-- !query
select date_part('minute', c), date_part('minute', ntz), date_part('minute', j) from t
-- !query schema
struct<date_part(minute, c):int,date_part(minute, ntz):int,date_part(minute, j):tinyint>
-- !query output
8	8	50


-- !query
select date_part('m', c), date_part('m', ntz), date_part('m', j) from t
-- !query schema
struct<date_part(m, c):int,date_part(m, ntz):int,date_part(m, j):tinyint>
-- !query output
8	8	50


-- !query
select date_part('min', c), date_part('min', ntz), date_part('min', j) from t
-- !query schema
struct<date_part(min, c):int,date_part(min, ntz):int,date_part(min, j):tinyint>
-- !query output
8	8	50


-- !query
select date_part('mins', c), date_part('mins', ntz), date_part('mins', j) from t
-- !query schema
struct<date_part(mins, c):int,date_part(mins, ntz):int,date_part(mins, j):tinyint>
-- !query output
8	8	50


-- !query
select date_part('minutes', c), date_part('minutes', ntz), date_part('minutes', j) from t
-- !query schema
struct<date_part(minutes, c):int,date_part(minutes, ntz):int,date_part(minutes, j):tinyint>
-- !query output
8	8	50


-- !query
select date_part('second', c), date_part('second', ntz), date_part('second', j) from t
-- !query schema
struct<date_part(second, c):decimal(8,6),date_part(second, ntz):decimal(8,6),date_part(second, j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select date_part('s', c), date_part('s', ntz), date_part('s', j) from t
-- !query schema
struct<date_part(s, c):decimal(8,6),date_part(s, ntz):decimal(8,6),date_part(s, j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select date_part('sec', c), date_part('sec', ntz), date_part('sec', j) from t
-- !query schema
struct<date_part(sec, c):decimal(8,6),date_part(sec, ntz):decimal(8,6),date_part(sec, j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select date_part('seconds', c), date_part('seconds', ntz), date_part('seconds', j) from t
-- !query schema
struct<date_part(seconds, c):decimal(8,6),date_part(seconds, ntz):decimal(8,6),date_part(seconds, j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select date_part('secs', c), date_part('secs', ntz), date_part('secs', j) from t
-- !query schema
struct<date_part(secs, c):decimal(8,6),date_part(secs, ntz):decimal(8,6),date_part(secs, j):decimal(8,6)>
-- !query output
9.123456	9.123456	6.789000


-- !query
select date_part('not_supported', c) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"c\"",
    "field" : "`not_supported`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 36,
    "fragment" : "date_part('not_supported', c)"
  } ]
}


-- !query
select date_part(c, c) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "NON_FOLDABLE_ARGUMENT",
  "sqlState" : "42K08",
  "messageParameters" : {
    "funcName" : "`date_part`",
    "paramName" : "`field`",
    "paramType" : "\"STRING\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "date_part(c, c)"
  } ]
}


-- !query
select date_part(null, c) from t
-- !query schema
struct<date_part(NULL, c):double>
-- !query output
NULL


-- !query
select date_part(i, i) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "NON_FOLDABLE_ARGUMENT",
  "sqlState" : "42K08",
  "messageParameters" : {
    "funcName" : "`date_part`",
    "paramName" : "`field`",
    "paramType" : "\"STRING\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "date_part(i, i)"
  } ]
}


-- !query
select date_part(null, i) from t
-- !query schema
struct<date_part(NULL, i):double>
-- !query output
NULL


-- !query
select extract('year', c) from t
-- !query schema
struct<extract(year FROM c):int>
-- !query output
2011


-- !query
select extract('quarter', c) from t
-- !query schema
struct<extract(quarter FROM c):int>
-- !query output
2


-- !query
select extract('month', c) from t
-- !query schema
struct<extract(month FROM c):int>
-- !query output
5


-- !query
select extract('week', c) from t
-- !query schema
struct<extract(week FROM c):int>
-- !query output
18


-- !query
select extract('day', c) from t
-- !query schema
struct<extract(day FROM c):int>
-- !query output
6


-- !query
select extract('days', c) from t
-- !query schema
struct<extract(days FROM c):int>
-- !query output
6


-- !query
select extract('dayofweek', c) from t
-- !query schema
struct<extract(dayofweek FROM c):int>
-- !query output
6


-- !query
select extract('dow', c) from t
-- !query schema
struct<extract(dow FROM c):int>
-- !query output
6


-- !query
select extract('doy', c) from t
-- !query schema
struct<extract(doy FROM c):int>
-- !query output
126


-- !query
select extract('hour', c) from t
-- !query schema
struct<extract(hour FROM c):int>
-- !query output
7


-- !query
select extract('minute', c) from t
-- !query schema
struct<extract(minute FROM c):int>
-- !query output
8


-- !query
select extract('second', c) from t
-- !query schema
struct<extract(second FROM c):decimal(8,6)>
-- !query output
9.123456


-- !query
select c - j from t
-- !query schema
struct<c - j:string>
-- !query output
2011-04-04 14:18:02.334456


-- !query
select day(c - j) from t
-- !query schema
struct<day(c - j):int>
-- !query output
4


-- !query
select extract(day from c - j) from t
-- !query schema
struct<extract(day FROM c - j):int>
-- !query output
4


-- !query
select extract(month from to_timestamp(c) - i) from t
-- !query schema
struct<extract(month FROM to_timestamp(c) - i):int>
-- !query output
9


-- !query
select extract(second from to_timestamp(c) - j) from t
-- !query schema
struct<extract(second FROM to_timestamp(c) - j):decimal(8,6)>
-- !query output
2.334456


-- !query
select extract(YEAR from interval '2-1' YEAR TO MONTH)
-- !query schema
struct<extract(YEAR FROM INTERVAL '2-1' YEAR TO MONTH):int>
-- !query output
2


-- !query
select date_part('YEAR', interval '2-1' YEAR TO MONTH)
-- !query schema
struct<date_part(YEAR, INTERVAL '2-1' YEAR TO MONTH):int>
-- !query output
2


-- !query
select extract(YEAR from -interval '2-1' YEAR TO MONTH)
-- !query schema
struct<extract(YEAR FROM (- INTERVAL '2-1' YEAR TO MONTH)):int>
-- !query output
-2


-- !query
select extract(MONTH from interval '2-1' YEAR TO MONTH)
-- !query schema
struct<extract(MONTH FROM INTERVAL '2-1' YEAR TO MONTH):tinyint>
-- !query output
1


-- !query
select date_part('MONTH', interval '2-1' YEAR TO MONTH)
-- !query schema
struct<date_part(MONTH, INTERVAL '2-1' YEAR TO MONTH):tinyint>
-- !query output
1


-- !query
select extract(MONTH from -interval '2-1' YEAR TO MONTH)
-- !query schema
struct<extract(MONTH FROM (- INTERVAL '2-1' YEAR TO MONTH)):tinyint>
-- !query output
-1


-- !query
select date_part(NULL, interval '2-1' YEAR TO MONTH)
-- !query schema
struct<date_part(NULL, INTERVAL '2-1' YEAR TO MONTH):double>
-- !query output
NULL


-- !query
select extract(DAY from interval '2-1' YEAR TO MONTH)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"INTERVAL '2-1' YEAR TO MONTH\"",
    "field" : "`DAY`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 53,
    "fragment" : "extract(DAY from interval '2-1' YEAR TO MONTH)"
  } ]
}


-- !query
select date_part('DAY', interval '2-1' YEAR TO MONTH)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"INTERVAL '2-1' YEAR TO MONTH\"",
    "field" : "`DAY`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 53,
    "fragment" : "date_part('DAY', interval '2-1' YEAR TO MONTH)"
  } ]
}


-- !query
select date_part('not_supported', interval '2-1' YEAR TO MONTH)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"INTERVAL '2-1' YEAR TO MONTH\"",
    "field" : "`not_supported`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 63,
    "fragment" : "date_part('not_supported', interval '2-1' YEAR TO MONTH)"
  } ]
}


-- !query
select extract(DAY from interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(DAY FROM INTERVAL '123 12:34:56.789123' DAY TO SECOND):int>
-- !query output
123


-- !query
select date_part('DAY', interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<date_part(DAY, INTERVAL '123 12:34:56.789123' DAY TO SECOND):int>
-- !query output
123


-- !query
select extract(DAY from -interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(DAY FROM (- INTERVAL '123 12:34:56.789123' DAY TO SECOND)):int>
-- !query output
-123


-- !query
select extract(HOUR from interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(HOUR FROM INTERVAL '123 12:34:56.789123' DAY TO SECOND):tinyint>
-- !query output
12


-- !query
select date_part('HOUR', interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<date_part(HOUR, INTERVAL '123 12:34:56.789123' DAY TO SECOND):tinyint>
-- !query output
12


-- !query
select extract(HOUR from -interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(HOUR FROM (- INTERVAL '123 12:34:56.789123' DAY TO SECOND)):tinyint>
-- !query output
-12


-- !query
select extract(MINUTE from interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(MINUTE FROM INTERVAL '123 12:34:56.789123' DAY TO SECOND):tinyint>
-- !query output
34


-- !query
select date_part('MINUTE', interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<date_part(MINUTE, INTERVAL '123 12:34:56.789123' DAY TO SECOND):tinyint>
-- !query output
34


-- !query
select extract(MINUTE from -interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(MINUTE FROM (- INTERVAL '123 12:34:56.789123' DAY TO SECOND)):tinyint>
-- !query output
-34


-- !query
select extract(SECOND from interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(SECOND FROM INTERVAL '123 12:34:56.789123' DAY TO SECOND):decimal(8,6)>
-- !query output
56.789123


-- !query
select date_part('SECOND', interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<date_part(SECOND, INTERVAL '123 12:34:56.789123' DAY TO SECOND):decimal(8,6)>
-- !query output
56.789123


-- !query
select extract(SECOND from -interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<extract(SECOND FROM (- INTERVAL '123 12:34:56.789123' DAY TO SECOND)):decimal(8,6)>
-- !query output
-56.789123


-- !query
select date_part(NULL, interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<date_part(NULL, INTERVAL '123 12:34:56.789123' DAY TO SECOND):double>
-- !query output
NULL


-- !query
select extract(MONTH from interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"INTERVAL '123 12:34:56.789123' DAY TO SECOND\"",
    "field" : "`MONTH`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "extract(MONTH from interval '123 12:34:56.789123123' DAY TO SECOND)"
  } ]
}


-- !query
select date_part('not_supported', interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EXTRACT_FIELD",
  "sqlState" : "42601",
  "messageParameters" : {
    "expr" : "\"INTERVAL '123 12:34:56.789123' DAY TO SECOND\"",
    "field" : "`not_supported`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 82,
    "fragment" : "date_part('not_supported', interval '123 12:34:56.789123123' DAY TO SECOND)"
  } ]
}


-- !query
select datepart('year', c), datepart('year', ntz), datepart('year', i) from t
-- !query schema
struct<datepart(year FROM c):int,datepart(year FROM ntz):int,datepart(year FROM i):int>
-- !query output
2011	2011	11


-- !query
select datepart('DAY', interval '123 12:34:56.789123123' DAY TO SECOND)
-- !query schema
struct<datepart(DAY FROM INTERVAL '123 12:34:56.789123' DAY TO SECOND):int>
-- !query output
123
