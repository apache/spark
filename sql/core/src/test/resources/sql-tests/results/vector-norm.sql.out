-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT vector_norm(array(3.0F, 4.0F))
-- !query schema
struct<vector_norm(array(3.0, 4.0), 2.0):float>
-- !query output
5.0


-- !query
SELECT vector_norm(array(3.0F, 4.0F), 2.0F)
-- !query schema
struct<vector_norm(array(3.0, 4.0), 2.0):float>
-- !query output
5.0


-- !query
SELECT vector_norm(array(3.0F, 4.0F), 1.0F)
-- !query schema
struct<vector_norm(array(3.0, 4.0), 1.0):float>
-- !query output
7.0


-- !query
SELECT vector_norm(array(3.0F, -4.0F), 1.0F)
-- !query schema
struct<vector_norm(array(3.0, -4.0), 1.0):float>
-- !query output
7.0


-- !query
SELECT vector_norm(array(3.0F, 4.0F), float('inf'))
-- !query schema
struct<vector_norm(array(3.0, 4.0), inf):float>
-- !query output
4.0


-- !query
SELECT vector_norm(array(3.0F, -5.0F), float('inf'))
-- !query schema
struct<vector_norm(array(3.0, -5.0), inf):float>
-- !query output
5.0


-- !query
SELECT vector_normalize(array(3.0F, 4.0F))
-- !query schema
struct<vector_normalize(array(3.0, 4.0), 2.0):array<float>>
-- !query output
[0.6,0.8]


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), 2.0F)
-- !query schema
struct<vector_normalize(array(3.0, 4.0), 2.0):array<float>>
-- !query output
[0.6,0.8]


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), 1.0F)
-- !query schema
struct<vector_normalize(array(3.0, 4.0), 1.0):array<float>>
-- !query output
[0.42857143,0.5714286]


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), float('inf'))
-- !query schema
struct<vector_normalize(array(3.0, 4.0), inf):array<float>>
-- !query output
[0.75,1.0]


-- !query
SELECT vector_norm(vector_normalize(array(3.0F, 4.0F, 5.0F), 2.0F), 2.0F)
-- !query schema
struct<vector_norm(vector_normalize(array(3.0, 4.0, 5.0), 2.0), 2.0):float>
-- !query output
1.0


-- !query
SELECT vector_norm(CAST(array() AS ARRAY<FLOAT>), 2.0F)
-- !query schema
struct<vector_norm(array(), 2.0):float>
-- !query output
0.0


-- !query
SELECT vector_norm(CAST(array() AS ARRAY<FLOAT>), 1.0F)
-- !query schema
struct<vector_norm(array(), 1.0):float>
-- !query output
0.0


-- !query
SELECT vector_norm(CAST(array() AS ARRAY<FLOAT>), float('inf'))
-- !query schema
struct<vector_norm(array(), inf):float>
-- !query output
0.0


-- !query
SELECT vector_normalize(CAST(array() AS ARRAY<FLOAT>), 2.0F)
-- !query schema
struct<vector_normalize(array(), 2.0):array<float>>
-- !query output
[]


-- !query
SELECT vector_norm(array(0.0F, 0.0F, 0.0F), 2.0F)
-- !query schema
struct<vector_norm(array(0.0, 0.0, 0.0), 2.0):float>
-- !query output
0.0


-- !query
SELECT vector_normalize(array(0.0F, 0.0F, 0.0F), 2.0F)
-- !query schema
struct<vector_normalize(array(0.0, 0.0, 0.0), 2.0):array<float>>
-- !query output
NULL


-- !query
SELECT vector_norm(NULL, 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_norm(NULL, 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "vector_norm(NULL, 2.0F)"
  } ]
}


-- !query
SELECT vector_normalize(NULL, 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_normalize(NULL, 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 35,
    "fragment" : "vector_normalize(NULL, 2.0F)"
  } ]
}


-- !query
SELECT vector_norm(array(3.0F, 4.0F), CAST(NULL AS FLOAT))
-- !query schema
struct<vector_norm(array(3.0, 4.0), CAST(NULL AS FLOAT)):float>
-- !query output
NULL


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), CAST(NULL AS FLOAT))
-- !query schema
struct<vector_normalize(array(3.0, 4.0), CAST(NULL AS FLOAT)):array<float>>
-- !query output
NULL


-- !query
SELECT vector_norm(array(1.0F, CAST(NULL AS FLOAT), 3.0F), 2.0F)
-- !query schema
struct<vector_norm(array(1.0, CAST(NULL AS FLOAT), 3.0), 2.0):float>
-- !query output
NULL


-- !query
SELECT vector_normalize(array(1.0F, CAST(NULL AS FLOAT), 3.0F), 2.0F)
-- !query schema
struct<vector_normalize(array(1.0, CAST(NULL AS FLOAT), 3.0), 2.0):array<float>>
-- !query output
NULL


-- !query
SELECT vector_norm(array(3.0F, 4.0F), 0.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_VECTOR_NORM_DEGREE",
  "sqlState" : "22023",
  "messageParameters" : {
    "degree" : "0.0",
    "functionName" : "`vector_norm`"
  }
}


-- !query
SELECT vector_norm(array(3.0F, 4.0F), 3.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_VECTOR_NORM_DEGREE",
  "sqlState" : "22023",
  "messageParameters" : {
    "degree" : "3.0",
    "functionName" : "`vector_norm`"
  }
}


-- !query
SELECT vector_norm(array(3.0F, 4.0F), float('-inf'))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_VECTOR_NORM_DEGREE",
  "sqlState" : "22023",
  "messageParameters" : {
    "degree" : "-Infinity",
    "functionName" : "`vector_norm`"
  }
}


-- !query
SELECT vector_norm(array(3.0F, 4.0F), -1.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_VECTOR_NORM_DEGREE",
  "sqlState" : "22023",
  "messageParameters" : {
    "degree" : "-1.0",
    "functionName" : "`vector_norm`"
  }
}


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), 0.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_VECTOR_NORM_DEGREE",
  "sqlState" : "22023",
  "messageParameters" : {
    "degree" : "0.0",
    "functionName" : "`vector_normalize`"
  }
}


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), 3.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "INVALID_VECTOR_NORM_DEGREE",
  "sqlState" : "22023",
  "messageParameters" : {
    "degree" : "3.0",
    "functionName" : "`vector_normalize`"
  }
}


-- !query
SELECT vector_norm(array(3.0D, 4.0D), 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(3.0, 4.0)\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_norm(array(3.0, 4.0), 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 43,
    "fragment" : "vector_norm(array(3.0D, 4.0D), 2.0F)"
  } ]
}


-- !query
SELECT vector_norm(array(3, 4), 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(3, 4)\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_norm(array(3, 4), 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 37,
    "fragment" : "vector_norm(array(3, 4), 2.0F)"
  } ]
}


-- !query
SELECT vector_normalize(array(3.0D, 4.0D), 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(3.0, 4.0)\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_normalize(array(3.0, 4.0), 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 48,
    "fragment" : "vector_normalize(array(3.0D, 4.0D), 2.0F)"
  } ]
}


-- !query
SELECT vector_normalize(array(3, 4), 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(3, 4)\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_normalize(array(3, 4), 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 42,
    "fragment" : "vector_normalize(array(3, 4), 2.0F)"
  } ]
}


-- !query
SELECT vector_norm(array(3.0F, 4.0F), 2.0D)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"2.0\"",
    "inputType" : "\"DOUBLE\"",
    "paramIndex" : "second",
    "requiredType" : "\"FLOAT\"",
    "sqlExpr" : "\"vector_norm(array(3.0, 4.0), 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 43,
    "fragment" : "vector_norm(array(3.0F, 4.0F), 2.0D)"
  } ]
}


-- !query
SELECT vector_norm(array(3.0F, 4.0F), 2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"2\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "second",
    "requiredType" : "\"FLOAT\"",
    "sqlExpr" : "\"vector_norm(array(3.0, 4.0), 2)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 40,
    "fragment" : "vector_norm(array(3.0F, 4.0F), 2)"
  } ]
}


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), 2.0D)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"2.0\"",
    "inputType" : "\"DOUBLE\"",
    "paramIndex" : "second",
    "requiredType" : "\"FLOAT\"",
    "sqlExpr" : "\"vector_normalize(array(3.0, 4.0), 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 48,
    "fragment" : "vector_normalize(array(3.0F, 4.0F), 2.0D)"
  } ]
}


-- !query
SELECT vector_normalize(array(3.0F, 4.0F), 2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"2\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "second",
    "requiredType" : "\"FLOAT\"",
    "sqlExpr" : "\"vector_normalize(array(3.0, 4.0), 2)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 45,
    "fragment" : "vector_normalize(array(3.0F, 4.0F), 2)"
  } ]
}


-- !query
SELECT vector_norm('not an array', 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_norm(not an array, 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 40,
    "fragment" : "vector_norm('not an array', 2.0F)"
  } ]
}


-- !query
SELECT vector_norm(3.0F, 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"3.0\"",
    "inputType" : "\"FLOAT\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_norm(3.0, 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "vector_norm(3.0F, 2.0F)"
  } ]
}


-- !query
SELECT vector_normalize('not an array', 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_normalize(not an array, 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 45,
    "fragment" : "vector_normalize('not an array', 2.0F)"
  } ]
}


-- !query
SELECT vector_normalize(3.0F, 2.0F)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"3.0\"",
    "inputType" : "\"FLOAT\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_normalize(3.0, 2.0)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 35,
    "fragment" : "vector_normalize(3.0F, 2.0F)"
  } ]
}


-- !query
SELECT vector_norm(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    2.0F
)
-- !query schema
struct<vector_norm(array(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), 2.0):float>
-- !query output
38.678158


-- !query
SELECT vector_norm(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    1.0F
)
-- !query schema
struct<vector_norm(array(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), 1.0):float>
-- !query output
136.0


-- !query
SELECT vector_norm(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    float('inf')
)
-- !query schema
struct<vector_norm(array(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), inf):float>
-- !query output
16.0


-- !query
SELECT vector_normalize(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    2.0F
)
-- !query schema
struct<vector_normalize(array(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), 2.0):array<float>>
-- !query output
[0.025854385,0.05170877,0.07756316,0.10341754,0.12927192,0.15512632,0.1809807,0.20683508,0.23268947,0.25854385,0.28439823,0.31025264,0.33610702,0.3619614,0.38781577,0.41367015]


-- !query
SELECT vector_norm(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, CAST(NULL AS FLOAT), 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    2.0F
)
-- !query schema
struct<vector_norm(array(1.0, 2.0, 3.0, 4.0, 5.0, CAST(NULL AS FLOAT), 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), 2.0):float>
-- !query output
NULL
