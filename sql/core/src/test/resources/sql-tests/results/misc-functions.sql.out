-- Automatically generated by SQLQueryTestSuite
-- !query
select typeof(null)
-- !query schema
struct<typeof(NULL):string>
-- !query output
void


-- !query
select typeof(true)
-- !query schema
struct<typeof(true):string>
-- !query output
boolean


-- !query
select typeof(1Y), typeof(1S), typeof(1), typeof(1L)
-- !query schema
struct<typeof(1):string,typeof(1):string,typeof(1):string,typeof(1):string>
-- !query output
tinyint	smallint	int	bigint


-- !query
select typeof(cast(1.0 as float)), typeof(1.0D), typeof(1.2)
-- !query schema
struct<typeof(CAST(1.0 AS FLOAT)):string,typeof(1.0):string,typeof(1.2):string>
-- !query output
float	double	decimal(2,1)


-- !query
select typeof(date '1986-05-23'),  typeof(timestamp '1986-05-23'), typeof(interval '23 days')
-- !query schema
struct<typeof(DATE '1986-05-23'):string,typeof(TIMESTAMP '1986-05-23 00:00:00'):string,typeof(INTERVAL '23' DAY):string>
-- !query output
date	timestamp	interval day


-- !query
select typeof(x'ABCD'), typeof('SPARK')
-- !query schema
struct<typeof(X'ABCD'):string,typeof(SPARK):string>
-- !query output
binary	string


-- !query
select typeof(array(1, 2)), typeof(map(1, 2)), typeof(named_struct('a', 1, 'b', 'spark'))
-- !query schema
struct<typeof(array(1, 2)):string,typeof(map(1, 2)):string,typeof(named_struct(a, 1, b, spark)):string>
-- !query output
array<int>	map<int,int>	struct<a:int,b:string>


-- !query
SELECT assert_true(true), assert_true(boolean(1))
-- !query schema
struct<assert_true(true, 'true' is not true!):void,assert_true(1, 'cast(1 as boolean)' is not true!):void>
-- !query output
NULL	NULL


-- !query
SELECT assert_true(false)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "'false' is not true!"
  }
}


-- !query
SELECT assert_true(boolean(0))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "'cast(0 as boolean)' is not true!"
  }
}


-- !query
SELECT assert_true(null)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "'null' is not true!"
  }
}


-- !query
SELECT assert_true(boolean(null))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "'cast(null as boolean)' is not true!"
  }
}


-- !query
SELECT assert_true(false, 'custom error message')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "custom error message"
  }
}


-- !query
CREATE TEMPORARY VIEW tbl_misc AS SELECT * FROM (VALUES (1), (8), (2)) AS T(v)
-- !query schema
struct<>
-- !query output



-- !query
SELECT raise_error('error message')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "error message"
  }
}


-- !query
SELECT if(v > 5, raise_error('too big: ' || v), v + 1) FROM tbl_misc
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "too big: 8"
  }
}


-- !query
SELECT raise_error('error message', Map())
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "condition" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "2",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "1",
    "functionName" : "`raise_error`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 42,
    "fragment" : "raise_error('error message', Map())"
  } ]
}


-- !query
SELECT raise_error('error message', 'some args')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "condition" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "2",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "1",
    "functionName" : "`raise_error`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 48,
    "fragment" : "raise_error('error message', 'some args')"
  } ]
}


-- !query
SELECT raise_error()
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "condition" : "WRONG_NUM_ARGS.WITHOUT_SUGGESTION",
  "sqlState" : "42605",
  "messageParameters" : {
    "actualNum" : "0",
    "docroot" : "https://spark.apache.org/docs/latest",
    "expectedNum" : "1",
    "functionName" : "`raise_error`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "raise_error()"
  } ]
}


-- !query
SELECT raise_error(NULL)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "null"
  }
}


-- !query
SELECT raise_error(1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "condition" : "USER_RAISED_EXCEPTION",
  "sqlState" : "P0001",
  "messageParameters" : {
    "errorMessage" : "1"
  }
}


-- !query
SET spark.sql.legacy.raiseErrorWithoutErrorClass=true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.legacy.raiseErrorWithoutErrorClass	true


-- !query
SELECT assert_true(false)
-- !query schema
struct<>
-- !query output
java.lang.RuntimeException
'false' is not true!


-- !query
SELECT raise_error('hello')
-- !query schema
struct<>
-- !query output
java.lang.RuntimeException
hello


-- !query
SET spark.sql.legacy.raiseErrorWithoutErrorClass=false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.legacy.raiseErrorWithoutErrorClass	false
