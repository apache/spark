-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), array(4.0F, 5.0F, 6.0F))
-- !query schema
struct<vector_cosine_similarity(array(1.0, 2.0, 3.0), array(4.0, 5.0, 6.0)):float>
-- !query output
0.9746319


-- !query
SELECT vector_cosine_similarity(array(1.0F, 0.0F, 0.0F), array(1.0F, 0.0F, 0.0F))
-- !query schema
struct<vector_cosine_similarity(array(1.0, 0.0, 0.0), array(1.0, 0.0, 0.0)):float>
-- !query output
1.0


-- !query
SELECT vector_cosine_similarity(array(1.0F, 0.0F), array(0.0F, 1.0F))
-- !query schema
struct<vector_cosine_similarity(array(1.0, 0.0), array(0.0, 1.0)):float>
-- !query output
0.0


-- !query
SELECT vector_cosine_similarity(array(1.0F, 0.0F), array(-1.0F, 0.0F))
-- !query schema
struct<vector_cosine_similarity(array(1.0, 0.0), array(-1.0, 0.0)):float>
-- !query output
-1.0


-- !query
SELECT vector_inner_product(array(1.0F, 2.0F, 3.0F), array(4.0F, 5.0F, 6.0F))
-- !query schema
struct<vector_inner_product(array(1.0, 2.0, 3.0), array(4.0, 5.0, 6.0)):float>
-- !query output
32.0


-- !query
SELECT vector_inner_product(array(1.0F, 0.0F), array(0.0F, 1.0F))
-- !query schema
struct<vector_inner_product(array(1.0, 0.0), array(0.0, 1.0)):float>
-- !query output
0.0


-- !query
SELECT vector_inner_product(array(3.0F, 4.0F), array(3.0F, 4.0F))
-- !query schema
struct<vector_inner_product(array(3.0, 4.0), array(3.0, 4.0)):float>
-- !query output
25.0


-- !query
SELECT vector_l2_distance(array(1.0F, 2.0F, 3.0F), array(4.0F, 5.0F, 6.0F))
-- !query schema
struct<vector_l2_distance(array(1.0, 2.0, 3.0), array(4.0, 5.0, 6.0)):float>
-- !query output
5.196152


-- !query
SELECT vector_l2_distance(array(1.0F, 2.0F), array(1.0F, 2.0F))
-- !query schema
struct<vector_l2_distance(array(1.0, 2.0), array(1.0, 2.0)):float>
-- !query output
0.0


-- !query
SELECT vector_l2_distance(array(0.0F, 0.0F), array(3.0F, 4.0F))
-- !query schema
struct<vector_l2_distance(array(0.0, 0.0), array(3.0, 4.0)):float>
-- !query output
5.0


-- !query
SELECT vector_cosine_similarity(array(), array())
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array()\"",
    "inputType" : "\"ARRAY<VOID>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(array(), array())\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 49,
    "fragment" : "vector_cosine_similarity(array(), array())"
  } ]
}


-- !query
SELECT vector_inner_product(CAST(array() AS ARRAY<FLOAT>), CAST(array() AS ARRAY<FLOAT>))
-- !query schema
struct<vector_inner_product(array(), array()):float>
-- !query output
0.0


-- !query
SELECT vector_l2_distance(CAST(array() AS ARRAY<FLOAT>), CAST(array() AS ARRAY<FLOAT>))
-- !query schema
struct<vector_l2_distance(array(), array()):float>
-- !query output
0.0


-- !query
SELECT vector_cosine_similarity(array(0.0F, 0.0F, 0.0F), array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<vector_cosine_similarity(array(0.0, 0.0, 0.0), array(1.0, 2.0, 3.0)):float>
-- !query output
NULL


-- !query
SELECT vector_cosine_similarity(NULL, array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(NULL, array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 62,
    "fragment" : "vector_cosine_similarity(NULL, array(1.0F, 2.0F, 3.0F))"
  } ]
}


-- !query
SELECT vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), NULL)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(array(1.0, 2.0, 3.0), NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 62,
    "fragment" : "vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), NULL)"
  } ]
}


-- !query
SELECT vector_inner_product(NULL, array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_inner_product(NULL, array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 58,
    "fragment" : "vector_inner_product(NULL, array(1.0F, 2.0F, 3.0F))"
  } ]
}


-- !query
SELECT vector_inner_product(array(1.0F, 2.0F, 3.0F), NULL)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_inner_product(array(1.0, 2.0, 3.0), NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 58,
    "fragment" : "vector_inner_product(array(1.0F, 2.0F, 3.0F), NULL)"
  } ]
}


-- !query
SELECT vector_l2_distance(NULL, array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_l2_distance(NULL, array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "vector_l2_distance(NULL, array(1.0F, 2.0F, 3.0F))"
  } ]
}


-- !query
SELECT vector_l2_distance(array(1.0F, 2.0F, 3.0F), NULL)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"NULL\"",
    "inputType" : "\"VOID\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_l2_distance(array(1.0, 2.0, 3.0), NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "vector_l2_distance(array(1.0F, 2.0F, 3.0F), NULL)"
  } ]
}


-- !query
SELECT vector_cosine_similarity(array(1.0F, CAST(NULL AS FLOAT), 3.0F), array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<vector_cosine_similarity(array(1.0, CAST(NULL AS FLOAT), 3.0), array(1.0, 2.0, 3.0)):float>
-- !query output
NULL


-- !query
SELECT vector_inner_product(array(1.0F, CAST(NULL AS FLOAT), 3.0F), array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<vector_inner_product(array(1.0, CAST(NULL AS FLOAT), 3.0), array(1.0, 2.0, 3.0)):float>
-- !query output
NULL


-- !query
SELECT vector_l2_distance(array(1.0F, CAST(NULL AS FLOAT), 3.0F), array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<vector_l2_distance(array(1.0, CAST(NULL AS FLOAT), 3.0), array(1.0, 2.0, 3.0)):float>
-- !query output
NULL


-- !query
SELECT vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), array(1.0F, 2.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "VECTOR_DIMENSION_MISMATCH",
  "sqlState" : "22000",
  "messageParameters" : {
    "functionName" : "`vector_cosine_similarity`",
    "leftDim" : "3",
    "rightDim" : "2"
  }
}


-- !query
SELECT vector_inner_product(array(1.0F, 2.0F, 3.0F), array(1.0F, 2.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "VECTOR_DIMENSION_MISMATCH",
  "sqlState" : "22000",
  "messageParameters" : {
    "functionName" : "`vector_inner_product`",
    "leftDim" : "3",
    "rightDim" : "2"
  }
}


-- !query
SELECT vector_l2_distance(array(1.0F, 2.0F, 3.0F), array(1.0F, 2.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "VECTOR_DIMENSION_MISMATCH",
  "sqlState" : "22000",
  "messageParameters" : {
    "functionName" : "`vector_l2_distance`",
    "leftDim" : "3",
    "rightDim" : "2"
  }
}


-- !query
SELECT vector_cosine_similarity(array(1.0D, 2.0D, 3.0D), array(4.0D, 5.0D, 6.0D))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1.0, 2.0, 3.0)\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(array(1.0, 2.0, 3.0), array(4.0, 5.0, 6.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 81,
    "fragment" : "vector_cosine_similarity(array(1.0D, 2.0D, 3.0D), array(4.0D, 5.0D, 6.0D))"
  } ]
}


-- !query
SELECT vector_cosine_similarity(array(1, 2, 3), array(4, 5, 6))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1, 2, 3)\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(array(1, 2, 3), array(4, 5, 6))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 63,
    "fragment" : "vector_cosine_similarity(array(1, 2, 3), array(4, 5, 6))"
  } ]
}


-- !query
SELECT vector_inner_product(array(1.0D, 2.0D, 3.0D), array(4.0D, 5.0D, 6.0D))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1.0, 2.0, 3.0)\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_inner_product(array(1.0, 2.0, 3.0), array(4.0, 5.0, 6.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 77,
    "fragment" : "vector_inner_product(array(1.0D, 2.0D, 3.0D), array(4.0D, 5.0D, 6.0D))"
  } ]
}


-- !query
SELECT vector_inner_product(array(1, 2, 3), array(4, 5, 6))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1, 2, 3)\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_inner_product(array(1, 2, 3), array(4, 5, 6))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 59,
    "fragment" : "vector_inner_product(array(1, 2, 3), array(4, 5, 6))"
  } ]
}


-- !query
SELECT vector_l2_distance(array(1.0D, 2.0D, 3.0D), array(4.0D, 5.0D, 6.0D))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1.0, 2.0, 3.0)\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_l2_distance(array(1.0, 2.0, 3.0), array(4.0, 5.0, 6.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 75,
    "fragment" : "vector_l2_distance(array(1.0D, 2.0D, 3.0D), array(4.0D, 5.0D, 6.0D))"
  } ]
}


-- !query
SELECT vector_l2_distance(array(1, 2, 3), array(4, 5, 6))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1, 2, 3)\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_l2_distance(array(1, 2, 3), array(4, 5, 6))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 57,
    "fragment" : "vector_l2_distance(array(1, 2, 3), array(4, 5, 6))"
  } ]
}


-- !query
SELECT vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), array(1.0D, 2.0D, 3.0D))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"array(1.0, 2.0, 3.0)\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(array(1.0, 2.0, 3.0), array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 81,
    "fragment" : "vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), array(1.0D, 2.0D, 3.0D))"
  } ]
}


-- !query
SELECT vector_cosine_similarity('not an array', array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(not an array, array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "vector_cosine_similarity('not an array', array(1.0F, 2.0F, 3.0F))"
  } ]
}


-- !query
SELECT vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), 'not an array')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(array(1.0, 2.0, 3.0), not an array)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "vector_cosine_similarity(array(1.0F, 2.0F, 3.0F), 'not an array')"
  } ]
}


-- !query
SELECT vector_cosine_similarity(123, 456)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"123\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_cosine_similarity(123, 456)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 41,
    "fragment" : "vector_cosine_similarity(123, 456)"
  } ]
}


-- !query
SELECT vector_inner_product('not an array', array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_inner_product(not an array, array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 68,
    "fragment" : "vector_inner_product('not an array', array(1.0F, 2.0F, 3.0F))"
  } ]
}


-- !query
SELECT vector_inner_product(array(1.0F, 2.0F, 3.0F), 'not an array')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_inner_product(array(1.0, 2.0, 3.0), not an array)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 68,
    "fragment" : "vector_inner_product(array(1.0F, 2.0F, 3.0F), 'not an array')"
  } ]
}


-- !query
SELECT vector_l2_distance('not an array', array(1.0F, 2.0F, 3.0F))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_l2_distance(not an array, array(1.0, 2.0, 3.0))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 66,
    "fragment" : "vector_l2_distance('not an array', array(1.0F, 2.0F, 3.0F))"
  } ]
}


-- !query
SELECT vector_l2_distance(array(1.0F, 2.0F, 3.0F), 'not an array')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"not an array\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_l2_distance(array(1.0, 2.0, 3.0), not an array)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 66,
    "fragment" : "vector_l2_distance(array(1.0F, 2.0F, 3.0F), 'not an array')"
  } ]
}


-- !query
SELECT vector_inner_product(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    array(16.0F, 15.0F, 14.0F, 13.0F, 12.0F, 11.0F, 10.0F, 9.0F, 8.0F, 7.0F, 6.0F, 5.0F, 4.0F, 3.0F, 2.0F, 1.0F)
)
-- !query schema
struct<vector_inner_product(array(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), array(16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0)):float>
-- !query output
816.0


-- !query
SELECT vector_l2_distance(
    array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F),
    array(16.0F, 15.0F, 14.0F, 13.0F, 12.0F, 11.0F, 10.0F, 9.0F, 8.0F, 7.0F, 6.0F, 5.0F, 4.0F, 3.0F, 2.0F, 1.0F)
)
-- !query schema
struct<vector_l2_distance(array(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0), array(16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0)):float>
-- !query output
36.878178
