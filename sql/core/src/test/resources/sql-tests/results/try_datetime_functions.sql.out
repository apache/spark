-- Automatically generated by SQLQueryTestSuite
-- !query
select try_to_timestamp(null), try_to_timestamp('2016-12-31 00:12:00'), try_to_timestamp('2016-12-31', 'yyyy-MM-dd')
-- !query schema
struct<try_to_timestamp(NULL):timestamp,try_to_timestamp(2016-12-31 00:12:00):timestamp,try_to_timestamp(2016-12-31, yyyy-MM-dd):timestamp>
-- !query output
NULL	2016-12-31 00:12:00	2016-12-31 00:00:00


-- !query
select try_to_timestamp(1)
-- !query schema
struct<try_to_timestamp(1):timestamp>
-- !query output
1969-12-31 16:00:01


-- !query
select try_to_timestamp('2016-12-31 abc')
-- !query schema
struct<try_to_timestamp(2016-12-31 abc):timestamp>
-- !query output
NULL


-- !query
select try_to_timestamp('2019-10-06 10:11:12.', 'yyyy-MM-dd HH:mm:ss.SSSSSS[zzz]')
-- !query schema
struct<try_to_timestamp(2019-10-06 10:11:12., yyyy-MM-dd HH:mm:ss.SSSSSS[zzz]):timestamp>
-- !query output
NULL


-- !query
select try_to_timestamp("02-29", "MM-dd")
-- !query schema
struct<try_to_timestamp(02-29, MM-dd):timestamp>
-- !query output
NULL


-- !query
select try_to_timestamp('22 05 2020 Friday', 'dd MM yyyy EEEEEE')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkUpgradeException
{
  "errorClass" : "INCONSISTENT_BEHAVIOR_CROSS_VERSION",
  "errorSubClass" : "DATETIME_PATTERN_RECOGNITION",
  "messageParameters" : {
    "config" : "\"spark.sql.legacy.timeParserPolicy\"",
    "pattern" : "'dd MM yyyy EEEEEE'"
  }
}
