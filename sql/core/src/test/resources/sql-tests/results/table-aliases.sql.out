-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW testData AS SELECT * FROM VALUES (1, 1), (1, 2), (2, 1) AS testData(a, b)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM testData AS t(col1, col2) WHERE col1 = 1
-- !query schema
struct<col1:int,col2:int>
-- !query output
1	1
1	2


-- !query
SELECT * FROM testData AS t(col1, col2) WHERE col1 = 2
-- !query schema
struct<col1:int,col2:int>
-- !query output
2	1


-- !query
SELECT col1 AS k, SUM(col2) FROM testData AS t(col1, col2) GROUP BY k
-- !query schema
struct<k:int,sum(col2):bigint>
-- !query output
1	3
2	1


-- !query
SELECT * FROM testData AS t(col1, col2, col3)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "ASSIGNMENT_ARITY_MISMATCH",
  "sqlState" : "42802",
  "messageParameters" : {
    "numExpr" : "3",
    "numTarget" : "2"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 45,
    "fragment" : "testData AS t(col1, col2, col3)"
  } ]
}


-- !query
SELECT * FROM testData AS t(col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "ASSIGNMENT_ARITY_MISMATCH",
  "sqlState" : "42802",
  "messageParameters" : {
    "numExpr" : "1",
    "numTarget" : "2"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 33,
    "fragment" : "testData AS t(col1)"
  } ]
}


-- !query
SELECT a AS col1, b AS col2 FROM testData AS t(c, d)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`a`",
    "proposal" : "`c`, `d`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 8,
    "fragment" : "a"
  } ]
}


-- !query
SELECT * FROM (SELECT 1 AS a, 1 AS b) t(col1, col2)
-- !query schema
struct<col1:int,col2:int>
-- !query output
1	1


-- !query
SELECT t.* FROM (SELECT 1 AS a, 1 AS b) t(col1, col2)
-- !query schema
struct<col1:int,col2:int>
-- !query output
1	1


-- !query
SELECT col1, col2 FROM (SELECT 1 AS a, 1 AS b) t(col1, col2)
-- !query schema
struct<col1:int,col2:int>
-- !query output
1	1


-- !query
SELECT t.col1, t.col2 FROM (SELECT 1 AS a, 1 AS b) t(col1, col2)
-- !query schema
struct<col1:int,col2:int>
-- !query output
1	1


-- !query
CREATE OR REPLACE TEMPORARY VIEW src1 AS SELECT * FROM VALUES (1, "a"), (2, "b"), (3, "c") AS src1(id, v1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW src2 AS SELECT * FROM VALUES (2, 1.0), (3, 3.2), (1, 8.5) AS src2(id, v2)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM (src1 s1 INNER JOIN src2 s2 ON s1.id = s2.id) dst(a, b, c, d)
-- !query schema
struct<a:int,b:string,c:int,d:decimal(2,1)>
-- !query output
1	a	1	8.5
2	b	2	1.0
3	c	3	3.2


-- !query
SELECT dst.* FROM (src1 s1 INNER JOIN src2 s2 ON s1.id = s2.id) dst(a, b, c, d)
-- !query schema
struct<a:int,b:string,c:int,d:decimal(2,1)>
-- !query output
1	a	1	8.5
2	b	2	1.0
3	c	3	3.2


-- !query
SELECT src1.* FROM src1 a ORDER BY id LIMIT 1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "CANNOT_RESOLVE_STAR_EXPAND",
  "sqlState" : "42704",
  "messageParameters" : {
    "columns" : "`id`, `v1`",
    "targetString" : "`src1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 13,
    "fragment" : "src1.*"
  } ]
}


-- !query
SELECT src1.id FROM (SELECT * FROM src1 ORDER BY id LIMIT 1) a
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`src1`.`id`",
    "proposal" : "`a`.`id`, `a`.`v1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 14,
    "fragment" : "src1.id"
  } ]
}
