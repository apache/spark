-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 8


-- !query
CREATE OR REPLACE TEMPORARY VIEW t1 AS SELECT * FROM VALUES
(-234), (145), (367), (975), (298)
as t1(int_col1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW t2 AS SELECT * FROM VALUES
(-769, -244), (-800, -409), (940, 86), (-507, 304), (-367, 158)
as t2(int_col0, int_col1)
-- !query schema
struct<>
-- !query output



-- !query
SELECT
  (udf(SUM(udf(COALESCE(t1.int_col1, t2.int_col0))))),
     (udf(COALESCE(t1.int_col1, t2.int_col0)) * 2)
FROM t1
RIGHT JOIN t2
  ON udf(t2.int_col0) = udf(t1.int_col1)
GROUP BY udf(GREATEST(COALESCE(udf(t2.int_col1), 109), COALESCE(t1.int_col1, udf(-449)))),
         COALESCE(t1.int_col1, t2.int_col0)
HAVING (udf(SUM(COALESCE(udf(t1.int_col1), udf(t2.int_col0)))))
            > (udf(COALESCE(t1.int_col1, t2.int_col0)) * 2)
-- !query schema
struct<CAST(udf(cast(sum(cast(cast(udf(cast(coalesce(int_col1, int_col0) as string)) as int) as bigint)) as string)) AS BIGINT):bigint,(CAST(udf(cast(coalesce(int_col1, int_col0) as string)) AS INT) * 2):int>
-- !query output
-367	-734
-507	-1014
-769	-1538
-800	-1600


-- !query
CREATE OR REPLACE TEMPORARY VIEW t1 AS SELECT * FROM VALUES (97) as t1(int_col1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW t2 AS SELECT * FROM VALUES (0) as t2(int_col1)
-- !query schema
struct<>
-- !query output



-- !query
set spark.sql.crossJoin.enabled = true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.crossJoin.enabled	true


-- !query
SELECT *
FROM (
SELECT
    udf(COALESCE(udf(t2.int_col1), udf(t1.int_col1))) AS int_col
    FROM t1
    LEFT JOIN t2 ON false
) t where (udf(t.int_col)) is not null
-- !query schema
struct<int_col:int>
-- !query output
97


-- !query
set spark.sql.crossJoin.enabled = false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.crossJoin.enabled	false
