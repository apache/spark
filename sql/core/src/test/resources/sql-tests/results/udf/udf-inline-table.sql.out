-- Automatically generated by SQLQueryTestSuite
-- !query
select udf(col1), udf(col2) from values ("one", 1)
-- !query schema
struct<udf(col1):string,udf(col2):int>
-- !query output
one	1


-- !query
select udf(col1), udf(udf(col2)) from values ("one", 1) as data
-- !query schema
struct<udf(col1):string,udf(udf(col2)):int>
-- !query output
one	1


-- !query
select udf(a), b from values ("one", 1) as data(a, b)
-- !query schema
struct<udf(a):string,b:int>
-- !query output
one	1


-- !query
select udf(a) from values 1, 2, 3 as data(a)
-- !query schema
struct<udf(a):int>
-- !query output
1
2
3


-- !query
select udf(a), b from values ("one", 1), ("two", 2), ("three", null) as data(a, b)
-- !query schema
struct<udf(a):string,b:int>
-- !query output
one	1
three	NULL
two	2


-- !query
select udf(a), b from values ("one", null), ("two", null) as data(a, b)
-- !query schema
struct<udf(a):string,b:void>
-- !query output
one	NULL
two	NULL


-- !query
select udf(a), b from values ("one", 1), ("two", 2L) as data(a, b)
-- !query schema
struct<udf(a):string,b:bigint>
-- !query output
one	1
two	2


-- !query
select udf(udf(a)), udf(b) from values ("one", 1 + 0), ("two", 1 + 3L) as data(a, b)
-- !query schema
struct<udf(udf(a)):string,udf(b):bigint>
-- !query output
one	1
two	4


-- !query
select udf(a), b from values ("one", array(0, 1)), ("two", array(2, 3)) as data(a, b)
-- !query schema
struct<udf(a):string,b:array<int>>
-- !query output
one	[0,1]
two	[2,3]


-- !query
select udf(a), b from values ("one", 2.0), ("two", 3.0D) as data(a, b)
-- !query schema
struct<udf(a):string,b:double>
-- !query output
one	2.0
two	3.0


-- !query
select udf(a), b from values ("one", rand(5)), ("two", 3.0D) as data(a, b)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot evaluate expression rand(5) in inline table definition; line 1 pos 37


-- !query
select udf(a), udf(b) from values ("one", 2.0), ("two") as data(a, b)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
expected 2 columns but found 1 columns in row 1; line 1 pos 27


-- !query
select udf(a), udf(b) from values ("one", array(0, 1)), ("two", struct(1, 2)) as data(a, b)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
incompatible types found in column b for inline table; line 1 pos 27


-- !query
select udf(a), udf(b) from values ("one"), ("two") as data(a, b)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
expected 2 columns but found 1 columns in row 0; line 1 pos 27


-- !query
select udf(a), udf(b) from values ("one", random_not_exist_func(1)), ("two", 2) as data(a, b)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1242",
  "messageParameters" : {
    "fullName" : "spark_catalog.default.random_not_exist_func",
    "rawName" : "random_not_exist_func"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 43,
    "stopIndex" : 66,
    "fragment" : "random_not_exist_func(1)"
  } ]
}


-- !query
select udf(a), udf(b) from values ("one", count(1)), ("two", 2) as data(a, b)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
cannot evaluate expression count(1) in inline table definition; line 1 pos 42


-- !query
select udf(a), b from values (timestamp('1991-12-06 00:00:00.0'), array(timestamp('1991-12-06 01:00:00.0'), timestamp('1991-12-06 12:00:00.0'))) as data(a, b)
-- !query schema
struct<udf(a):timestamp,b:array<timestamp>>
-- !query output
1991-12-06 00:00:00	[1991-12-06 01:00:00,1991-12-06 12:00:00]
