-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW INT2_TBL(f1) AS VALUES
  (smallint(trim('0   '))),
  (smallint(trim('  1234 '))),
  (smallint(trim('    -1234'))),
  (smallint('32767')),
  (smallint('-32767'))
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW INT4_TBL AS SELECT * FROM
  (VALUES (0), (123456), (-123456), (2147483647), (-2147483647))
  AS v(f1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW INT8_TBL AS SELECT * FROM
  (VALUES
    (123, 456),
    (123, 4567890123456789),
    (4567890123456789, 123),
    (4567890123456789, 4567890123456789),
    (4567890123456789, -4567890123456789))
  AS v(q1, q2)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW FLOAT8_TBL AS SELECT * FROM
  (VALUES (0.0), (1004.30), (-34.84),
    (cast('1.2345678901234e+200' as double)), (cast('1.2345678901234e-200' as double)))
  AS v(f1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW TEXT_TBL AS SELECT * FROM
  (VALUES ('doh!'), ('hi de ho neighbor'))
  AS v(f1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW tenk2 AS SELECT * FROM tenk1
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE J1_TBL (
  i integer,
  j integer,
  t string
) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE J2_TBL (
  i integer,
  k integer
) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (1, 4, 'one')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (2, 3, 'two')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (3, 2, 'three')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (4, 1, 'four')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (5, 0, 'five')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (6, 6, 'six')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (7, 7, 'seven')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (8, 8, 'eight')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (0, NULL, 'zero')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (NULL, NULL, 'null')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J1_TBL VALUES (NULL, 0, 'zero')
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (1, -1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (2, 2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (3, -3)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (2, 4)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (5, -5)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (5, -5)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (0, NULL)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (NULL, NULL)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO J2_TBL VALUES (NULL, 0)
-- !query schema
struct<>
-- !query output



-- !query
SELECT udf('') AS `xxx`, udf(i), udf(j), udf(t)
  FROM J1_TBL AS tx
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string>
-- !query output
	0	NULL	zero
	1	4	one
	2	3	two
	3	2	three
	4	1	four
	5	0	five
	6	6	six
	7	7	seven
	8	8	eight
	NULL	0	zero
	NULL	NULL	null


-- !query
SELECT udf(udf('')) AS `xxx`, udf(udf(i)), udf(j), udf(t)
  FROM J1_TBL tx
-- !query schema
struct<xxx:string,udf(udf(i)):int,udf(j):int,udf(t):string>
-- !query output
	0	NULL	zero
	1	4	one
	2	3	two
	3	2	three
	4	1	four
	5	0	five
	6	6	six
	7	7	seven
	8	8	eight
	NULL	0	zero
	NULL	NULL	null


-- !query
SELECT udf('') AS `xxx`, a, udf(udf(b)), c
  FROM J1_TBL AS t1 (a, b, c)
-- !query schema
struct<xxx:string,a:int,udf(udf(b)):int,c:string>
-- !query output
	0	NULL	zero
	1	4	one
	2	3	two
	3	2	three
	4	1	four
	5	0	five
	6	6	six
	7	7	seven
	8	8	eight
	NULL	0	zero
	NULL	NULL	null


-- !query
SELECT udf('') AS `xxx`, udf(a), udf(b), udf(udf(c))
  FROM J1_TBL t1 (a, b, c)
-- !query schema
struct<xxx:string,udf(a):int,udf(b):int,udf(udf(c)):string>
-- !query output
	0	NULL	zero
	1	4	one
	2	3	two
	3	2	three
	4	1	four
	5	0	five
	6	6	six
	7	7	seven
	8	8	eight
	NULL	0	zero
	NULL	NULL	null


-- !query
SELECT udf('') AS `xxx`, udf(a), b, udf(c), udf(d), e
  FROM J1_TBL t1 (a, b, c), J2_TBL t2 (d, e)
-- !query schema
struct<xxx:string,udf(a):int,b:int,udf(c):string,udf(d):int,e:int>
-- !query output
	0	NULL	zero	0	NULL
	0	NULL	zero	1	-1
	0	NULL	zero	2	2
	0	NULL	zero	2	4
	0	NULL	zero	3	-3
	0	NULL	zero	5	-5
	0	NULL	zero	5	-5
	0	NULL	zero	NULL	0
	0	NULL	zero	NULL	NULL
	1	4	one	0	NULL
	1	4	one	1	-1
	1	4	one	2	2
	1	4	one	2	4
	1	4	one	3	-3
	1	4	one	5	-5
	1	4	one	5	-5
	1	4	one	NULL	0
	1	4	one	NULL	NULL
	2	3	two	0	NULL
	2	3	two	1	-1
	2	3	two	2	2
	2	3	two	2	4
	2	3	two	3	-3
	2	3	two	5	-5
	2	3	two	5	-5
	2	3	two	NULL	0
	2	3	two	NULL	NULL
	3	2	three	0	NULL
	3	2	three	1	-1
	3	2	three	2	2
	3	2	three	2	4
	3	2	three	3	-3
	3	2	three	5	-5
	3	2	three	5	-5
	3	2	three	NULL	0
	3	2	three	NULL	NULL
	4	1	four	0	NULL
	4	1	four	1	-1
	4	1	four	2	2
	4	1	four	2	4
	4	1	four	3	-3
	4	1	four	5	-5
	4	1	four	5	-5
	4	1	four	NULL	0
	4	1	four	NULL	NULL
	5	0	five	0	NULL
	5	0	five	1	-1
	5	0	five	2	2
	5	0	five	2	4
	5	0	five	3	-3
	5	0	five	5	-5
	5	0	five	5	-5
	5	0	five	NULL	0
	5	0	five	NULL	NULL
	6	6	six	0	NULL
	6	6	six	1	-1
	6	6	six	2	2
	6	6	six	2	4
	6	6	six	3	-3
	6	6	six	5	-5
	6	6	six	5	-5
	6	6	six	NULL	0
	6	6	six	NULL	NULL
	7	7	seven	0	NULL
	7	7	seven	1	-1
	7	7	seven	2	2
	7	7	seven	2	4
	7	7	seven	3	-3
	7	7	seven	5	-5
	7	7	seven	5	-5
	7	7	seven	NULL	0
	7	7	seven	NULL	NULL
	8	8	eight	0	NULL
	8	8	eight	1	-1
	8	8	eight	2	2
	8	8	eight	2	4
	8	8	eight	3	-3
	8	8	eight	5	-5
	8	8	eight	5	-5
	8	8	eight	NULL	0
	8	8	eight	NULL	NULL
	NULL	0	zero	0	NULL
	NULL	0	zero	1	-1
	NULL	0	zero	2	2
	NULL	0	zero	2	4
	NULL	0	zero	3	-3
	NULL	0	zero	5	-5
	NULL	0	zero	5	-5
	NULL	0	zero	NULL	0
	NULL	0	zero	NULL	NULL
	NULL	NULL	null	0	NULL
	NULL	NULL	null	1	-1
	NULL	NULL	null	2	2
	NULL	NULL	null	2	4
	NULL	NULL	null	3	-3
	NULL	NULL	null	5	-5
	NULL	NULL	null	5	-5
	NULL	NULL	null	NULL	0
	NULL	NULL	null	NULL	NULL


-- !query
SELECT udf('') AS `xxx`, *
  FROM J1_TBL CROSS JOIN J2_TBL
-- !query schema
struct<xxx:string,i:int,j:int,t:string,i:int,k:int>
-- !query output
	0	NULL	zero	0	NULL
	0	NULL	zero	1	-1
	0	NULL	zero	2	2
	0	NULL	zero	2	4
	0	NULL	zero	3	-3
	0	NULL	zero	5	-5
	0	NULL	zero	5	-5
	0	NULL	zero	NULL	0
	0	NULL	zero	NULL	NULL
	1	4	one	0	NULL
	1	4	one	1	-1
	1	4	one	2	2
	1	4	one	2	4
	1	4	one	3	-3
	1	4	one	5	-5
	1	4	one	5	-5
	1	4	one	NULL	0
	1	4	one	NULL	NULL
	2	3	two	0	NULL
	2	3	two	1	-1
	2	3	two	2	2
	2	3	two	2	4
	2	3	two	3	-3
	2	3	two	5	-5
	2	3	two	5	-5
	2	3	two	NULL	0
	2	3	two	NULL	NULL
	3	2	three	0	NULL
	3	2	three	1	-1
	3	2	three	2	2
	3	2	three	2	4
	3	2	three	3	-3
	3	2	three	5	-5
	3	2	three	5	-5
	3	2	three	NULL	0
	3	2	three	NULL	NULL
	4	1	four	0	NULL
	4	1	four	1	-1
	4	1	four	2	2
	4	1	four	2	4
	4	1	four	3	-3
	4	1	four	5	-5
	4	1	four	5	-5
	4	1	four	NULL	0
	4	1	four	NULL	NULL
	5	0	five	0	NULL
	5	0	five	1	-1
	5	0	five	2	2
	5	0	five	2	4
	5	0	five	3	-3
	5	0	five	5	-5
	5	0	five	5	-5
	5	0	five	NULL	0
	5	0	five	NULL	NULL
	6	6	six	0	NULL
	6	6	six	1	-1
	6	6	six	2	2
	6	6	six	2	4
	6	6	six	3	-3
	6	6	six	5	-5
	6	6	six	5	-5
	6	6	six	NULL	0
	6	6	six	NULL	NULL
	7	7	seven	0	NULL
	7	7	seven	1	-1
	7	7	seven	2	2
	7	7	seven	2	4
	7	7	seven	3	-3
	7	7	seven	5	-5
	7	7	seven	5	-5
	7	7	seven	NULL	0
	7	7	seven	NULL	NULL
	8	8	eight	0	NULL
	8	8	eight	1	-1
	8	8	eight	2	2
	8	8	eight	2	4
	8	8	eight	3	-3
	8	8	eight	5	-5
	8	8	eight	5	-5
	8	8	eight	NULL	0
	8	8	eight	NULL	NULL
	NULL	0	zero	0	NULL
	NULL	0	zero	1	-1
	NULL	0	zero	2	2
	NULL	0	zero	2	4
	NULL	0	zero	3	-3
	NULL	0	zero	5	-5
	NULL	0	zero	5	-5
	NULL	0	zero	NULL	0
	NULL	0	zero	NULL	NULL
	NULL	NULL	null	0	NULL
	NULL	NULL	null	1	-1
	NULL	NULL	null	2	2
	NULL	NULL	null	2	4
	NULL	NULL	null	3	-3
	NULL	NULL	null	5	-5
	NULL	NULL	null	5	-5
	NULL	NULL	null	NULL	0
	NULL	NULL	null	NULL	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i) AS i, udf(k), udf(t) AS t
  FROM J1_TBL CROSS JOIN J2_TBL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`i`",
    "referenceNames" : "[`spark_catalog`.`default`.`j1_tbl`.`i`, `spark_catalog`.`default`.`j2_tbl`.`i`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 30,
    "fragment" : "i"
  } ]
}


-- !query
SELECT udf('') AS `xxx`, udf(t1.i) AS i, udf(k), udf(t)
  FROM J1_TBL t1 CROSS JOIN J2_TBL t2
-- !query schema
struct<xxx:string,i:int,udf(k):int,udf(t):string>
-- !query output
	0	-1	zero
	0	-3	zero
	0	-5	zero
	0	-5	zero
	0	0	zero
	0	2	zero
	0	4	zero
	0	NULL	zero
	0	NULL	zero
	1	-1	one
	1	-3	one
	1	-5	one
	1	-5	one
	1	0	one
	1	2	one
	1	4	one
	1	NULL	one
	1	NULL	one
	2	-1	two
	2	-3	two
	2	-5	two
	2	-5	two
	2	0	two
	2	2	two
	2	4	two
	2	NULL	two
	2	NULL	two
	3	-1	three
	3	-3	three
	3	-5	three
	3	-5	three
	3	0	three
	3	2	three
	3	4	three
	3	NULL	three
	3	NULL	three
	4	-1	four
	4	-3	four
	4	-5	four
	4	-5	four
	4	0	four
	4	2	four
	4	4	four
	4	NULL	four
	4	NULL	four
	5	-1	five
	5	-3	five
	5	-5	five
	5	-5	five
	5	0	five
	5	2	five
	5	4	five
	5	NULL	five
	5	NULL	five
	6	-1	six
	6	-3	six
	6	-5	six
	6	-5	six
	6	0	six
	6	2	six
	6	4	six
	6	NULL	six
	6	NULL	six
	7	-1	seven
	7	-3	seven
	7	-5	seven
	7	-5	seven
	7	0	seven
	7	2	seven
	7	4	seven
	7	NULL	seven
	7	NULL	seven
	8	-1	eight
	8	-3	eight
	8	-5	eight
	8	-5	eight
	8	0	eight
	8	2	eight
	8	4	eight
	8	NULL	eight
	8	NULL	eight
	NULL	-1	null
	NULL	-1	zero
	NULL	-3	null
	NULL	-3	zero
	NULL	-5	null
	NULL	-5	null
	NULL	-5	zero
	NULL	-5	zero
	NULL	0	null
	NULL	0	zero
	NULL	2	null
	NULL	2	zero
	NULL	4	null
	NULL	4	zero
	NULL	NULL	null
	NULL	NULL	null
	NULL	NULL	zero
	NULL	NULL	zero


-- !query
SELECT udf(udf('')) AS `xxx`, udf(udf(ii)) AS ii, udf(udf(tt)) AS tt, udf(udf(kk))
  FROM (J1_TBL CROSS JOIN J2_TBL)
    AS tx (ii, jj, tt, ii2, kk)
-- !query schema
struct<xxx:string,ii:int,tt:string,udf(udf(kk)):int>
-- !query output
	0	zero	-1
	0	zero	-3
	0	zero	-5
	0	zero	-5
	0	zero	0
	0	zero	2
	0	zero	4
	0	zero	NULL
	0	zero	NULL
	1	one	-1
	1	one	-3
	1	one	-5
	1	one	-5
	1	one	0
	1	one	2
	1	one	4
	1	one	NULL
	1	one	NULL
	2	two	-1
	2	two	-3
	2	two	-5
	2	two	-5
	2	two	0
	2	two	2
	2	two	4
	2	two	NULL
	2	two	NULL
	3	three	-1
	3	three	-3
	3	three	-5
	3	three	-5
	3	three	0
	3	three	2
	3	three	4
	3	three	NULL
	3	three	NULL
	4	four	-1
	4	four	-3
	4	four	-5
	4	four	-5
	4	four	0
	4	four	2
	4	four	4
	4	four	NULL
	4	four	NULL
	5	five	-1
	5	five	-3
	5	five	-5
	5	five	-5
	5	five	0
	5	five	2
	5	five	4
	5	five	NULL
	5	five	NULL
	6	six	-1
	6	six	-3
	6	six	-5
	6	six	-5
	6	six	0
	6	six	2
	6	six	4
	6	six	NULL
	6	six	NULL
	7	seven	-1
	7	seven	-3
	7	seven	-5
	7	seven	-5
	7	seven	0
	7	seven	2
	7	seven	4
	7	seven	NULL
	7	seven	NULL
	8	eight	-1
	8	eight	-3
	8	eight	-5
	8	eight	-5
	8	eight	0
	8	eight	2
	8	eight	4
	8	eight	NULL
	8	eight	NULL
	NULL	null	-1
	NULL	null	-3
	NULL	null	-5
	NULL	null	-5
	NULL	null	0
	NULL	null	2
	NULL	null	4
	NULL	null	NULL
	NULL	null	NULL
	NULL	zero	-1
	NULL	zero	-3
	NULL	zero	-5
	NULL	zero	-5
	NULL	zero	0
	NULL	zero	2
	NULL	zero	4
	NULL	zero	NULL
	NULL	zero	NULL


-- !query
SELECT udf('') AS `xxx`, udf(udf(j1_tbl.i)), udf(j), udf(t), udf(a.i), udf(a.k), udf(b.i),  udf(b.k)
  FROM J1_TBL CROSS JOIN J2_TBL a CROSS JOIN J2_TBL b
-- !query schema
struct<xxx:string,udf(udf(i)):int,udf(j):int,udf(t):string,udf(i):int,udf(k):int,udf(i):int,udf(k):int>
-- !query output
	0	NULL	zero	0	NULL	0	NULL
	0	NULL	zero	0	NULL	1	-1
	0	NULL	zero	0	NULL	2	2
	0	NULL	zero	0	NULL	2	4
	0	NULL	zero	0	NULL	3	-3
	0	NULL	zero	0	NULL	5	-5
	0	NULL	zero	0	NULL	5	-5
	0	NULL	zero	0	NULL	NULL	0
	0	NULL	zero	0	NULL	NULL	NULL
	0	NULL	zero	1	-1	0	NULL
	0	NULL	zero	1	-1	1	-1
	0	NULL	zero	1	-1	2	2
	0	NULL	zero	1	-1	2	4
	0	NULL	zero	1	-1	3	-3
	0	NULL	zero	1	-1	5	-5
	0	NULL	zero	1	-1	5	-5
	0	NULL	zero	1	-1	NULL	0
	0	NULL	zero	1	-1	NULL	NULL
	0	NULL	zero	2	2	0	NULL
	0	NULL	zero	2	2	1	-1
	0	NULL	zero	2	2	2	2
	0	NULL	zero	2	2	2	4
	0	NULL	zero	2	2	3	-3
	0	NULL	zero	2	2	5	-5
	0	NULL	zero	2	2	5	-5
	0	NULL	zero	2	2	NULL	0
	0	NULL	zero	2	2	NULL	NULL
	0	NULL	zero	2	4	0	NULL
	0	NULL	zero	2	4	1	-1
	0	NULL	zero	2	4	2	2
	0	NULL	zero	2	4	2	4
	0	NULL	zero	2	4	3	-3
	0	NULL	zero	2	4	5	-5
	0	NULL	zero	2	4	5	-5
	0	NULL	zero	2	4	NULL	0
	0	NULL	zero	2	4	NULL	NULL
	0	NULL	zero	3	-3	0	NULL
	0	NULL	zero	3	-3	1	-1
	0	NULL	zero	3	-3	2	2
	0	NULL	zero	3	-3	2	4
	0	NULL	zero	3	-3	3	-3
	0	NULL	zero	3	-3	5	-5
	0	NULL	zero	3	-3	5	-5
	0	NULL	zero	3	-3	NULL	0
	0	NULL	zero	3	-3	NULL	NULL
	0	NULL	zero	5	-5	0	NULL
	0	NULL	zero	5	-5	0	NULL
	0	NULL	zero	5	-5	1	-1
	0	NULL	zero	5	-5	1	-1
	0	NULL	zero	5	-5	2	2
	0	NULL	zero	5	-5	2	2
	0	NULL	zero	5	-5	2	4
	0	NULL	zero	5	-5	2	4
	0	NULL	zero	5	-5	3	-3
	0	NULL	zero	5	-5	3	-3
	0	NULL	zero	5	-5	5	-5
	0	NULL	zero	5	-5	5	-5
	0	NULL	zero	5	-5	5	-5
	0	NULL	zero	5	-5	5	-5
	0	NULL	zero	5	-5	NULL	0
	0	NULL	zero	5	-5	NULL	0
	0	NULL	zero	5	-5	NULL	NULL
	0	NULL	zero	5	-5	NULL	NULL
	0	NULL	zero	NULL	0	0	NULL
	0	NULL	zero	NULL	0	1	-1
	0	NULL	zero	NULL	0	2	2
	0	NULL	zero	NULL	0	2	4
	0	NULL	zero	NULL	0	3	-3
	0	NULL	zero	NULL	0	5	-5
	0	NULL	zero	NULL	0	5	-5
	0	NULL	zero	NULL	0	NULL	0
	0	NULL	zero	NULL	0	NULL	NULL
	0	NULL	zero	NULL	NULL	0	NULL
	0	NULL	zero	NULL	NULL	1	-1
	0	NULL	zero	NULL	NULL	2	2
	0	NULL	zero	NULL	NULL	2	4
	0	NULL	zero	NULL	NULL	3	-3
	0	NULL	zero	NULL	NULL	5	-5
	0	NULL	zero	NULL	NULL	5	-5
	0	NULL	zero	NULL	NULL	NULL	0
	0	NULL	zero	NULL	NULL	NULL	NULL
	1	4	one	0	NULL	0	NULL
	1	4	one	0	NULL	1	-1
	1	4	one	0	NULL	2	2
	1	4	one	0	NULL	2	4
	1	4	one	0	NULL	3	-3
	1	4	one	0	NULL	5	-5
	1	4	one	0	NULL	5	-5
	1	4	one	0	NULL	NULL	0
	1	4	one	0	NULL	NULL	NULL
	1	4	one	1	-1	0	NULL
	1	4	one	1	-1	1	-1
	1	4	one	1	-1	2	2
	1	4	one	1	-1	2	4
	1	4	one	1	-1	3	-3
	1	4	one	1	-1	5	-5
	1	4	one	1	-1	5	-5
	1	4	one	1	-1	NULL	0
	1	4	one	1	-1	NULL	NULL
	1	4	one	2	2	0	NULL
	1	4	one	2	2	1	-1
	1	4	one	2	2	2	2
	1	4	one	2	2	2	4
	1	4	one	2	2	3	-3
	1	4	one	2	2	5	-5
	1	4	one	2	2	5	-5
	1	4	one	2	2	NULL	0
	1	4	one	2	2	NULL	NULL
	1	4	one	2	4	0	NULL
	1	4	one	2	4	1	-1
	1	4	one	2	4	2	2
	1	4	one	2	4	2	4
	1	4	one	2	4	3	-3
	1	4	one	2	4	5	-5
	1	4	one	2	4	5	-5
	1	4	one	2	4	NULL	0
	1	4	one	2	4	NULL	NULL
	1	4	one	3	-3	0	NULL
	1	4	one	3	-3	1	-1
	1	4	one	3	-3	2	2
	1	4	one	3	-3	2	4
	1	4	one	3	-3	3	-3
	1	4	one	3	-3	5	-5
	1	4	one	3	-3	5	-5
	1	4	one	3	-3	NULL	0
	1	4	one	3	-3	NULL	NULL
	1	4	one	5	-5	0	NULL
	1	4	one	5	-5	0	NULL
	1	4	one	5	-5	1	-1
	1	4	one	5	-5	1	-1
	1	4	one	5	-5	2	2
	1	4	one	5	-5	2	2
	1	4	one	5	-5	2	4
	1	4	one	5	-5	2	4
	1	4	one	5	-5	3	-3
	1	4	one	5	-5	3	-3
	1	4	one	5	-5	5	-5
	1	4	one	5	-5	5	-5
	1	4	one	5	-5	5	-5
	1	4	one	5	-5	5	-5
	1	4	one	5	-5	NULL	0
	1	4	one	5	-5	NULL	0
	1	4	one	5	-5	NULL	NULL
	1	4	one	5	-5	NULL	NULL
	1	4	one	NULL	0	0	NULL
	1	4	one	NULL	0	1	-1
	1	4	one	NULL	0	2	2
	1	4	one	NULL	0	2	4
	1	4	one	NULL	0	3	-3
	1	4	one	NULL	0	5	-5
	1	4	one	NULL	0	5	-5
	1	4	one	NULL	0	NULL	0
	1	4	one	NULL	0	NULL	NULL
	1	4	one	NULL	NULL	0	NULL
	1	4	one	NULL	NULL	1	-1
	1	4	one	NULL	NULL	2	2
	1	4	one	NULL	NULL	2	4
	1	4	one	NULL	NULL	3	-3
	1	4	one	NULL	NULL	5	-5
	1	4	one	NULL	NULL	5	-5
	1	4	one	NULL	NULL	NULL	0
	1	4	one	NULL	NULL	NULL	NULL
	2	3	two	0	NULL	0	NULL
	2	3	two	0	NULL	1	-1
	2	3	two	0	NULL	2	2
	2	3	two	0	NULL	2	4
	2	3	two	0	NULL	3	-3
	2	3	two	0	NULL	5	-5
	2	3	two	0	NULL	5	-5
	2	3	two	0	NULL	NULL	0
	2	3	two	0	NULL	NULL	NULL
	2	3	two	1	-1	0	NULL
	2	3	two	1	-1	1	-1
	2	3	two	1	-1	2	2
	2	3	two	1	-1	2	4
	2	3	two	1	-1	3	-3
	2	3	two	1	-1	5	-5
	2	3	two	1	-1	5	-5
	2	3	two	1	-1	NULL	0
	2	3	two	1	-1	NULL	NULL
	2	3	two	2	2	0	NULL
	2	3	two	2	2	1	-1
	2	3	two	2	2	2	2
	2	3	two	2	2	2	4
	2	3	two	2	2	3	-3
	2	3	two	2	2	5	-5
	2	3	two	2	2	5	-5
	2	3	two	2	2	NULL	0
	2	3	two	2	2	NULL	NULL
	2	3	two	2	4	0	NULL
	2	3	two	2	4	1	-1
	2	3	two	2	4	2	2
	2	3	two	2	4	2	4
	2	3	two	2	4	3	-3
	2	3	two	2	4	5	-5
	2	3	two	2	4	5	-5
	2	3	two	2	4	NULL	0
	2	3	two	2	4	NULL	NULL
	2	3	two	3	-3	0	NULL
	2	3	two	3	-3	1	-1
	2	3	two	3	-3	2	2
	2	3	two	3	-3	2	4
	2	3	two	3	-3	3	-3
	2	3	two	3	-3	5	-5
	2	3	two	3	-3	5	-5
	2	3	two	3	-3	NULL	0
	2	3	two	3	-3	NULL	NULL
	2	3	two	5	-5	0	NULL
	2	3	two	5	-5	0	NULL
	2	3	two	5	-5	1	-1
	2	3	two	5	-5	1	-1
	2	3	two	5	-5	2	2
	2	3	two	5	-5	2	2
	2	3	two	5	-5	2	4
	2	3	two	5	-5	2	4
	2	3	two	5	-5	3	-3
	2	3	two	5	-5	3	-3
	2	3	two	5	-5	5	-5
	2	3	two	5	-5	5	-5
	2	3	two	5	-5	5	-5
	2	3	two	5	-5	5	-5
	2	3	two	5	-5	NULL	0
	2	3	two	5	-5	NULL	0
	2	3	two	5	-5	NULL	NULL
	2	3	two	5	-5	NULL	NULL
	2	3	two	NULL	0	0	NULL
	2	3	two	NULL	0	1	-1
	2	3	two	NULL	0	2	2
	2	3	two	NULL	0	2	4
	2	3	two	NULL	0	3	-3
	2	3	two	NULL	0	5	-5
	2	3	two	NULL	0	5	-5
	2	3	two	NULL	0	NULL	0
	2	3	two	NULL	0	NULL	NULL
	2	3	two	NULL	NULL	0	NULL
	2	3	two	NULL	NULL	1	-1
	2	3	two	NULL	NULL	2	2
	2	3	two	NULL	NULL	2	4
	2	3	two	NULL	NULL	3	-3
	2	3	two	NULL	NULL	5	-5
	2	3	two	NULL	NULL	5	-5
	2	3	two	NULL	NULL	NULL	0
	2	3	two	NULL	NULL	NULL	NULL
	3	2	three	0	NULL	0	NULL
	3	2	three	0	NULL	1	-1
	3	2	three	0	NULL	2	2
	3	2	three	0	NULL	2	4
	3	2	three	0	NULL	3	-3
	3	2	three	0	NULL	5	-5
	3	2	three	0	NULL	5	-5
	3	2	three	0	NULL	NULL	0
	3	2	three	0	NULL	NULL	NULL
	3	2	three	1	-1	0	NULL
	3	2	three	1	-1	1	-1
	3	2	three	1	-1	2	2
	3	2	three	1	-1	2	4
	3	2	three	1	-1	3	-3
	3	2	three	1	-1	5	-5
	3	2	three	1	-1	5	-5
	3	2	three	1	-1	NULL	0
	3	2	three	1	-1	NULL	NULL
	3	2	three	2	2	0	NULL
	3	2	three	2	2	1	-1
	3	2	three	2	2	2	2
	3	2	three	2	2	2	4
	3	2	three	2	2	3	-3
	3	2	three	2	2	5	-5
	3	2	three	2	2	5	-5
	3	2	three	2	2	NULL	0
	3	2	three	2	2	NULL	NULL
	3	2	three	2	4	0	NULL
	3	2	three	2	4	1	-1
	3	2	three	2	4	2	2
	3	2	three	2	4	2	4
	3	2	three	2	4	3	-3
	3	2	three	2	4	5	-5
	3	2	three	2	4	5	-5
	3	2	three	2	4	NULL	0
	3	2	three	2	4	NULL	NULL
	3	2	three	3	-3	0	NULL
	3	2	three	3	-3	1	-1
	3	2	three	3	-3	2	2
	3	2	three	3	-3	2	4
	3	2	three	3	-3	3	-3
	3	2	three	3	-3	5	-5
	3	2	three	3	-3	5	-5
	3	2	three	3	-3	NULL	0
	3	2	three	3	-3	NULL	NULL
	3	2	three	5	-5	0	NULL
	3	2	three	5	-5	0	NULL
	3	2	three	5	-5	1	-1
	3	2	three	5	-5	1	-1
	3	2	three	5	-5	2	2
	3	2	three	5	-5	2	2
	3	2	three	5	-5	2	4
	3	2	three	5	-5	2	4
	3	2	three	5	-5	3	-3
	3	2	three	5	-5	3	-3
	3	2	three	5	-5	5	-5
	3	2	three	5	-5	5	-5
	3	2	three	5	-5	5	-5
	3	2	three	5	-5	5	-5
	3	2	three	5	-5	NULL	0
	3	2	three	5	-5	NULL	0
	3	2	three	5	-5	NULL	NULL
	3	2	three	5	-5	NULL	NULL
	3	2	three	NULL	0	0	NULL
	3	2	three	NULL	0	1	-1
	3	2	three	NULL	0	2	2
	3	2	three	NULL	0	2	4
	3	2	three	NULL	0	3	-3
	3	2	three	NULL	0	5	-5
	3	2	three	NULL	0	5	-5
	3	2	three	NULL	0	NULL	0
	3	2	three	NULL	0	NULL	NULL
	3	2	three	NULL	NULL	0	NULL
	3	2	three	NULL	NULL	1	-1
	3	2	three	NULL	NULL	2	2
	3	2	three	NULL	NULL	2	4
	3	2	three	NULL	NULL	3	-3
	3	2	three	NULL	NULL	5	-5
	3	2	three	NULL	NULL	5	-5
	3	2	three	NULL	NULL	NULL	0
	3	2	three	NULL	NULL	NULL	NULL
	4	1	four	0	NULL	0	NULL
	4	1	four	0	NULL	1	-1
	4	1	four	0	NULL	2	2
	4	1	four	0	NULL	2	4
	4	1	four	0	NULL	3	-3
	4	1	four	0	NULL	5	-5
	4	1	four	0	NULL	5	-5
	4	1	four	0	NULL	NULL	0
	4	1	four	0	NULL	NULL	NULL
	4	1	four	1	-1	0	NULL
	4	1	four	1	-1	1	-1
	4	1	four	1	-1	2	2
	4	1	four	1	-1	2	4
	4	1	four	1	-1	3	-3
	4	1	four	1	-1	5	-5
	4	1	four	1	-1	5	-5
	4	1	four	1	-1	NULL	0
	4	1	four	1	-1	NULL	NULL
	4	1	four	2	2	0	NULL
	4	1	four	2	2	1	-1
	4	1	four	2	2	2	2
	4	1	four	2	2	2	4
	4	1	four	2	2	3	-3
	4	1	four	2	2	5	-5
	4	1	four	2	2	5	-5
	4	1	four	2	2	NULL	0
	4	1	four	2	2	NULL	NULL
	4	1	four	2	4	0	NULL
	4	1	four	2	4	1	-1
	4	1	four	2	4	2	2
	4	1	four	2	4	2	4
	4	1	four	2	4	3	-3
	4	1	four	2	4	5	-5
	4	1	four	2	4	5	-5
	4	1	four	2	4	NULL	0
	4	1	four	2	4	NULL	NULL
	4	1	four	3	-3	0	NULL
	4	1	four	3	-3	1	-1
	4	1	four	3	-3	2	2
	4	1	four	3	-3	2	4
	4	1	four	3	-3	3	-3
	4	1	four	3	-3	5	-5
	4	1	four	3	-3	5	-5
	4	1	four	3	-3	NULL	0
	4	1	four	3	-3	NULL	NULL
	4	1	four	5	-5	0	NULL
	4	1	four	5	-5	0	NULL
	4	1	four	5	-5	1	-1
	4	1	four	5	-5	1	-1
	4	1	four	5	-5	2	2
	4	1	four	5	-5	2	2
	4	1	four	5	-5	2	4
	4	1	four	5	-5	2	4
	4	1	four	5	-5	3	-3
	4	1	four	5	-5	3	-3
	4	1	four	5	-5	5	-5
	4	1	four	5	-5	5	-5
	4	1	four	5	-5	5	-5
	4	1	four	5	-5	5	-5
	4	1	four	5	-5	NULL	0
	4	1	four	5	-5	NULL	0
	4	1	four	5	-5	NULL	NULL
	4	1	four	5	-5	NULL	NULL
	4	1	four	NULL	0	0	NULL
	4	1	four	NULL	0	1	-1
	4	1	four	NULL	0	2	2
	4	1	four	NULL	0	2	4
	4	1	four	NULL	0	3	-3
	4	1	four	NULL	0	5	-5
	4	1	four	NULL	0	5	-5
	4	1	four	NULL	0	NULL	0
	4	1	four	NULL	0	NULL	NULL
	4	1	four	NULL	NULL	0	NULL
	4	1	four	NULL	NULL	1	-1
	4	1	four	NULL	NULL	2	2
	4	1	four	NULL	NULL	2	4
	4	1	four	NULL	NULL	3	-3
	4	1	four	NULL	NULL	5	-5
	4	1	four	NULL	NULL	5	-5
	4	1	four	NULL	NULL	NULL	0
	4	1	four	NULL	NULL	NULL	NULL
	5	0	five	0	NULL	0	NULL
	5	0	five	0	NULL	1	-1
	5	0	five	0	NULL	2	2
	5	0	five	0	NULL	2	4
	5	0	five	0	NULL	3	-3
	5	0	five	0	NULL	5	-5
	5	0	five	0	NULL	5	-5
	5	0	five	0	NULL	NULL	0
	5	0	five	0	NULL	NULL	NULL
	5	0	five	1	-1	0	NULL
	5	0	five	1	-1	1	-1
	5	0	five	1	-1	2	2
	5	0	five	1	-1	2	4
	5	0	five	1	-1	3	-3
	5	0	five	1	-1	5	-5
	5	0	five	1	-1	5	-5
	5	0	five	1	-1	NULL	0
	5	0	five	1	-1	NULL	NULL
	5	0	five	2	2	0	NULL
	5	0	five	2	2	1	-1
	5	0	five	2	2	2	2
	5	0	five	2	2	2	4
	5	0	five	2	2	3	-3
	5	0	five	2	2	5	-5
	5	0	five	2	2	5	-5
	5	0	five	2	2	NULL	0
	5	0	five	2	2	NULL	NULL
	5	0	five	2	4	0	NULL
	5	0	five	2	4	1	-1
	5	0	five	2	4	2	2
	5	0	five	2	4	2	4
	5	0	five	2	4	3	-3
	5	0	five	2	4	5	-5
	5	0	five	2	4	5	-5
	5	0	five	2	4	NULL	0
	5	0	five	2	4	NULL	NULL
	5	0	five	3	-3	0	NULL
	5	0	five	3	-3	1	-1
	5	0	five	3	-3	2	2
	5	0	five	3	-3	2	4
	5	0	five	3	-3	3	-3
	5	0	five	3	-3	5	-5
	5	0	five	3	-3	5	-5
	5	0	five	3	-3	NULL	0
	5	0	five	3	-3	NULL	NULL
	5	0	five	5	-5	0	NULL
	5	0	five	5	-5	0	NULL
	5	0	five	5	-5	1	-1
	5	0	five	5	-5	1	-1
	5	0	five	5	-5	2	2
	5	0	five	5	-5	2	2
	5	0	five	5	-5	2	4
	5	0	five	5	-5	2	4
	5	0	five	5	-5	3	-3
	5	0	five	5	-5	3	-3
	5	0	five	5	-5	5	-5
	5	0	five	5	-5	5	-5
	5	0	five	5	-5	5	-5
	5	0	five	5	-5	5	-5
	5	0	five	5	-5	NULL	0
	5	0	five	5	-5	NULL	0
	5	0	five	5	-5	NULL	NULL
	5	0	five	5	-5	NULL	NULL
	5	0	five	NULL	0	0	NULL
	5	0	five	NULL	0	1	-1
	5	0	five	NULL	0	2	2
	5	0	five	NULL	0	2	4
	5	0	five	NULL	0	3	-3
	5	0	five	NULL	0	5	-5
	5	0	five	NULL	0	5	-5
	5	0	five	NULL	0	NULL	0
	5	0	five	NULL	0	NULL	NULL
	5	0	five	NULL	NULL	0	NULL
	5	0	five	NULL	NULL	1	-1
	5	0	five	NULL	NULL	2	2
	5	0	five	NULL	NULL	2	4
	5	0	five	NULL	NULL	3	-3
	5	0	five	NULL	NULL	5	-5
	5	0	five	NULL	NULL	5	-5
	5	0	five	NULL	NULL	NULL	0
	5	0	five	NULL	NULL	NULL	NULL
	6	6	six	0	NULL	0	NULL
	6	6	six	0	NULL	1	-1
	6	6	six	0	NULL	2	2
	6	6	six	0	NULL	2	4
	6	6	six	0	NULL	3	-3
	6	6	six	0	NULL	5	-5
	6	6	six	0	NULL	5	-5
	6	6	six	0	NULL	NULL	0
	6	6	six	0	NULL	NULL	NULL
	6	6	six	1	-1	0	NULL
	6	6	six	1	-1	1	-1
	6	6	six	1	-1	2	2
	6	6	six	1	-1	2	4
	6	6	six	1	-1	3	-3
	6	6	six	1	-1	5	-5
	6	6	six	1	-1	5	-5
	6	6	six	1	-1	NULL	0
	6	6	six	1	-1	NULL	NULL
	6	6	six	2	2	0	NULL
	6	6	six	2	2	1	-1
	6	6	six	2	2	2	2
	6	6	six	2	2	2	4
	6	6	six	2	2	3	-3
	6	6	six	2	2	5	-5
	6	6	six	2	2	5	-5
	6	6	six	2	2	NULL	0
	6	6	six	2	2	NULL	NULL
	6	6	six	2	4	0	NULL
	6	6	six	2	4	1	-1
	6	6	six	2	4	2	2
	6	6	six	2	4	2	4
	6	6	six	2	4	3	-3
	6	6	six	2	4	5	-5
	6	6	six	2	4	5	-5
	6	6	six	2	4	NULL	0
	6	6	six	2	4	NULL	NULL
	6	6	six	3	-3	0	NULL
	6	6	six	3	-3	1	-1
	6	6	six	3	-3	2	2
	6	6	six	3	-3	2	4
	6	6	six	3	-3	3	-3
	6	6	six	3	-3	5	-5
	6	6	six	3	-3	5	-5
	6	6	six	3	-3	NULL	0
	6	6	six	3	-3	NULL	NULL
	6	6	six	5	-5	0	NULL
	6	6	six	5	-5	0	NULL
	6	6	six	5	-5	1	-1
	6	6	six	5	-5	1	-1
	6	6	six	5	-5	2	2
	6	6	six	5	-5	2	2
	6	6	six	5	-5	2	4
	6	6	six	5	-5	2	4
	6	6	six	5	-5	3	-3
	6	6	six	5	-5	3	-3
	6	6	six	5	-5	5	-5
	6	6	six	5	-5	5	-5
	6	6	six	5	-5	5	-5
	6	6	six	5	-5	5	-5
	6	6	six	5	-5	NULL	0
	6	6	six	5	-5	NULL	0
	6	6	six	5	-5	NULL	NULL
	6	6	six	5	-5	NULL	NULL
	6	6	six	NULL	0	0	NULL
	6	6	six	NULL	0	1	-1
	6	6	six	NULL	0	2	2
	6	6	six	NULL	0	2	4
	6	6	six	NULL	0	3	-3
	6	6	six	NULL	0	5	-5
	6	6	six	NULL	0	5	-5
	6	6	six	NULL	0	NULL	0
	6	6	six	NULL	0	NULL	NULL
	6	6	six	NULL	NULL	0	NULL
	6	6	six	NULL	NULL	1	-1
	6	6	six	NULL	NULL	2	2
	6	6	six	NULL	NULL	2	4
	6	6	six	NULL	NULL	3	-3
	6	6	six	NULL	NULL	5	-5
	6	6	six	NULL	NULL	5	-5
	6	6	six	NULL	NULL	NULL	0
	6	6	six	NULL	NULL	NULL	NULL
	7	7	seven	0	NULL	0	NULL
	7	7	seven	0	NULL	1	-1
	7	7	seven	0	NULL	2	2
	7	7	seven	0	NULL	2	4
	7	7	seven	0	NULL	3	-3
	7	7	seven	0	NULL	5	-5
	7	7	seven	0	NULL	5	-5
	7	7	seven	0	NULL	NULL	0
	7	7	seven	0	NULL	NULL	NULL
	7	7	seven	1	-1	0	NULL
	7	7	seven	1	-1	1	-1
	7	7	seven	1	-1	2	2
	7	7	seven	1	-1	2	4
	7	7	seven	1	-1	3	-3
	7	7	seven	1	-1	5	-5
	7	7	seven	1	-1	5	-5
	7	7	seven	1	-1	NULL	0
	7	7	seven	1	-1	NULL	NULL
	7	7	seven	2	2	0	NULL
	7	7	seven	2	2	1	-1
	7	7	seven	2	2	2	2
	7	7	seven	2	2	2	4
	7	7	seven	2	2	3	-3
	7	7	seven	2	2	5	-5
	7	7	seven	2	2	5	-5
	7	7	seven	2	2	NULL	0
	7	7	seven	2	2	NULL	NULL
	7	7	seven	2	4	0	NULL
	7	7	seven	2	4	1	-1
	7	7	seven	2	4	2	2
	7	7	seven	2	4	2	4
	7	7	seven	2	4	3	-3
	7	7	seven	2	4	5	-5
	7	7	seven	2	4	5	-5
	7	7	seven	2	4	NULL	0
	7	7	seven	2	4	NULL	NULL
	7	7	seven	3	-3	0	NULL
	7	7	seven	3	-3	1	-1
	7	7	seven	3	-3	2	2
	7	7	seven	3	-3	2	4
	7	7	seven	3	-3	3	-3
	7	7	seven	3	-3	5	-5
	7	7	seven	3	-3	5	-5
	7	7	seven	3	-3	NULL	0
	7	7	seven	3	-3	NULL	NULL
	7	7	seven	5	-5	0	NULL
	7	7	seven	5	-5	0	NULL
	7	7	seven	5	-5	1	-1
	7	7	seven	5	-5	1	-1
	7	7	seven	5	-5	2	2
	7	7	seven	5	-5	2	2
	7	7	seven	5	-5	2	4
	7	7	seven	5	-5	2	4
	7	7	seven	5	-5	3	-3
	7	7	seven	5	-5	3	-3
	7	7	seven	5	-5	5	-5
	7	7	seven	5	-5	5	-5
	7	7	seven	5	-5	5	-5
	7	7	seven	5	-5	5	-5
	7	7	seven	5	-5	NULL	0
	7	7	seven	5	-5	NULL	0
	7	7	seven	5	-5	NULL	NULL
	7	7	seven	5	-5	NULL	NULL
	7	7	seven	NULL	0	0	NULL
	7	7	seven	NULL	0	1	-1
	7	7	seven	NULL	0	2	2
	7	7	seven	NULL	0	2	4
	7	7	seven	NULL	0	3	-3
	7	7	seven	NULL	0	5	-5
	7	7	seven	NULL	0	5	-5
	7	7	seven	NULL	0	NULL	0
	7	7	seven	NULL	0	NULL	NULL
	7	7	seven	NULL	NULL	0	NULL
	7	7	seven	NULL	NULL	1	-1
	7	7	seven	NULL	NULL	2	2
	7	7	seven	NULL	NULL	2	4
	7	7	seven	NULL	NULL	3	-3
	7	7	seven	NULL	NULL	5	-5
	7	7	seven	NULL	NULL	5	-5
	7	7	seven	NULL	NULL	NULL	0
	7	7	seven	NULL	NULL	NULL	NULL
	8	8	eight	0	NULL	0	NULL
	8	8	eight	0	NULL	1	-1
	8	8	eight	0	NULL	2	2
	8	8	eight	0	NULL	2	4
	8	8	eight	0	NULL	3	-3
	8	8	eight	0	NULL	5	-5
	8	8	eight	0	NULL	5	-5
	8	8	eight	0	NULL	NULL	0
	8	8	eight	0	NULL	NULL	NULL
	8	8	eight	1	-1	0	NULL
	8	8	eight	1	-1	1	-1
	8	8	eight	1	-1	2	2
	8	8	eight	1	-1	2	4
	8	8	eight	1	-1	3	-3
	8	8	eight	1	-1	5	-5
	8	8	eight	1	-1	5	-5
	8	8	eight	1	-1	NULL	0
	8	8	eight	1	-1	NULL	NULL
	8	8	eight	2	2	0	NULL
	8	8	eight	2	2	1	-1
	8	8	eight	2	2	2	2
	8	8	eight	2	2	2	4
	8	8	eight	2	2	3	-3
	8	8	eight	2	2	5	-5
	8	8	eight	2	2	5	-5
	8	8	eight	2	2	NULL	0
	8	8	eight	2	2	NULL	NULL
	8	8	eight	2	4	0	NULL
	8	8	eight	2	4	1	-1
	8	8	eight	2	4	2	2
	8	8	eight	2	4	2	4
	8	8	eight	2	4	3	-3
	8	8	eight	2	4	5	-5
	8	8	eight	2	4	5	-5
	8	8	eight	2	4	NULL	0
	8	8	eight	2	4	NULL	NULL
	8	8	eight	3	-3	0	NULL
	8	8	eight	3	-3	1	-1
	8	8	eight	3	-3	2	2
	8	8	eight	3	-3	2	4
	8	8	eight	3	-3	3	-3
	8	8	eight	3	-3	5	-5
	8	8	eight	3	-3	5	-5
	8	8	eight	3	-3	NULL	0
	8	8	eight	3	-3	NULL	NULL
	8	8	eight	5	-5	0	NULL
	8	8	eight	5	-5	0	NULL
	8	8	eight	5	-5	1	-1
	8	8	eight	5	-5	1	-1
	8	8	eight	5	-5	2	2
	8	8	eight	5	-5	2	2
	8	8	eight	5	-5	2	4
	8	8	eight	5	-5	2	4
	8	8	eight	5	-5	3	-3
	8	8	eight	5	-5	3	-3
	8	8	eight	5	-5	5	-5
	8	8	eight	5	-5	5	-5
	8	8	eight	5	-5	5	-5
	8	8	eight	5	-5	5	-5
	8	8	eight	5	-5	NULL	0
	8	8	eight	5	-5	NULL	0
	8	8	eight	5	-5	NULL	NULL
	8	8	eight	5	-5	NULL	NULL
	8	8	eight	NULL	0	0	NULL
	8	8	eight	NULL	0	1	-1
	8	8	eight	NULL	0	2	2
	8	8	eight	NULL	0	2	4
	8	8	eight	NULL	0	3	-3
	8	8	eight	NULL	0	5	-5
	8	8	eight	NULL	0	5	-5
	8	8	eight	NULL	0	NULL	0
	8	8	eight	NULL	0	NULL	NULL
	8	8	eight	NULL	NULL	0	NULL
	8	8	eight	NULL	NULL	1	-1
	8	8	eight	NULL	NULL	2	2
	8	8	eight	NULL	NULL	2	4
	8	8	eight	NULL	NULL	3	-3
	8	8	eight	NULL	NULL	5	-5
	8	8	eight	NULL	NULL	5	-5
	8	8	eight	NULL	NULL	NULL	0
	8	8	eight	NULL	NULL	NULL	NULL
	NULL	0	zero	0	NULL	0	NULL
	NULL	0	zero	0	NULL	1	-1
	NULL	0	zero	0	NULL	2	2
	NULL	0	zero	0	NULL	2	4
	NULL	0	zero	0	NULL	3	-3
	NULL	0	zero	0	NULL	5	-5
	NULL	0	zero	0	NULL	5	-5
	NULL	0	zero	0	NULL	NULL	0
	NULL	0	zero	0	NULL	NULL	NULL
	NULL	0	zero	1	-1	0	NULL
	NULL	0	zero	1	-1	1	-1
	NULL	0	zero	1	-1	2	2
	NULL	0	zero	1	-1	2	4
	NULL	0	zero	1	-1	3	-3
	NULL	0	zero	1	-1	5	-5
	NULL	0	zero	1	-1	5	-5
	NULL	0	zero	1	-1	NULL	0
	NULL	0	zero	1	-1	NULL	NULL
	NULL	0	zero	2	2	0	NULL
	NULL	0	zero	2	2	1	-1
	NULL	0	zero	2	2	2	2
	NULL	0	zero	2	2	2	4
	NULL	0	zero	2	2	3	-3
	NULL	0	zero	2	2	5	-5
	NULL	0	zero	2	2	5	-5
	NULL	0	zero	2	2	NULL	0
	NULL	0	zero	2	2	NULL	NULL
	NULL	0	zero	2	4	0	NULL
	NULL	0	zero	2	4	1	-1
	NULL	0	zero	2	4	2	2
	NULL	0	zero	2	4	2	4
	NULL	0	zero	2	4	3	-3
	NULL	0	zero	2	4	5	-5
	NULL	0	zero	2	4	5	-5
	NULL	0	zero	2	4	NULL	0
	NULL	0	zero	2	4	NULL	NULL
	NULL	0	zero	3	-3	0	NULL
	NULL	0	zero	3	-3	1	-1
	NULL	0	zero	3	-3	2	2
	NULL	0	zero	3	-3	2	4
	NULL	0	zero	3	-3	3	-3
	NULL	0	zero	3	-3	5	-5
	NULL	0	zero	3	-3	5	-5
	NULL	0	zero	3	-3	NULL	0
	NULL	0	zero	3	-3	NULL	NULL
	NULL	0	zero	5	-5	0	NULL
	NULL	0	zero	5	-5	0	NULL
	NULL	0	zero	5	-5	1	-1
	NULL	0	zero	5	-5	1	-1
	NULL	0	zero	5	-5	2	2
	NULL	0	zero	5	-5	2	2
	NULL	0	zero	5	-5	2	4
	NULL	0	zero	5	-5	2	4
	NULL	0	zero	5	-5	3	-3
	NULL	0	zero	5	-5	3	-3
	NULL	0	zero	5	-5	5	-5
	NULL	0	zero	5	-5	5	-5
	NULL	0	zero	5	-5	5	-5
	NULL	0	zero	5	-5	5	-5
	NULL	0	zero	5	-5	NULL	0
	NULL	0	zero	5	-5	NULL	0
	NULL	0	zero	5	-5	NULL	NULL
	NULL	0	zero	5	-5	NULL	NULL
	NULL	0	zero	NULL	0	0	NULL
	NULL	0	zero	NULL	0	1	-1
	NULL	0	zero	NULL	0	2	2
	NULL	0	zero	NULL	0	2	4
	NULL	0	zero	NULL	0	3	-3
	NULL	0	zero	NULL	0	5	-5
	NULL	0	zero	NULL	0	5	-5
	NULL	0	zero	NULL	0	NULL	0
	NULL	0	zero	NULL	0	NULL	NULL
	NULL	0	zero	NULL	NULL	0	NULL
	NULL	0	zero	NULL	NULL	1	-1
	NULL	0	zero	NULL	NULL	2	2
	NULL	0	zero	NULL	NULL	2	4
	NULL	0	zero	NULL	NULL	3	-3
	NULL	0	zero	NULL	NULL	5	-5
	NULL	0	zero	NULL	NULL	5	-5
	NULL	0	zero	NULL	NULL	NULL	0
	NULL	0	zero	NULL	NULL	NULL	NULL
	NULL	NULL	null	0	NULL	0	NULL
	NULL	NULL	null	0	NULL	1	-1
	NULL	NULL	null	0	NULL	2	2
	NULL	NULL	null	0	NULL	2	4
	NULL	NULL	null	0	NULL	3	-3
	NULL	NULL	null	0	NULL	5	-5
	NULL	NULL	null	0	NULL	5	-5
	NULL	NULL	null	0	NULL	NULL	0
	NULL	NULL	null	0	NULL	NULL	NULL
	NULL	NULL	null	1	-1	0	NULL
	NULL	NULL	null	1	-1	1	-1
	NULL	NULL	null	1	-1	2	2
	NULL	NULL	null	1	-1	2	4
	NULL	NULL	null	1	-1	3	-3
	NULL	NULL	null	1	-1	5	-5
	NULL	NULL	null	1	-1	5	-5
	NULL	NULL	null	1	-1	NULL	0
	NULL	NULL	null	1	-1	NULL	NULL
	NULL	NULL	null	2	2	0	NULL
	NULL	NULL	null	2	2	1	-1
	NULL	NULL	null	2	2	2	2
	NULL	NULL	null	2	2	2	4
	NULL	NULL	null	2	2	3	-3
	NULL	NULL	null	2	2	5	-5
	NULL	NULL	null	2	2	5	-5
	NULL	NULL	null	2	2	NULL	0
	NULL	NULL	null	2	2	NULL	NULL
	NULL	NULL	null	2	4	0	NULL
	NULL	NULL	null	2	4	1	-1
	NULL	NULL	null	2	4	2	2
	NULL	NULL	null	2	4	2	4
	NULL	NULL	null	2	4	3	-3
	NULL	NULL	null	2	4	5	-5
	NULL	NULL	null	2	4	5	-5
	NULL	NULL	null	2	4	NULL	0
	NULL	NULL	null	2	4	NULL	NULL
	NULL	NULL	null	3	-3	0	NULL
	NULL	NULL	null	3	-3	1	-1
	NULL	NULL	null	3	-3	2	2
	NULL	NULL	null	3	-3	2	4
	NULL	NULL	null	3	-3	3	-3
	NULL	NULL	null	3	-3	5	-5
	NULL	NULL	null	3	-3	5	-5
	NULL	NULL	null	3	-3	NULL	0
	NULL	NULL	null	3	-3	NULL	NULL
	NULL	NULL	null	5	-5	0	NULL
	NULL	NULL	null	5	-5	0	NULL
	NULL	NULL	null	5	-5	1	-1
	NULL	NULL	null	5	-5	1	-1
	NULL	NULL	null	5	-5	2	2
	NULL	NULL	null	5	-5	2	2
	NULL	NULL	null	5	-5	2	4
	NULL	NULL	null	5	-5	2	4
	NULL	NULL	null	5	-5	3	-3
	NULL	NULL	null	5	-5	3	-3
	NULL	NULL	null	5	-5	5	-5
	NULL	NULL	null	5	-5	5	-5
	NULL	NULL	null	5	-5	5	-5
	NULL	NULL	null	5	-5	5	-5
	NULL	NULL	null	5	-5	NULL	0
	NULL	NULL	null	5	-5	NULL	0
	NULL	NULL	null	5	-5	NULL	NULL
	NULL	NULL	null	5	-5	NULL	NULL
	NULL	NULL	null	NULL	0	0	NULL
	NULL	NULL	null	NULL	0	1	-1
	NULL	NULL	null	NULL	0	2	2
	NULL	NULL	null	NULL	0	2	4
	NULL	NULL	null	NULL	0	3	-3
	NULL	NULL	null	NULL	0	5	-5
	NULL	NULL	null	NULL	0	5	-5
	NULL	NULL	null	NULL	0	NULL	0
	NULL	NULL	null	NULL	0	NULL	NULL
	NULL	NULL	null	NULL	NULL	0	NULL
	NULL	NULL	null	NULL	NULL	1	-1
	NULL	NULL	null	NULL	NULL	2	2
	NULL	NULL	null	NULL	NULL	2	4
	NULL	NULL	null	NULL	NULL	3	-3
	NULL	NULL	null	NULL	NULL	5	-5
	NULL	NULL	null	NULL	NULL	5	-5
	NULL	NULL	null	NULL	NULL	NULL	0
	NULL	NULL	null	NULL	NULL	NULL	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i) AS i, udf(j), udf(t) AS t, udf(k)
  FROM J1_TBL INNER JOIN J2_TBL USING (i)
-- !query schema
struct<xxx:string,i:int,udf(j):int,t:string,udf(k):int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5


-- !query
SELECT udf(udf('')) AS `xxx`, udf(i), udf(j) AS j, udf(t), udf(k) AS k
  FROM J1_TBL JOIN J2_TBL USING (i)
-- !query schema
struct<xxx:string,udf(i):int,j:int,udf(t):string,k:int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5


-- !query
SELECT udf('') AS `xxx`, *
  FROM J1_TBL t1 (a, b, c) JOIN J2_TBL t2 (a, d) USING (a)
  ORDER BY udf(udf(a)), udf(d)
-- !query schema
struct<xxx:string,a:int,b:int,c:string,d:int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5


-- !query
SELECT udf(udf('')) AS `xxx`, udf(i), udf(j), udf(t), udf(k)
  FROM J1_TBL NATURAL JOIN J2_TBL
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string,udf(k):int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5


-- !query
SELECT udf('') AS `xxx`, udf(udf(udf(a))) AS a, udf(b), udf(c), udf(d)
  FROM J1_TBL t1 (a, b, c) NATURAL JOIN J2_TBL t2 (a, d)
-- !query schema
struct<xxx:string,a:int,udf(b):int,udf(c):string,udf(d):int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5


-- !query
SELECT udf('') AS `xxx`, udf(udf(a)), udf(udf(b)), udf(udf(c)) AS c, udf(udf(udf(d))) AS d
  FROM J1_TBL t1 (a, b, c) NATURAL JOIN J2_TBL t2 (d, a)
-- !query schema
struct<xxx:string,udf(udf(a)):int,udf(udf(b)):int,c:string,d:int>
-- !query output
	0	NULL	zero	NULL
	2	3	two	2
	4	1	four	2


-- !query
SELECT udf('') AS `xxx`, udf(J1_TBL.i), udf(udf(J1_TBL.j)), udf(J1_TBL.t), udf(J2_TBL.i), udf(J2_TBL.k)
  FROM J1_TBL JOIN J2_TBL ON (udf(J1_TBL.i) = J2_TBL.i)
-- !query schema
struct<xxx:string,udf(i):int,udf(udf(j)):int,udf(t):string,udf(i):int,udf(k):int>
-- !query output
	0	NULL	zero	0	NULL
	1	4	one	1	-1
	2	3	two	2	2
	2	3	two	2	4
	3	2	three	3	-3
	5	0	five	5	-5
	5	0	five	5	-5


-- !query
SELECT udf('') AS `xxx`, udf(udf(J1_TBL.i)), udf(udf(J1_TBL.j)), udf(udf(J1_TBL.t)), J2_TBL.i, J2_TBL.k
  FROM J1_TBL JOIN J2_TBL ON (J1_TBL.i = udf(J2_TBL.k))
-- !query schema
struct<xxx:string,udf(udf(i)):int,udf(udf(j)):int,udf(udf(t)):string,i:int,k:int>
-- !query output
	0	NULL	zero	NULL	0
	2	3	two	2	2
	4	1	four	2	4


-- !query
SELECT udf('') AS `xxx`, udf(J1_TBL.i), udf(J1_TBL.j), udf(J1_TBL.t), udf(J2_TBL.i), udf(J2_TBL.k)
  FROM J1_TBL JOIN J2_TBL ON (udf(J1_TBL.i) <= udf(udf(J2_TBL.k)))
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string,udf(i):int,udf(k):int>
-- !query output
	0	NULL	zero	2	2
	0	NULL	zero	2	4
	0	NULL	zero	NULL	0
	1	4	one	2	2
	1	4	one	2	4
	2	3	two	2	2
	2	3	two	2	4
	3	2	three	2	4
	4	1	four	2	4


-- !query
SELECT udf(udf('')) AS `xxx`, udf(i), udf(j), udf(t), udf(k)
  FROM J1_TBL LEFT OUTER JOIN J2_TBL USING (i)
  ORDER BY udf(udf(i)), udf(k), udf(t)
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string,udf(k):int>
-- !query output
	NULL	NULL	null	NULL
	NULL	0	zero	NULL
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	4	1	four	NULL
	5	0	five	-5
	5	0	five	-5
	6	6	six	NULL
	7	7	seven	NULL
	8	8	eight	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i), udf(j), udf(t), udf(k)
  FROM J1_TBL LEFT JOIN J2_TBL USING (i)
  ORDER BY udf(i), udf(udf(k)), udf(t)
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string,udf(k):int>
-- !query output
	NULL	NULL	null	NULL
	NULL	0	zero	NULL
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	4	1	four	NULL
	5	0	five	-5
	5	0	five	-5
	6	6	six	NULL
	7	7	seven	NULL
	8	8	eight	NULL


-- !query
SELECT udf('') AS `xxx`, udf(udf(i)), udf(j), udf(t), udf(k)
  FROM J1_TBL RIGHT OUTER JOIN J2_TBL USING (i)
-- !query schema
struct<xxx:string,udf(udf(i)):int,udf(j):int,udf(t):string,udf(k):int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5
	NULL	NULL	NULL	0
	NULL	NULL	NULL	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i), udf(udf(j)), udf(t), udf(k)
  FROM J1_TBL RIGHT JOIN J2_TBL USING (i)
-- !query schema
struct<xxx:string,udf(i):int,udf(udf(j)):int,udf(t):string,udf(k):int>
-- !query output
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	5	0	five	-5
	5	0	five	-5
	NULL	NULL	NULL	0
	NULL	NULL	NULL	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i), udf(j), udf(udf(t)), udf(k)
  FROM J1_TBL FULL OUTER JOIN J2_TBL USING (i)
  ORDER BY udf(udf(i)), udf(k), udf(t)
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(udf(t)):string,udf(k):int>
-- !query output
	NULL	NULL	NULL	NULL
	NULL	NULL	null	NULL
	NULL	0	zero	NULL
	NULL	NULL	NULL	0
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	4	1	four	NULL
	5	0	five	-5
	5	0	five	-5
	6	6	six	NULL
	7	7	seven	NULL
	8	8	eight	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i), udf(j), t, udf(udf(k))
  FROM J1_TBL FULL JOIN J2_TBL USING (i)
  ORDER BY udf(udf(i)), udf(k), udf(udf(t))
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,t:string,udf(udf(k)):int>
-- !query output
	NULL	NULL	NULL	NULL
	NULL	NULL	null	NULL
	NULL	0	zero	NULL
	NULL	NULL	NULL	0
	0	NULL	zero	NULL
	1	4	one	-1
	2	3	two	2
	2	3	two	4
	3	2	three	-3
	4	1	four	NULL
	5	0	five	-5
	5	0	five	-5
	6	6	six	NULL
	7	7	seven	NULL
	8	8	eight	NULL


-- !query
SELECT udf('') AS `xxx`, udf(i), udf(j), udf(t), udf(udf(k))
  FROM J1_TBL LEFT JOIN J2_TBL USING (i) WHERE (udf(k) = 1)
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string,udf(udf(k)):int>
-- !query output



-- !query
SELECT udf('') AS `xxx`, udf(i), udf(j), udf(t), udf(k)
  FROM J1_TBL LEFT JOIN J2_TBL USING (i) WHERE (udf(udf(i)) = udf(1))
-- !query schema
struct<xxx:string,udf(i):int,udf(j):int,udf(t):string,udf(k):int>
-- !query output
	1	4	one	-1


-- !query
CREATE TABLE t1 (name STRING, n INTEGER) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t2 (name STRING, n INTEGER) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t3 (name STRING, n INTEGER) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t1 VALUES ( 'bb', 11 )
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t2 VALUES ( 'bb', 12 )
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t2 VALUES ( 'cc', 22 )
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t2 VALUES ( 'ee', 42 )
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t3 VALUES ( 'bb', 13 )
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t3 VALUES ( 'cc', 23 )
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t3 VALUES ( 'dd', 33 )
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM t1 FULL JOIN t2 USING (name) FULL JOIN t3 USING (name)
-- !query schema
struct<name:string,n:int,n:int,n:int>
-- !query output
bb	11	12	13
cc	NULL	22	23
dd	NULL	NULL	33
ee	NULL	42	NULL


-- !query
SELECT * FROM
(SELECT udf(name) as name, t2.n FROM t2) as s2
INNER JOIN
(SELECT udf(udf(name)) as name, t3.n FROM t3) s3
USING (name)
-- !query schema
struct<name:string,n:int,n:int>
-- !query output
bb	12	13
cc	22	23


-- !query
SELECT * FROM
(SELECT udf(udf(name)) as name, t2.n FROM t2) as s2
LEFT JOIN
(SELECT udf(name) as name, t3.n FROM t3) s3
USING (name)
-- !query schema
struct<name:string,n:int,n:int>
-- !query output
bb	12	13
cc	22	23
ee	42	NULL


-- !query
SELECT udf(name), udf(udf(s2.n)), udf(s3.n) FROM
(SELECT * FROM t2) as s2
FULL JOIN
(SELECT * FROM t3) s3
USING (name)
-- !query schema
struct<udf(name):string,udf(udf(n)):int,udf(n):int>
-- !query output
bb	12	13
cc	22	23
dd	NULL	33
ee	42	NULL


-- !query
SELECT * FROM
(SELECT udf(udf(name)) as name, udf(n) as s2_n, udf(2) as s2_2 FROM t2) as s2
NATURAL INNER JOIN
(SELECT udf(name) as name, udf(udf(n)) as s3_n, udf(3) as s3_2 FROM t3) s3
-- !query schema
struct<name:string,s2_n:int,s2_2:int,s3_n:int,s3_2:int>
-- !query output
bb	12	2	13	3
cc	22	2	23	3


-- !query
SELECT * FROM
(SELECT udf(name) as name, udf(udf(n)) as s2_n, 2 as s2_2 FROM t2) as s2
NATURAL LEFT JOIN
(SELECT udf(udf(name)) as name, udf(n) as s3_n, 3 as s3_2 FROM t3) s3
-- !query schema
struct<name:string,s2_n:int,s2_2:int,s3_n:int,s3_2:int>
-- !query output
bb	12	2	13	3
cc	22	2	23	3
ee	42	2	NULL	NULL


-- !query
SELECT * FROM
(SELECT udf(name) as name, udf(n) as s2_n, 2 as s2_2 FROM t2) as s2
NATURAL FULL JOIN
(SELECT udf(udf(name)) as name, udf(udf(n)) as s3_n, 3 as s3_2 FROM t3) s3
-- !query schema
struct<name:string,s2_n:int,s2_2:int,s3_n:int,s3_2:int>
-- !query output
bb	12	2	13	3
cc	22	2	23	3
dd	NULL	NULL	33	3
ee	42	2	NULL	NULL


-- !query
SELECT * FROM
(SELECT udf(udf(name)) as name, udf(n) as s1_n, 1 as s1_1 FROM t1) as s1
NATURAL INNER JOIN
(SELECT udf(name) as name, udf(n) as s2_n, 2 as s2_2 FROM t2) as s2
NATURAL INNER JOIN
(SELECT udf(udf(udf(name))) as name, udf(n) as s3_n, 3 as s3_2 FROM t3) s3
-- !query schema
struct<name:string,s1_n:int,s1_1:int,s2_n:int,s2_2:int,s3_n:int,s3_2:int>
-- !query output
bb	11	1	12	2	13	3


-- !query
SELECT * FROM
(SELECT udf(name) as name, udf(n) as s1_n, udf(udf(1)) as s1_1 FROM t1) as s1
NATURAL FULL JOIN
(SELECT udf(name) as name, udf(udf(n)) as s2_n, udf(2) as s2_2 FROM t2) as s2
NATURAL FULL JOIN
(SELECT udf(udf(name)) as name, udf(n) as s3_n, udf(3) as s3_2 FROM t3) s3
-- !query schema
struct<name:string,s1_n:int,s1_1:int,s2_n:int,s2_2:int,s3_n:int,s3_2:int>
-- !query output
bb	11	1	12	2	13	3
cc	NULL	NULL	22	2	23	3
dd	NULL	NULL	NULL	NULL	33	3
ee	NULL	NULL	42	2	NULL	NULL


-- !query
SELECT name, udf(udf(s1_n)), udf(s2_n), udf(s3_n) FROM
(SELECT name, udf(udf(n)) as s1_n FROM t1) as s1
NATURAL FULL JOIN
  (SELECT * FROM
    (SELECT name, udf(n) as s2_n FROM t2) as s2
    NATURAL FULL JOIN
    (SELECT name, udf(udf(n)) as s3_n FROM t3) as s3
  ) ss2
-- !query schema
struct<name:string,udf(udf(s1_n)):int,udf(s2_n):int,udf(s3_n):int>
-- !query output
bb	11	12	13
cc	NULL	22	23
dd	NULL	NULL	33
ee	NULL	42	NULL


-- !query
SELECT * FROM
(SELECT name, n as s1_n FROM t1) as s1
NATURAL FULL JOIN
  (SELECT * FROM
    (SELECT name, udf(udf(n)) as s2_n, 2 as s2_2 FROM t2) as s2
    NATURAL FULL JOIN
    (SELECT name, udf(n) as s3_n FROM t3) as s3
  ) ss2
-- !query schema
struct<name:string,s1_n:int,s2_n:int,s2_2:int,s3_n:int>
-- !query output
bb	11	12	2	13
cc	NULL	22	2	23
dd	NULL	NULL	NULL	33
ee	NULL	42	2	NULL


-- !query
SELECT s1.name, udf(s1_n), s2.name, udf(udf(s2_n)) FROM
  (SELECT name, udf(n) as s1_n FROM t1) as s1
FULL JOIN
  (SELECT name, 2 as s2_n FROM t2) as s2
ON (udf(udf(s1_n)) = udf(s2_n))
-- !query schema
struct<name:string,udf(s1_n):int,name:string,udf(udf(s2_n)):int>
-- !query output
NULL	NULL	bb	2
NULL	NULL	cc	2
NULL	NULL	ee	2
bb	11	NULL	NULL


-- !query
create or replace temporary view x as select * from
  (values (1,11), (2,22), (3,null), (4,44), (5,null))
  as v(x1, x2)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view y as select * from
  (values (1,111), (2,222), (3,333), (4,null))
  as v(y1, y2)
-- !query schema
struct<>
-- !query output



-- !query
select udf(udf(x1)), udf(x2) from x
-- !query schema
struct<udf(udf(x1)):int,udf(x2):int>
-- !query output
1	11
2	22
3	NULL
4	44
5	NULL


-- !query
select udf(y1), udf(udf(y2)) from y
-- !query schema
struct<udf(y1):int,udf(udf(y2)):int>
-- !query output
1	111
2	222
3	333
4	NULL


-- !query
select * from x left join y on (udf(x1) = udf(udf(y1)) and udf(x2) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	11	1	111
2	22	2	222
3	NULL	NULL	NULL
4	44	4	NULL
5	NULL	NULL	NULL


-- !query
select * from x left join y on (udf(udf(x1)) = udf(y1) and udf(y2) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int>
-- !query output
1	11	1	111
2	22	2	222
3	NULL	3	333
4	44	NULL	NULL
5	NULL	NULL	NULL


-- !query
select * from (x left join y on (udf(x1) = udf(udf(y1)))) left join x xx(xx1,xx2)
on (udf(udf(x1)) = udf(xx1))
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
3	NULL	3	333	3	NULL
4	44	4	NULL	4	44
5	NULL	NULL	NULL	5	NULL


-- !query
select * from (x left join y on (udf(x1) = udf(y1))) left join x xx(xx1,xx2)
on (udf(x1) = xx1 and udf(x2) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
3	NULL	3	333	NULL	NULL
4	44	4	NULL	4	44
5	NULL	NULL	NULL	NULL	NULL


-- !query
select * from (x left join y on (x1 = udf(y1))) left join x xx(xx1,xx2)
on (udf(x1) = udf(udf(xx1)) and udf(y2) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
3	NULL	3	333	3	NULL
4	44	4	NULL	NULL	NULL
5	NULL	NULL	NULL	NULL	NULL


-- !query
select * from (x left join y on (udf(x1) = y1)) left join x xx(xx1,xx2)
on (udf(udf(x1)) = udf(xx1) and udf(udf(xx2)) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
3	NULL	3	333	NULL	NULL
4	44	4	NULL	4	44
5	NULL	NULL	NULL	NULL	NULL


-- !query
select * from (x left join y on (udf(udf(x1)) = udf(udf(y1)))) left join x xx(xx1,xx2)
on (udf(x1) = udf(xx1)) where (udf(x2) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
4	44	4	NULL	4	44


-- !query
select * from (x left join y on (udf(x1) = udf(y1))) left join x xx(xx1,xx2)
on (udf(x1) = xx1) where (udf(y2) is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
3	NULL	3	333	3	NULL


-- !query
select * from (x left join y on (udf(x1) = udf(y1))) left join x xx(xx1,xx2)
on (x1 = udf(xx1)) where (xx2 is not null)
-- !query schema
struct<x1:int,x2:int,y1:int,y2:int,xx1:int,xx2:int>
-- !query output
1	11	1	111	1	11
2	22	2	222	2	22
4	44	4	NULL	4	44


-- !query
select udf(udf(count(*))) from tenk1 a where udf(udf(unique1)) in
  (select udf(unique1) from tenk1 b join tenk1 c using (unique1)
   where udf(udf(b.unique2)) = udf(42))
-- !query schema
struct<udf(udf(count(1))):bigint>
-- !query output
1


-- !query
select udf(count(*)) from tenk1 x where
  udf(x.unique1) in (select udf(a.f1) from int4_tbl a,float8_tbl b where udf(udf(a.f1))=b.f1) and
  udf(x.unique1) = 0 and
  udf(x.unique1) in (select aa.f1 from int4_tbl aa,float8_tbl bb where aa.f1=udf(udf(bb.f1)))
-- !query schema
struct<udf(count(1)):bigint>
-- !query output
1


-- !query
select udf(udf(count(*))) from tenk1 x where
  udf(x.unique1) in (select udf(a.f1) from int4_tbl a,float8_tbl b where udf(udf(a.f1))=b.f1) and
  udf(x.unique1) = 0 and
  udf(udf(x.unique1)) in (select udf(aa.f1) from int4_tbl aa,float8_tbl bb where udf(aa.f1)=udf(udf(bb.f1)))
-- !query schema
struct<udf(udf(count(1))):bigint>
-- !query output
1


-- !query
select * from int8_tbl i1 left join (int8_tbl i2 join
  (select udf(123) as x) ss on udf(udf(i2.q1)) = udf(x)) on udf(udf(i1.q2)) = udf(udf(i2.q2))
order by udf(udf(1)), 2
-- !query schema
struct<q1:bigint,q2:bigint,q1:bigint,q2:bigint,x:int>
-- !query output
4567890123456789	-4567890123456789	NULL	NULL	NULL
4567890123456789	123	NULL	NULL	NULL
123	456	123	456	123
123	4567890123456789	123	4567890123456789	123
4567890123456789	4567890123456789	123	4567890123456789	123


-- !query
select udf(count(*))
from
  (select udf(t3.tenthous) as x1, udf(coalesce(udf(t1.stringu1), udf(t2.stringu1))) as x2
   from tenk1 t1
   left join tenk1 t2 on udf(t1.unique1) = udf(t2.unique1)
   join tenk1 t3 on t1.unique2 = udf(t3.unique2)) ss,
  tenk1 t4,
  tenk1 t5
where udf(t4.thousand) = udf(t5.unique1) and udf(udf(ss.x1)) = t4.tenthous and udf(ss.x2) = udf(udf(t5.stringu1))
-- !query schema
struct<udf(count(1)):bigint>
-- !query output
1000


-- !query
select udf(a.f1), udf(b.f1), udf(t.thousand), udf(t.tenthous) from
  tenk1 t,
  (select udf(udf(sum(udf(f1))+1)) as f1 from int4_tbl i4a) a,
  (select udf(sum(udf(f1))) as f1 from int4_tbl i4b) b
where b.f1 = udf(t.thousand) and udf(a.f1) = udf(b.f1) and udf((udf(a.f1)+udf(b.f1)+999)) = udf(udf(t.tenthous))
-- !query schema
struct<udf(f1):bigint,udf(f1):bigint,udf(thousand):int,udf(tenthous):int>
-- !query output



-- !query
select * from
  j1_tbl full join
  (select * from j2_tbl order by udf(udf(j2_tbl.i)) desc, udf(j2_tbl.k) asc) j2_tbl
  on udf(j1_tbl.i) = udf(j2_tbl.i) and udf(j1_tbl.i) = udf(j2_tbl.k)
-- !query schema
struct<i:int,j:int,t:string,i:int,k:int>
-- !query output
0	NULL	zero	NULL	NULL
1	4	one	NULL	NULL
2	3	two	2	2
3	2	three	NULL	NULL
4	1	four	NULL	NULL
5	0	five	NULL	NULL
6	6	six	NULL	NULL
7	7	seven	NULL	NULL
8	8	eight	NULL	NULL
NULL	0	zero	NULL	NULL
NULL	NULL	NULL	0	NULL
NULL	NULL	NULL	1	-1
NULL	NULL	NULL	2	4
NULL	NULL	NULL	3	-3
NULL	NULL	NULL	5	-5
NULL	NULL	NULL	5	-5
NULL	NULL	NULL	NULL	0
NULL	NULL	NULL	NULL	NULL
NULL	NULL	null	NULL	NULL


-- !query
select udf(count(*)) from
  (select * from tenk1 x order by udf(x.thousand), udf(udf(x.twothousand)), x.fivethous) x
  left join
  (select * from tenk1 y order by udf(y.unique2)) y
  on udf(x.thousand) = y.unique2 and x.twothousand = udf(y.hundred) and x.fivethous = y.unique2
-- !query schema
struct<udf(count(1)):bigint>
-- !query output
10000


-- !query
DROP TABLE t1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE t2
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE t3
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE J1_TBL
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE J2_TBL
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view tt1 as select * from
  (values (1, 11), (2, NULL))
  as v(tt1_id, joincol)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view tt2 as select * from
  (values (21, 11), (22, 11))
  as v(tt2_id, joincol)
-- !query schema
struct<>
-- !query output



-- !query
select tt1.*, tt2.* from tt1 left join tt2 on udf(udf(tt1.joincol)) = udf(tt2.joincol)
-- !query schema
struct<tt1_id:int,joincol:int,tt2_id:int,joincol:int>
-- !query output
1	11	21	11
1	11	22	11
2	NULL	NULL	NULL


-- !query
select tt1.*, tt2.* from tt2 right join tt1 on udf(udf(tt1.joincol)) = udf(udf(tt2.joincol))
-- !query schema
struct<tt1_id:int,joincol:int,tt2_id:int,joincol:int>
-- !query output
1	11	21	11
1	11	22	11
2	NULL	NULL	NULL


-- !query
select udf(count(*)) from tenk1 a, tenk1 b
  where udf(a.hundred) = b.thousand and udf(udf((b.fivethous % 10)) < 10)
-- !query schema
struct<udf(count(1)):bigint>
-- !query output
100000


-- !query
DROP TABLE IF EXISTS tt3
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE tt3(f1 int, f2 string) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO tt3 SELECT x.id, repeat('xyzzy', 100) FROM range(1,10001) x
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS tt4
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE tt4(f1 int) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO tt4 VALUES (0),(1),(9999)
-- !query schema
struct<>
-- !query output



-- !query
SELECT udf(udf(a.f1)) as f1
FROM tt4 a
LEFT JOIN (
        SELECT b.f1
        FROM tt3 b LEFT JOIN tt3 c ON udf(b.f1) = udf(c.f1)
        WHERE udf(c.f1) IS NULL
) AS d ON udf(a.f1) = d.f1
WHERE udf(udf(d.f1)) IS NULL
-- !query schema
struct<f1:int>
-- !query output
0
1
9999


-- !query
create or replace temporary view tt5 as select * from
  (values (1, 10), (1, 11))
  as v(f1, f2)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view tt6 as select * from
  (values (1, 9), (1, 2), (2, 9))
  as v(f1, f2)
-- !query schema
struct<>
-- !query output



-- !query
select * from tt5,tt6 where udf(tt5.f1) = udf(tt6.f1) and udf(tt5.f1) = udf(udf(tt5.f2) - udf(tt6.f2))
-- !query schema
struct<f1:int,f2:int,f1:int,f2:int>
-- !query output
1	10	1	9


-- !query
create or replace temporary view xx as select * from
  (values (1), (2), (3))
  as v(pkxx)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view yy as select * from
  (values (101, 1), (201, 2), (301, NULL))
  as v(pkyy, pkxx)
-- !query schema
struct<>
-- !query output



-- !query
select udf(udf(yy.pkyy)) as yy_pkyy, udf(yy.pkxx) as yy_pkxx, udf(yya.pkyy) as yya_pkyy,
       udf(xxa.pkxx) as xxa_pkxx, udf(xxb.pkxx) as xxb_pkxx
from yy
     left join (SELECT * FROM yy where pkyy = 101) as yya ON udf(yy.pkyy) = udf(yya.pkyy)
     left join xx xxa on udf(yya.pkxx) = udf(udf(xxa.pkxx))
     left join xx xxb on udf(udf(coalesce (xxa.pkxx, 1))) = udf(xxb.pkxx)
-- !query schema
struct<yy_pkyy:int,yy_pkxx:int,yya_pkyy:int,xxa_pkxx:int,xxb_pkxx:int>
-- !query output
101	1	101	1	1
201	2	NULL	NULL	1
301	NULL	NULL	NULL	1


-- !query
create or replace temporary view zt1 as select * from
  (values (53))
  as v(f1)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view zt2 as select * from
  (values (53))
  as v(f2)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view zt3(f3 int) using parquet
-- !query schema
struct<>
-- !query output



-- !query
select * from
  zt2 left join zt3 on (udf(f2) = udf(udf(f3)))
      left join zt1 on (udf(udf(f3)) = udf(f1))
where udf(f2) = 53
-- !query schema
struct<f2:int,f3:int,f1:int>
-- !query output
53	NULL	NULL


-- !query
create temp view zv1 as select *,'dummy' AS junk from zt1
-- !query schema
struct<>
-- !query output



-- !query
select * from
  zt2 left join zt3 on (f2 = udf(f3))
      left join zv1 on (udf(f3) = f1)
where udf(udf(f2)) = 53
-- !query schema
struct<f2:int,f3:int,f1:int,junk:string>
-- !query output
53	NULL	NULL	NULL


-- !query
select udf(a.unique2), udf(a.ten), udf(b.tenthous), udf(b.unique2), udf(b.hundred)
from tenk1 a left join tenk1 b on a.unique2 = udf(b.tenthous)
where udf(a.unique1) = 42 and
      ((udf(b.unique2) is null and udf(a.ten) = 2) or udf(udf(b.hundred)) = udf(udf(3)))
-- !query schema
struct<udf(unique2):int,udf(ten):int,udf(tenthous):int,udf(unique2):int,udf(hundred):int>
-- !query output



-- !query
create or replace temporary view a (i integer) using parquet
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view b (x integer, y integer) using parquet
-- !query schema
struct<>
-- !query output



-- !query
select * from a left join b on udf(i) = x and i = udf(y) and udf(x) = udf(i)
-- !query schema
struct<i:int,x:int,y:int>
-- !query output



-- !query
select udf(t1.q2), udf(count(t2.q1, t2.q2))
from int8_tbl t1 left join int8_tbl t2 on (udf(udf(t1.q2)) = t2.q1)
group by udf(t1.q2) order by 1
-- !query schema
struct<udf(q2):bigint,udf(count(q1, q2)):bigint>
-- !query output
-4567890123456789	0
123	2
456	0
4567890123456789	6


-- !query
select udf(udf(t1.q2)), udf(count(t2.q1, t2.q2))
from int8_tbl t1 left join (select * from int8_tbl) t2 on (udf(udf(t1.q2)) = udf(t2.q1))
group by udf(udf(t1.q2)) order by 1
-- !query schema
struct<udf(udf(q2)):bigint,udf(count(q1, q2)):bigint>
-- !query output
-4567890123456789	0
123	2
456	0
4567890123456789	6


-- !query
select udf(t1.q2) as q2, udf(udf(count(t2.q1, t2.q2)))
from int8_tbl t1 left join
  (select udf(q1) as q1, case when q2=1 then 1 else q2 end as q2 from int8_tbl) t2
  on (udf(t1.q2) = udf(t2.q1))
group by t1.q2 order by 1
-- !query schema
struct<q2:bigint,udf(udf(count(q1, q2))):bigint>
-- !query output
-4567890123456789	0
123	2
456	0
4567890123456789	6


-- !query
create or replace temporary view a as select * from
  (values ('p'), ('q'))
  as v(code)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view b as select * from
  (values ('p', 1), ('p', 2))
  as v(a, num)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view c as select * from
  (values ('A', 'p'), ('B', 'q'), ('C', null))
  as v(name, a)
-- !query schema
struct<>
-- !query output



-- !query
select udf(c.name), udf(ss.code), udf(ss.b_cnt), udf(ss.const)
from c left join
  (select a.code, coalesce(b_grp.cnt, 0) as b_cnt, -1 as const
   from a left join
     (select udf(count(1)) as cnt, b.a as a from b group by b.a) as b_grp
     on udf(a.code) = udf(udf(b_grp.a))
  ) as ss
  on (udf(udf(c.a)) = udf(ss.code))
order by c.name
-- !query schema
struct<udf(name):string,udf(code):string,udf(b_cnt):bigint,udf(const):int>
-- !query output
A	p	2	-1
B	q	0	-1
C	NULL	NULL	NULL


-- !query
SELECT * FROM
( SELECT 1 as key1 ) sub1
LEFT JOIN
( SELECT sub3.key3, sub4.value2, COALESCE(sub4.value2, 66) as value3 FROM
    ( SELECT 1 as key3 ) sub3
    LEFT JOIN
    ( SELECT udf(sub5.key5) as key5, udf(udf(COALESCE(sub6.value1, 1))) as value2 FROM
        ( SELECT 1 as key5 ) sub5
        LEFT JOIN
        ( SELECT 2 as key6, 42 as value1 ) sub6
        ON sub5.key5 = udf(sub6.key6)
    ) sub4
    ON udf(sub4.key5) = sub3.key3
) sub2
ON udf(udf(sub1.key1)) = udf(udf(sub2.key3))
-- !query schema
struct<key1:int,key3:int,value2:int,value3:int>
-- !query output
1	1	1	1


-- !query
SELECT * FROM
( SELECT 1 as key1 ) sub1
LEFT JOIN
( SELECT udf(sub3.key3) as key3, udf(value2), udf(COALESCE(value2, 66)) as value3 FROM
    ( SELECT 1 as key3 ) sub3
    LEFT JOIN
    ( SELECT sub5.key5, COALESCE(sub6.value1, 1) as value2 FROM
        ( SELECT 1 as key5 ) sub5
        LEFT JOIN
        ( SELECT 2 as key6, 42 as value1 ) sub6
        ON udf(udf(sub5.key5)) = sub6.key6
    ) sub4
    ON sub4.key5 = sub3.key3
) sub2
ON sub1.key1 = udf(udf(sub2.key3))
-- !query schema
struct<key1:int,key3:int,udf(value2):int,value3:int>
-- !query output
1	1	1	1


-- !query
SELECT udf(qq), udf(udf(unique1))
  FROM
  ( SELECT udf(COALESCE(q1, 0)) AS qq FROM int8_tbl a ) AS ss1
  FULL OUTER JOIN
  ( SELECT udf(udf(COALESCE(q2, -1))) AS qq FROM int8_tbl b ) AS ss2
  USING (qq)
  INNER JOIN tenk1 c ON udf(qq) = udf(unique2)
-- !query schema
struct<udf(qq):bigint,udf(udf(unique1)):int>
-- !query output
123	4596
123	4596
456	7318


-- !query
create or replace temporary view nt1 as select * from
  (values(1,true,true), (2,true,false), (3,false,false))
  as v(id, a1, a2)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view nt2 as select * from
  (values(1,1,true,true), (2,2,true,false), (3,3,false,false))
  as v(id, nt1_id, b1, b2)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view nt3 as select * from
  (values(1,1,true), (2,2,false), (3,3,true))
  as v(id, nt2_id, c1)
-- !query schema
struct<>
-- !query output



-- !query
select udf(nt3.id)
from nt3 as nt3
  left join
    (select nt2.*, (udf(nt2.b1) and udf(ss1.a3)) AS b3
     from nt2 as nt2
       left join
         (select nt1.*, (udf(nt1.id) is not null) as a3 from nt1) as ss1
         on ss1.id = udf(udf(nt2.nt1_id))
    ) as ss2
    on udf(ss2.id) = nt3.nt2_id
where udf(nt3.id) = 1 and udf(ss2.b3)
-- !query schema
struct<udf(id):int>
-- !query output
1


-- !query
select * from int4_tbl a full join int4_tbl b on true
-- !query schema
struct<f1:int,f1:int>
-- !query output
-123456	-123456
-123456	-2147483647
-123456	0
-123456	123456
-123456	2147483647
-2147483647	-123456
-2147483647	-2147483647
-2147483647	0
-2147483647	123456
-2147483647	2147483647
0	-123456
0	-2147483647
0	0
0	123456
0	2147483647
123456	-123456
123456	-2147483647
123456	0
123456	123456
123456	2147483647
2147483647	-123456
2147483647	-2147483647
2147483647	0
2147483647	123456
2147483647	2147483647


-- !query
select * from int4_tbl a full join int4_tbl b on false
-- !query schema
struct<f1:int,f1:int>
-- !query output
-123456	NULL
-2147483647	NULL
0	NULL
123456	NULL
2147483647	NULL
NULL	-123456
NULL	-2147483647
NULL	0
NULL	123456
NULL	2147483647


-- !query
select udf(count(*)) from
  tenk1 a join tenk1 b on udf(a.unique1) = udf(b.unique2)
  left join tenk1 c on udf(a.unique2) = udf(b.unique1) and udf(c.thousand) = udf(udf(a.thousand))
  join int4_tbl on udf(b.thousand) = f1
-- !query schema
struct<udf(count(1)):bigint>
-- !query output
10


-- !query
select udf(b.unique1) from
  tenk1 a join tenk1 b on udf(a.unique1) = udf(b.unique2)
  left join tenk1 c on udf(b.unique1) = 42 and c.thousand = udf(a.thousand)
  join int4_tbl i1 on udf(b.thousand) = udf(udf(f1))
  right join int4_tbl i2 on udf(udf(i2.f1)) = udf(b.tenthous)
  order by udf(1)
-- !query schema
struct<udf(unique1):int>
-- !query output
NULL
NULL
0
NULL
NULL


-- !query
select * from
(
  select udf(unique1), udf(q1), udf(udf(coalesce(unique1, -1)) + udf(q1)) as fault
  from int8_tbl left join tenk1 on (udf(q2) = udf(unique2))
) ss
where udf(fault) = udf(122)
order by udf(fault)
-- !query schema
struct<udf(unique1):int,udf(q1):bigint,fault:bigint>
-- !query output
NULL	123	122


-- !query
select udf(q1), udf(unique2), udf(thousand), udf(hundred)
  from int8_tbl a left join tenk1 b on udf(q1) = udf(unique2)
  where udf(coalesce(thousand,123)) = udf(q1) and udf(q1) = udf(udf(coalesce(hundred,123)))
-- !query schema
struct<udf(q1):bigint,udf(unique2):int,udf(thousand):int,udf(hundred):int>
-- !query output



-- !query
select udf(f1), udf(unique2), case when udf(udf(unique2)) is null then udf(f1) else 0 end
  from int4_tbl a left join tenk1 b on udf(f1) = udf(udf(unique2))
  where (case when udf(unique2) is null then udf(f1) else 0 end) = 0
-- !query schema
struct<udf(f1):int,udf(unique2):int,CASE WHEN (udf(udf(unique2)) IS NULL) THEN udf(f1) ELSE 0 END:int>
-- !query output
0	0	0


-- !query
select udf(a.unique1), udf(b.unique1), udf(c.unique1), udf(coalesce(b.twothousand, a.twothousand))
  from tenk1 a left join tenk1 b on udf(b.thousand) = a.unique1                       left join tenk1 c on udf(c.unique2) = udf(coalesce(b.twothousand, a.twothousand))
  where a.unique2 < udf(10) and udf(udf(coalesce(b.twothousand, a.twothousand))) = udf(44)
-- !query schema
struct<udf(unique1):int,udf(unique1):int,udf(unique1):int,udf(coalesce(twothousand, twothousand)):int>
-- !query output



-- !query
select * from
  text_tbl t1
  inner join int8_tbl i8
  on udf(i8.q2) = udf(udf(456))
  right join text_tbl t2
  on udf(t1.f1) = udf(udf('doh!'))
  left join int4_tbl i4
  on udf(udf(i8.q1)) = i4.f1
-- !query schema
struct<f1:string,q1:bigint,q2:bigint,f1:string,f1:int>
-- !query output
doh!	123	456	doh!	NULL
doh!	123	456	hi de ho neighbor	NULL


-- !query
select * from
  (select udf(udf(1)) as id) as xx
  left join
    (tenk1 as a1 full join (select udf(1) as id) as yy on (udf(a1.unique1) = udf(yy.id)))
  on (xx.id = udf(udf(coalesce(yy.id))))
-- !query schema
struct<id:int,unique1:int,unique2:int,two:int,four:int,ten:int,twenty:int,hundred:int,thousand:int,twothousand:int,fivethous:int,tenthous:int,odd:int,even:int,stringu1:string,stringu2:string,string4:string,id:int>
-- !query output
1	1	2838	1	1	1	1	1	1	1	1	1	2	3	BAAAAA	EFEAAA	OOOOxx	1


-- !query
select udf(a.q2), udf(b.q1)
  from int8_tbl a left join int8_tbl b on udf(a.q2) = coalesce(b.q1, 1)
  where udf(udf(coalesce(b.q1, 1)) > 0)
-- !query schema
struct<udf(q2):bigint,udf(q1):bigint>
-- !query output
-4567890123456789	NULL
123	123
123	123
456	NULL
4567890123456789	4567890123456789
4567890123456789	4567890123456789
4567890123456789	4567890123456789
4567890123456789	4567890123456789
4567890123456789	4567890123456789
4567890123456789	4567890123456789


-- !query
create or replace temporary view parent as select * from
  (values (1, 10), (2, 20), (3, 30))
  as v(k, pd)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view child as select * from
  (values (1, 100), (4, 400))
  as v(k, cd)
-- !query schema
struct<>
-- !query output



-- !query
select p.* from parent p left join child c on (udf(p.k) = udf(c.k))
-- !query schema
struct<k:int,pd:int>
-- !query output
1	10
2	20
3	30


-- !query
select p.*, linked from parent p
  left join (select c.*, udf(udf(true)) as linked from child c) as ss
  on (udf(p.k) = udf(udf(ss.k)))
-- !query schema
struct<k:int,pd:int,linked:boolean>
-- !query output
1	10	true
2	20	NULL
3	30	NULL


-- !query
select p.* from
  parent p left join child c on (udf(p.k) = c.k)
  where p.k = udf(1) and udf(udf(p.k)) = udf(udf(2))
-- !query schema
struct<k:int,pd:int>
-- !query output



-- !query
select p.* from
  (parent p left join child c on (udf(p.k) = c.k)) join parent x on p.k = udf(x.k)
  where udf(p.k) = udf(1) and udf(udf(p.k)) = udf(udf(2))
-- !query schema
struct<k:int,pd:int>
-- !query output



-- !query
create or replace temporary view a as select * from
  (values (0), (1))
  as v(id)
-- !query schema
struct<>
-- !query output



-- !query
create or replace temporary view b as select * from
  (values (0, 0), (1, NULL))
  as v(id, a_id)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM b LEFT JOIN a ON (udf(b.a_id) = udf(a.id)) WHERE (udf(udf(a.id)) IS NULL OR udf(a.id) > 0)
-- !query schema
struct<id:int,a_id:int,id:int>
-- !query output
1	NULL	NULL


-- !query
SELECT b.* FROM b LEFT JOIN a ON (udf(b.a_id) = udf(a.id)) WHERE (udf(a.id) IS NULL OR udf(udf(a.id)) > 0)
-- !query schema
struct<id:int,a_id:int>
-- !query output
1	NULL


-- !query
create or replace temporary view innertab as select * from
  (values (123L, 42L))
  as v(id, dat1)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM
    (SELECT udf(1) AS x) ss1
  LEFT JOIN
    (SELECT udf(q1), udf(q2), udf(COALESCE(dat1, q1)) AS y
     FROM int8_tbl LEFT JOIN innertab ON udf(udf(q2)) = id) ss2
  ON true
-- !query schema
struct<x:int,udf(q1):bigint,udf(q2):bigint,y:bigint>
-- !query output
1	123	456	123
1	123	4567890123456789	123
1	4567890123456789	-4567890123456789	4567890123456789
1	4567890123456789	123	42
1	4567890123456789	4567890123456789	4567890123456789


-- !query
select * from
  int8_tbl x join (int4_tbl x cross join int4_tbl y) j on udf(q1) = udf(f1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "AMBIGUOUS_REFERENCE",
  "sqlState" : "42704",
  "messageParameters" : {
    "name" : "`f1`",
    "referenceNames" : "[`j`.`f1`, `j`.`f1`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 87,
    "stopIndex" : 88,
    "fragment" : "f1"
  } ]
}


-- !query
select * from
  int8_tbl x join (int4_tbl x cross join int4_tbl y) j on udf(q1) = udf(y.f1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`y`.`f1`",
    "proposal" : "`j`.`f1`, `j`.`f1`, `x`.`q1`, `x`.`q2`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 87,
    "stopIndex" : 90,
    "fragment" : "y.f1"
  } ]
}


-- !query
select * from
  int8_tbl x join (int4_tbl x cross join int4_tbl y(ff)) j on udf(q1) = udf(udf(f1))
-- !query schema
struct<q1:bigint,q2:bigint,f1:int,ff:int>
-- !query output



-- !query
select udf(t1.uunique1) from
  tenk1 t1 join tenk2 t2 on t1.two = udf(t2.two)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`t1`.`uunique1`",
    "proposal" : "`t1`.`unique1`, `t2`.`unique1`, `t1`.`unique2`, `t2`.`unique2`, `t1`.`four`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 12,
    "stopIndex" : 22,
    "fragment" : "t1.uunique1"
  } ]
}


-- !query
select udf(udf(t2.uunique1)) from
  tenk1 t1 join tenk2 t2 on udf(t1.two) = t2.two
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`t2`.`uunique1`",
    "proposal" : "`t2`.`unique1`, `t1`.`unique1`, `t2`.`unique2`, `t1`.`unique2`, `t2`.`four`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 16,
    "stopIndex" : 26,
    "fragment" : "t2.uunique1"
  } ]
}


-- !query
select udf(uunique1) from
  tenk1 t1 join tenk2 t2 on udf(t1.two) = udf(t2.two)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`uunique1`",
    "proposal" : "`t1`.`unique1`, `t2`.`unique1`, `t1`.`unique2`, `t2`.`unique2`, `t1`.`ten`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 12,
    "stopIndex" : 19,
    "fragment" : "uunique1"
  } ]
}


-- !query
select unique2, x.*
from tenk1 a, lateral (select * from int4_tbl b where f1 = a.unique1) x
-- !query schema
struct<unique2:int,f1:int>
-- !query output
9998	0


-- !query
select unique2, x.*
from int4_tbl x, lateral (select unique2 from tenk1 where f1 = unique1) ss
-- !query schema
struct<unique2:int,f1:int>
-- !query output
9998	0


-- !query
select unique2, x.*
from int4_tbl x left join lateral (select unique1, unique2 from tenk1 where f1 = unique1) ss on true
-- !query schema
struct<unique2:int,f1:int>
-- !query output
9998	0
NULL	-123456
NULL	-2147483647
NULL	123456
NULL	2147483647


-- !query
select * from (select f1/2 as x from int4_tbl) ss1 join int4_tbl i4 on x = f1,
  lateral (select x) ss2(y)
-- !query schema
struct<x:double,f1:int,y:double>
-- !query output
0.0	0	0.0


-- !query
select * from ((select f1/2 as x from int4_tbl) ss1 join int4_tbl i4 on x = f1) j,
  lateral (select x) ss2(y)
-- !query schema
struct<x:double,f1:int,y:double>
-- !query output
0.0	0	0.0


-- !query
select * from
  int8_tbl x left join (select q1,coalesce(q2,0) q2 from int8_tbl) y on x.q2 = y.q1,
  lateral (select x.q1,y.q1,y.q2) v(xq1,yq1,yq2)
-- !query schema
struct<q1:bigint,q2:bigint,q1:bigint,q2:bigint,xq1:bigint,yq1:bigint,yq2:bigint>
-- !query output
123	456	NULL	NULL	123	NULL	NULL
123	4567890123456789	4567890123456789	-4567890123456789	123	4567890123456789	-4567890123456789
123	4567890123456789	4567890123456789	123	123	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123	4567890123456789	4567890123456789
4567890123456789	-4567890123456789	NULL	NULL	4567890123456789	NULL	NULL
4567890123456789	123	123	456	4567890123456789	123	456
4567890123456789	123	123	4567890123456789	4567890123456789	123	4567890123456789
4567890123456789	4567890123456789	4567890123456789	-4567890123456789	4567890123456789	4567890123456789	-4567890123456789
4567890123456789	4567890123456789	4567890123456789	123	4567890123456789	4567890123456789	123
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789


-- !query
select x.* from
  int8_tbl x left join (select q1,coalesce(q2,0) q2 from int8_tbl) y on x.q2 = y.q1,
  lateral (select x.q1,y.q1,y.q2) v(xq1,yq1,yq2)
-- !query schema
struct<q1:bigint,q2:bigint>
-- !query output
123	456
123	4567890123456789
123	4567890123456789
123	4567890123456789
4567890123456789	-4567890123456789
4567890123456789	123
4567890123456789	123
4567890123456789	4567890123456789
4567890123456789	4567890123456789
4567890123456789	4567890123456789


-- !query
select * from
  int8_tbl a left join
  lateral (select *, a.q2 as x from int8_tbl b) ss on a.q2 = ss.q1
-- !query schema
struct<q1:bigint,q2:bigint,q1:bigint,q2:bigint,x:bigint>
-- !query output
123	456	NULL	NULL	NULL
123	4567890123456789	4567890123456789	-4567890123456789	4567890123456789
123	4567890123456789	4567890123456789	123	4567890123456789
123	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	-4567890123456789	NULL	NULL	NULL
4567890123456789	123	123	456	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	4567890123456789	4567890123456789	-4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	123	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789


-- !query
select * from
  int8_tbl a left join
  lateral (select *, coalesce(a.q2, 42) as x from int8_tbl b) ss on a.q2 = ss.q1
-- !query schema
struct<q1:bigint,q2:bigint,q1:bigint,q2:bigint,x:bigint>
-- !query output
123	456	NULL	NULL	NULL
123	4567890123456789	4567890123456789	-4567890123456789	4567890123456789
123	4567890123456789	4567890123456789	123	4567890123456789
123	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	-4567890123456789	NULL	NULL	NULL
4567890123456789	123	123	456	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	4567890123456789	4567890123456789	-4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	123	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789


-- !query
select * from int4_tbl i left join
  lateral (select * from int2_tbl j where i.f1 = j.f1) k on true
-- !query schema
struct<f1:int,f1:smallint>
-- !query output
-123456	NULL
-2147483647	NULL
0	0
123456	NULL
2147483647	NULL


-- !query
select * from
  int8_tbl a left join lateral
  (select b.q1 as bq1, c.q1 as cq1, least(a.q1,b.q1,c.q1) from
   int8_tbl b cross join int8_tbl c) ss
  on a.q2 = ss.bq1
-- !query schema
struct<q1:bigint,q2:bigint,bq1:bigint,cq1:bigint,least(outer(a.q1), q1, q1):bigint>
-- !query output
123	456	NULL	NULL	NULL
123	4567890123456789	4567890123456789	123	123
123	4567890123456789	4567890123456789	123	123
123	4567890123456789	4567890123456789	123	123
123	4567890123456789	4567890123456789	123	123
123	4567890123456789	4567890123456789	123	123
123	4567890123456789	4567890123456789	123	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
123	4567890123456789	4567890123456789	4567890123456789	123
4567890123456789	-4567890123456789	NULL	NULL	NULL
4567890123456789	123	123	123	123
4567890123456789	123	123	123	123
4567890123456789	123	123	123	123
4567890123456789	123	123	123	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	123	123	4567890123456789	123
4567890123456789	4567890123456789	4567890123456789	123	123
4567890123456789	4567890123456789	4567890123456789	123	123
4567890123456789	4567890123456789	4567890123456789	123	123
4567890123456789	4567890123456789	4567890123456789	123	123
4567890123456789	4567890123456789	4567890123456789	123	123
4567890123456789	4567890123456789	4567890123456789	123	123
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789
4567890123456789	4567890123456789	4567890123456789	4567890123456789	4567890123456789


-- !query
select udf(udf(f1,g)) from int4_tbl a, (select udf(udf(f1)) as g) ss
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`f1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 56,
    "stopIndex" : 57,
    "fragment" : "f1"
  } ]
}


-- !query
select udf(f1,g) from int4_tbl a, (select a.f1 as g) ss
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`a`.`f1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 43,
    "stopIndex" : 46,
    "fragment" : "a.f1"
  } ]
}


-- !query
select udf(udf(f1,g)) from int4_tbl a cross join (select udf(f1) as g) ss
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`f1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 62,
    "stopIndex" : 63,
    "fragment" : "f1"
  } ]
}


-- !query
select udf(f1,g) from int4_tbl a cross join (select udf(udf(a.f1)) as g) ss
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`a`.`f1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 61,
    "stopIndex" : 64,
    "fragment" : "a.f1"
  } ]
}


-- !query
CREATE TABLE j1 (id1 int, id2 int) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE j2 (id1 int, id2 int) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO j1 values(1,1),(1,2)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO j2 values(1,1)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO j2 values(1,2)
-- !query schema
struct<>
-- !query output



-- !query
select * from j1
inner join j2 on udf(j1.id1) = udf(j2.id1) and udf(udf(j1.id2)) = udf(j2.id2)
where udf(j1.id1) % 1000 = 1 and udf(udf(j2.id1) % 1000) = 1
-- !query schema
struct<id1:int,id2:int,id1:int,id2:int>
-- !query output
1	1	1	1
1	2	1	2


-- !query
drop table j1
-- !query schema
struct<>
-- !query output



-- !query
drop table j2
-- !query schema
struct<>
-- !query output

