-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t2_star(col1 INT, col2 STRING) AS VALUES (1, 'a'), (2, 'b')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
CREATE TEMPORARY VIEW t3_star(col1 INT) AS VALUES (1), (2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
SELECT named_struct(*) AS a FROM t2_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t2_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 34,
    "stopIndex" : 40,
    "fragment" : "t2_star"
  } ]
}


-- !query
SELECT named_struct('key', *) AS a FROM t3_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t3_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 41,
    "stopIndex" : 47,
    "fragment" : "t3_star"
  } ]
}


-- !query
SELECT named_struct('key', *) AS a FROM t2_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t2_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 41,
    "stopIndex" : 47,
    "fragment" : "t2_star"
  } ]
}


-- !query
SELECT named_struct('key', struct(*)) AS a FROM t2_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t2_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 49,
    "stopIndex" : 55,
    "fragment" : "t2_star"
  } ]
}


-- !query
SELECT * FROM t2_star AS l INNER JOIN t2_star as r ON l.col1 in (r.*)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t2_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 21,
    "fragment" : "t2_star"
  } ]
}


-- !query
SELECT * FROM t2_star AS l INNER JOIN t2_star as r ON struct(l.col1, l.col2) in (struct(r.*))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t2_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 21,
    "fragment" : "t2_star"
  } ]
}


-- !query
SELECT named_struct('a',1) AS s GROUP BY 1 HAVING s.* > 1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_USAGE_OF_STAR_OR_REGEX",
  "sqlState" : "42000",
  "messageParameters" : {
    "elem" : "'*'",
    "prettyName" : "UnresolvedHaving"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 51,
    "stopIndex" : 53,
    "fragment" : "s.*"
  } ]
}


-- !query
SELECT named_struct('a',1) AS s GROUP BY 1 HAVING 1 in (s.*)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "INVALID_USAGE_OF_STAR_OR_REGEX",
  "sqlState" : "42000",
  "messageParameters" : {
    "elem" : "'*'",
    "prettyName" : "UnresolvedHaving"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 57,
    "stopIndex" : 59,
    "fragment" : "s.*"
  } ]
}


-- !query
CREATE TEMPORARY VIEW t7_star(col1 INT, col2 INT, col3 INT) AS VALUES (1, 2, 3), (4, 5, 6)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'AS'",
    "hint" : ": missing 'USING'"
  }
}


-- !query
SELECT * FROM t2_star WHERE col1 IN (*, *)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t2_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 21,
    "fragment" : "t2_star"
  } ]
}


-- !query
SELECT * FROM t7_star WHERE col1 in (* EXCEPT (col1, col2), * EXCEPT (col1, col3))
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`t7_star`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 21,
    "fragment" : "t7_star"
  } ]
}


-- !query
SELECT 42, col1.* FROM (SELECT struct() as col1)
-- !query schema
struct<42:int>
-- !query output
42


-- !query
SELECT count(my_table.*), count(*) FROM VALUES(1, 2, NULL) my_table(a, b, c)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1021",
  "messageParameters" : {
    "targetString" : "my_table"
  }
}


-- !query
SELECT COUNT(my_table.*), count(*) FROM VALUES(1, 2, NULL) my_table(a, b, c)
-- !query schema
struct<count(a, b, c):bigint,count(1):bigint>
-- !query output
0	1


-- !query
DROP VIEW t2_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`t2_star`"
  }
}


-- !query
DROP VIEW t3_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`t3_star`"
  }
}


-- !query
DROP VIEW t7_star
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "errorClass" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`t7_star`"
  }
}
