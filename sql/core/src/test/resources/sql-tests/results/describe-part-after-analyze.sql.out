-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 15


-- !query
CREATE TABLE t (key STRING, value STRING, ds STRING, hr INT) USING parquet
    PARTITIONED BY (ds, hr)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TABLE t PARTITION (ds='2017-08-01', hr=10)
VALUES ('k1', 100), ('k2', 200), ('k3', 300)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TABLE t PARTITION (ds='2017-08-01', hr=11)
VALUES ('k1', 101), ('k2', 201), ('k3', 301), ('k4', 401)
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO TABLE t PARTITION (ds='2017-09-01', hr=5)
VALUES ('k1', 102), ('k2', 202)
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
ANALYZE TABLE t PARTITION (ds='2017-08-01', hr=10) COMPUTE STATISTICS
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 3 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
ANALYZE TABLE t PARTITION (ds='2017-08-01') COMPUTE STATISTICS
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 3 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=11)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=11]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-08-01/hr=11	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 4 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
ANALYZE TABLE t PARTITION (ds, hr) COMPUTE STATISTICS
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 3 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=11)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=11]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-08-01/hr=11	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 4 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
DESC EXTENDED t PARTITION (ds='2017-09-01', hr=5)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-09-01, hr=5]	                    
Location [not included in comparison]/{warehouse_dir}/t/ds=2017-09-01/hr=5	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 2 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]/{warehouse_dir}/t


-- !query
DROP TABLE t
-- !query schema
struct<>
-- !query output

