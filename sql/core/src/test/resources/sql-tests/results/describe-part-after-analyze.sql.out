-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 15


-- !query 0
CREATE TABLE t (key STRING, value STRING, ds STRING, hr INT) USING parquet
    PARTITIONED BY (ds, hr)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
INSERT INTO TABLE t PARTITION (ds='2017-08-01', hr=10)
VALUES ('k1', 100), ('k2', 200), ('k3', 300)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
INSERT INTO TABLE t PARTITION (ds='2017-08-01', hr=11)
VALUES ('k1', 101), ('k2', 201), ('k3', 301), ('k4', 401)
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
INSERT INTO TABLE t PARTITION (ds='2017-09-01', hr=5)
VALUES ('k1', 102), ('k2', 202)
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query 4 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 4 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 5
ANALYZE TABLE t PARTITION (ds='2017-08-01', hr=10) COMPUTE STATISTICS
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query 6 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 6 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 3 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 7
ANALYZE TABLE t PARTITION (ds='2017-08-01') COMPUTE STATISTICS
-- !query 7 schema
struct<>
-- !query 7 output



-- !query 8
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query 8 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 8 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 3 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 9
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=11)
-- !query 9 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 9 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=11]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-08-01/hr=11	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 4 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 10
ANALYZE TABLE t PARTITION (ds, hr) COMPUTE STATISTICS
-- !query 10 schema
struct<>
-- !query 10 output



-- !query 11
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=10)
-- !query 11 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 11 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=10]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-08-01/hr=10	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 3 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 12
DESC EXTENDED t PARTITION (ds='2017-08-01', hr=11)
-- !query 12 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 12 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-08-01, hr=11]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-08-01/hr=11	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 4 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 13
DESC EXTENDED t PARTITION (ds='2017-09-01', hr=5)
-- !query 13 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 13 output
key                 	string              	                    
value               	string              	                    
ds                  	string              	                    
hr                  	int                 	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
ds                  	string              	                    
hr                  	int                 	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[ds=2017-09-01, hr=5]	                    
Location [not included in comparison]sql/core/spark-warehouse/t/ds=2017-09-01/hr=5	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Partition Statistics	[not included in comparison] bytes, 2 rows  	                    
                    	                    	                    
# Storage Information	                    	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 14
DROP TABLE t
-- !query 14 schema
struct<>
-- !query 14 output

