-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT vector_sum(col) FROM VALUES (array(1.0F, 2.0F, 3.0F)), (array(4.0F, 5.0F, 6.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[5.0,7.0,9.0]


-- !query
SELECT vector_avg(col) FROM VALUES (array(1.0F, 2.0F, 3.0F)), (array(3.0F, 4.0F, 5.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[2.0,3.0,4.0]


-- !query
SELECT vector_sum(col) FROM VALUES (array(1.0F, 2.0F, 3.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[1.0,2.0,3.0]


-- !query
SELECT vector_avg(col) FROM VALUES (array(1.0F, 2.0F, 3.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[1.0,2.0,3.0]


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 1.0F)),
    (array(2.0F, 2.0F)),
    (array(3.0F, 3.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[6.0,6.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, 1.0F)),
    (array(2.0F, 2.0F)),
    (array(3.0F, 3.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[2.0,2.0]


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F)),
    (array(10.0F, 20.0F, 30.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[11.0,22.0,33.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(0.0F, 0.0F)),
    (array(10.0F, 20.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[5.0,10.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(-5.0F, 10.0F)),
    (array(5.0F, -10.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[0.0,0.0]


-- !query
SELECT category, vector_sum(embedding) AS sum_vector
FROM VALUES
    ('A', array(1.0F, 2.0F, 3.0F)),
    ('A', array(4.0F, 5.0F, 6.0F)),
    ('B', array(2.0F, 1.0F, 4.0F)),
    ('B', array(3.0F, 2.0F, 1.0F))
AS tab(category, embedding)
GROUP BY category
ORDER BY category
-- !query schema
struct<category:string,sum_vector:array<float>>
-- !query output
A	[5.0,7.0,9.0]
B	[5.0,3.0,5.0]


-- !query
SELECT category, vector_avg(embedding) AS avg_vector
FROM VALUES
    ('A', array(2.0F, 4.0F, 6.0F)),
    ('A', array(4.0F, 8.0F, 12.0F)),
    ('B', array(1.0F, 2.0F, 3.0F)),
    ('B', array(3.0F, 6.0F, 9.0F))
AS tab(category, embedding)
GROUP BY category
ORDER BY category
-- !query schema
struct<category:string,avg_vector:array<float>>
-- !query output
A	[3.0,6.0,9.0]
B	[2.0,4.0,6.0]


-- !query
SELECT vector_sum(col) FROM VALUES
    (CAST(array() AS ARRAY<FLOAT>)),
    (CAST(array() AS ARRAY<FLOAT>)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[]


-- !query
SELECT vector_avg(col) FROM VALUES
    (CAST(array() AS ARRAY<FLOAT>)),
    (CAST(array() AS ARRAY<FLOAT>)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[]


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F)),
    (CAST(NULL AS ARRAY<FLOAT>)),
    (array(3.0F, 4.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[4.0,6.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, 2.0F)),
    (CAST(NULL AS ARRAY<FLOAT>)),
    (array(3.0F, 4.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[2.0,3.0]


-- !query
SELECT vector_sum(col) FROM VALUES
    (CAST(NULL AS ARRAY<FLOAT>)),
    (CAST(NULL AS ARRAY<FLOAT>)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
NULL


-- !query
SELECT vector_avg(col) FROM VALUES
    (CAST(NULL AS ARRAY<FLOAT>)),
    (CAST(NULL AS ARRAY<FLOAT>)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
NULL


-- !query
SELECT vector_sum(col) FROM VALUES (CAST(NULL AS ARRAY<FLOAT>)) AS tab(col) WHERE col IS NOT NULL
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
NULL


-- !query
SELECT vector_avg(col) FROM VALUES (CAST(NULL AS ARRAY<FLOAT>)) AS tab(col) WHERE col IS NOT NULL
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
NULL


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F)),
    (array(CAST(NULL AS FLOAT), 10.0F)),
    (array(3.0F, 4.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[4.0,6.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, 2.0F)),
    (array(CAST(NULL AS FLOAT), 10.0F)),
    (array(3.0F, 4.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[2.0,3.0]


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, CAST(NULL AS FLOAT))),
    (array(CAST(NULL AS FLOAT), 2.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
NULL


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, CAST(NULL AS FLOAT))),
    (array(CAST(NULL AS FLOAT), 2.0F)) AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
NULL


-- !query
SELECT vector_sum(col) FROM VALUES
    (CAST(NULL AS ARRAY<FLOAT>)),
    (array(1.0F, CAST(NULL AS FLOAT))),
    (array(1.0F, 2.0F)),
    (array(3.0F, 4.0F)) AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[4.0,6.0]


-- !query
SELECT category, vector_sum(embedding) AS sum_vector
FROM VALUES
    ('A', array(1.0F, 2.0F)),
    ('A', CAST(NULL AS ARRAY<FLOAT>)),
    ('A', array(3.0F, 4.0F)),
    ('B', CAST(NULL AS ARRAY<FLOAT>)),
    ('B', CAST(NULL AS ARRAY<FLOAT>))
AS tab(category, embedding)
GROUP BY category
ORDER BY category
-- !query schema
struct<category:string,sum_vector:array<float>>
-- !query output
A	[4.0,6.0]
B	NULL


-- !query
SELECT category, vector_avg(embedding) AS avg_vector
FROM VALUES
    ('A', array(1.0F, 2.0F)),
    ('A', CAST(NULL AS ARRAY<FLOAT>)),
    ('A', array(3.0F, 4.0F)),
    ('B', CAST(NULL AS ARRAY<FLOAT>)),
    ('B', CAST(NULL AS ARRAY<FLOAT>))
AS tab(category, embedding)
GROUP BY category
ORDER BY category
-- !query schema
struct<category:string,avg_vector:array<float>>
-- !query output
A	[2.0,3.0]
B	NULL


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F)),
    (array(1.0F, 2.0F)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "VECTOR_DIMENSION_MISMATCH",
  "sqlState" : "22000",
  "messageParameters" : {
    "functionName" : "`vector_sum`",
    "leftDim" : "3",
    "rightDim" : "2"
  }
}


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F)),
    (array(1.0F, 2.0F)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "VECTOR_DIMENSION_MISMATCH",
  "sqlState" : "22000",
  "messageParameters" : {
    "functionName" : "`vector_avg`",
    "leftDim" : "3",
    "rightDim" : "2"
  }
}


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F)),
    (CAST(NULL AS ARRAY<FLOAT>)),
    (array(1.0F, 2.0F)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkRuntimeException
{
  "errorClass" : "VECTOR_DIMENSION_MISMATCH",
  "sqlState" : "22000",
  "messageParameters" : {
    "functionName" : "`vector_sum`",
    "leftDim" : "3",
    "rightDim" : "2"
  }
}


-- !query
SELECT vector_sum(col) FROM VALUES (array(1.0D, 2.0D)), (array(3.0D, 4.0D)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_sum(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_sum(col)"
  } ]
}


-- !query
SELECT vector_sum(col) FROM VALUES (array(1, 2)), (array(3, 4)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_sum(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_sum(col)"
  } ]
}


-- !query
SELECT vector_avg(col) FROM VALUES (array(1.0D, 2.0D)), (array(3.0D, 4.0D)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"ARRAY<DOUBLE>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_avg(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_avg(col)"
  } ]
}


-- !query
SELECT vector_avg(col) FROM VALUES (array(1, 2)), (array(3, 4)) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"ARRAY<INT>\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_avg(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_avg(col)"
  } ]
}


-- !query
SELECT vector_sum(col) FROM VALUES ('not an array'), ('also not an array') AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_sum(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_sum(col)"
  } ]
}


-- !query
SELECT vector_sum(col) FROM VALUES (1.0F), (2.0F) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"FLOAT\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_sum(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_sum(col)"
  } ]
}


-- !query
SELECT vector_avg(col) FROM VALUES ('not an array'), ('also not an array') AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_avg(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_avg(col)"
  } ]
}


-- !query
SELECT vector_avg(col) FROM VALUES (1.0F), (2.0F) AS tab(col)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"FLOAT\"",
    "paramIndex" : "first",
    "requiredType" : "\"ARRAY<FLOAT>\"",
    "sqlExpr" : "\"vector_avg(col)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "vector_avg(col)"
  } ]
}


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F)),
    (array(16.0F, 15.0F, 14.0F, 13.0F, 12.0F, 11.0F, 10.0F, 9.0F, 8.0F, 7.0F, 6.0F, 5.0F, 4.0F, 3.0F, 2.0F, 1.0F))
AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0,17.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, 6.0F, 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F)),
    (array(16.0F, 15.0F, 14.0F, 13.0F, 12.0F, 11.0F, 10.0F, 9.0F, 8.0F, 7.0F, 6.0F, 5.0F, 4.0F, 3.0F, 2.0F, 1.0F))
AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5]


-- !query
SELECT vector_sum(col) FROM VALUES
    (array(1.0F, 2.0F, 3.0F, 4.0F, 5.0F, CAST(NULL AS FLOAT), 7.0F, 8.0F, 9.0F, 10.0F, 11.0F, 12.0F, 13.0F, 14.0F, 15.0F, 16.0F)),
    (array(16.0F, 15.0F, 14.0F, 13.0F, 12.0F, 11.0F, 10.0F, 9.0F, 8.0F, 7.0F, 6.0F, 5.0F, 4.0F, 3.0F, 2.0F, 1.0F))
AS tab(col)
-- !query schema
struct<vector_sum(col):array<float>>
-- !query output
[16.0,15.0,14.0,13.0,12.0,11.0,10.0,9.0,8.0,7.0,6.0,5.0,4.0,3.0,2.0,1.0]


-- !query
SELECT vector_avg(col) FROM VALUES
    (array(1.0F, 1.0F)),
    (array(2.0F, 2.0F)),
    (array(3.0F, 3.0F)),
    (array(4.0F, 4.0F)),
    (array(5.0F, 5.0F)),
    (array(6.0F, 6.0F)),
    (array(7.0F, 7.0F)),
    (array(8.0F, 8.0F)),
    (array(9.0F, 9.0F)),
    (array(10.0F, 10.0F))
AS tab(col)
-- !query schema
struct<vector_avg(col):array<float>>
-- !query output
[5.5,5.5]
