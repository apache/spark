-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num
  UNION
  SELECT 2
  UNION
  SELECT 3
  UNION
  SELECT 4
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int>
-- !query output
1
2


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1
  UNION
  SELECT 2
  UNION
  SELECT 3
  UNION
  SELECT 4
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<1:int,a:string>
-- !query output
1	a
2	b


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int,a:string>
-- !query output
1	a
2	b


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num
  EXCEPT
  SELECT 2
  EXCEPT
  SELECT 1
  EXCEPT
  SELECT 2
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int>
-- !query output
1


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1
  EXCEPT
  SELECT 2
  EXCEPT
  SELECT 1
  EXCEPT
  SELECT 2
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a'
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a' AS a
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<1:int,a:string>
-- !query output
1	a


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a' AS a
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int,a:string>
-- !query output
1	a


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num
  INTERSECT
  SELECT 1
  INTERSECT
  SELECT 2
  INTERSECT
  SELECT 2
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int>
-- !query output
1


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1
  INTERSECT
  SELECT 1
  INTERSECT
  SELECT 2
  INTERSECT
  SELECT 2
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a'
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a'
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a' AS a
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<1:int,a:string>
-- !query output
1	a


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a' AS a
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int,a:string>
-- !query output
1	a


-- !query
DROP VIEW v1
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE VIEW v1 WITH SCHEMA EVOLUTION AS
  SELECT 1, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<1:int,UNION:string>
-- !query output
1	a


-- !query
CREATE OR REPLACE VIEW v1 WITH SCHEMA EVOLUTION AS
  SELECT 1 AS num, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int,UNION:string>
-- !query output
1	a


-- !query
CREATE OR REPLACE VIEW v1 WITH SCHEMA EVOLUTION AS
  SELECT 1 AS num, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v1
-- !query schema
struct<num:int,a:string>
-- !query output
1	a
2	b


-- !query
DROP VIEW v1
-- !query schema
struct<>
-- !query output



-- !query
DECLARE v1 INT
-- !query schema
struct<>
-- !query output



-- !query
EXECUTE IMMEDIATE 'SELECT 1 UNION SELECT 2 UNION SELECT 3' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 UNION SELECT 1 UNION SELECT 1' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 EXCEPT SELECT 2 EXCEPT SELECT 3' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 EXCEPT SELECT 1 EXCEPT SELECT 1' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 INTERSECT SELECT 2 INTERSECT SELECT 3' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 INTERSECT SELECT 1 INTERSECT SELECT 1' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 JOIN SELECT 2' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 VALUES (1)' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 alias garbage garbage garbage' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 WITH abc' INTO v1
-- !query schema
struct<>
-- !query output



-- !query
SELECT v1
-- !query schema
struct<v1:int>
-- !query output
1


-- !query
DROP TEMPORARY VARIABLE v1
-- !query schema
struct<>
-- !query output

