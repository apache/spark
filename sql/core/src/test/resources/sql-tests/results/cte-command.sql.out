-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE cte_tbl USING csv AS WITH s AS (SELECT 42 AS col) SELECT * FROM s
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM cte_tbl
-- !query schema
struct<col:int>
-- !query output
42


-- !query
CREATE TEMPORARY VIEW cte_view AS WITH s AS (SELECT 42 AS col) SELECT * FROM s
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM cte_view
-- !query schema
struct<col:int>
-- !query output
42


-- !query
WITH s AS (SELECT 43 AS col)
INSERT INTO cte_tbl SELECT * FROM S
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM cte_tbl
-- !query schema
struct<col:int>
-- !query output
42
43


-- !query
INSERT INTO cte_tbl WITH s AS (SELECT 44 AS col) SELECT * FROM s
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM cte_tbl
-- !query schema
struct<col:int>
-- !query output
42
43
44


-- !query
CREATE TABLE cte_tbl2 (col INT) USING csv
-- !query schema
struct<>
-- !query output



-- !query
WITH s AS (SELECT 45 AS col)
FROM s
INSERT INTO cte_tbl SELECT col
INSERT INTO cte_tbl2 SELECT col
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM cte_tbl
-- !query schema
struct<col:int>
-- !query output
42
43
44
45


-- !query
SELECT * FROM cte_tbl2
-- !query schema
struct<col:int>
-- !query output
45


-- !query
DROP TABLE cte_tbl
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE cte_tbl2
-- !query schema
struct<>
-- !query output

