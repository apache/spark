-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS SELECT * FROM VALUES
  (1, 2),
  (3, 5),
  (7, 2),
  (1, 2),
  (8, 3),
  (4, 9),
  (5, 7),
  (9, 4),
  (2, 6),
  (5, 7),
  (3, 8),
  (6, 1),
  (4, 9),
  (7, 5),
  (2, 8)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW v2 AS SELECT * FROM VALUES
  (1, 2),
  (5, 9),
  (8, 4),
  (7, 5),
  (4, 9),
  (3, 1),
  (7, 2),
  (6, 8),
  (9, 7),
  (2, 3),
  (8, 3),
  (5, 7),
  (1, 6),
  (3, 2),
  (9, 8)
-- !query schema
struct<>
-- !query output



-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY col1
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 65,
    "stopIndex" : 68,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v1.col1
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 68,
    "stopIndex" : 74,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v2.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 68,
    "stopIndex" : 74,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v2.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 68,
    "stopIndex" : 74,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + col1, 2 + col2
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + col2, 2 + col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 83,
    "stopIndex" : 86,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + v1.col1, 2 + v1.col2
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + v1.col2, 2 + v1.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 89,
    "stopIndex" : 95,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + v1.col1, 2 + v2.col2
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + v2.col1, 2 + v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 89,
    "stopIndex" : 95,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY MAX(col1)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY MAX(col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
3
7
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v1.col1)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v1.col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
3
7
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v2.col1)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v2.col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
3
7
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + MAX(col1), 2 + MIN(col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + MAX(col2), 2 + MIN(col1)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
2
3
5
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v1.col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + MAX(v1.col2), 2 + MIN(v1.col1)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
2
3
5
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v2.col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + MAX(v2.col1), 2 + MIN(v1.col2)
-- !query schema
struct<sum(col2):bigint>
-- !query output
4
18
14
2
5
3


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY col1
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 94,
    "stopIndex" : 97,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v1.col1
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 97,
    "stopIndex" : 103,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v2.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 97,
    "stopIndex" : 103,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY v2.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 97,
    "stopIndex" : 103,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + col1, 2 + col2
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + col2, 2 + col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 112,
    "stopIndex" : 115,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + v1.col1, 2 + v1.col2
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + v1.col2, 2 + v1.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 118,
    "stopIndex" : 124,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + v1.col1, 2 + v2.col2
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + v2.col1, 2 + v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 118,
    "stopIndex" : 124,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY MAX(col1)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 ORDER BY MAX(col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
3	4	5
7	8	9
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v1.col1)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v1.col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
3	4	5
7	8	9
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v2.col1)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 ORDER BY MAX(v2.col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
3	4	5
7	8	9
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + MAX(col1), 2 + MIN(col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 ORDER BY 1 + MAX(col2), 2 + MIN(col1)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
2	3	4
3	4	5
5	6	7
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v1.col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 ORDER BY 1 + MAX(v1.col2), 2 + MIN(v1.col1)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
2	3	4
3	4	5
5	6	7
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v2.col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 ORDER BY 1 + MAX(v2.col1), 2 + MIN(v1.col2)
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
4	5	6
18	19	20
14	15	16
2	3	4
5	6	7
3	4	5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col1 > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
3
7


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 63,
    "stopIndex" : 66,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col1 > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
3
7


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 66,
    "stopIndex" : 72,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col1 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 66,
    "stopIndex" : 72,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 66,
    "stopIndex" : 72,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col1 > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 81,
    "stopIndex" : 84,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col1 > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 87,
    "stopIndex" : 93,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v1.col1 > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v2.col1 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 87,
    "stopIndex" : 93,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
3
7


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col2) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
3
7


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col2) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
3
7


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col2) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
18


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col2) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
18
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col2) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
18
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v1.col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v2.col1) > 5
-- !query schema
struct<sum(col2):bigint>
-- !query output
14
2
3
5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col1 > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
3	4	5
7	8	9


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 92,
    "stopIndex" : 95,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col1 > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
3	4	5
7	8	9


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 95,
    "stopIndex" : 101,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col1 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 95,
    "stopIndex" : 101,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 95,
    "stopIndex" : 101,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col1 > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 110,
    "stopIndex" : 113,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col1 > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col2 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 116,
    "stopIndex" : 122,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v1.col1 > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v2.col1 > 5
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 116,
    "stopIndex" : 122,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
3	4	5
7	8	9


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col2) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
3	4	5
7	8	9


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col2) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
3	4	5
7	8	9


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col2) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
18	19	20


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col2) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
18	19	20
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col2) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
18	19	20
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v1.col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v2.col1) > 5
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
14	15	16
2	3	4
3	4	5
5	6	7


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col1 > 5 ORDER BY col1
-- !query schema
struct<sum(col2):bigint>
-- !query output
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col2 > 5 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 63,
    "stopIndex" : 66,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col1 > 5 ORDER BY v1.col1
-- !query schema
struct<sum(col2):bigint>
-- !query output
7
3


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col2 > 5 ORDER BY v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 66,
    "stopIndex" : 72,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col1 > 5 ORDER BY v2.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 66,
    "stopIndex" : 72,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col2 > 5 ORDER BY v2.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 66,
    "stopIndex" : 72,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col1 > 5 ORDER BY 1 + col1, 2 + col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 103,
    "stopIndex" : 106,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col2 > 5 ORDER BY 1 + col2, 2 + col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 81,
    "stopIndex" : 84,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col1 > 5 ORDER BY 1 + v1.col1, 2 + v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 112,
    "stopIndex" : 118,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col2 > 5 ORDER BY 1 + v1.col2, 2 + v1.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 87,
    "stopIndex" : 93,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v1.col1 > 5 ORDER BY 1 + v1.col1, 2 + v2.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 112,
    "stopIndex" : 118,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v2.col1 > 5 ORDER BY 1 + v2.col1, 2 + v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 87,
    "stopIndex" : 93,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col1) > 5 ORDER BY MAX(col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNSUPPORTED_EXPR_FOR_OPERATOR",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "invalidExprSqls" : "\"max(col1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 77,
    "stopIndex" : 94,
    "fragment" : "ORDER BY MAX(col1)"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col2) > 5 ORDER BY MAX(col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 90,
    "stopIndex" : 93,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col1) > 5 ORDER BY MAX(v1.col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNSUPPORTED_EXPR_FOR_OPERATOR",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "invalidExprSqls" : "\"max(col1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 83,
    "stopIndex" : 103,
    "fragment" : "ORDER BY MAX(v1.col1)"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col2) > 5 ORDER BY MAX(v1.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 96,
    "stopIndex" : 102,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col1) > 5 ORDER BY MAX(v2.col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 96,
    "stopIndex" : 102,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col2) > 5 ORDER BY MAX(v2.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 96,
    "stopIndex" : 102,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col1) > 5 ORDER BY 1 + MAX(col1), 2 + MIN(col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 112,
    "stopIndex" : 115,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col2) > 5 ORDER BY 1 + MAX(col2), 2 + MIN(col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 112,
    "stopIndex" : 115,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col1) > 5 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v1.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 121,
    "stopIndex" : 127,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col2) > 5 ORDER BY 1 + MAX(v1.col2), 2 + MIN(v1.col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 121,
    "stopIndex" : 127,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v1.col1) > 5 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v2.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 121,
    "stopIndex" : 127,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v1.col1) > 5 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v2.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`sum(col2)`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 121,
    "stopIndex" : 127,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col1 > 5 ORDER BY col1
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING col2 > 5 ORDER BY col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 92,
    "stopIndex" : 95,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col1 > 5 ORDER BY v1.col1
-- !query schema
struct<a:bigint,b:bigint,c:bigint>
-- !query output
7	8	9
3	4	5


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v1.col2 > 5 ORDER BY v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 95,
    "stopIndex" : 101,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col1 > 5 ORDER BY v2.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 95,
    "stopIndex" : 101,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING v2.col2 > 5 ORDER BY v2.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 95,
    "stopIndex" : 101,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col1 > 5 ORDER BY 1 + col1, 2 + col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col1`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 132,
    "stopIndex" : 135,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + col2 > 5 ORDER BY 1 + col2, 2 + col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 110,
    "stopIndex" : 113,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col1 > 5 ORDER BY 1 + v1.col1, 2 + v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 141,
    "stopIndex" : 147,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + v1.col2 > 5 ORDER BY 1 + v1.col2, 2 + v1.col1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 116,
    "stopIndex" : 122,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v1.col1 > 5 ORDER BY 1 + v1.col1, 2 + v2.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 141,
    "stopIndex" : 147,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + v2.col1 > 5 ORDER BY 1 + v2.col1, 2 + v1.col2
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 116,
    "stopIndex" : 122,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col1) > 5 ORDER BY MAX(col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNSUPPORTED_EXPR_FOR_OPERATOR",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "invalidExprSqls" : "\"max(col1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 106,
    "stopIndex" : 123,
    "fragment" : "ORDER BY MAX(col1)"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 HAVING MAX(col2) > 5 ORDER BY MAX(col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 119,
    "stopIndex" : 122,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col1) > 5 ORDER BY MAX(v1.col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNSUPPORTED_EXPR_FOR_OPERATOR",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "invalidExprSqls" : "\"max(col1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 112,
    "stopIndex" : 132,
    "fragment" : "ORDER BY MAX(v1.col1)"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v1.col2) > 5 ORDER BY MAX(v1.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 125,
    "stopIndex" : 131,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col1) > 5 ORDER BY MAX(v2.col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 125,
    "stopIndex" : 131,
    "fragment" : "v2.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 HAVING MAX(v2.col2) > 5 ORDER BY MAX(v2.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v2`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 125,
    "stopIndex" : 131,
    "fragment" : "v2.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col1) > 5 ORDER BY 1 + MAX(col1), 2 + MIN(col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col1`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 141,
    "stopIndex" : 144,
    "fragment" : "col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY col1 + 1, col2 + 2 HAVING 1 + MAX(col2) > 5 ORDER BY 1 + MAX(col2), 2 + MIN(col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`col2`",
    "proposal" : "`a`, `b`, `c`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 141,
    "stopIndex" : 144,
    "fragment" : "col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col1) > 5 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v1.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 150,
    "stopIndex" : 156,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v1.col2 + 2 HAVING 1 + MAX(v1.col2) > 5 ORDER BY 1 + MAX(v1.col2), 2 + MIN(v1.col1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col2`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 150,
    "stopIndex" : 156,
    "fragment" : "v1.col2"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v1.col1) > 5 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v2.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 150,
    "stopIndex" : 156,
    "fragment" : "v1.col1"
  } ]
}


-- !query
SELECT SUM(col2) AS a, a + 1 AS b, b + 1 AS c FROM v1 NATURAL JOIN v2 GROUP BY v1.col1 + 1, v2.col2 + 2 HAVING 1 + MAX(v1.col1) > 5 ORDER BY 1 + MAX(v1.col1), 2 + MIN(v2.col2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_COLUMN.WITH_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`v1`.`col1`",
    "proposal" : "`c`, `a`, `b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 150,
    "stopIndex" : 156,
    "fragment" : "v1.col1"
  } ]
}


-- !query
DROP VIEW IF EXISTS v1
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW IF EXISTS v2
-- !query schema
struct<>
-- !query output

