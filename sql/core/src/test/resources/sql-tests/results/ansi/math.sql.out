-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT round(25y, 1)
-- !query schema
struct<round(25, 1):tinyint>
-- !query output
25


-- !query
SELECT round(25y, 0)
-- !query schema
struct<round(25, 0):tinyint>
-- !query output
25


-- !query
SELECT round(25y, -1)
-- !query schema
struct<round(25, -1):tinyint>
-- !query output
30


-- !query
SELECT round(25y, -2)
-- !query schema
struct<round(25, -2):tinyint>
-- !query output
0


-- !query
SELECT round(25y, -3)
-- !query schema
struct<round(25, -3):tinyint>
-- !query output
0


-- !query
SELECT round(127y, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 22,
    "fragment" : "round(127y, -1)"
  } ]
}


-- !query
SELECT round(-128y, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 23,
    "fragment" : "round(-128y, -1)"
  } ]
}


-- !query
SELECT round(525s, 1)
-- !query schema
struct<round(525, 1):smallint>
-- !query output
525


-- !query
SELECT round(525s, 0)
-- !query schema
struct<round(525, 0):smallint>
-- !query output
525


-- !query
SELECT round(525s, -1)
-- !query schema
struct<round(525, -1):smallint>
-- !query output
530


-- !query
SELECT round(525s, -2)
-- !query schema
struct<round(525, -2):smallint>
-- !query output
500


-- !query
SELECT round(525s, -3)
-- !query schema
struct<round(525, -3):smallint>
-- !query output
1000


-- !query
SELECT round(32767s, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "round(32767s, -1)"
  } ]
}


-- !query
SELECT round(-32768s, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "round(-32768s, -1)"
  } ]
}


-- !query
SELECT round(525, 1)
-- !query schema
struct<round(525, 1):int>
-- !query output
525


-- !query
SELECT round(525, 0)
-- !query schema
struct<round(525, 0):int>
-- !query output
525


-- !query
SELECT round(525, -1)
-- !query schema
struct<round(525, -1):int>
-- !query output
530


-- !query
SELECT round(525, -2)
-- !query schema
struct<round(525, -2):int>
-- !query output
500


-- !query
SELECT round(525, -3)
-- !query schema
struct<round(525, -3):int>
-- !query output
1000


-- !query
SELECT round(2147483647, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 28,
    "fragment" : "round(2147483647, -1)"
  } ]
}


-- !query
SELECT round(-2147483647, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 29,
    "fragment" : "round(-2147483647, -1)"
  } ]
}


-- !query
SELECT round(525L, 1)
-- !query schema
struct<round(525, 1):bigint>
-- !query output
525


-- !query
SELECT round(525L, 0)
-- !query schema
struct<round(525, 0):bigint>
-- !query output
525


-- !query
SELECT round(525L, -1)
-- !query schema
struct<round(525, -1):bigint>
-- !query output
530


-- !query
SELECT round(525L, -2)
-- !query schema
struct<round(525, -2):bigint>
-- !query output
500


-- !query
SELECT round(525L, -3)
-- !query schema
struct<round(525, -3):bigint>
-- !query output
1000


-- !query
SELECT round(9223372036854775807L, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 38,
    "fragment" : "round(9223372036854775807L, -1)"
  } ]
}


-- !query
SELECT round(-9223372036854775808L, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_round' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 39,
    "fragment" : "round(-9223372036854775808L, -1)"
  } ]
}


-- !query
SELECT bround(25y, 1)
-- !query schema
struct<bround(25, 1):tinyint>
-- !query output
25


-- !query
SELECT bround(25y, 0)
-- !query schema
struct<bround(25, 0):tinyint>
-- !query output
25


-- !query
SELECT bround(25y, -1)
-- !query schema
struct<bround(25, -1):tinyint>
-- !query output
20


-- !query
SELECT bround(25y, -2)
-- !query schema
struct<bround(25, -2):tinyint>
-- !query output
0


-- !query
SELECT bround(25y, -3)
-- !query schema
struct<bround(25, -3):tinyint>
-- !query output
0


-- !query
SELECT bround(127y, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 23,
    "fragment" : "bround(127y, -1)"
  } ]
}


-- !query
SELECT bround(-128y, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "bround(-128y, -1)"
  } ]
}


-- !query
SELECT bround(525s, 1)
-- !query schema
struct<bround(525, 1):smallint>
-- !query output
525


-- !query
SELECT bround(525s, 0)
-- !query schema
struct<bround(525, 0):smallint>
-- !query output
525


-- !query
SELECT bround(525s, -1)
-- !query schema
struct<bround(525, -1):smallint>
-- !query output
520


-- !query
SELECT bround(525s, -2)
-- !query schema
struct<bround(525, -2):smallint>
-- !query output
500


-- !query
SELECT bround(525s, -3)
-- !query schema
struct<bround(525, -3):smallint>
-- !query output
1000


-- !query
SELECT bround(32767s, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 25,
    "fragment" : "bround(32767s, -1)"
  } ]
}


-- !query
SELECT bround(-32768s, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 26,
    "fragment" : "bround(-32768s, -1)"
  } ]
}


-- !query
SELECT bround(525, 1)
-- !query schema
struct<bround(525, 1):int>
-- !query output
525


-- !query
SELECT bround(525, 0)
-- !query schema
struct<bround(525, 0):int>
-- !query output
525


-- !query
SELECT bround(525, -1)
-- !query schema
struct<bround(525, -1):int>
-- !query output
520


-- !query
SELECT bround(525, -2)
-- !query schema
struct<bround(525, -2):int>
-- !query output
500


-- !query
SELECT bround(525, -3)
-- !query schema
struct<bround(525, -3):int>
-- !query output
1000


-- !query
SELECT bround(2147483647, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 29,
    "fragment" : "bround(2147483647, -1)"
  } ]
}


-- !query
SELECT bround(-2147483647, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "bround(-2147483647, -1)"
  } ]
}


-- !query
SELECT bround(525L, 1)
-- !query schema
struct<bround(525, 1):bigint>
-- !query output
525


-- !query
SELECT bround(525L, 0)
-- !query schema
struct<bround(525, 0):bigint>
-- !query output
525


-- !query
SELECT bround(525L, -1)
-- !query schema
struct<bround(525, -1):bigint>
-- !query output
520


-- !query
SELECT bround(525L, -2)
-- !query schema
struct<bround(525, -2):bigint>
-- !query output
500


-- !query
SELECT bround(525L, -3)
-- !query schema
struct<bround(525, -3):bigint>
-- !query output
1000


-- !query
SELECT bround(9223372036854775807L, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 39,
    "fragment" : "bround(9223372036854775807L, -1)"
  } ]
}


-- !query
SELECT bround(-9223372036854775808L, -1)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow",
    "try_alternative" : " Use 'try_bround' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 40,
    "fragment" : "bround(-9223372036854775808L, -1)"
  } ]
}


-- !query
SELECT conv('100', 2, 10)
-- !query schema
struct<conv(100, 2, 10):string>
-- !query output
4


-- !query
SELECT conv(-10, 16, -10)
-- !query schema
struct<conv(-10, 16, -10):string>
-- !query output
-16


-- !query
SELECT conv('9223372036854775808', 10, 16)
-- !query schema
struct<conv(9223372036854775808, 10, 16):string>
-- !query output
8000000000000000


-- !query
SELECT conv('92233720368547758070', 10, 16)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow in function conv()",
    "try_alternative" : " Use 'try_conv' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 43,
    "fragment" : "conv('92233720368547758070', 10, 16)"
  } ]
}


-- !query
SELECT conv('9223372036854775807', 36, 10)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow in function conv()",
    "try_alternative" : " Use 'try_conv' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 42,
    "fragment" : "conv('9223372036854775807', 36, 10)"
  } ]
}


-- !query
SELECT conv('-9223372036854775807', 36, 10)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkArithmeticException
{
  "errorClass" : "ARITHMETIC_OVERFLOW",
  "sqlState" : "22003",
  "messageParameters" : {
    "message" : "Overflow in function conv()",
    "try_alternative" : " Use 'try_conv' to tolerate overflow and return NULL instead."
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 43,
    "fragment" : "conv('-9223372036854775807', 36, 10)"
  } ]
}


-- !query
SELECT BIN(0)
-- !query schema
struct<bin(0):string>
-- !query output
0


-- !query
SELECT BIN(25)
-- !query schema
struct<bin(25):string>
-- !query output
11001


-- !query
SELECT BIN(25L)
-- !query schema
struct<bin(25):string>
-- !query output
11001


-- !query
SELECT BIN(25.5)
-- !query schema
struct<bin(25.5):string>
-- !query output
11001


-- !query
SELECT POSITIVE(0Y)
-- !query schema
struct<(+ 0):tinyint>
-- !query output
0


-- !query
SELECT POSITIVE(25)
-- !query schema
struct<(+ 25):int>
-- !query output
25


-- !query
SELECT POSITIVE(-25L)
-- !query schema
struct<(+ -25):bigint>
-- !query output
-25


-- !query
SELECT POSITIVE(25.5)
-- !query schema
struct<(+ 25.5):decimal(3,1)>
-- !query output
25.5


-- !query
SELECT POSITIVE("25.5")
-- !query schema
struct<(+ 25.5):double>
-- !query output
25.5


-- !query
SELECT POSITIVE("invalid")
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNumberFormatException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "expression" : "'invalid'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"DOUBLE\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 26,
    "fragment" : "POSITIVE(\"invalid\")"
  } ]
}


-- !query
SELECT POSITIVE(null)
-- !query schema
struct<(+ NULL):double>
-- !query output
NULL
