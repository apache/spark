-- Automatically generated by SQLQueryTestSuite
-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 INT NOT NULL, c2 INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES (1, 2)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE VIEW v WITH SCHEMA TYPE EVOLUTION AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<c1:int,c2:int>
-- !query output
1	2


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	int                 	                    
c2                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 STRING NOT NULL, c2 DOUBLE) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('1', 2.0)
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<c1:string,c2:double>
-- !query output
1	2.0


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	string              	                    
c2                  	double              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 STRING, c2 DOUBLE, c3 DATE) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES ('1', 2.0, DATE'2022-01-01')
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<c1:string,c2:double>
-- !query output
1	2.0


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	string              	                    
c2                  	double              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 INT, c2 INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES (1, 2)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE VIEW v WITH SCHEMA TYPE EVOLUTION AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<c1:int,c2:int>
-- !query output
1	2


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	int                 	                    
c2                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "c2",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE VIEW spark_catalog.default.v AS SELECT * FROM t",
    "viewName" : "`spark_catalog`.`default`.`v`"
  }
}


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	int                 	                    
c2                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c3 INT, c2 INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "c1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE VIEW spark_catalog.default.v AS SELECT * FROM t",
    "viewName" : "`spark_catalog`.`default`.`v`"
  }
}


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	int                 	                    
c2                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 INT COMMENT 'c1', c2 INT COMMENT 'c2') USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE VIEW v(a1, a2) WITH SCHEMA TYPE EVOLUTION AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a1                  	int                 	c1                  
a2                  	int                 	c2                  
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 BIGINT COMMENT 'c1 6a', c2 STRING COMMENT 'c2 6a') USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<a1:bigint,a2:string>
-- !query output



-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a1                  	bigint              	c1                  
a2                  	string              	c2                  
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
CREATE OR REPLACE VIEW v(a1 COMMENT 'a1', a2 COMMENT 'a2') WITH SCHEMA TYPE EVOLUTION AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a1                  	bigint              	a1                  
a2                  	string              	a2                  
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 BIGINT COMMENT 'c1 6b', c2 STRING COMMENT 'c2 6b') USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<a1:bigint,a2:string>
-- !query output



-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a1                  	bigint              	a1                  
a2                  	string              	a2                  
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1, c2]


-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 INT) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES(1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE VIEW v WITH SCHEMA COMPENSATION AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t(c1 STRING) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO t VALUES('1')
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<c1:int>
-- !query output
1


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	int                 	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1]


-- !query
ALTER VIEW v WITH SCHEMA TYPE EVOLUTION
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM v
-- !query schema
struct<c1:string>
-- !query output
1


-- !query
DESCRIBE EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Schema Mode    	TYPE EVOLUTION      	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c1]


-- !query
DROP VIEW IF EXISTS v
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE IF EXISTS t
-- !query schema
struct<>
-- !query output

