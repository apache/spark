-- Automatically generated by SQLQueryTestSuite
-- !query
create table char_tbl(c char(5), v varchar(6)) using parquet
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl            	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl


-- !query
desc formatted char_tbl c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
show create table char_tbl
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE spark_catalog.default.char_tbl (
  c CHAR(5),
  v VARCHAR(6))
USING parquet


-- !query
create table char_tbl2 using parquet as select * from char_tbl
-- !query schema
struct<>
-- !query output



-- !query
show create table char_tbl2
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE spark_catalog.default.char_tbl2 (
  c CHAR(5),
  v VARCHAR(6))
USING parquet


-- !query
desc formatted char_tbl2
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl2           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl2


-- !query
desc formatted char_tbl2 c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
create table char_tbl3 like char_tbl
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl3
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl3           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl3


-- !query
desc formatted char_tbl3 c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
show create table char_tbl3
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE spark_catalog.default.char_tbl3 (
  c CHAR(5),
  v VARCHAR(6))
USING parquet


-- !query
create view char_view as select * from char_tbl
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl	                    
View Original Text  	select * from char_tbl	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]


-- !query
desc formatted char_view c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
show create table char_view
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE VIEW default.char_view (
  c,
  v)
WITH SCHEMA COMPENSATION
AS select * from char_tbl


-- !query
alter table char_tbl rename to char_tbl1
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter table char_tbl1 change column c type char(6)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "NOT_SUPPORTED_CHANGE_COLUMN",
  "sqlState" : "0A000",
  "messageParameters" : {
    "newName" : "`c`",
    "newType" : "\"CHAR(6)\"",
    "originName" : "`c`",
    "originType" : "\"CHAR(5)\"",
    "table" : "`spark_catalog`.`default`.`char_tbl1`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 1,
    "stopIndex" : 50,
    "fragment" : "alter table char_tbl1 change column c type char(6)"
  } ]
}


-- !query
alter table char_tbl1 change column c type char(5)
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter table char_tbl1 add columns (d char(5))
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter view char_view as select * from char_tbl2
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl2	                    
View Original Text  	select * from char_tbl2	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]


-- !query
alter table char_tbl1 SET TBLPROPERTIES('yes'='no')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Table Properties    	[yes=no]            	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter view char_view SET TBLPROPERTIES('yes'='no')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl2	                    
View Original Text  	select * from char_tbl2	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]              	                    
Table Properties    	[yes=no]


-- !query
alter table char_tbl1 UNSET TBLPROPERTIES('yes')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter view char_view UNSET TBLPROPERTIES('yes')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl2	                    
View Original Text  	select * from char_tbl2	                    
View Schema Mode    	COMPENSATION        	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]


-- !query
alter table char_tbl1 SET SERDEPROPERTIES('yes'='no')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1	                    
Storage Properties  	[yes=no]


-- !query
create table char_part(c1 char(5), c2 char(2), v1 varchar(6), v2 varchar(2)) using parquet partitioned by (v2, c2)
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	                    
v1                  	varchar(6)          	                    
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
alter table char_part change column c1 comment 'char comment'
-- !query schema
struct<>
-- !query output



-- !query
alter table char_part change column v1 comment 'varchar comment'
-- !query schema
struct<>
-- !query output



-- !query
alter table char_part add partition (v2='ke', c2='nt') location 'loc1'
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	char comment        
v1                  	varchar(6)          	varchar comment     
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
alter table char_part partition (v2='ke') rename to partition (v2='nt')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "_LEGACY_ERROR_TEMP_1232",
  "messageParameters" : {
    "partitionColumnNames" : "v2, c2",
    "specKeys" : "v2",
    "tableName" : "`spark_catalog`.`default`.`char_part`"
  }
}


-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	char comment        
v1                  	varchar(6)          	varchar comment     
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
alter table char_part partition (v2='ke', c2='nt') set location 'loc2'
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	char comment        
v1                  	varchar(6)          	varchar comment     
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
MSCK REPAIR TABLE char_part
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	char comment        
v1                  	varchar(6)          	varchar comment     
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Catalog             	spark_catalog       	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
create temporary view str_view as select c, v from values
    (null, null),
    (null, 'S'),
    ('N', 'N '),
    ('Ne', 'Sp'),
    ('Net  ', 'Spa  '),
    ('NetE', 'Spar'),
    ('NetEa ', 'Spark '),
    ('NetEas ', 'Spark'),
    ('NetEase', 'Spark-') t(c, v)
-- !query schema
struct<>
-- !query output



-- !query
create table char_tbl4(c7 char(7), c8 char(8), v varchar(6), s string) using parquet
-- !query schema
struct<>
-- !query output



-- !query
insert into char_tbl4 select c, c, v, c from str_view
-- !query schema
struct<>
-- !query output



-- !query
select c7, c8, v, s from char_tbl4
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
N      	N       	N 	N
NULL	NULL	NULL	NULL
NULL	NULL	S	NULL
Ne     	Ne      	Sp	Ne
Net    	Net     	Spa  	Net  
NetE   	NetE    	Spar	NetE
NetEa  	NetEa   	Spark 	NetEa 
NetEas 	NetEas  	Spark	NetEas 
NetEase	NetEase 	Spark-	NetEase


-- !query
select c7, c8, v, s from char_tbl4 where c7 = c8
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
N      	N       	N 	N
Ne     	Ne      	Sp	Ne
Net    	Net     	Spa  	Net  
NetE   	NetE    	Spar	NetE
NetEa  	NetEa   	Spark 	NetEa 
NetEas 	NetEas  	Spark	NetEas 
NetEase	NetEase 	Spark-	NetEase


-- !query
select c7, c8, v, s from char_tbl4 where c7 = v
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output



-- !query
select c7, c8, v, s from char_tbl4 where c7 = s
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
NetEas 	NetEas  	Spark	NetEas 
NetEase	NetEase 	Spark-	NetEase


-- !query
select c7, c8, v, s from char_tbl4 where c7 = 'NetEase               '
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
NetEase	NetEase 	Spark-	NetEase


-- !query
select c7, c8, v, s from char_tbl4 where v = 'Spark '
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
NetEa  	NetEa   	Spark 	NetEa


-- !query
select c7, c8, v, s from char_tbl4 order by c7
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
NULL	NULL	NULL	NULL
NULL	NULL	S	NULL
N      	N       	N 	N
Ne     	Ne      	Sp	Ne
Net    	Net     	Spa  	Net  
NetE   	NetE    	Spar	NetE
NetEa  	NetEa   	Spark 	NetEa 
NetEas 	NetEas  	Spark	NetEas 
NetEase	NetEase 	Spark-	NetEase


-- !query
select c7, c8, v, s from char_tbl4 order by v
-- !query schema
struct<c7:string,c8:string,v:string,s:string>
-- !query output
NULL	NULL	NULL	NULL
N      	N       	N 	N
NULL	NULL	S	NULL
Ne     	Ne      	Sp	Ne
Net    	Net     	Spa  	Net  
NetE   	NetE    	Spar	NetE
NetEas 	NetEas  	Spark	NetEas 
NetEa  	NetEa   	Spark 	NetEa 
NetEase	NetEase 	Spark-	NetEase


-- !query
select ascii(c7), ascii(c8), ascii(v), ascii(s) from char_tbl4
-- !query schema
struct<ascii(c7):int,ascii(c8):int,ascii(v):int,ascii(s):int>
-- !query output
78	78	78	78
78	78	83	78
78	78	83	78
78	78	83	78
78	78	83	78
78	78	83	78
78	78	83	78
NULL	NULL	83	NULL
NULL	NULL	NULL	NULL


-- !query
select base64(c7), base64(c8), base64(v), ascii(s) from char_tbl4
-- !query schema
struct<base64(c7):string,base64(c8):string,base64(v):string,ascii(s):int>
-- !query output
NULL	NULL	NULL	NULL
NULL	NULL	Uw==	NULL
TiAgICAgIA==	TiAgICAgICA=	TiA=	78
TmUgICAgIA==	TmUgICAgICA=	U3A=	78
TmV0ICAgIA==	TmV0ICAgICA=	U3BhICA=	78
TmV0RSAgIA==	TmV0RSAgICA=	U3Bhcg==	78
TmV0RWEgIA==	TmV0RWEgICA=	U3Bhcmsg	78
TmV0RWFzIA==	TmV0RWFzICA=	U3Bhcms=	78
TmV0RWFzZQ==	TmV0RWFzZSA=	U3Bhcmst	78


-- !query
select bit_length(c7), bit_length(c8), bit_length(v), bit_length(s) from char_tbl4
-- !query schema
struct<bit_length(c7):int,bit_length(c8):int,bit_length(v):int,bit_length(s):int>
-- !query output
56	64	16	16
56	64	16	8
56	64	32	32
56	64	40	40
56	64	40	56
56	64	48	48
56	64	48	56
NULL	NULL	8	NULL
NULL	NULL	NULL	NULL


-- !query
select char_length(c7), char_length(c8), char_length(v), char_length(s) from char_tbl4
-- !query schema
struct<char_length(c7):int,char_length(c8):int,char_length(v):int,char_length(s):int>
-- !query output
7	8	2	1
7	8	2	2
7	8	4	4
7	8	5	5
7	8	5	7
7	8	6	6
7	8	6	7
NULL	NULL	1	NULL
NULL	NULL	NULL	NULL


-- !query
select octet_length(c7), octet_length(c8), octet_length(v), octet_length(s) from char_tbl4
-- !query schema
struct<octet_length(c7):int,octet_length(c8):int,octet_length(v):int,octet_length(s):int>
-- !query output
7	8	2	1
7	8	2	2
7	8	4	4
7	8	5	5
7	8	5	7
7	8	6	6
7	8	6	7
NULL	NULL	1	NULL
NULL	NULL	NULL	NULL


-- !query
select concat_ws('|', c7, c8), concat_ws('|', c7, v), concat_ws('|', c7, s), concat_ws('|', v, s) from char_tbl4
-- !query schema
struct<concat_ws(|, c7, c8):string,concat_ws(|, c7, v):string,concat_ws(|, c7, s):string,concat_ws(|, v, s):string>
-- !query output
			
	S		S
N      |N       	N      |N 	N      |N	N |N
Ne     |Ne      	Ne     |Sp	Ne     |Ne	Sp|Ne
Net    |Net     	Net    |Spa  	Net    |Net  	Spa  |Net  
NetE   |NetE    	NetE   |Spar	NetE   |NetE	Spar|NetE
NetEa  |NetEa   	NetEa  |Spark 	NetEa  |NetEa 	Spark |NetEa 
NetEas |NetEas  	NetEas |Spark	NetEas |NetEas 	Spark|NetEas 
NetEase|NetEase 	NetEase|Spark-	NetEase|NetEase	Spark-|NetEase


-- !query
select concat(c7, c8), concat(c7, v), concat(c7, s), concat(v, s) from char_tbl4
-- !query schema
struct<concat(c7, c8):string,concat(c7, v):string,concat(c7, s):string,concat(v, s):string>
-- !query output
N      N       	N      N 	N      N	N N
NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL
Ne     Ne      	Ne     Sp	Ne     Ne	SpNe
Net    Net     	Net    Spa  	Net    Net  	Spa  Net  
NetE   NetE    	NetE   Spar	NetE   NetE	SparNetE
NetEa  NetEa   	NetEa  Spark 	NetEa  NetEa 	Spark NetEa 
NetEas NetEas  	NetEas Spark	NetEas NetEas 	SparkNetEas 
NetEaseNetEase 	NetEaseSpark-	NetEaseNetEase	Spark-NetEase


-- !query
select like(c7, 'Ne     _'), like(c8, 'Ne     _') from char_tbl4
-- !query schema
struct<c7 LIKE Ne     _:boolean,c8 LIKE Ne     _:boolean>
-- !query output
NULL	NULL
NULL	NULL
false	false
false	false
false	false
false	false
false	false
false	false
false	true


-- !query
select like(v, 'Spark_') from char_tbl4
-- !query schema
struct<v LIKE Spark_:boolean>
-- !query output
NULL
false
false
false
false
false
false
true
true


-- !query
select c7 = c8, upper(c7) = upper(c8), lower(c7) = lower(c8) from char_tbl4 where s = 'NetEase'
-- !query schema
struct<(c7 = c8):boolean,(upper(c7) = upper(c8)):boolean,(lower(c7) = lower(c8)):boolean>
-- !query output
true	false	false


-- !query
select c7 = s, upper(c7) = upper(s), lower(c7) = lower(s) from char_tbl4 where s = 'NetEase'
-- !query schema
struct<(c7 = s):boolean,(upper(c7) = upper(s)):boolean,(lower(c7) = lower(s)):boolean>
-- !query output
true	true	true


-- !query
select c7 = 'NetEase', upper(c7) = upper('NetEase'), lower(c7) = lower('NetEase') from char_tbl4 where s = 'NetEase'
-- !query schema
struct<(c7 = NetEase):boolean,(upper(c7) = upper(NetEase)):boolean,(lower(c7) = lower(NetEase)):boolean>
-- !query output
true	true	true


-- !query
select printf('Hey, %s%s%s%s', c7, c8, v, s) from char_tbl4
-- !query schema
struct<printf(Hey, %s%s%s%s, c7, c8, v, s):string>
-- !query output
Hey, N      N       N N
Hey, Ne     Ne      SpNe
Hey, Net    Net     Spa  Net  
Hey, NetE   NetE    SparNetE
Hey, NetEa  NetEa   Spark NetEa 
Hey, NetEas NetEas  SparkNetEas 
Hey, NetEaseNetEase Spark-NetEase
Hey, nullnullSnull
Hey, nullnullnullnull


-- !query
select repeat(c7, 2), repeat(c8, 2), repeat(v, 2), repeat(s, 2) from char_tbl4
-- !query schema
struct<repeat(c7, 2):string,repeat(c8, 2):string,repeat(v, 2):string,repeat(s, 2):string>
-- !query output
N      N      	N       N       	N N 	NN
NULL	NULL	NULL	NULL
NULL	NULL	SS	NULL
Ne     Ne     	Ne      Ne      	SpSp	NeNe
Net    Net    	Net     Net     	Spa  Spa  	Net  Net  
NetE   NetE   	NetE    NetE    	SparSpar	NetENetE
NetEa  NetEa  	NetEa   NetEa   	Spark Spark 	NetEa NetEa 
NetEas NetEas 	NetEas  NetEas  	SparkSpark	NetEas NetEas 
NetEaseNetEase	NetEase NetEase 	Spark-Spark-	NetEaseNetEase


-- !query
select replace(c7, 'Net', 'Apache'), replace(c8, 'Net', 'Apache'), replace(v, 'Spark', 'Kyuubi'), replace(s, 'Net', 'Apache') from char_tbl4
-- !query schema
struct<replace(c7, Net, Apache):string,replace(c8, Net, Apache):string,replace(v, Spark, Kyuubi):string,replace(s, Net, Apache):string>
-- !query output
Apache    	Apache     	Spa  	Apache  
ApacheE   	ApacheE    	Spar	ApacheE
ApacheEa  	ApacheEa   	Kyuubi 	ApacheEa 
ApacheEas 	ApacheEas  	Kyuubi	ApacheEas 
ApacheEase	ApacheEase 	Kyuubi-	ApacheEase
N      	N       	N 	N
NULL	NULL	NULL	NULL
NULL	NULL	S	NULL
Ne     	Ne      	Sp	Ne


-- !query
select rpad(c7, 10), rpad(c8, 5), rpad(v, 5), rpad(s, 5)  from char_tbl4
-- !query schema
struct<rpad(c7, 10,  ):string,rpad(c8, 5,  ):string,rpad(v, 5,  ):string,rpad(s, 5,  ):string>
-- !query output
N         	N    	N    	N    
NULL	NULL	NULL	NULL
NULL	NULL	S    	NULL
Ne        	Ne   	Sp   	Ne   
Net       	Net  	Spa  	Net  
NetE      	NetE 	Spar 	NetE 
NetEa     	NetEa	Spark	NetEa
NetEas    	NetEa	Spark	NetEa
NetEase   	NetEa	Spark	NetEa


-- !query
select rtrim(c7), rtrim(c8), rtrim(v), rtrim(s) from char_tbl4
-- !query schema
struct<rtrim(c7):string,rtrim(c8):string,rtrim(v):string,rtrim(s):string>
-- !query output
N	N	N	N
NULL	NULL	NULL	NULL
NULL	NULL	S	NULL
Ne	Ne	Sp	Ne
Net	Net	Spa	Net
NetE	NetE	Spar	NetE
NetEa	NetEa	Spark	NetEa
NetEas	NetEas	Spark	NetEas
NetEase	NetEase	Spark-	NetEase


-- !query
select split(c7, 'e'), split(c8, 'e'), split(v, 'a'), split(s, 'e') from char_tbl4
-- !query schema
struct<split(c7, e, -1):array<string>,split(c8, e, -1):array<string>,split(v, a, -1):array<string>,split(s, e, -1):array<string>>
-- !query output
NULL	NULL	NULL	NULL
NULL	NULL	["S"]	NULL
["N      "]	["N       "]	["N "]	["N"]
["N","     "]	["N","      "]	["Sp"]	["N",""]
["N","t    "]	["N","t     "]	["Sp","  "]	["N","t  "]
["N","tE   "]	["N","tE    "]	["Sp","r"]	["N","tE"]
["N","tEa  "]	["N","tEa   "]	["Sp","rk "]	["N","tEa "]
["N","tEas "]	["N","tEas  "]	["Sp","rk"]	["N","tEas "]
["N","tEas",""]	["N","tEas"," "]	["Sp","rk-"]	["N","tEas",""]


-- !query
select substring(c7, 2), substring(c8, 2), substring(v, 3), substring(s, 2) from char_tbl4
-- !query schema
struct<substring(c7, 2, 2147483647):string,substring(c8, 2, 2147483647):string,substring(v, 3, 2147483647):string,substring(s, 2, 2147483647):string>
-- !query output
      	       		
NULL	NULL		NULL
NULL	NULL	NULL	NULL
e     	e      		e
et    	et     	a  	et  
etE   	etE    	ar	etE
etEa  	etEa   	ark 	etEa 
etEas 	etEas  	ark	etEas 
etEase	etEase 	ark-	etEase


-- !query
select left(c7, 2), left(c8, 2), left(v, 3), left(s, 2) from char_tbl4
-- !query schema
struct<left(c7, 2):string,left(c8, 2):string,left(v, 3):string,left(s, 2):string>
-- !query output
N 	N 	N 	N
NULL	NULL	NULL	NULL
NULL	NULL	S	NULL
Ne	Ne	Sp	Ne
Ne	Ne	Spa	Ne
Ne	Ne	Spa	Ne
Ne	Ne	Spa	Ne
Ne	Ne	Spa	Ne
Ne	Ne	Spa	Ne


-- !query
select right(c7, 2), right(c8, 2), right(v, 3), right(s, 2) from char_tbl4
-- !query schema
struct<right(c7, 2):string,right(c8, 2):string,right(v, 3):string,right(s, 2):string>
-- !query output
  	  	N 	N
  	  	Sp	Ne
  	  	a  	  
  	  	par	tE
  	  	rk 	a 
NULL	NULL	NULL	NULL
NULL	NULL	S	NULL
s 	  	ark	s 
se	e 	rk-	se


-- !query
select typeof(c7), typeof(c8), typeof(v), typeof(s) from char_tbl4 limit 1
-- !query schema
struct<typeof(c7):string,typeof(c8):string,typeof(v):string,typeof(s):string>
-- !query output
string	string	string	string


-- !query
select cast(c7 as char(1)), cast(c8 as char(10)), cast(v as char(1)), cast(v as varchar(1)), cast(s as char(5)) from char_tbl4
-- !query schema
struct<c7:string,c8:string,v:string,v:string,s:string>
-- !query output
N      	N       	N 	N 	N
NULL	NULL	NULL	NULL	NULL
NULL	NULL	S	S	NULL
Ne     	Ne      	Sp	Sp	Ne
Net    	Net     	Spa  	Spa  	Net  
NetE   	NetE    	Spar	Spar	NetE
NetEa  	NetEa   	Spark 	Spark 	NetEa 
NetEas 	NetEas  	Spark	Spark	NetEas 
NetEase	NetEase 	Spark-	Spark-	NetEase


-- !query
drop table char_tbl1
-- !query schema
struct<>
-- !query output



-- !query
drop table char_tbl2
-- !query schema
struct<>
-- !query output



-- !query
drop table char_tbl3
-- !query schema
struct<>
-- !query output



-- !query
drop table char_tbl4
-- !query schema
struct<>
-- !query output



-- !query
select ascii('§'), ascii('÷'), ascii('×10')
-- !query schema
struct<ascii(§):int,ascii(÷):int,ascii(×10):int>
-- !query output
167	247	215


-- !query
select chr(167), chr(247), chr(215)
-- !query schema
struct<chr(167):string,chr(247):string,chr(215):string>
-- !query output
§	÷	×


-- !query
SELECT to_varchar(78.12, '$99.99')
-- !query schema
struct<to_char(78.12, $99.99):string>
-- !query output
$78.12


-- !query
SELECT to_varchar(111.11, '99.9')
-- !query schema
struct<to_char(111.11, 99.9):string>
-- !query output
##.#


-- !query
SELECT to_varchar(12454.8, '99,999.9S')
-- !query schema
struct<to_char(12454.8, 99,999.9S):string>
-- !query output
12,454.8+
