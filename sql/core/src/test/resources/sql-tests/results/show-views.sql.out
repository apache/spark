-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE DATABASE showdb
-- !query schema
struct<>
-- !query output



-- !query
USE showdb
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE tbl(a STRING, b INT, c STRING, d STRING) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW view_1 AS SELECT * FROM tbl
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW view_2 AS SELECT * FROM tbl WHERE c='a'
-- !query schema
struct<>
-- !query output



-- !query
CREATE GLOBAL TEMP VIEW view_3 AS SELECT 1 as col1
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW view_4(e INT) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
SHOW VIEWS
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2
view_4


-- !query
SHOW VIEWS FROM showdb
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2
view_4


-- !query
SHOW VIEWS IN showdb
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2
view_4


-- !query
SHOW VIEWS IN global_temp
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_3
view_4


-- !query
SHOW VIEWS 'view_*'
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2
view_4


-- !query
SHOW VIEWS LIKE 'view_1*|view_2*'
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2


-- !query
SHOW VIEWS IN showdb 'view_*'
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2
view_4


-- !query
SHOW VIEWS IN showdb LIKE 'view_*'
-- !query schema
struct<namespace:string,viewName:string,isTemporary:boolean>
-- !query output
view_1
view_2
view_4


-- !query
SHOW VIEWS IN wrongdb LIKE 'view_*'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchNamespaceException
{
  "errorClass" : "SCHEMA_NOT_FOUND",
  "sqlState" : "42704",
  "messageParameters" : {
    "schemaName" : "`spark_catalog`.`wrongdb`"
  }
}


-- !query
SHOW VIEWS AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
SHOW VIEWS FROM showdb AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
SHOW VIEWS IN showdb AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
SHOW VIEWS IN global_temp AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"global_temp","viewName":"view_3","isTemporary":true},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
SHOW VIEWS 'view_*' AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
SHOW VIEWS LIKE 'view_1*|view_2*' AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false}]}


-- !query
SHOW VIEWS IN showdb 'view_*' AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
SHOW VIEWS IN showdb LIKE 'view_*' AS JSON
-- !query schema
struct<namespace:string>
-- !query output
{"views":[{"namespace":"showdb","viewName":"view_1","isTemporary":false},{"namespace":"showdb","viewName":"view_2","isTemporary":false},{"namespace":"","viewName":"view_4","isTemporary":true}]}


-- !query
DROP VIEW global_temp.view_3
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW view_4
-- !query schema
struct<>
-- !query output



-- !query
USE default
-- !query schema
struct<>
-- !query output



-- !query
DROP DATABASE showdb CASCADE
-- !query schema
struct<>
-- !query output

