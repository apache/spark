-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW tbl_x AS VALUES
  (1, NAMED_STRUCT('C', 'gamma', 'D', 'delta')),
  (2, NAMED_STRUCT('C', 'epsilon', 'D', 'eta')),
  (3, NAMED_STRUCT('C', 'theta', 'D', 'iota'))
  AS T(ID, ST)
-- !query analysis
CreateViewCommand `tbl_x`, VALUES
  (1, NAMED_STRUCT('C', 'gamma', 'D', 'delta')),
  (2, NAMED_STRUCT('C', 'epsilon', 'D', 'eta')),
  (3, NAMED_STRUCT('C', 'theta', 'D', 'iota'))
  AS T(ID, ST), false, false, LocalTempView, UNSUPPORTED, true
   +- SubqueryAlias T
      +- LocalRelation [ID#x, ST#x]


-- !query
SELECT STRUCT('alpha', 'beta') ST
-- !query analysis
Project [struct(col1, alpha, col2, beta) AS ST#x]
+- OneRowRelation


-- !query
SELECT STRUCT('alpha' AS A, 'beta' AS B) ST
-- !query analysis
Project [struct(A, alpha, B, beta) AS ST#x]
+- OneRowRelation


-- !query
SELECT ID, STRUCT(ST.*) NST FROM tbl_x
-- !query analysis
Project [ID#x, struct(C, ST#x.C, D, ST#x.D) AS NST#x]
+- SubqueryAlias tbl_x
   +- View (`tbl_x`, [ID#x, ST#x])
      +- Project [cast(ID#x as int) AS ID#x, cast(ST#x as struct<C:string,D:string>) AS ST#x]
         +- SubqueryAlias T
            +- LocalRelation [ID#x, ST#x]


-- !query
SELECT ID, STRUCT(ST.*,CAST(ID AS STRING) AS E) NST FROM tbl_x
-- !query analysis
Project [ID#x, struct(C, ST#x.C, D, ST#x.D, E, cast(ID#x as string)) AS NST#x]
+- SubqueryAlias tbl_x
   +- View (`tbl_x`, [ID#x, ST#x])
      +- Project [cast(ID#x as int) AS ID#x, cast(ST#x as struct<C:string,D:string>) AS ST#x]
         +- SubqueryAlias T
            +- LocalRelation [ID#x, ST#x]


-- !query
SELECT ID, STRUCT(CAST(ID AS STRING) AS AA, ST.*) NST FROM tbl_x
-- !query analysis
Project [ID#x, struct(AA, cast(ID#x as string), C, ST#x.C, D, ST#x.D) AS NST#x]
+- SubqueryAlias tbl_x
   +- View (`tbl_x`, [ID#x, ST#x])
      +- Project [cast(ID#x as int) AS ID#x, cast(ST#x as struct<C:string,D:string>) AS ST#x]
         +- SubqueryAlias T
            +- LocalRelation [ID#x, ST#x]


-- !query
SELECT ID, STRUCT(ST.*).C NST FROM tbl_x
-- !query analysis
Project [ID#x, struct(C, ST#x.C, D, ST#x.D).C AS NST#x]
+- SubqueryAlias tbl_x
   +- View (`tbl_x`, [ID#x, ST#x])
      +- Project [cast(ID#x as int) AS ID#x, cast(ST#x as struct<C:string,D:string>) AS ST#x]
         +- SubqueryAlias T
            +- LocalRelation [ID#x, ST#x]


-- !query
SELECT ID, STRUCT(ST.C, ST.D).D NST FROM tbl_x
-- !query analysis
Project [ID#x, struct(C, ST#x.C, D, ST#x.D).D AS NST#x]
+- SubqueryAlias tbl_x
   +- View (`tbl_x`, [ID#x, ST#x])
      +- Project [cast(ID#x as int) AS ID#x, cast(ST#x as struct<C:string,D:string>) AS ST#x]
         +- SubqueryAlias T
            +- LocalRelation [ID#x, ST#x]


-- !query
SELECT ID, STRUCT(ST.C as STC, ST.D as STD).STD FROM tbl_x
-- !query analysis
Project [ID#x, struct(STC, ST#x.C, STD, ST#x.D).STD AS struct(ST.C AS STC, ST.D AS STD).STD#x]
+- SubqueryAlias tbl_x
   +- View (`tbl_x`, [ID#x, ST#x])
      +- Project [cast(ID#x as int) AS ID#x, cast(ST#x as struct<C:string,D:string>) AS ST#x]
         +- SubqueryAlias T
            +- LocalRelation [ID#x, ST#x]
