-- Automatically generated by SQLQueryTestSuite
-- !query
select * from values ("one", 1)
-- !query analysis
Project [col1#x, col2#x]
+- LocalRelation [col1#x, col2#x]


-- !query
select * from values ("one", 1) as data
-- !query analysis
Project [col1#x, col2#x]
+- SubqueryAlias data
   +- LocalRelation [col1#x, col2#x]


-- !query
select * from values ("one", 1) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select * from values 1, 2, 3 as data(a)
-- !query analysis
Project [a#x]
+- SubqueryAlias data
   +- LocalRelation [a#x]


-- !query
select * from values ("one", 1), ("two", 2), ("three", null) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select * from values ("one", null), ("two", null) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select * from values ("one", 1), ("two", 2L) as data(a, b)
-- !query analysis
Project [a#x, b#xL]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#xL]


-- !query
select * from values ("one", 1 + 0), ("two", 1 + 3L) as data(a, b)
-- !query analysis
Project [a#x, b#xL]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#xL]


-- !query
select * from values ("one", 1 as one) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select a from values ("one", current_timestamp) as data(a, b)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select * from values ("one", array(0, 1)), ("two", array(2, 3)) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select * from values ("one", 2.0), ("two", 3.0D) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select * from values ("one", rand(5)), ("two", 3.0D) as data(a, b)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select * from values ("one", 2.0), ("two") as data(a, b)
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_INLINE_TABLE.NUM_COLUMNS_MISMATCH",
  "sqlState" : "42000",
  "messageParameters" : {
    "actualNumCols" : "1",
    "expectedNumCols" : "2",
    "rowIndex" : "1"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 56,
    "fragment" : "values (\"one\", 2.0), (\"two\") as data(a, b)"
  } ]
}


-- !query
select * from values ("one", array(0, 1)), ("two", struct(1, 2)) as data(a, b)
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_INLINE_TABLE.INCOMPATIBLE_TYPES_IN_INLINE_TABLE",
  "sqlState" : "42000",
  "messageParameters" : {
    "colName" : "`b`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 78,
    "fragment" : "values (\"one\", array(0, 1)), (\"two\", struct(1, 2)) as data(a, b)"
  } ]
}


-- !query
select * from values ("one"), ("two") as data(a, b)
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_INLINE_TABLE.NUM_COLUMNS_MISMATCH",
  "sqlState" : "42000",
  "messageParameters" : {
    "actualNumCols" : "1",
    "expectedNumCols" : "2",
    "rowIndex" : "0"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 51,
    "fragment" : "values (\"one\"), (\"two\") as data(a, b)"
  } ]
}


-- !query
select * from values ("one", random_not_exist_func(1)), ("two", 2) as data(a, b)
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`random_not_exist_func`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 53,
    "fragment" : "random_not_exist_func(1)"
  } ]
}


-- !query
select * from values ("one", count(1)), ("two", 2) as data(a, b)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNSUPPORTED_EXPR_FOR_OPERATOR",
  "sqlState" : "42K0E",
  "messageParameters" : {
    "invalidExprSqls" : "\"count(1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 64,
    "fragment" : "values (\"one\", count(1)), (\"two\", 2) as data(a, b)"
  } ]
}


-- !query
select * from values (timestamp('1991-12-06 00:00:00.0'), array(timestamp('1991-12-06 01:00:00.0'), timestamp('1991-12-06 12:00:00.0'))) as data(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias data
   +- LocalRelation [a#x, b#x]


-- !query
select * from values (try_add(5, 0))
-- !query analysis
Project [col1#x]
+- LocalRelation [col1#x]


-- !query
select * from values (try_divide(5, 0))
-- !query analysis
Project [col1#x]
+- LocalRelation [col1#x]


-- !query
select * from values (10 + try_divide(5, 0))
-- !query analysis
Project [col1#x]
+- LocalRelation [col1#x]


-- !query
select count(distinct ct) from values now(), now(), now() as data(ct)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select count(distinct ct) from values current_timestamp(), current_timestamp() as data(ct)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select count(*) from values (rand()), (rand()), (rand()) as data(a)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select count(*) from values (rand(1)), (rand(2)), (rand(3)) as data(a)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select count(*) from values (random()), (random()) as data(a)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select length(a) from values (uuid()), (uuid()) as data(a)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select a from values (1, rand(5)), (2, rand(5)) as data(a, b)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select count(*) from values (1 + rand(5)), (2 + rand(5)) as data(a)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select * from values (1) as t(c1), lateral (values (t.c1)) as s(c2)
-- !query analysis
Project [c1#x, c2#x]
+- LateralJoin lateral-subquery#x [c1#x], Inner
   :  +- SubqueryAlias s
   :     +- Project [col1#x AS c2#x]
   :        +- ResolvedInlineTable [[outer(c1#x)]], [col1#x]
   +- SubqueryAlias t
      +- LocalRelation [c1#x]


-- !query
select * from values (1, 2) as t(c1, c2), lateral (values (t.c1, t.c2)) as s(c3, c4)
-- !query analysis
Project [c1#x, c2#x, c3#x, c4#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x], Inner
   :  +- SubqueryAlias s
   :     +- Project [col1#x AS c3#x, col2#x AS c4#x]
   :        +- ResolvedInlineTable [[outer(c1#x), outer(c2#x)]], [col1#x, col2#x]
   +- SubqueryAlias t
      +- LocalRelation [c1#x, c2#x]


-- !query
select * from values (1, 2) as t(c1, c2), lateral (values (t.c1 + t.c2)) as s(c3)
-- !query analysis
Project [c1#x, c2#x, c3#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x], Inner
   :  +- SubqueryAlias s
   :     +- Project [col1#x AS c3#x]
   :        +- ResolvedInlineTable [[(outer(c1#x) + outer(c2#x))]], [col1#x]
   +- SubqueryAlias t
      +- LocalRelation [c1#x, c2#x]


-- !query
select * from values (1), (2), (3) as t(c1), lateral (values (t.c1 * 2)) as s(c2) order by c1
-- !query analysis
Sort [c1#x ASC NULLS FIRST], true
+- Project [c1#x, c2#x]
   +- LateralJoin lateral-subquery#x [c1#x], Inner
      :  +- SubqueryAlias s
      :     +- Project [col1#x AS c2#x]
      :        +- ResolvedInlineTable [[(outer(c1#x) * 2)]], [col1#x]
      +- SubqueryAlias t
         +- LocalRelation [c1#x]


-- !query
select * from values (1, 2) as t(c1, c2), lateral (values (t.c1), (t.c2)) as s(c3) order by c3
-- !query analysis
Sort [c3#x ASC NULLS FIRST], true
+- Project [c1#x, c2#x, c3#x]
   +- LateralJoin lateral-subquery#x [c1#x && c2#x], Inner
      :  +- SubqueryAlias s
      :     +- Project [col1#x AS c3#x]
      :        +- ResolvedInlineTable [[outer(c1#x)], [outer(c2#x)]], [col1#x]
      +- SubqueryAlias t
         +- LocalRelation [c1#x, c2#x]


-- !query
select * from values (1), (2) as t(c1), lateral (values (t.c1), (t.c1 + 10)) as s(c2) order by c1, c2
-- !query analysis
Sort [c1#x ASC NULLS FIRST, c2#x ASC NULLS FIRST], true
+- Project [c1#x, c2#x]
   +- LateralJoin lateral-subquery#x [c1#x && c1#x], Inner
      :  +- SubqueryAlias s
      :     +- Project [col1#x AS c2#x]
      :        +- ResolvedInlineTable [[outer(c1#x)], [(outer(c1#x) + 10)]], [col1#x]
      +- SubqueryAlias t
         +- LocalRelation [c1#x]


-- !query
select * from values (1, 2) as t(c1, c2),
  lateral (values (t.c1, t.c2, t.c1 + t.c2)) as s(c3, c4, c5)
-- !query analysis
Project [c1#x, c2#x, c3#x, c4#x, c5#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x && c1#x && c2#x], Inner
   :  +- SubqueryAlias s
   :     +- Project [col1#x AS c3#x, col2#x AS c4#x, col3#x AS c5#x]
   :        +- ResolvedInlineTable [[outer(c1#x), outer(c2#x), (outer(c1#x) + outer(c2#x))]], [col1#x, col2#x, col3#x]
   +- SubqueryAlias t
      +- LocalRelation [c1#x, c2#x]


-- !query
select t.c1, s.c2 from values (1) as t(c1),
  lateral (values (t.c1, rand())) as s(c2, c3) order by c1
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select t.c1 from values (1), (2) as t(c1),
  lateral (values (t.c1, rand())) as s(c2, c3) order by c1
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNSUPPORTED_SUBQUERY_EXPRESSION_CATEGORY.NON_DETERMINISTIC_LATERAL_SUBQUERIES",
  "sqlState" : "0A000",
  "messageParameters" : {
    "treeNode" : "LateralJoin lateral-subquery#x [c1#x], Inner\n:  +- SubqueryAlias s\n:     +- Project [col1#x AS c2#x, col2#x AS c3#x]\n:        +- ResolvedInlineTable [[outer(c1#x), rand(number)]], [col1#x, col2#x]\n+- SubqueryAlias t\n   +- LocalRelation [c1#x]\n"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 13,
    "stopIndex" : 89,
    "fragment" : "from values (1), (2) as t(c1),\n  lateral (values (t.c1, rand())) as s(c2, c3)"
  } ]
}


-- !query
select t.c1 from values (1) as t(c1),
  lateral (values (t.c1, rand()), (t.c1 + 1, rand())) as s(c2, c3) order by c2
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select c1, c2, c3 = current_date as date_matches from values (1) as t(c1),
  lateral (values (t.c1, current_date)) as s(c2, c3)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]


-- !query
select * from values (1) as t(c1),
  lateral (values (t.c1, 2.0), (t.c1 + 1, 3.0)) as s(c2, c3) order by c2
-- !query analysis
Sort [c2#x ASC NULLS FIRST], true
+- Project [c1#x, c2#x, c3#x]
   +- LateralJoin lateral-subquery#x [c1#x && c1#x], Inner
      :  +- SubqueryAlias s
      :     +- Project [col1#x AS c2#x, col2#x AS c3#x]
      :        +- ResolvedInlineTable [[outer(c1#x), 2.0], [(outer(c1#x) + 1), 3.0]], [col1#x, col2#x]
      +- SubqueryAlias t
         +- LocalRelation [c1#x]


-- !query
select * from values (1, null) as t(c1, c2),
  lateral (values (t.c1, t.c2)) as s(c3, c4)
-- !query analysis
Project [c1#x, c2#x, c3#x, c4#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x], Inner
   :  +- SubqueryAlias s
   :     +- Project [col1#x AS c3#x, col2#x AS c4#x]
   :        +- ResolvedInlineTable [[outer(c1#x), outer(c2#x)]], [col1#x, col2#x]
   +- SubqueryAlias t
      +- LocalRelation [c1#x, c2#x]


-- !query
select * from values (1, 2, 3) as t(c1, c2, c3),
  lateral (values (t.c1 * t.c2 + t.c3)) as s(c4)
-- !query analysis
Project [c1#x, c2#x, c3#x, c4#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x && c3#x], Inner
   :  +- SubqueryAlias s
   :     +- Project [col1#x AS c4#x]
   :        +- ResolvedInlineTable [[((outer(c1#x) * outer(c2#x)) + outer(c3#x))]], [col1#x]
   +- SubqueryAlias t
      +- LocalRelation [c1#x, c2#x, c3#x]


-- !query
select * from values (1), (2) as t(c1)
  left join lateral (values (t.c1 * 10)) as s(c2) on true order by c1
-- !query analysis
Sort [c1#x ASC NULLS FIRST], true
+- Project [c1#x, c2#x]
   +- LateralJoin lateral-subquery#x [c1#x], LeftOuter, true
      :  +- SubqueryAlias s
      :     +- Project [col1#x AS c2#x]
      :        +- ResolvedInlineTable [[(outer(c1#x) * 10)]], [col1#x]
      +- SubqueryAlias t
         +- LocalRelation [c1#x]
