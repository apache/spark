-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t AS SELECT 1
-- !query analysis
CreateViewCommand `t`, SELECT 1, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [1 AS 1#x]
      +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as tinyint) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS TINYINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as smallint) ELSE cast(2 as smallint) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS SMALLINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as int) ELSE cast(2 as int) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS INT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as bigint) ELSE cast(2 as bigint) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS BIGINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as decimal(10,0)) ELSE cast(2 as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as tinyint) as bigint) ELSE cast(cast(2 as string) as bigint) END AS CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS STRING) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "CASE WHEN true THEN cast(1 as tinyint) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "CASE WHEN true THEN cast(1 as tinyint) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "CASE WHEN true THEN cast(1 as tinyint) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as tinyint) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS TINYINT) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 90,
    "fragment" : "CASE WHEN true THEN cast(1 as tinyint) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as smallint) ELSE cast(cast(2 as tinyint) as smallint) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS TINYINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as smallint) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS SMALLINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as smallint) as int) ELSE cast(2 as int) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS INT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as smallint) as bigint) ELSE cast(2 as bigint) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS BIGINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as smallint) as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as smallint) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as smallint) as decimal(10,0)) ELSE cast(2 as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as smallint) as bigint) ELSE cast(cast(2 as string) as bigint) END AS CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS STRING) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 75,
    "fragment" : "CASE WHEN true THEN cast(1 as smallint) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "CASE WHEN true THEN cast(1 as smallint) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 98,
    "fragment" : "CASE WHEN true THEN cast(1 as smallint) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as smallint) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS SMALLINT) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 91,
    "fragment" : "CASE WHEN true THEN cast(1 as smallint) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as int) ELSE cast(cast(2 as tinyint) as int) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS TINYINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as int) ELSE cast(cast(2 as smallint) as int) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS SMALLINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as int) ELSE cast(2 as int) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS INT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as int) as bigint) ELSE cast(2 as bigint) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS BIGINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as int) as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as int) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as int) as decimal(10,0)) ELSE cast(2 as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as int) as bigint) ELSE cast(cast(2 as string) as bigint) END AS CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS STRING) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 70,
    "fragment" : "CASE WHEN true THEN cast(1 as int) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 69,
    "fragment" : "CASE WHEN true THEN cast(1 as int) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 93,
    "fragment" : "CASE WHEN true THEN cast(1 as int) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as int) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS INT) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 86,
    "fragment" : "CASE WHEN true THEN cast(1 as int) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as bigint) ELSE cast(cast(2 as tinyint) as bigint) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS TINYINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as bigint) ELSE cast(cast(2 as smallint) as bigint) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS SMALLINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as bigint) ELSE cast(cast(2 as int) as bigint) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS INT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as bigint) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS BIGINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as bigint) as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as bigint) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as bigint) as decimal(20,0)) ELSE cast(cast(2 as decimal(10,0)) as decimal(20,0)) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as bigint) ELSE cast(cast(2 as string) as bigint) END AS CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS STRING) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "CASE WHEN true THEN cast(1 as bigint) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "CASE WHEN true THEN cast(1 as bigint) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 96,
    "fragment" : "CASE WHEN true THEN cast(1 as bigint) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as bigint) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BIGINT) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 89,
    "fragment" : "CASE WHEN true THEN cast(1 as bigint) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(cast(2 as tinyint) as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS TINYINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(cast(2 as smallint) as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS SMALLINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(cast(2 as int) as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS INT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(cast(2 as bigint) as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS BIGINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as float) ELSE cast(2 as float) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(cast(2 as decimal(10,0)) as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as float) as double) ELSE cast(cast(2 as string) as double) END AS CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "CASE WHEN true THEN cast(1 as float) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "CASE WHEN true THEN cast(1 as float) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 95,
    "fragment" : "CASE WHEN true THEN cast(1 as float) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as float) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS FLOAT) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 88,
    "fragment" : "CASE WHEN true THEN cast(1 as float) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as tinyint) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS TINYINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as smallint) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS SMALLINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as int) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS INT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as bigint) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS BIGINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as decimal(10,0)) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as double) ELSE cast(cast(2 as string) as double) END AS CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "CASE WHEN true THEN cast(1 as double) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "CASE WHEN true THEN cast(1 as double) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 96,
    "fragment" : "CASE WHEN true THEN cast(1 as double) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as double) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DOUBLE) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 89,
    "fragment" : "CASE WHEN true THEN cast(1 as double) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as decimal(10,0)) ELSE cast(cast(2 as tinyint) as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS TINYINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as decimal(10,0)) ELSE cast(cast(2 as smallint) as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS SMALLINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as decimal(10,0)) ELSE cast(cast(2 as int) as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS INT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as decimal(10,0)) as decimal(20,0)) ELSE cast(cast(2 as bigint) as decimal(20,0)) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS BIGINT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as decimal(10,0)) as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as decimal(10,0)) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as decimal(10,0)) ELSE cast(2 as decimal(10,0)) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as decimal(10,0)) as double) ELSE cast(cast(2 as string) as double) END AS CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 81,
    "fragment" : "CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 80,
    "fragment" : "CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 104,
    "fragment" : "CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS DECIMAL(10,0)) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "CASE WHEN true THEN cast(1 as decimal(10, 0)) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as bigint) ELSE cast(cast(2 as tinyint) as bigint) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS TINYINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as smallint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as bigint) ELSE cast(cast(2 as smallint) as bigint) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS SMALLINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as int) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as bigint) ELSE cast(cast(2 as int) as bigint) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS INT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as bigint) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as bigint) ELSE cast(2 as bigint) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS BIGINT) END#xL]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as float) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as double) ELSE cast(cast(2 as float) as double) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS FLOAT) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as double) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as double) ELSE cast(2 as double) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS DOUBLE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as double) ELSE cast(cast(2 as decimal(10,0)) as double) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS DECIMAL(10,0)) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as string) ELSE cast(2 as string) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast('2' as binary) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as binary) ELSE cast(2 as binary) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS BINARY) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast(2 as boolean) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as boolean) ELSE cast(2 as boolean) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2 AS BOOLEAN) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as timestamp) ELSE cast(2017-12-11 09:30:00.0 as timestamp) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as string) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(1 as string) as date) ELSE cast(2017-12-11 09:30:00 as date) END AS CASE WHEN true THEN CAST(1 AS STRING) ELSE CAST(2017-12-11 09:30:00 AS DATE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"TINYINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS TINYINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as tinyint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as smallint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"SMALLINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS SMALLINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 75,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as smallint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as int) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"INT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS INT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 70,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as int) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as bigint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"BIGINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS BIGINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as bigint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as float) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"FLOAT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS FLOAT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as float) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as double) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"DOUBLE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS DOUBLE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as double) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"DECIMAL(10,0)\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS DECIMAL(10,0)) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 81,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as decimal(10, 0)) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as binary) ELSE cast(cast(2 as string) as binary) END AS CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast('2' as binary) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as binary) ELSE cast(2 as binary) END AS CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS BINARY) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 98,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('1' as binary) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BINARY) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 91,
    "fragment" : "CASE WHEN true THEN cast('1' as binary) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"TINYINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS TINYINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as tinyint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as smallint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"SMALLINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS SMALLINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as smallint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as int) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"INT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS INT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 69,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as int) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as bigint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"BIGINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS BIGINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as bigint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as float) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"FLOAT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS FLOAT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as float) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as double) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"DOUBLE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS DOUBLE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as double) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"DECIMAL(10,0)\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS DECIMAL(10,0)) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 80,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as decimal(10, 0)) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as boolean) ELSE cast(cast(2 as string) as boolean) END AS CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 74,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as boolean) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(1 as boolean) ELSE cast(2 as boolean) END AS CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2 AS BOOLEAN) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"TIMESTAMP\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast(1 as boolean) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"DATE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(1 AS BOOLEAN) ELSE CAST(2017-12-11 09:30:00 AS DATE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 90,
    "fragment" : "CASE WHEN true THEN cast(1 as boolean) ELSE cast('2017-12-11 09:30:00' as date) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"TINYINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS TINYINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as tinyint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as smallint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"SMALLINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS SMALLINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 98,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as smallint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as int) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"INT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS INT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 93,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as int) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as bigint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"BIGINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS BIGINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 96,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as bigint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as float) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"FLOAT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS FLOAT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 95,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as float) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as double) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"DOUBLE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS DOUBLE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 96,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as double) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"DECIMAL(10,0)\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS DECIMAL(10,0)) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 104,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as decimal(10, 0)) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(2017-12-12 09:30:00.0 as timestamp) ELSE cast(cast(2 as string) as timestamp) END AS CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 98,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(2017-12-12 09:30:00.0 as timestamp) ELSE cast(2017-12-11 09:30:00.0 as timestamp) END AS CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00.0' as timestamp) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(2017-12-12 09:30:00.0 as timestamp) ELSE cast(cast(2017-12-11 09:30:00 as date) as timestamp) END AS CASE WHEN true THEN CAST(2017-12-12 09:30:00.0 AS TIMESTAMP) ELSE CAST(2017-12-11 09:30:00 AS DATE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as tinyint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"TINYINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS TINYINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 90,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as tinyint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as smallint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"SMALLINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS SMALLINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 91,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as smallint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as int) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"INT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS INT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 86,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as int) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as bigint) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"BIGINT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS BIGINT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 89,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as bigint) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as float) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"FLOAT\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS FLOAT) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 88,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as float) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as double) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"DOUBLE\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS DOUBLE) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 89,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as double) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as decimal(10, 0)) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"DECIMAL(10,0)\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS DECIMAL(10,0)) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 97,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as decimal(10, 0)) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as string) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(2017-12-12 09:30:00 as date) ELSE cast(cast(2 as string) as date) END AS CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS STRING) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast('2' as binary) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"BINARY\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS BINARY) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 91,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast('2' as binary) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as boolean) END FROM t
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"BOOLEAN\"]",
    "functionName" : "`casewhen`",
    "sqlExpr" : "\"CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2 AS BOOLEAN) END\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 90,
    "fragment" : "CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast(2 as boolean) END"
  } ]
}


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast('2017-12-11 09:30:00.0' as timestamp) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(cast(2017-12-12 09:30:00 as date) as timestamp) ELSE cast(2017-12-11 09:30:00.0 as timestamp) END AS CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2017-12-11 09:30:00.0 AS TIMESTAMP) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation


-- !query
SELECT CASE WHEN true THEN cast('2017-12-12 09:30:00' as date) ELSE cast('2017-12-11 09:30:00' as date) END FROM t
-- !query analysis
Project [CASE WHEN true THEN cast(2017-12-12 09:30:00 as date) ELSE cast(2017-12-11 09:30:00 as date) END AS CASE WHEN true THEN CAST(2017-12-12 09:30:00 AS DATE) ELSE CAST(2017-12-11 09:30:00 AS DATE) END#x]
+- SubqueryAlias t
   +- View (`t`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- Project [1 AS 1#x]
            +- OneRowRelation
