-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT * FROM variant_explode(input => parse_json('["hello", "world"]'))
-- !query analysis
Project [pos#x, key#x, value#x]
+- Generate variant_explode(parse_json(["hello", "world"], true)), false, [pos#x, key#x, value#x]
   +- OneRowRelation


-- !query
SELECT * FROM variant_explode_outer(input => parse_json('{"a": true, "b": 3.14}'))
-- !query analysis
Project [pos#x, key#x, value#x]
+- Generate variant_explode(parse_json({"a": true, "b": 3.14}, true)), true, [pos#x, key#x, value#x]
   +- OneRowRelation


-- !query
SELECT * FROM variant_explode(parse_json('["hello", "world"]')), variant_explode(parse_json('{"a": true, "b": 3.14}'))
-- !query analysis
Project [pos#x, key#x, value#x, pos#x, key#x, value#x]
+- Join Inner
   :- Generate variant_explode(parse_json(["hello", "world"], true)), false, [pos#x, key#x, value#x]
   :  +- OneRowRelation
   +- Generate variant_explode(parse_json({"a": true, "b": 3.14}, true)), false, [pos#x, key#x, value#x]
      +- OneRowRelation


-- !query
SELECT * FROM variant_explode(parse_json('{"a": ["hello", "world"], "b": {"x": true, "y": 3.14}}')) AS t, LATERAL variant_explode(t.value)
-- !query analysis
Project [pos#x, key#x, value#x, pos#x, key#x, value#x]
+- LateralJoin lateral-subquery#x [value#x], Inner
   :  +- Generate variant_explode(outer(value#x)), false, [pos#x, key#x, value#x]
   :     +- OneRowRelation
   +- SubqueryAlias t
      +- Generate variant_explode(parse_json({"a": ["hello", "world"], "b": {"x": true, "y": 3.14}}, true)), false, [pos#x, key#x, value#x]
         +- OneRowRelation


-- !query
SELECT num, key, val, 'Spark' FROM variant_explode(parse_json('["hello", "world"]')) AS t(num, key, val)
-- !query analysis
Project [num#x, key#x, val#x, Spark AS Spark#x]
+- SubqueryAlias t
   +- Project [pos#x AS num#x, key#x AS key#x, value#x AS val#x]
      +- Generate variant_explode(parse_json(["hello", "world"], true)), false, [pos#x, key#x, value#x]
         +- OneRowRelation
