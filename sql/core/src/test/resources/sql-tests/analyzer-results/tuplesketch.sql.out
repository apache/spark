-- Automatically generated by SQLQueryTestSuite
-- !query
DROP TABLE IF EXISTS t_int_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_double_1_5_through_7_11


-- !query
CREATE TABLE t_int_double_1_5_through_7_11 AS
VALUES
  (1, 1.0D, 5, 5.0D), (2, 2.0D, 6, 6.0D), (3, 3.0D, 7, 7.0D),
  (4, 4.0D, 8, 8.0D), (5, 5.0D, 9, 9.0D), (6, 6.0D, 10, 10.0D),
  (7, 7.0D, 11, 11.0D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_int_double_1_5_through_7_11`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_long_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_long_double_1_5_through_7_11


-- !query
CREATE TABLE t_long_double_1_5_through_7_11 AS
VALUES
  (1L, 1.0D, 5L, 5.00D), (2L, 2.00D, 6L, 6.00D), (3L, 3.00D, 7L, 7.00D),
  (4L, 4.0D, 8L, 8.00D), (5L, 5.00D, 9L, 9.00D), (6L, 6.00D, 10L, 10.00D),
  (7L, 7.0D, 11L, 11.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_long_double_1_5_through_7_11`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#xL, val1#x, key2#xL, val2#x]


-- !query
DROP TABLE IF EXISTS t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_double_double_1_1_1_4_through_1_5_1_8


-- !query
CREATE TABLE t_double_double_1_1_1_4_through_1_5_1_8 AS
SELECT CAST(key1 AS DOUBLE) AS key1, CAST(val1 AS DOUBLE) AS val1,
       CAST(key2 AS DOUBLE) AS key2, CAST(val2 AS DOUBLE) AS val2
FROM VALUES
  (1.1, 1.0, 1.4, 4.0), (1.2, 2.0, 1.5, 5.0), (1.3, 3.0, 1.6, 6.0),
  (1.4, 4.0, 1.7, 7.0), (1.5, 5.0, 1.8, 8.0) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_double_double_1_1_1_4_through_1_5_1_8`, ErrorIfExists, [key1, val1, key2, val2]
   +- Project [cast(key1#x as double) AS key1#x, cast(val1#x as double) AS val1#x, cast(key2#x as double) AS key2#x, cast(val2#x as double) AS val2#x]
      +- SubqueryAlias tab
         +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_float_double_1_1_1_4_through_1_5_1_8


-- !query
CREATE TABLE t_float_double_1_1_1_4_through_1_5_1_8 AS
SELECT CAST(key1 AS FLOAT) key1, CAST(val1 AS DOUBLE) AS val1,
       CAST(key2 AS FLOAT) key2, CAST(val2 AS DOUBLE) AS val2
FROM VALUES
  (1.1, 1.0, 1.4, 4.0), (1.2, 2.0, 1.5, 5.0), (1.3, 3.0, 1.6, 6.0),
  (1.4, 4.0, 1.7, 7.0), (1.5, 5.0, 1.8, 8.0) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_float_double_1_1_1_4_through_1_5_1_8`, ErrorIfExists, [key1, val1, key2, val2]
   +- Project [cast(key1#x as float) AS key1#x, cast(val1#x as double) AS val1#x, cast(key2#x as float) AS key2#x, cast(val2#x as double) AS val2#x]
      +- SubqueryAlias tab
         +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_string_double_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_double_a_d_through_e_h


-- !query
CREATE TABLE t_string_double_a_d_through_e_h AS
VALUES
  ('a', 1.00D, 'd', 4.00D), ('b', 2.00D, 'e', 5.00D), ('c', 3.00D, 'f', 6.00D),
  ('d', 4.00D, 'g', 7.00D), ('e', 5.00D, 'h', 8.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_string_double_a_d_through_e_h`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_binary_double_a_b_through_e_f
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_binary_double_a_b_through_e_f


-- !query
CREATE TABLE t_binary_double_a_b_through_e_f AS
VALUES
  (X'A', 1.00D, X'B', 2.00D), (X'B', 2.00D, X'C', 3.00D), (X'C', 3.00D, X'D', 4.00D),
  (X'D', 4.00D, X'E', 5.00D), (X'E', 5.00D, X'F', 6.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_binary_double_a_b_through_e_f`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_array_int_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_int_double_1_3_through_4_6


-- !query
CREATE TABLE t_array_int_double_1_3_through_4_6 AS
VALUES
  (ARRAY(1), 1.00D, ARRAY(3), 3.00D),
  (ARRAY(2), 2.00D, ARRAY(4), 4.00D),
  (ARRAY(3), 3.00D, ARRAY(5), 5.00D),
  (ARRAY(4), 4.00D, ARRAY(6), 6.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_array_int_double_1_3_through_4_6`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_array_long_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_long_double_1_3_through_4_6


-- !query
CREATE TABLE t_array_long_double_1_3_through_4_6 AS
VALUES
  (ARRAY(1L), 1.00D, ARRAY(3L), 3.00D),
  (ARRAY(2L), 2.00D, ARRAY(4L), 4.00D),
  (ARRAY(3L), 3.00D, ARRAY(5L), 5.00D),
  (ARRAY(4L), 4.00D, ARRAY(6L), 6.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_array_long_double_1_3_through_4_6`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_int_int_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_int_1_5_through_7_11


-- !query
CREATE TABLE t_int_int_1_5_through_7_11 AS
VALUES
  (1, 1, 5, 5), (2, 2, 6, 6), (3, 3, 7, 7),
  (4, 4, 8, 8), (5, 5, 9, 9), (6, 6, 10, 10),
  (7, 7, 11, 11) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_int_int_1_5_through_7_11`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_string_string_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_string_a_d_through_e_h


-- !query
CREATE TABLE t_string_string_a_d_through_e_h AS
VALUES
  ('a', 'val_a', 'd', 'val_d'), ('b', 'val_b', 'e', 'val_e'),
  ('c', 'val_c', 'f', 'val_f'), ('d', 'val_d', 'g', 'val_g'),
  ('e', 'val_e', 'h', 'val_h') AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_string_string_a_d_through_e_h`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_string_array_string_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_array_string_a_d_through_e_h


-- !query
CREATE TABLE t_string_array_string_a_d_through_e_h AS
VALUES
  ('a', array('val_a', 'extra_a'), 'd', array('val_d')), 
  ('b', array('val_b'), 'e', array('val_e', 'extra_e')),
  ('c', array('val_c1', 'val_c2', 'val_c3'), 'f', array('val_f')), 
  ('d', array('val_d'), 'g', array('val_g')),
  ('e', array('val_e'), 'h', array('val_h1', 'val_h2')) 
AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_string_array_string_a_d_through_e_h`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_string_collation
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_collation


-- !query
CREATE TABLE t_string_collation AS
VALUES
  ('', 1.00D), ('  ', 2.00D), (CAST(X'C1' AS STRING), 3.00D), (CAST(X'80' AS STRING), 4.00D),
  ('\uFFFD', 5.00D), ('Å', 6.00D), ('å', 7.00D), ('a\u030A', 8.00D), ('Å ', 9.00D), ('å  ', 10.00D),
  ('a\u030A   ', 11.00D) AS tab(key1, val1)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_string_collation`, ErrorIfExists, [key1, val1]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1))) AS result
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS result#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'integer'), 'integer') AS result
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), integer, sum, 0, 0), integer) AS result#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1)))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key2, val2)))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key2, val2), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1)))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1)))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key2, val2)))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key2, val2), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 22))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(22), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 22, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1)))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1)))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'double'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'integer'), 'integer')
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), integer, sum, 0, 0), integer) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, integer, sum), integer)#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'string'), 'string')
FROM t_string_string_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), string, sum, 0, 0), string) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, string, sum), string)#x]
+- SubqueryAlias spark_catalog.default.t_string_string_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_string_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'string'), 'string')
FROM t_string_array_string_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), string, sum, 0, 0), string) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, string, sum), string)#x]
+- SubqueryAlias spark_catalog.default.t_string_array_string_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_array_string_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'), 'double')
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, min, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, min), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, max, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, max), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'alwaysone'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, alwaysone, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, alwaysone), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double, sum) AS tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, double, sum), double, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, min, 0, 0), double, sum) AS tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, double, min), double, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, max, 0, 0), double, sum) AS tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, double, max), double, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'alwaysone'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, alwaysone, 0, 0), double, sum) AS tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, double, alwaysone), double, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, 'integer', 'sum'), 'integer', 'sum')
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), integer, sum, 0, 0), integer, sum) AS tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, integer, sum), integer, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1), 15),
    tuple_sketch_agg(struct(key2, val2)), 15))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(15), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#xL, val2, val2#x), Some(12), double, sum, 0, 0), 15, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 15, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 15, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1), 6),
    tuple_sketch_agg(struct(key2, val2), 15), 15))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(6), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(15), double, sum, 0, 0), 15, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 6, double, sum), tuple_sketch_agg(struct(key2, val2), 15, double, sum), 15, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2), 20), 20))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(20), double, sum, 0, 0), 20, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 20, double, sum), 20, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2), 13), 13))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(13), double, sum, 0, 0), 13, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 13, double, sum), 13, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union(
    tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'),
    tuple_sketch_agg(struct(key2, val2), 12, 'double', 'sum'), 12, 'double', 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union_theta(
    tuple_sketch_agg(struct(key1, val1)),
    theta_sketch_agg(key2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_theta(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), theta_sketch_agg(key2#x, 12, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union_theta(tuple_sketch_agg(struct(key1, val1), 12, double, sum), theta_sketch_agg(key2, 12), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_union_theta(
    tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'),
    theta_sketch_agg(key2, 12), 12, 'double', 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_theta(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), theta_sketch_agg(key2#x, 12, 0, 0), 12, double, sum), double) AS tuple_sketch_estimate(tuple_union_theta(tuple_sketch_agg(struct(key1, val1), 12, double, sum), theta_sketch_agg(key2, 12), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1), 5),
    tuple_sketch_agg(struct(key2, val2), 12)))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(5), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#xL, val2, val2#x), Some(12), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 5, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1), 5),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(5), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 5, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2), 22)))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(22), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 22, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2), 10)))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(10), double, sum, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 10, double, sum), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection(
    tuple_sketch_agg(struct(key1, val1), 12, 'double', 'min'),
    tuple_sketch_agg(struct(key2, val2), 12, 'double', 'min'), 'double', 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, min, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, min, 0, 0), double, min), double) AS tuple_sketch_estimate(tuple_intersection(tuple_sketch_agg(struct(key1, val1), 12, double, min), tuple_sketch_agg(struct(key2, val2), 12, double, min), double, min), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection_theta(
    tuple_sketch_agg(struct(key1, val1)),
    theta_sketch_agg(key2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_theta(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), theta_sketch_agg(key2#x, 12, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection_theta(tuple_sketch_agg(struct(key1, val1), 12, double, sum), theta_sketch_agg(key2, 12), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_intersection_theta(
    tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'),
    theta_sketch_agg(key2, 12), 'double', 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_theta(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), theta_sketch_agg(key2#x, 12, 0, 0), double, sum), double) AS tuple_sketch_estimate(tuple_intersection_theta(tuple_sketch_agg(struct(key1, val1), 12, double, sum), theta_sketch_agg(key2, 12), double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2), 5)))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#xL, val2, val2#x), Some(5), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 5, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1), 12),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1), 6),
    tuple_sketch_agg(struct(key2, val2), 8)))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(6), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(8), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 6, double, sum), tuple_sketch_agg(struct(key2, val2), 8, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2))))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1)),
    tuple_sketch_agg(struct(key2, val2), 4)))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(4), double, sum, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, double, sum), tuple_sketch_agg(struct(key2, val2), 4, double, sum), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference(
    tuple_sketch_agg(struct(key1, val1), 12, 'integer', 'sum'),
    tuple_sketch_agg(struct(key2, val2), 12, 'integer', 'sum'), 'integer'), 'integer')
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), integer, sum, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), integer, sum, 0, 0), integer), integer) AS tuple_sketch_estimate(tuple_difference(tuple_sketch_agg(struct(key1, val1), 12, integer, sum), tuple_sketch_agg(struct(key2, val2), 12, integer, sum), integer), integer)#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference_theta(
    tuple_sketch_agg(struct(key1, val1)),
    theta_sketch_agg(key2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference_theta(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), theta_sketch_agg(key2#x, 12, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference_theta(tuple_sketch_agg(struct(key1, val1), 12, double, sum), theta_sketch_agg(key2, 12), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(
  tuple_difference_theta(
    tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'),
    theta_sketch_agg(key2, 12), 'double'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_difference_theta(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), theta_sketch_agg(key2#x, 12, 0, 0), double), double) AS tuple_sketch_estimate(tuple_difference_theta(tuple_sketch_agg(struct(key1, val1), 12, double, sum), theta_sketch_agg(key2, 12), double), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 15, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2), 20) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(15), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 15, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(20), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 12, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 12, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 14, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_string_double_a_d_through_e_h
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_string_double_a_d_through_e_h)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(14), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 14, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
      :     +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
            +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 10, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_long_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_long_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(10), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 10, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#xL, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 6, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(6), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 6, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 12, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_binary_double_a_b_through_e_f
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_binary_double_a_b_through_e_f)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 12, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
      :     +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
            +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 12, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_array_int_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_array_int_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 12, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 16, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_array_long_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_array_long_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(16), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_union_agg(sketch, 16, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_union_agg(sketch, 12, 'integer', 'sum'), 'integer')
FROM (SELECT tuple_sketch_agg(struct(key1, val1), 12, 'integer', 'sum') as sketch FROM t_int_int_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2), 12, 'integer', 'sum') as sketch FROM t_int_int_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_union_agg(sketch#x, Some(12), integer, sum, 0, 0), integer) AS tuple_sketch_estimate(tuple_union_agg(sketch, 12, integer, sum), integer)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), integer, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), integer, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_long_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_long_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#xL, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_string_double_a_d_through_e_h
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_string_double_a_d_through_e_h)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
      :     +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
            +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_binary_double_a_b_through_e_f
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_binary_double_a_b_through_e_f)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
      :     +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
            +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_array_int_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_array_int_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'double', 'sum'))
FROM (SELECT tuple_sketch_agg(struct(key1, val1)) as sketch FROM t_array_long_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2)) as sketch FROM t_array_long_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, double, sum), double)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_intersection_agg(sketch, 'integer', 'sum'), 'integer')
FROM (SELECT tuple_sketch_agg(struct(key1, val1), 12, 'integer', 'sum') as sketch FROM t_int_int_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg(struct(key2, val2), 12, 'integer', 'sum') as sketch FROM t_int_int_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_intersection_agg(sketch#x, integer, sum, 0, 0), integer) AS tuple_sketch_estimate(tuple_intersection_agg(sketch, integer, sum), integer)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), integer, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), integer, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (1, 1.0D), (null, 2.0D), (2, 2.0D), (null, 3.0D), (3, 3.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES ('test', 1.0D), (null, 2.0D), ('null', 3.0D), (null, 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (100L, 1.0D), (null, 2.0D), (200L, 3.0D), (null, 4.0D), (300L, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#xL, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#xL, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(CAST(key AS DOUBLE), val)))
FROM VALUES (1.1, 1.0D), (null, 2.0D), (2.2, 3.0D), (null, 4.0D), (3.3, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, cast(key#x as double), val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(CAST(key AS DOUBLE), val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(CAST(key AS FLOAT), val)))
FROM VALUES (1.5, 1.0D), (null, 2.0D), (2.5, 3.0D), (null, 4.0D), (3.5, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, cast(key#x as float), val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(CAST(key AS FLOAT), val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (X'AA', 1.0D), (null, 2.0D), (X'BB', 3.0D), (null, 4.0D), (X'CC', 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (ARRAY(1, 2), 1.0D), (null, 2.0D), (ARRAY(3, 4), 3.0D), (null, 4.0D), (ARRAY(5, 6), 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (ARRAY(10L, 20L), 1.0), (null, 2.0D), (ARRAY(30L, 40L), 3.0D), (null, 4.0D), (ARRAY(50L, 60L), 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (ARRAY(1, null), 1.0), (ARRAY(1), 2.0D), (ARRAY(2, null, 3), 3.0D), (ARRAY(4), 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (ARRAY(10L, null), 1.0D), (ARRAY(10L), 2.0D), (ARRAY(20L, null, 30L), 3.0D), (ARRAY(40L), 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (ARRAY(), 1.0D), (ARRAY(1, 2), 2.0D), (ARRAY(), 3.0D), (ARRAY(3, 4), 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES ('', 1.0D), ('a', 2.0D), ('', 3.0D), ('b', 4.0D), ('c', 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key, val)))
FROM VALUES (X'', 1.0D), (X'01', 2.0D), (X'02', 3.0D), (X'03', 4.0D), (CAST('  ' AS BINARY), 5.0D), (X'e280', 6.0D), (X'c1', 7.0D), (X'c120', 8.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key, key#x, val, val#x), Some(12), double, sum, 0, 0), double) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key, val), 12, double, sum), double)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1))) utf8_b FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), double) AS utf8_b#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UTF8_LCASE, val1))) utf8_lc FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UTF8_LCASE), val1, val1#x), Some(12), double, sum, 0, 0), double) AS utf8_lc#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UNICODE, val1))) unicode FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UNICODE), val1, val1#x), Some(12), double, sum, 0, 0), double) AS unicode#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UNICODE_CI, val1))) unicode_ci FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UNICODE_CI), val1, val1#x), Some(12), double, sum, 0, 0), double) AS unicode_ci#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UTF8_BINARY_RTRIM, val1))) utf8_b_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UTF8_BINARY_RTRIM), val1, val1#x), Some(12), double, sum, 0, 0), double) AS utf8_b_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UTF8_LCASE_RTRIM, val1))) utf8_lc_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UTF8_LCASE_RTRIM), val1, val1#x), Some(12), double, sum, 0, 0), double) AS utf8_lc_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UNICODE_RTRIM, val1))) unicode_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UNICODE_RTRIM), val1, val1#x), Some(12), double, sum, 0, 0), double) AS unicode_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1 COLLATE UNICODE_CI_RTRIM, val1))) unicode_ci_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(col1, collate(key1#x, UNICODE_CI_RTRIM), val1, val1#x), Some(12), double, sum, 0, 0), double) AS unicode_ci_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
WITH sketches AS (
  SELECT 'int_sketch' as sketch_type, tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum') as sketch
  FROM t_int_double_1_5_through_7_11
  UNION ALL
  SELECT 'long_sketch' as sketch_type, tuple_sketch_agg(struct(key1, val1), 15, 'double', 'sum') as sketch
  FROM t_long_double_1_5_through_7_11
  UNION ALL
  SELECT 'double_sketch' as sketch_type, tuple_sketch_agg(struct(key1, val1), 10, 'double', 'sum') as sketch
  FROM t_double_double_1_1_1_4_through_1_5_1_8
  UNION ALL
  SELECT 'string_sketch' as sketch_type, tuple_sketch_agg(struct(key1, val1), 14, 'double', 'sum') as sketch
  FROM t_string_double_a_d_through_e_h
),
union_result AS (
  SELECT tuple_union_agg(sketch, 16, 'double', 'sum') as union_sketch FROM sketches
),
individual_sketches AS (
  SELECT
    tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum') as sketch1,
    tuple_sketch_agg(struct(key2, val2), 12, 'double', 'sum') as sketch2
  FROM t_int_double_1_5_through_7_11
)
SELECT
  tuple_sketch_estimate((SELECT union_sketch FROM union_result)) as union_estimate,
  tuple_sketch_summary((SELECT union_sketch FROM union_result), 'double', 'sum') as union_summary,
  tuple_sketch_estimate(tuple_union(sketch1, sketch2, 15, 'double', 'sum')) as binary_union_estimate,
  tuple_sketch_estimate(tuple_intersection(sketch1, sketch2, 'double', 'sum')) as intersection_estimate,
  tuple_sketch_estimate(tuple_difference(sketch1, sketch2, 'double')) as difference_estimate
FROM individual_sketches
-- !query analysis
WithCTE
:- CTERelationDef xxxx, false
:  +- SubqueryAlias sketches
:     +- Union false, false
:        :- Union false, false
:        :  :- Union false, false
:        :  :  :- Aggregate [int_sketch AS sketch_type#x, tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch#x]
:        :  :  :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:        :  :  :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
:        :  :  +- Aggregate [long_sketch AS sketch_type#x, tuple_sketch_agg(struct(key1, key1#xL, val1, val1#x), Some(15), double, sum, 0, 0) AS sketch#x]
:        :  :     +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
:        :  :        +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet
:        :  +- Aggregate [double_sketch AS sketch_type#x, tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(10), double, sum, 0, 0) AS sketch#x]
:        :     +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
:        :        +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
:        +- Aggregate [string_sketch AS sketch_type#x, tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(14), double, sum, 0, 0) AS sketch#x]
:           +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
:              +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet
:- CTERelationDef xxxx, false
:  +- SubqueryAlias union_result
:     +- Aggregate [tuple_union_agg(sketch#x, Some(16), double, sum, 0, 0) AS union_sketch#x]
:        +- SubqueryAlias sketches
:           +- CTERelationRef xxxx, true, [sketch_type#x, sketch#x], false, false, 4
:- CTERelationDef xxxx, false
:  +- SubqueryAlias individual_sketches
:     +- Aggregate [tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0) AS sketch1#x, tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0) AS sketch2#x]
:        +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:           +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
+- Project [tuple_sketch_estimate(scalar-subquery#x [], double) AS union_estimate#x, tuple_sketch_summary(scalar-subquery#x [], double, sum) AS union_summary#x, tuple_sketch_estimate(tuple_union(sketch1#x, sketch2#x, 15, double, sum), double) AS binary_union_estimate#x, tuple_sketch_estimate(tuple_intersection(sketch1#x, sketch2#x, double, sum), double) AS intersection_estimate#x, tuple_sketch_estimate(tuple_difference(sketch1#x, sketch2#x, double), double) AS difference_estimate#x]
   :  :- Project [union_sketch#x]
   :  :  +- SubqueryAlias union_result
   :  :     +- CTERelationRef xxxx, true, [union_sketch#x], false, false, 1
   :  +- Project [union_sketch#x]
   :     +- SubqueryAlias union_result
   :        +- CTERelationRef xxxx, true, [union_sketch#x], false, false, 1
   +- SubqueryAlias individual_sketches
      +- CTERelationRef xxxx, true, [sketch1#x, sketch2#x], false, false, 1


-- !query
SELECT tuple_sketch_agg(struct(col, val), 2)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_sketch_agg`; the `lgNomEntries` value must be between 4 and 26, inclusive: 2. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 2, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 44,
    "fragment" : "tuple_sketch_agg(struct(col, val), 2)"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), 40)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_sketch_agg`; the `lgNomEntries` value must be between 4 and 26, inclusive: 40. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 40, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 45,
    "fragment" : "tuple_sketch_agg(struct(col, val), 40)"
  } ]
}


-- !query
SELECT tuple_union_agg(sketch, 3, 'double', 'sum')
FROM (SELECT tuple_sketch_agg(struct(col, val), 12) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val)
      UNION ALL
      SELECT tuple_sketch_agg(struct(col, val), 20) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val))
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_union_agg`; the `lgNomEntries` value must be between 4 and 26, inclusive: 3. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_union_agg(sketch, 3, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 50,
    "fragment" : "tuple_union_agg(sketch, 3, 'double', 'sum')"
  } ]
}


-- !query
SELECT tuple_union_agg(sketch, 27, 'double', 'sum')
FROM (SELECT tuple_sketch_agg(struct(col, val), 12) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val)
      UNION ALL
      SELECT tuple_sketch_agg(struct(col, val), 20) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val))
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_union_agg`; the `lgNomEntries` value must be between 4 and 26, inclusive: 27. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_union_agg(sketch, 27, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 51,
    "fragment" : "tuple_union_agg(sketch, 27, 'double', 'sum')"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), CAST(NULL AS INT)) AS lg_nom_entries_is_null
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_NULL",
  "sqlState" : "42K09",
  "messageParameters" : {
    "exprName" : "lgNomEntries",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), CAST(NULL AS INT), double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 60,
    "fragment" : "tuple_sketch_agg(struct(col, val), CAST(NULL AS INT))"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), CAST(col AS INT)) AS lg_nom_entries_non_constant
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "CAST(tab.col AS INT)",
    "inputName" : "lgNomEntries",
    "inputType" : "int",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), CAST(col AS INT), double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 59,
    "fragment" : "tuple_sketch_agg(struct(col, val), CAST(col AS INT))"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), '15')
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"15\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"INT\"",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 15, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 47,
    "fragment" : "tuple_sketch_agg(struct(col, val), '15')"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), 12, CAST(col AS STRING))
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "CAST(tab.col AS STRING)",
    "inputName" : "summaryType",
    "inputType" : "string",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 12, CAST(col AS STRING), sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 66,
    "fragment" : "tuple_sketch_agg(struct(col, val), 12, CAST(col AS STRING))"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), 12, 'invalid_type')
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[TUPLE_INVALID_SKETCH_SUMMARY_TYPE] Invalid call to `tuple_sketch_agg`: summary type 'invalid_type' is not supported. Valid summary types are: double, integer, string. SQLSTATE: 22023",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 12, invalid_type, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 61,
    "fragment" : "tuple_sketch_agg(struct(col, val), 12, 'invalid_type')"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), 12, 'double', CAST(col AS STRING))
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "CAST(tab.col AS STRING)",
    "inputName" : "mode",
    "inputType" : "string",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 12, double, CAST(col AS STRING))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 76,
    "fragment" : "tuple_sketch_agg(struct(col, val), 12, 'double', CAST(col AS STRING))"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val), 12, 'double', 'invalid_mode')
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[TUPLE_INVALID_SKETCH_MODE] Invalid call to `tuple_sketch_agg`: mode 'invalid_mode' is not supported. Valid modes are: sum, min, max, alwaysone. SQLSTATE: 22023",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val), 12, double, invalid_mode)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "tuple_sketch_agg(struct(col, val), 12, 'double', 'invalid_mode')"
  } ]
}


-- !query
SELECT tuple_sketch_agg(col, 15)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"col\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"STRUCT\"",
    "sqlExpr" : "\"tuple_sketch_agg(col, 15, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 32,
    "fragment" : "tuple_sketch_agg(col, 15)"
  } ]
}


-- !query
SELECT tuple_sketch_agg(struct(col, val, 2.0D), 15)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "The struct input to tuple_sketch_agg must have exactly 2 fields (key, summary value), but got 3 fields",
    "sqlExpr" : "\"tuple_sketch_agg(struct(col, val, 2.0), 15, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 51,
    "fragment" : "tuple_sketch_agg(struct(col, val, 2.0D), 15)"
  } ]
}


-- !query
SELECT tuple_union(1, 2)
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_union(1, 2, 12, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 24,
    "fragment" : "tuple_union(1, 2)"
  } ]
}


-- !query
SELECT tuple_intersection(1, 2)
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_intersection(1, 2, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 31,
    "fragment" : "tuple_intersection(1, 2)"
  } ]
}


-- !query
SELECT tuple_difference(1, 2)
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_difference(1, 2, double)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 29,
    "fragment" : "tuple_difference(1, 2)"
  } ]
}


-- !query
SELECT tuple_union(
    tuple_sketch_agg(struct(col1, 1.0D)),
    tuple_sketch_agg(struct(col2, 2.0D)), 'invalid')
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"invalid\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "third",
    "requiredType" : "\"INT\"",
    "sqlExpr" : "\"tuple_union(tuple_sketch_agg(struct(col1, 1.0), 12, double, sum), tuple_sketch_agg(struct(col2, 2.0), 12, double, sum), invalid, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 114,
    "fragment" : "tuple_union(\n    tuple_sketch_agg(struct(col1, 1.0D)),\n    tuple_sketch_agg(struct(col2, 2.0D)), 'invalid')"
  } ]
}


-- !query
SELECT tuple_intersection(
    tuple_sketch_agg(struct(col1, 1.0)),
    'invalid_sketch')
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"invalid_sketch\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_intersection(tuple_sketch_agg(struct(col1, 1.0), 12, double, sum), invalid_sketch, double, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 89,
    "fragment" : "tuple_intersection(\n    tuple_sketch_agg(struct(col1, 1.0)),\n    'invalid_sketch')"
  } ]
}


-- !query
SELECT tuple_sketch_estimate(CAST('abc' AS BINARY))
-- !query analysis
Project [tuple_sketch_estimate(cast(abc as binary), double) AS tuple_sketch_estimate(CAST(abc AS BINARY), double)#x]
+- OneRowRelation


-- !query
SELECT tuple_union(CAST('abc' AS BINARY), CAST('def' AS BINARY))
-- !query analysis
Project [tuple_union(cast(abc as binary), cast(def as binary), 12, double, sum) AS tuple_union(CAST(abc AS BINARY), CAST(def AS BINARY), 12, double, sum)#x]
+- OneRowRelation


-- !query
SELECT tuple_intersection(CAST('abc' AS BINARY), CAST('def' AS BINARY))
-- !query analysis
Project [tuple_intersection(cast(abc as binary), cast(def as binary), double, sum) AS tuple_intersection(CAST(abc AS BINARY), CAST(def AS BINARY), double, sum)#x]
+- OneRowRelation


-- !query
SELECT tuple_difference(CAST('abc' AS BINARY), CAST('def' AS BINARY))
-- !query analysis
Project [tuple_difference(cast(abc as binary), cast(def as binary), double) AS tuple_difference(CAST(abc AS BINARY), CAST(def AS BINARY), double)#x]
+- OneRowRelation


-- !query
SELECT tuple_union_agg(buffer, 15, 'double', 'sum')
FROM (SELECT CAST('abc' AS BINARY) AS buffer)
-- !query analysis
Aggregate [tuple_union_agg(buffer#x, Some(15), double, sum, 0, 0) AS tuple_union_agg(buffer, 15, double, sum)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Project [cast(abc as binary) AS buffer#x]
      +- OneRowRelation


-- !query
SELECT tuple_intersection_agg(buffer, 'double', 'sum')
FROM (SELECT CAST('abc' AS BINARY) AS buffer)
-- !query analysis
Aggregate [tuple_intersection_agg(buffer#x, double, sum, 0, 0) AS tuple_intersection_agg(buffer, double, sum)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Project [cast(abc as binary) AS buffer#x]
      +- OneRowRelation


-- !query
SELECT tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, 'string', 'sum'), 'string', 'sum')
FROM t_string_string_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_summary(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), string, sum, 0, 0), string, sum) AS tuple_sketch_summary(tuple_sketch_agg(struct(key1, val1), 12, string, sum), string, sum)#x]
+- SubqueryAlias spark_catalog.default.t_string_string_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_string_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_union_theta(
    theta_sketch_agg(key1),
    tuple_sketch_agg(struct(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_union_theta(theta_sketch_agg(key1#x, 12, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), 12, double, sum) AS tuple_union_theta(theta_sketch_agg(key1, 12), tuple_sketch_agg(struct(key2, val2), 12, double, sum), 12, double, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_intersection_theta(
    theta_sketch_agg(key1),
    tuple_sketch_agg(struct(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_intersection_theta(theta_sketch_agg(key1#x, 12, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double, sum) AS tuple_intersection_theta(theta_sketch_agg(key1, 12), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double, sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_difference_theta(
    theta_sketch_agg(key1),
    tuple_sketch_agg(struct(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_difference_theta(theta_sketch_agg(key1#x, 12, 0, 0), tuple_sketch_agg(struct(key2, key2#x, val2, val2#x), Some(12), double, sum, 0, 0), double) AS tuple_difference_theta(theta_sketch_agg(key1, 12), tuple_sketch_agg(struct(key2, val2), 12, double, sum), double)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_agg(struct(col1, col2), 12, 'double', 'sum')
FROM VALUES (1, 'invalid'), (2, 'invalid') AS tab(col1, col2)
-- !query analysis
Aggregate [tuple_sketch_agg(struct(col1, col1#x, col2, col2#x), Some(12), double, sum, 0, 0) AS tuple_sketch_agg(struct(col1, col2), 12, double, sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT tuple_sketch_agg(struct(col1, col2), 12, 'integer', 'sum')
FROM VALUES (1, 1.5D), (2, 2.5D) AS tab(col1, col2)
-- !query analysis
Aggregate [tuple_sketch_agg(struct(col1, col1#x, col2, col2#x), Some(12), integer, sum, 0, 0) AS tuple_sketch_agg(struct(col1, col2), 12, integer, sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, 'double', 'sum'), 'integer')
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate(tuple_sketch_agg(struct(key1, key1#x, val1, val1#x), Some(12), double, sum, 0, 0), integer) AS tuple_sketch_estimate(tuple_sketch_agg(struct(key1, val1), 12, double, sum), integer)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
DROP TABLE IF EXISTS t_int_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_double_1_5_through_7_11


-- !query
DROP TABLE IF EXISTS t_long_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_long_double_1_5_through_7_11


-- !query
DROP TABLE IF EXISTS t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_double_double_1_1_1_4_through_1_5_1_8


-- !query
DROP TABLE IF EXISTS t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_float_double_1_1_1_4_through_1_5_1_8


-- !query
DROP TABLE IF EXISTS t_string_double_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_double_a_d_through_e_h


-- !query
DROP TABLE IF EXISTS t_binary_double_a_b_through_e_f
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_binary_double_a_b_through_e_f


-- !query
DROP TABLE IF EXISTS t_array_int_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_int_double_1_3_through_4_6


-- !query
DROP TABLE IF EXISTS t_array_long_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_long_double_1_3_through_4_6


-- !query
DROP TABLE IF EXISTS t_int_int_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_int_1_5_through_7_11


-- !query
DROP TABLE IF EXISTS t_string_string_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_string_a_d_through_e_h


-- !query
DROP TABLE IF EXISTS t_string_collation
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_collation
