-- Automatically generated by SQLQueryTestSuite
-- !query
DROP TABLE IF EXISTS t_int_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_double_1_5_through_7_11


-- !query
CREATE TABLE t_int_double_1_5_through_7_11 AS
VALUES
  (1, 1.0D, 5, 5.0D), (2, 2.0D, 6, 6.0D), (3, 3.0D, 7, 7.0D),
  (4, 4.0D, 8, 8.0D), (5, 5.0D, 9, 9.0D), (6, 6.0D, 10, 10.0D),
  (7, 7.0D, 11, 11.0D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_int_double_1_5_through_7_11`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_long_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_long_double_1_5_through_7_11


-- !query
CREATE TABLE t_long_double_1_5_through_7_11 AS
VALUES
  (1L, 1.0D, 5L, 5.00D), (2L, 2.00D, 6L, 6.00D), (3L, 3.00D, 7L, 7.00D),
  (4L, 4.0D, 8L, 8.00D), (5L, 5.00D, 9L, 9.00D), (6L, 6.00D, 10L, 10.00D),
  (7L, 7.0D, 11L, 11.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_long_double_1_5_through_7_11`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#xL, val1#x, key2#xL, val2#x]


-- !query
DROP TABLE IF EXISTS t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_double_double_1_1_1_4_through_1_5_1_8


-- !query
CREATE TABLE t_double_double_1_1_1_4_through_1_5_1_8 AS
SELECT CAST(key1 AS DOUBLE) AS key1, CAST(val1 AS DOUBLE) AS val1,
       CAST(key2 AS DOUBLE) AS key2, CAST(val2 AS DOUBLE) AS val2
FROM VALUES
  (1.1, 1.0, 1.4, 4.0), (1.2, 2.0, 1.5, 5.0), (1.3, 3.0, 1.6, 6.0),
  (1.4, 4.0, 1.7, 7.0), (1.5, 5.0, 1.8, 8.0) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_double_double_1_1_1_4_through_1_5_1_8`, ErrorIfExists, [key1, val1, key2, val2]
   +- Project [cast(key1#x as double) AS key1#x, cast(val1#x as double) AS val1#x, cast(key2#x as double) AS key2#x, cast(val2#x as double) AS val2#x]
      +- SubqueryAlias tab
         +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_float_double_1_1_1_4_through_1_5_1_8


-- !query
CREATE TABLE t_float_double_1_1_1_4_through_1_5_1_8 AS
SELECT CAST(key1 AS FLOAT) key1, CAST(val1 AS DOUBLE) AS val1,
       CAST(key2 AS FLOAT) key2, CAST(val2 AS DOUBLE) AS val2
FROM VALUES
  (1.1, 1.0, 1.4, 4.0), (1.2, 2.0, 1.5, 5.0), (1.3, 3.0, 1.6, 6.0),
  (1.4, 4.0, 1.7, 7.0), (1.5, 5.0, 1.8, 8.0) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_float_double_1_1_1_4_through_1_5_1_8`, ErrorIfExists, [key1, val1, key2, val2]
   +- Project [cast(key1#x as float) AS key1#x, cast(val1#x as double) AS val1#x, cast(key2#x as float) AS key2#x, cast(val2#x as double) AS val2#x]
      +- SubqueryAlias tab
         +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_string_double_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_double_a_d_through_e_h


-- !query
CREATE TABLE t_string_double_a_d_through_e_h AS
VALUES
  ('a', 1.00D, 'd', 4.00D), ('b', 2.00D, 'e', 5.00D), ('c', 3.00D, 'f', 6.00D),
  ('d', 4.00D, 'g', 7.00D), ('e', 5.00D, 'h', 8.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_string_double_a_d_through_e_h`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_binary_double_a_b_through_e_f
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_binary_double_a_b_through_e_f


-- !query
CREATE TABLE t_binary_double_a_b_through_e_f AS
VALUES
  (X'A', 1.00D, X'B', 2.00D), (X'B', 2.00D, X'C', 3.00D), (X'C', 3.00D, X'D', 4.00D),
  (X'D', 4.00D, X'E', 5.00D), (X'E', 5.00D, X'F', 6.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_binary_double_a_b_through_e_f`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_array_int_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_int_double_1_3_through_4_6


-- !query
CREATE TABLE t_array_int_double_1_3_through_4_6 AS
VALUES
  (ARRAY(1), 1.00D, ARRAY(3), 3.00D),
  (ARRAY(2), 2.00D, ARRAY(4), 4.00D),
  (ARRAY(3), 3.00D, ARRAY(5), 5.00D),
  (ARRAY(4), 4.00D, ARRAY(6), 6.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_array_int_double_1_3_through_4_6`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_array_long_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_long_double_1_3_through_4_6


-- !query
CREATE TABLE t_array_long_double_1_3_through_4_6 AS
VALUES
  (ARRAY(1L), 1.00D, ARRAY(3L), 3.00D),
  (ARRAY(2L), 2.00D, ARRAY(4L), 4.00D),
  (ARRAY(3L), 3.00D, ARRAY(5L), 5.00D),
  (ARRAY(4L), 4.00D, ARRAY(6L), 6.00D) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_array_long_double_1_3_through_4_6`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_int_int_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_int_1_5_through_7_11


-- !query
CREATE TABLE t_int_int_1_5_through_7_11 AS
VALUES
  (1, 1, 5, 5), (2, 2, 6, 6), (3, 3, 7, 7),
  (4, 4, 8, 8), (5, 5, 9, 9), (6, 6, 10, 10),
  (7, 7, 11, 11) AS tab(key1, val1, key2, val2)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_int_int_1_5_through_7_11`, ErrorIfExists, [key1, val1, key2, val2]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
DROP TABLE IF EXISTS t_string_collation
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_collation


-- !query
CREATE TABLE t_string_collation AS
VALUES
  ('', 1.00D), ('  ', 2.00D), (CAST(X'C1' AS STRING), 3.00D), (CAST(X'80' AS STRING), 4.00D),
  ('\uFFFD', 5.00D), ('Å', 6.00D), ('å', 7.00D), ('a\u030A', 8.00D), ('Å ', 9.00D), ('å  ', 10.00D),
  ('a\u030A   ', 11.00D) AS tab(key1, val1)
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`t_string_collation`, ErrorIfExists, [key1, val1]
   +- SubqueryAlias tab
      +- LocalRelation [key1#x, val1#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1)) AS result
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS result#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12)) AS result
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0)) AS result#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key2, val2))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key2, val2, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key2, val2))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key2, val2, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 22))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 22, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 22, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#xL, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, min, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, min))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, max, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, max))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'alwaysone'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, alwaysone, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, alwaysone))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, sum), sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key1#x, val1#x, 12, min, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, min), sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, 'max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key1#x, val1#x, 12, max, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, max), sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, 'alwaysone'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key1#x, val1#x, 12, alwaysone, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key1, val1, 12, alwaysone), sum)#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_summary_integer(tuple_sketch_agg_integer(key1, val1, 12, 'sum'), 'sum')
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_summary_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_integer(tuple_sketch_agg_integer(key1, val1, 12, sum), sum)#xL]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_theta_double(tuple_sketch_agg_double(key1, val1))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_theta_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_theta_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_theta_double(tuple_sketch_agg_double(key1, val1))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_theta_double(tuple_sketch_agg_double(key1#xL, val1#x, 12, sum, 0, 0)) AS tuple_sketch_theta_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_theta_double(tuple_sketch_agg_double(key1, val1))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_theta_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_theta_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_theta_integer(tuple_sketch_agg_integer(key1, val1, 12))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_theta_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_theta_integer(tuple_sketch_agg_integer(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1, 15),
    tuple_sketch_agg_double(key2, val2), 15))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#xL, val1#x, 15, sum, 0, 0), tuple_sketch_agg_double(key2#xL, val2#x, 12, sum, 0, 0), 15, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 15, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 15, sum))#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1, 6),
    tuple_sketch_agg_double(key2, val2, 15), 15))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 6, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 15, sum, 0, 0), 15, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 6, sum), tuple_sketch_agg_double(key2, val2, 15, sum), 15, sum))#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2, 20), 20))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 20, sum, 0, 0), 20, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 20, sum), 20, sum))#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2, 13), 13))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 13, sum, 0, 0), 13, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 13, sum), 13, sum))#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1, 12, 'sum'),
    tuple_sketch_agg_double(key2, val2, 12, 'sum'), 12, 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1, 5),
    tuple_sketch_agg_double(key2, val2, 12)))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#xL, val1#x, 5, sum, 0, 0), tuple_sketch_agg_double(key2#xL, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 5, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1, 5),
    tuple_sketch_agg_double(key2, val2)))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 5, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 5, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2, 22)))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 22, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 22, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2, 10)))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 10, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 10, sum), sum))#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1, 12, 'min'),
    tuple_sketch_agg_double(key2, val2, 12, 'min'), 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, min, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, min, 0, 0), min)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, min), tuple_sketch_agg_double(key2, val2, 12, min), min))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2, 5)))
FROM t_long_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#xL, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#xL, val2#x, 5, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 5, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1, 12),
    tuple_sketch_agg_double(key2, val2)))
FROM t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
   +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_string_double_a_d_through_e_h
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
   +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1, 6),
    tuple_sketch_agg_double(key2, val2, 8)))
FROM t_binary_double_a_b_through_e_f
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 6, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 8, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 6, sum), tuple_sketch_agg_double(key2, val2, 8, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
   +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_array_int_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_difference_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2, 4)))
FROM t_array_long_double_1_3_through_4_6
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 4, sum, 0, 0))) AS tuple_sketch_estimate_double(tuple_difference_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 4, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
   +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(
  tuple_difference_integer(
    tuple_sketch_agg_integer(key1, val1, 12, 'sum'),
    tuple_sketch_agg_integer(key2, val2, 12, 'sum')))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_difference_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_integer(key2#x, val2#x, 12, sum, 0, 0))) AS tuple_sketch_estimate_integer(tuple_difference_integer(tuple_sketch_agg_integer(key1, val1, 12, sum), tuple_sketch_agg_integer(key2, val2, 12, sum)))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 15, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2, 20) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 15, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 15, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 20, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 14, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_string_double_a_d_through_e_h
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_string_double_a_d_through_e_h)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 14, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 14, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
      :     +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
            +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 10, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_long_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_long_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 10, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 10, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#xL, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#xL, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 6, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 6, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 6, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_binary_double_a_b_through_e_f
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_binary_double_a_b_through_e_f)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
      :     +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
            +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_array_int_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_array_int_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 16, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_array_long_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_array_long_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 16, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 16, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_union_agg_integer(sketch, 12, 'sum'))
FROM (SELECT tuple_sketch_agg_integer(key1, val1, 12, 'sum') as sketch FROM t_int_int_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_integer(key2, val2, 12, 'sum') as sketch FROM t_int_int_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_union_agg_integer(sketch#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_union_agg_integer(sketch, 12, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_integer(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_long_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_long_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#xL, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#xL, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_float_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_float_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_double_double_1_1_1_4_through_1_5_1_8)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
      :     +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
            +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_string_double_a_d_through_e_h
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_string_double_a_d_through_e_h)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
      :     +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
            +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_binary_double_a_b_through_e_f
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_binary_double_a_b_through_e_f)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
      :     +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_binary_double_a_b_through_e_f
            +- Relation spark_catalog.default.t_binary_double_a_b_through_e_f[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_array_int_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_array_int_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_int_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_int_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_array_long_double_1_3_through_4_6
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_array_long_double_1_3_through_4_6)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
      :     +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_array_long_double_1_3_through_4_6
            +- Relation spark_catalog.default.t_array_long_double_1_3_through_4_6[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_intersection_agg_integer(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_integer(key1, val1, 12, 'sum') as sketch FROM t_int_int_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_integer(key2, val2, 12, 'sum') as sketch FROM t_int_int_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_intersection_agg_integer(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_intersection_agg_integer(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_integer(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (1, 1.0D), (null, 2.0D), (2, 2.0D), (null, 3.0D), (3, 3.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES ('test', 1.0D), (null, 2.0D), ('null', 3.0D), (null, 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES ('test', 1.0F), (null, 2.0F), ('null', 3.0F), ('null', 4.0F) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, cast(val#x as double), 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (100L, 1.0D), (null, 2.0D), (200L, 3.0D), (null, 4.0D), (300L, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#xL, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#xL, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS DOUBLE), val))
FROM VALUES (1.1, 1.0D), (null, 2.0D), (2.2, 3.0D), (null, 4.0D), (3.3, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(cast(key#x as double), val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS DOUBLE), val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS FLOAT), val))
FROM VALUES (1.5, 1.0D), (null, 2.0D), (2.5, 3.0D), (null, 4.0D), (3.5, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(cast(key#x as float), val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS FLOAT), val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (X'AA', 1.0D), (null, 2.0D), (X'BB', 3.0D), (null, 4.0D), (X'CC', 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(1, 2), 1.0D), (null, 2.0D), (ARRAY(3, 4), 3.0D), (null, 4.0D), (ARRAY(5, 6), 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(10L, 20L), 1.0), (null, 2.0D), (ARRAY(30L, 40L), 3.0D), (null, 4.0D), (ARRAY(50L, 60L), 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(1, null), 1.0), (ARRAY(1), 2.0D), (ARRAY(2, null, 3), 3.0D), (ARRAY(4), 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(10L, null), 1.0D), (ARRAY(10L), 2.0D), (ARRAY(20L, null, 30L), 3.0D), (ARRAY(40L), 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (1, 1.0D), (2, null), (3, 3.0D), (4, null), (5, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES ('a', 1.0D), ('b', null), ('c', 3.0D), ('d', null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (100L, 1.0D), (200L, null), (300L, 3.0D), (400L, null), (500L, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#xL, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#xL, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS DOUBLE), val))
FROM VALUES (1.1, 1.0D), (2.2, null), (3.3, 3.0D), (4.4, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(cast(key#x as double), val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS DOUBLE), val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS FLOAT), val))
FROM VALUES (1.5, 1.0D), (2.5, null), (3.5, 3.0D), (4.5, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(cast(key#x as float), val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(CAST(key AS FLOAT), val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (X'AA', 1.0D), (X'BB', null), (X'CC', 3.0D), (X'DD', null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(1, 2), 1.0D), (ARRAY(3, 4), null), (ARRAY(5, 6), 3.0D), (ARRAY(7, 8), null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(10L, 20L), 1.0D), (ARRAY(30L, 40L), null), (ARRAY(50L, 60L), 3.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12))
FROM VALUES (1, 1), (2, null), (3, 3), (4, null), (5, 5) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (1, 1.0D), (null, 2.0D), (3, null), (null, null), (5, 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (null, 1.0D), (null, 2.0D), (null, 3.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(cast(key#x as array<int>), val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (1, null), (2, null), (3, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, cast(val#x as double), 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (null, null), (null, null), (null, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(cast(key#x as array<int>), cast(val#x as double), 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12))
FROM VALUES (null, 1), (null, 2), (null, 3) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(cast(key#x as array<int>), val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12))
FROM VALUES (1, null), (2, null), (3, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, cast(val#x as int), 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12))
FROM VALUES (null, null), (null, null), (null, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(cast(key#x as array<int>), cast(val#x as int), 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key, val, 12, 'sum'))
FROM VALUES (1, null), (2, null), (3, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key#x, cast(val#x as double), 12, sum, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key, val, 12, sum), sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'), 'sum')
FROM VALUES (1, null), (2, null), (3, null) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_summary_integer(tuple_sketch_agg_integer(key#x, cast(val#x as int), 12, sum, 0, 0), sum) AS tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, sum), sum)#xL]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (ARRAY(), 1.0D), (ARRAY(1, 2), 2.0D), (ARRAY(), 3.0D), (ARRAY(3, 4), 4.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES ('', 1.0D), ('a', 2.0D), ('', 3.0D), ('b', 4.0D), ('c', 5.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val))
FROM VALUES (X'', 1.0D), (X'01', 2.0D), (X'02', 3.0D), (X'03', 4.0D), (CAST('  ' AS BINARY), 5.0D), (X'e280', 6.0D), (X'c1', 7.0D), (X'c120', 8.0D) tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1)) utf8_b FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS utf8_b#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UTF8_LCASE, val1)) utf8_lc FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UTF8_LCASE), val1#x, 12, sum, 0, 0)) AS utf8_lc#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UNICODE, val1)) unicode FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UNICODE), val1#x, 12, sum, 0, 0)) AS unicode#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UNICODE_CI, val1)) unicode_ci FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UNICODE_CI), val1#x, 12, sum, 0, 0)) AS unicode_ci#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UTF8_BINARY_RTRIM, val1)) utf8_b_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UTF8_BINARY_RTRIM), val1#x, 12, sum, 0, 0)) AS utf8_b_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UTF8_LCASE_RTRIM, val1)) utf8_lc_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UTF8_LCASE_RTRIM), val1#x, 12, sum, 0, 0)) AS utf8_lc_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UNICODE_RTRIM, val1)) unicode_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UNICODE_RTRIM), val1#x, 12, sum, 0, 0)) AS unicode_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1 COLLATE UNICODE_CI_RTRIM, val1)) unicode_ci_rt FROM t_string_collation
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(collate(key1#x, UNICODE_CI_RTRIM), val1#x, 12, sum, 0, 0)) AS unicode_ci_rt#x]
+- SubqueryAlias spark_catalog.default.t_string_collation
   +- Relation spark_catalog.default.t_string_collation[key1#x,val1#x] parquet


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key, val))
FROM VALUES (1, 1.0D) tab(key, val) WHERE key > 100
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key, val, 12, sum), sum)#x]
+- Filter (key#x > 100)
   +- SubqueryAlias tab
      +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'), 'sum')
FROM VALUES (1, 1) tab(key, val) WHERE key > 100
-- !query analysis
Aggregate [tuple_sketch_summary_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, sum), sum)#xL]
+- Filter (key#x > 100)
   +- SubqueryAlias tab
      +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'SUM'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, SUM, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, SUM))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'Sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, Sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, Sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'MIN'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, MIN, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, MIN))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'Min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, Min, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, Min))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'MAX'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, MAX, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, MAX))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'Max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, Max, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, Max))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'ALWAYSONE'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, ALWAYSONE, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, ALWAYSONE))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, 'AlwaysOne'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, AlwaysOne, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, AlwaysOne))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, 'SUM'))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, SUM, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, SUM))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, 'Max'))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, Max, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, Max))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, 'MAX'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, MAX, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, MAX))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, 'Min'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, Min, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, Min))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM (SELECT 1 as key1, 1.0D as val1, 10 as key2, 10.0D as val2
      UNION ALL
      SELECT 2, 2.0D, 20, 20.0D
      UNION ALL
      SELECT 3, 3.0D, 30, 30.0D) tab
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- SubqueryAlias tab
   +- Union false, false
      :- Union false, false
      :  :- Project [1 AS key1#x, 1.0 AS val1#x, 10 AS key2#x, 10.0 AS val2#x]
      :  :  +- OneRowRelation
      :  +- Project [2 AS 2#x, 2.0 AS 2.0#x, 20 AS 20#x, 20.0 AS 20.0#x]
      :     +- OneRowRelation
      +- Project [3 AS 3#x, 3.0 AS 3.0#x, 30 AS 30#x, 30.0 AS 30.0#x]
         +- OneRowRelation


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_int_double_1_5_through_7_11
WHERE key1 > 100
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- Filter (key1#x > 100)
   +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(
    tuple_sketch_agg_double(key1, val1),
    tuple_sketch_agg_double(key2, val2)))
FROM t_int_double_1_5_through_7_11
WHERE key1 > 100
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), sum))#x]
+- Filter (key1#x > 100)
   +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
WITH non_empty AS (
  SELECT tuple_sketch_agg_double(key1, val1) as sketch1 FROM t_int_double_1_5_through_7_11
),
empty_sketch AS (
  SELECT tuple_sketch_agg_double(key1, val1) as sketch2 FROM t_int_double_1_5_through_7_11 WHERE key1 > 100
)
SELECT tuple_sketch_estimate_double(
  tuple_union_double(sketch1, sketch2))
FROM non_empty, empty_sketch
-- !query analysis
WithCTE
:- CTERelationDef xxxx, false
:  +- SubqueryAlias non_empty
:     +- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch1#x]
:        +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:           +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
:- CTERelationDef xxxx, false
:  +- SubqueryAlias empty_sketch
:     +- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch2#x]
:        +- Filter (key1#x > 100)
:           +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:              +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
+- Project [tuple_sketch_estimate_double(tuple_union_double(sketch1#x, sketch2#x, 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(sketch1, sketch2, 12, sum))#x]
   +- Join Inner
      :- SubqueryAlias non_empty
      :  +- CTERelationRef xxxx, true, [sketch1#x], false, false, 1
      +- SubqueryAlias empty_sketch
         +- CTERelationRef xxxx, true, [sketch2#x], false, false, 1


-- !query
WITH non_empty AS (
  SELECT tuple_sketch_agg_double(key1, val1) as sketch1 FROM t_int_double_1_5_through_7_11
),
empty_sketch AS (
  SELECT tuple_sketch_agg_double(key1, val1) as sketch2 FROM t_int_double_1_5_through_7_11 WHERE key1 > 100
)
SELECT tuple_sketch_estimate_double(
  tuple_intersection_double(sketch1, sketch2))
FROM non_empty, empty_sketch
-- !query analysis
WithCTE
:- CTERelationDef xxxx, false
:  +- SubqueryAlias non_empty
:     +- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch1#x]
:        +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:           +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
:- CTERelationDef xxxx, false
:  +- SubqueryAlias empty_sketch
:     +- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch2#x]
:        +- Filter (key1#x > 100)
:           +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:              +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
+- Project [tuple_sketch_estimate_double(tuple_intersection_double(sketch1#x, sketch2#x, sum)) AS tuple_sketch_estimate_double(tuple_intersection_double(sketch1, sketch2, sum))#x]
   +- Join Inner
      :- SubqueryAlias non_empty
      :  +- CTERelationRef xxxx, true, [sketch1#x], false, false, 1
      +- SubqueryAlias empty_sketch
         +- CTERelationRef xxxx, true, [sketch2#x], false, false, 1


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11 WHERE key1 > 100
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11 WHERE key2 > 100)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- Filter (key1#x > 100)
      :     +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :        +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- Filter (key2#x > 100)
            +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
               +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, 'sum'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11 WHERE key1 > 100
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11 WHERE key2 > 100)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch#x, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_intersection_agg_double(sketch, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- Filter (key1#x > 100)
      :     +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :        +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- Filter (key2#x > 100)
            +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
               +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
WITH sketches AS (
  SELECT 'int_sketch' as sketch_type, tuple_sketch_agg_double(key1, val1, 12, 'sum') as sketch
  FROM t_int_double_1_5_through_7_11
  UNION ALL
  SELECT 'long_sketch' as sketch_type, tuple_sketch_agg_double(key1, val1, 15, 'sum') as sketch
  FROM t_long_double_1_5_through_7_11
  UNION ALL
  SELECT 'double_sketch' as sketch_type, tuple_sketch_agg_double(key1, val1, 10, 'sum') as sketch
  FROM t_double_double_1_1_1_4_through_1_5_1_8
  UNION ALL
  SELECT 'string_sketch' as sketch_type, tuple_sketch_agg_double(key1, val1, 14, 'sum') as sketch
  FROM t_string_double_a_d_through_e_h
),
union_result AS (
  SELECT tuple_union_agg_double(sketch, 16, 'sum') as union_sketch FROM sketches
),
individual_sketches AS (
  SELECT
    tuple_sketch_agg_double(key1, val1, 12, 'sum') as sketch1,
    tuple_sketch_agg_double(key2, val2, 12, 'sum') as sketch2
  FROM t_int_double_1_5_through_7_11
)
SELECT
  tuple_sketch_estimate_double((SELECT union_sketch FROM union_result)) as union_estimate,
  tuple_sketch_summary_double((SELECT union_sketch FROM union_result), 'sum') as union_summary,
  tuple_sketch_estimate_double(tuple_union_double(sketch1, sketch2, 15, 'sum')) as binary_union_estimate,
  tuple_sketch_estimate_double(tuple_intersection_double(sketch1, sketch2, 'sum')) as intersection_estimate,
  tuple_sketch_estimate_double(tuple_difference_double(sketch1, sketch2)) as difference_estimate
FROM individual_sketches
-- !query analysis
WithCTE
:- CTERelationDef xxxx, false
:  +- SubqueryAlias sketches
:     +- Union false, false
:        :- Union false, false
:        :  :- Union false, false
:        :  :  :- Aggregate [int_sketch AS sketch_type#x, tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
:        :  :  :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:        :  :  :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
:        :  :  +- Aggregate [long_sketch AS sketch_type#x, tuple_sketch_agg_double(key1#xL, val1#x, 15, sum, 0, 0) AS sketch#x]
:        :  :     +- SubqueryAlias spark_catalog.default.t_long_double_1_5_through_7_11
:        :  :        +- Relation spark_catalog.default.t_long_double_1_5_through_7_11[key1#xL,val1#x,key2#xL,val2#x] parquet
:        :  +- Aggregate [double_sketch AS sketch_type#x, tuple_sketch_agg_double(key1#x, val1#x, 10, sum, 0, 0) AS sketch#x]
:        :     +- SubqueryAlias spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8
:        :        +- Relation spark_catalog.default.t_double_double_1_1_1_4_through_1_5_1_8[key1#x,val1#x,key2#x,val2#x] parquet
:        +- Aggregate [string_sketch AS sketch_type#x, tuple_sketch_agg_double(key1#x, val1#x, 14, sum, 0, 0) AS sketch#x]
:           +- SubqueryAlias spark_catalog.default.t_string_double_a_d_through_e_h
:              +- Relation spark_catalog.default.t_string_double_a_d_through_e_h[key1#x,val1#x,key2#x,val2#x] parquet
:- CTERelationDef xxxx, false
:  +- SubqueryAlias union_result
:     +- Aggregate [tuple_union_agg_double(sketch#x, 16, sum, 0, 0) AS union_sketch#x]
:        +- SubqueryAlias sketches
:           +- CTERelationRef xxxx, true, [sketch_type#x, sketch#x], false, false, 4
:- CTERelationDef xxxx, false
:  +- SubqueryAlias individual_sketches
:     +- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch1#x, tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch2#x]
:        +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
:           +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
+- Project [tuple_sketch_estimate_double(scalar-subquery#x []) AS union_estimate#x, tuple_sketch_summary_double(scalar-subquery#x [], sum) AS union_summary#x, tuple_sketch_estimate_double(tuple_union_double(sketch1#x, sketch2#x, 15, sum)) AS binary_union_estimate#x, tuple_sketch_estimate_double(tuple_intersection_double(sketch1#x, sketch2#x, sum)) AS intersection_estimate#x, tuple_sketch_estimate_double(tuple_difference_double(sketch1#x, sketch2#x)) AS difference_estimate#x]
   :  :- Project [union_sketch#x]
   :  :  +- SubqueryAlias union_result
   :  :     +- CTERelationRef xxxx, true, [union_sketch#x], false, false, 1
   :  +- Project [union_sketch#x]
   :     +- SubqueryAlias union_result
   :        +- CTERelationRef xxxx, true, [union_sketch#x], false, false, 1
   +- SubqueryAlias individual_sketches
      +- CTERelationRef xxxx, true, [sketch1#x, sketch2#x], false, false, 1


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'))
FROM VALUES
  (1, 2147483647),
  (2, 1),
  (3, 100) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'))
FROM VALUES
  (1, -2147483648),
  (2, -1),
  (3, -100) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'))
FROM VALUES
  (1, 2147483647),
  (2, -2147483648),
  (3, 1000000) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, 'max'))
FROM VALUES
  (1, 2147483647),
  (2, 2147483646),
  (3, 100) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, max, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, max))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, 'min'))
FROM VALUES
  (1, -2147483648),
  (2, -2147483647),
  (3, 100) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, min, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, min))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, 'sum'))
FROM VALUES
  (1, 1.7976931348623157E308),
  (2, 1.7976931348623157E308),
  (3, 1.0E308) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, 'sum'))
FROM VALUES
  (1, -1.7976931348623157E308),
  (2, -1.7976931348623157E308),
  (3, -1.0E308) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, 'max'))
FROM VALUES
  (1, 1.7976931348623157E308),
  (2, 1.0E308),
  (3, 100.0D) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, max, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, max))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, 'min'))
FROM VALUES
  (1, -1.7976931348623157E308),
  (2, -1.0E308),
  (3, -100.0D) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, min, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, min))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, 'sum'))
FROM VALUES
  (1, 1.0E308),
  (1, 1.0E308),
  (1, 1.0E308) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key, val, 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'), 'sum')
FROM VALUES
  (1, 2147483647),
  (2, 1),
  (3, 100) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_summary_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, sum), sum)#xL]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'), 'sum')
FROM VALUES
  (1, 2147483647),
  (1, 2147483647),
  (1, 2147483647),
  (2, 100),
  (3, 200) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_summary_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, sum), sum)#xL]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT
  tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key, val, 12, 'sum')) AS estimate,
  tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'), 'sum') AS summary
FROM VALUES
  (1, -2147483648),
  (1, -2147483648),
  (1, -2147483648),
  (2, -100),
  (3, -200) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0)) AS estimate#x, tuple_sketch_summary_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0), sum) AS summary#xL]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, 'sum'), 'sum')
FROM VALUES
  (1, 2147483647),
  (1, 2147483647),
  (1, -2147483648),
  (2, 500) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_summary_integer(tuple_sketch_agg_integer(key#x, val#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_integer(tuple_sketch_agg_integer(key, val, 12, sum), sum)#xL]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_summary_double(tuple_sketch_agg_double(key, val, 12, 'sum'), 'sum')
FROM VALUES
  (1, 1.7976931348623157E308),
  (2, 1.7976931348623157E308) AS tab(key, val)
-- !query analysis
Aggregate [tuple_sketch_summary_double(tuple_sketch_agg_double(key#x, val#x, 12, sum, 0, 0), sum) AS tuple_sketch_summary_double(tuple_sketch_agg_double(key, val, 12, sum), sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [key#x, val#x]


-- !query
SELECT tuple_sketch_estimate_integer(
  tuple_union_integer(
    tuple_sketch_agg_integer(key1, val1, 12, 'sum'),
    tuple_sketch_agg_integer(key2, val2, 12, 'sum'), 12, 'sum'))
FROM VALUES
  (1, 2147483647, 1, 1000) AS tab(key1, val1, key2, val2)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_union_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_integer(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_integer(tuple_union_integer(tuple_sketch_agg_integer(key1, val1, 12, sum), tuple_sketch_agg_integer(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    tuple_sketch_agg_double(key1, val1, 12, 'sum'),
    tuple_sketch_agg_double(key2, val2, 12, 'sum'), 12, 'sum'))
FROM VALUES
  (1, 1.0E308, 1, 1.0E308) AS tab(key1, val1, key2, val2)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias tab
   +- LocalRelation [key1#x, val1#x, key2#x, val2#x]


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key => key1, summary => val1))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key => key1, summary => val1, lgNomEntries => 14))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 14, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 14, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key => key1, summary => val1, mode => 'max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 12, max, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 12, max))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(key => key1, summary => val1, lgNomEntries => 10, mode => 'min'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 10, min, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 10, min))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_sketch_agg_double(mode => 'max', lgNomEntries => 15, summary => val1, key => key1))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_sketch_agg_double(key1#x, val1#x, 15, max, 0, 0)) AS tuple_sketch_estimate_double(tuple_sketch_agg_double(key1, val1, 15, max))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key => key1, summary => val1))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key => key1, summary => val1, mode => 'max'))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, max, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 12, max))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_integer(lgNomEntries => 14, key => key1, mode => 'sum', summary => val1))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1#x, val1#x, 14, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_integer(key1, val1, 14, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(child => sketch))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(child => sketch, lgNomEntries => 14))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 14, sum, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 14, sum))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(child => sketch, mode => 'max'))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 12, max, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 12, max))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(tuple_union_agg_double(mode => 'min', lgNomEntries => 13, child => sketch))
FROM (SELECT tuple_sketch_agg_double(key1, val1) as sketch FROM t_int_double_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_double(key2, val2) as sketch FROM t_int_double_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_agg_double(sketch#x, 13, min, 0, 0)) AS tuple_sketch_estimate_double(tuple_union_agg_double(sketch, 13, min))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(tuple_union_agg_integer(child => sketch, mode => 'max'))
FROM (SELECT tuple_sketch_agg_integer(key1, val1, 12, 'sum') as sketch FROM t_int_int_1_5_through_7_11
      UNION ALL
      SELECT tuple_sketch_agg_integer(key2, val2, 12, 'sum') as sketch FROM t_int_int_1_5_through_7_11)
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_union_agg_integer(sketch#x, 12, max, 0, 0)) AS tuple_sketch_estimate_integer(tuple_union_agg_integer(sketch, 12, max))#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Union false, false
      :- Aggregate [tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0) AS sketch#x]
      :  +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
      :     +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet
      +- Aggregate [tuple_sketch_agg_integer(key2#x, val2#x, 12, sum, 0, 0) AS sketch#x]
         +- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
            +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    first => tuple_sketch_agg_double(key1, val1),
    second => tuple_sketch_agg_double(key2, val2)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    first => tuple_sketch_agg_double(key1, val1),
    second => tuple_sketch_agg_double(key2, val2),
    lgNomEntries => 14))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 14, sum)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 14, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    first => tuple_sketch_agg_double(key1, val1),
    second => tuple_sketch_agg_double(key2, val2),
    mode => 'max'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 12, max)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 12, max))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_double(
  tuple_union_double(
    mode => 'min',
    lgNomEntries => 15,
    second => tuple_sketch_agg_double(key2, val2),
    first => tuple_sketch_agg_double(key1, val1)))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_double(key2#x, val2#x, 12, sum, 0, 0), 15, min)) AS tuple_sketch_estimate_double(tuple_union_double(tuple_sketch_agg_double(key1, val1, 12, sum), tuple_sketch_agg_double(key2, val2, 12, sum), 15, min))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_estimate_integer(
  tuple_union_integer(
    first => tuple_sketch_agg_integer(key1, val1),
    second => tuple_sketch_agg_integer(key2, val2),
    lgNomEntries => 14))
FROM t_int_int_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_union_integer(tuple_sketch_agg_integer(key1#x, val1#x, 12, sum, 0, 0), tuple_sketch_agg_integer(key2#x, val2#x, 12, sum, 0, 0), 14, sum)) AS tuple_sketch_estimate_integer(tuple_union_integer(tuple_sketch_agg_integer(key1, val1, 12, sum), tuple_sketch_agg_integer(key2, val2, 12, sum), 14, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_int_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_int_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_agg_double(col, val, 2)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_sketch_agg_double`; the `lgNomEntries` value must be between 4 and 26, inclusive: 2. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, 2, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 43,
    "fragment" : "tuple_sketch_agg_double(col, val, 2)"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, val, 40)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_sketch_agg_double`; the `lgNomEntries` value must be between 4 and 26, inclusive: 40. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, 40, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 44,
    "fragment" : "tuple_sketch_agg_double(col, val, 40)"
  } ]
}


-- !query
SELECT tuple_union_agg_double(sketch, 3, 'sum')
FROM (SELECT tuple_sketch_agg_double(col, val, 12) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val)
      UNION ALL
      SELECT tuple_sketch_agg_double(col, val, 20) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val))
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_union_agg_double`; the `lgNomEntries` value must be between 4 and 26, inclusive: 3. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_union_agg_double(sketch, 3, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 47,
    "fragment" : "tuple_union_agg_double(sketch, 3, 'sum')"
  } ]
}


-- !query
SELECT tuple_union_agg_double(sketch, 27, 'sum')
FROM (SELECT tuple_sketch_agg_double(col, val, 12) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val)
      UNION ALL
      SELECT tuple_sketch_agg_double(col, val, 20) as sketch
        FROM VALUES (1, 1.0D) AS tab(col, val))
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_union_agg_double`; the `lgNomEntries` value must be between 4 and 26, inclusive: 27. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_union_agg_double(sketch, 27, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 48,
    "fragment" : "tuple_union_agg_double(sketch, 27, 'sum')"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, val, CAST(NULL AS INT)) AS lg_nom_entries_is_null
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_NULL",
  "sqlState" : "42K09",
  "messageParameters" : {
    "exprName" : "lgNomEntries",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, CAST(NULL AS INT), sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 59,
    "fragment" : "tuple_sketch_agg_double(col, val, CAST(NULL AS INT))"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, val, CAST(col AS INT)) AS lg_nom_entries_non_constant
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "CAST(tab.col AS INT)",
    "inputName" : "lgNomEntries",
    "inputType" : "int",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, CAST(col AS INT), sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 58,
    "fragment" : "tuple_sketch_agg_double(col, val, CAST(col AS INT))"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, val, 'fifteen')
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.SparkNumberFormatException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'fifteen'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"INT\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 51,
    "fragment" : "tuple_sketch_agg_double(col, val, 'fifteen')"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, val, 12, CAST(col AS STRING))
FROM VALUES (15, 1.0D), (16, 2.0D), (17, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "CAST(tab.col AS STRING)",
    "inputName" : "mode",
    "inputType" : "string",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, 12, CAST(col AS STRING))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 65,
    "fragment" : "tuple_sketch_agg_double(col, val, 12, CAST(col AS STRING))"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, val, 12, 'invalid_type')
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[TUPLE_INVALID_SKETCH_MODE] Invalid call to `tuple_sketch_agg_double`: mode 'invalid_type' is not supported. Valid modes are: sum, min, max, alwaysone. SQLSTATE: 22023",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, 12, invalid_type)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 60,
    "fragment" : "tuple_sketch_agg_double(col, val, 12, 'invalid_type')"
  } ]
}


-- !query
SELECT tuple_sketch_agg_double(col, 'fifteen')
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
Aggregate [tuple_sketch_agg_double(col#x, cast(fifteen as double), 12, sum, 0, 0) AS tuple_sketch_agg_double(col, fifteen, 12, sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [col#x, val#x]


-- !query
SELECT tuple_sketch_agg_double(col, val, 2.0D, 15)
FROM VALUES (50, 1.0D), (60, 2.0D), (60, 3.0D) tab(col, val)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.TYPE_CHECK_FAILURE_WITH_HINT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "hint" : "",
    "msg" : "[SKETCH_INVALID_LG_NOM_ENTRIES] Invalid call to `tuple_sketch_agg_double`; the `lgNomEntries` value must be between 4 and 26, inclusive: 2. SQLSTATE: 22003",
    "sqlExpr" : "\"tuple_sketch_agg_double(col, val, 2.0, 15)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 50,
    "fragment" : "tuple_sketch_agg_double(col, val, 2.0D, 15)"
  } ]
}


-- !query
SELECT tuple_union_double(1, 2)
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_union_double(1, 2, 12, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 31,
    "fragment" : "tuple_union_double(1, 2)"
  } ]
}


-- !query
SELECT tuple_intersection_double(1, 2)
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_intersection_double(1, 2, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 38,
    "fragment" : "tuple_intersection_double(1, 2)"
  } ]
}


-- !query
SELECT tuple_difference_double(1, 2)
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"1\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_difference_double(1, 2)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 36,
    "fragment" : "tuple_difference_double(1, 2)"
  } ]
}


-- !query
SELECT tuple_union_double(
    tuple_sketch_agg_double(col1, 1.0D),
    tuple_sketch_agg_double(col2, 2.0D), 'invalid')
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"invalid\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "third",
    "requiredType" : "\"INT\"",
    "sqlExpr" : "\"tuple_union_double(tuple_sketch_agg_double(col1, 1.0, 12, sum), tuple_sketch_agg_double(col2, 2.0, 12, sum), invalid, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 119,
    "fragment" : "tuple_union_double(\n    tuple_sketch_agg_double(col1, 1.0D),\n    tuple_sketch_agg_double(col2, 2.0D), 'invalid')"
  } ]
}


-- !query
SELECT tuple_intersection_double(
    tuple_sketch_agg_double(col1, 1.0),
    'invalid_sketch')
FROM VALUES
  (1, 4),
  (2, 5),
  (3, 6) AS tab(col1, col2)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"invalid_sketch\"",
    "inputType" : "\"STRING\"",
    "paramIndex" : "second",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_intersection_double(tuple_sketch_agg_double(col1, 1.0, 12, sum), invalid_sketch, sum)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 95,
    "fragment" : "tuple_intersection_double(\n    tuple_sketch_agg_double(col1, 1.0),\n    'invalid_sketch')"
  } ]
}


-- !query
SELECT tuple_sketch_estimate_double(CAST('abc' AS BINARY))
-- !query analysis
Project [tuple_sketch_estimate_double(cast(abc as binary)) AS tuple_sketch_estimate_double(CAST(abc AS BINARY))#x]
+- OneRowRelation


-- !query
SELECT tuple_union_double(CAST('abc' AS BINARY), CAST('def' AS BINARY))
-- !query analysis
Project [tuple_union_double(cast(abc as binary), cast(def as binary), 12, sum) AS tuple_union_double(CAST(abc AS BINARY), CAST(def AS BINARY), 12, sum)#x]
+- OneRowRelation


-- !query
SELECT tuple_intersection_double(CAST('abc' AS BINARY), CAST('def' AS BINARY))
-- !query analysis
Project [tuple_intersection_double(cast(abc as binary), cast(def as binary), sum) AS tuple_intersection_double(CAST(abc AS BINARY), CAST(def AS BINARY), sum)#x]
+- OneRowRelation


-- !query
SELECT tuple_difference_double(CAST('abc' AS BINARY), CAST('def' AS BINARY))
-- !query analysis
Project [tuple_difference_double(cast(abc as binary), cast(def as binary)) AS tuple_difference_double(CAST(abc AS BINARY), CAST(def AS BINARY))#x]
+- OneRowRelation


-- !query
SELECT tuple_union_agg_double(buffer, 15, 'sum')
FROM (SELECT CAST('abc' AS BINARY) AS buffer)
-- !query analysis
Aggregate [tuple_union_agg_double(buffer#x, 15, sum, 0, 0) AS tuple_union_agg_double(buffer, 15, sum)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Project [cast(abc as binary) AS buffer#x]
      +- OneRowRelation


-- !query
SELECT tuple_intersection_agg_double(buffer, 'sum')
FROM (SELECT CAST('abc' AS BINARY) AS buffer)
-- !query analysis
Aggregate [tuple_intersection_agg_double(buffer#x, sum, 0, 0) AS tuple_intersection_agg_double(buffer, sum)#x]
+- SubqueryAlias __auto_generated_subquery_name
   +- Project [cast(abc as binary) AS buffer#x]
      +- OneRowRelation


-- !query
SELECT tuple_sketch_agg_double(col1, col2, 12, 'sum')
FROM VALUES (1, 'invalid'), (2, 'invalid') AS tab(col1, col2)
-- !query analysis
Aggregate [tuple_sketch_agg_double(col1#x, cast(col2#x as double), 12, sum, 0, 0) AS tuple_sketch_agg_double(col1, col2, 12, sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT tuple_sketch_agg_integer(col1, col2, 12, 'sum')
FROM VALUES (1, 'invalid'), (2, 'invalid') AS tab(col1, col2)
-- !query analysis
Aggregate [tuple_sketch_agg_integer(col1#x, cast(col2#x as int), 12, sum, 0, 0) AS tuple_sketch_agg_integer(col1, col2, 12, sum)#x]
+- SubqueryAlias tab
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT tuple_sketch_estimate_integer(tuple_sketch_agg_double(key1, val1, 12, 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_estimate_integer(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_estimate_integer(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_theta_double(CAST('abc' AS BINARY))
-- !query analysis
Project [tuple_sketch_theta_double(cast(abc as binary)) AS tuple_sketch_theta_double(CAST(abc AS BINARY))#x]
+- OneRowRelation


-- !query
SELECT tuple_sketch_theta_integer(tuple_sketch_agg_double(key1, val1, 12, 'sum'))
FROM t_int_double_1_5_through_7_11
-- !query analysis
Aggregate [tuple_sketch_theta_integer(tuple_sketch_agg_double(key1#x, val1#x, 12, sum, 0, 0)) AS tuple_sketch_theta_integer(tuple_sketch_agg_double(key1, val1, 12, sum))#x]
+- SubqueryAlias spark_catalog.default.t_int_double_1_5_through_7_11
   +- Relation spark_catalog.default.t_int_double_1_5_through_7_11[key1#x,val1#x,key2#x,val2#x] parquet


-- !query
SELECT tuple_sketch_theta_double(123)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"123\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "first",
    "requiredType" : "\"BINARY\"",
    "sqlExpr" : "\"tuple_sketch_theta_double(123)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 37,
    "fragment" : "tuple_sketch_theta_double(123)"
  } ]
}


-- !query
DROP TABLE IF EXISTS t_int_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_double_1_5_through_7_11


-- !query
DROP TABLE IF EXISTS t_long_double_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_long_double_1_5_through_7_11


-- !query
DROP TABLE IF EXISTS t_double_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_double_double_1_1_1_4_through_1_5_1_8


-- !query
DROP TABLE IF EXISTS t_float_double_1_1_1_4_through_1_5_1_8
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_float_double_1_1_1_4_through_1_5_1_8


-- !query
DROP TABLE IF EXISTS t_string_double_a_d_through_e_h
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_double_a_d_through_e_h


-- !query
DROP TABLE IF EXISTS t_binary_double_a_b_through_e_f
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_binary_double_a_b_through_e_f


-- !query
DROP TABLE IF EXISTS t_array_int_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_int_double_1_3_through_4_6


-- !query
DROP TABLE IF EXISTS t_array_long_double_1_3_through_4_6
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_array_long_double_1_3_through_4_6


-- !query
DROP TABLE IF EXISTS t_int_int_1_5_through_7_11
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_int_int_1_5_through_7_11


-- !query
DROP TABLE IF EXISTS t_string_collation
-- !query analysis
DropTable true, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t_string_collation
