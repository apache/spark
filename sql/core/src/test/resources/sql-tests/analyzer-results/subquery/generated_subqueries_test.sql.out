-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW inner_table (a, b) AS VALUES
    (1, 10),
    (2, 20),
    (3, 30),
    (4, 40),
    (5, 50),
    (8, 80),
    (9, 90)
-- !query analysis
CreateViewCommand `inner_table`, [(a,None), (b,None)], VALUES
    (1, 10),
    (2, 20),
    (3, 30),
    (4, 40),
    (5, 50),
    (8, 80),
    (9, 90), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW outer_table (a, b) AS VALUES
    (1, 100),
    (2, 200),
    (3, 300),
    (4, 400),
    (6, 600),
    (7, 700),
    (10, 1000)
-- !query analysis
CreateViewCommand `outer_table`, [(a,None), (b,None)], VALUES
    (1, 100),
    (2, 200),
    (3, 300),
    (4, 400),
    (6, 600),
    (7, 700),
    (10, 1000), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW no_match_inner_table (a, b) AS VALUES
    (5, 50),
    (8, 80),
    (9, 90)
-- !query analysis
CreateViewCommand `no_match_inner_table`, [(a,None), (b,None)], VALUES
    (5, 50),
    (8, 80),
    (9, 90), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW no_match_outer_table (a, b) AS VALUES
    (6, 600),
    (7, 700),
    (10, 1000)
-- !query analysis
CreateViewCommand `no_match_outer_table`, [(a,None), (b,None)], VALUES
    (6, 600),
    (7, 700),
    (10, 1000), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
CREATE TEMPORARY VIEW join_table (a, b) AS VALUES
    (1, 10),
    (3, 30),
    (4, 400),
    (6, 600),
    (8, 80)
-- !query analysis
CreateViewCommand `join_table`, [(a,None), (b,None)], VALUES
    (1, 10),
    (3, 30),
    (4, 400),
    (6, 600),
    (8, 80), false, false, LocalTempView, true
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join Inner, (b#x = b#x)
   :                       :- SubqueryAlias inner_table
   :                       :  +- View (`inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join LeftOuter, (b#x = b#x)
   :                       :- SubqueryAlias inner_table
   :                       :  +- View (`inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join RightOuter, (b#x = b#x)
   :                       :- SubqueryAlias inner_table
   :                       :  +- View (`inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Intersect false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Distinct
   :                          +- Union false, false
   :                             :- Project [a#x, b#x]
   :                             :  +- SubqueryAlias inner_table
   :                             :     +- View (`inner_table`, [a#x, b#x])
   :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             :           +- LocalRelation [col1#x, col2#x]
   :                             +- Project [a#x, b#x]
   :                                +- SubqueryAlias join_table
   :                                   +- View (`join_table`, [a#x, b#x])
   :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                         +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Except false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join Inner, (b#x = b#x)
   :                 :- SubqueryAlias inner_table
   :                 :  +- View (`inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join LeftOuter, (b#x = b#x)
   :                 :- SubqueryAlias inner_table
   :                 :  +- View (`inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join RightOuter, (b#x = b#x)
   :                 :- SubqueryAlias inner_table
   :                 :  +- View (`inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Intersect false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias inner_table
   :                    :     +- View (`inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Distinct
   :                    +- Union false, false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Except false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias inner_table
   :                    :     +- View (`inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Distinct
            +- Project [a#x AS subquery_column_alias#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join Inner, (b#x = b#x)
               :- SubqueryAlias inner_table
               :  +- View (`inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join LeftOuter, (b#x = b#x)
               :- SubqueryAlias inner_table
               :  +- View (`inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join RightOuter, (b#x = b#x)
               :- SubqueryAlias inner_table
               :  +- View (`inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Intersect false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias inner_table
                  :     +- View (`inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Distinct
                  +- Union false, false
                     :- Project [a#x, b#x]
                     :  +- SubqueryAlias inner_table
                     :     +- View (`inner_table`, [a#x, b#x])
                     :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :           +- LocalRelation [col1#x, col2#x]
                     +- Project [a#x, b#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Except false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias inner_table
                  :     +- View (`inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join Inner, (b#x = b#x)
            :- SubqueryAlias inner_table
            :  +- View (`inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join LeftOuter, (b#x = b#x)
            :- SubqueryAlias inner_table
            :  +- View (`inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join RightOuter, (b#x = b#x)
            :- SubqueryAlias inner_table
            :  +- View (`inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Intersect false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias inner_table
               :     +- View (`inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Distinct
               +- Union false, false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias inner_table
                  :     +- View (`inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Except false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias inner_table
               :     +- View (`inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Distinct
            +- Project [a#x AS subquery_column_alias#x]
               +- SubqueryAlias inner_table
                  +- View (`inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join Inner, (b#x = b#x)
               :- SubqueryAlias inner_table
               :  +- View (`inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join LeftOuter, (b#x = b#x)
               :- SubqueryAlias inner_table
               :  +- View (`inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join RightOuter, (b#x = b#x)
               :- SubqueryAlias inner_table
               :  +- View (`inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Intersect false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias inner_table
                  :     +- View (`inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Distinct
                  +- Union false, false
                     :- Project [a#x, b#x]
                     :  +- SubqueryAlias inner_table
                     :     +- View (`inner_table`, [a#x, b#x])
                     :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :           +- LocalRelation [col1#x, col2#x]
                     +- Project [a#x, b#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Except false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias inner_table
                  :     +- View (`inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias inner_table
            +- View (`inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias inner_table
               +- View (`inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join Inner, (b#x = b#x)
            :- SubqueryAlias inner_table
            :  +- View (`inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join LeftOuter, (b#x = b#x)
            :- SubqueryAlias inner_table
            :  +- View (`inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join RightOuter, (b#x = b#x)
            :- SubqueryAlias inner_table
            :  +- View (`inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Intersect false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias inner_table
               :     +- View (`inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Distinct
               +- Union false, false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias inner_table
                  :     +- View (`inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Except false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias inner_table
               :     +- View (`inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join Inner, (b#x = b#x)
                        :- SubqueryAlias inner_table
                        :  +- View (`inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join LeftOuter, (b#x = b#x)
                        :- SubqueryAlias inner_table
                        :  +- View (`inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join RightOuter, (b#x = b#x)
                        :- SubqueryAlias inner_table
                        :  +- View (`inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Intersect false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias inner_table
                           :     +- View (`inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Distinct
                           +- Union false, false
                              :- Project [a#x, b#x]
                              :  +- SubqueryAlias inner_table
                              :     +- View (`inner_table`, [a#x, b#x])
                              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              :           +- LocalRelation [col1#x, col2#x]
                              +- Project [a#x, b#x]
                                 +- SubqueryAlias join_table
                                    +- View (`join_table`, [a#x, b#x])
                                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                          +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Except false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias inner_table
                           :     +- View (`inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join Inner, (b#x = b#x)
                     :- SubqueryAlias inner_table
                     :  +- View (`inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join LeftOuter, (b#x = b#x)
                     :- SubqueryAlias inner_table
                     :  +- View (`inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join RightOuter, (b#x = b#x)
                     :- SubqueryAlias inner_table
                     :  +- View (`inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Intersect false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias inner_table
                        :     +- View (`inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Distinct
                        +- Union false, false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias inner_table
                           :     +- View (`inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Except false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias inner_table
                        :     +- View (`inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias inner_table
                        +- View (`inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join Inner, (b#x = b#x)
                        :- SubqueryAlias inner_table
                        :  +- View (`inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join LeftOuter, (b#x = b#x)
                        :- SubqueryAlias inner_table
                        :  +- View (`inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join RightOuter, (b#x = b#x)
                        :- SubqueryAlias inner_table
                        :  +- View (`inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Intersect false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias inner_table
                           :     +- View (`inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Distinct
                           +- Union false, false
                              :- Project [a#x, b#x]
                              :  +- SubqueryAlias inner_table
                              :     +- View (`inner_table`, [a#x, b#x])
                              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              :           +- LocalRelation [col1#x, col2#x]
                              +- Project [a#x, b#x]
                                 +- SubqueryAlias join_table
                                    +- View (`join_table`, [a#x, b#x])
                                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                          +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Except false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias inner_table
                           :     +- View (`inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias inner_table
                     +- View (`inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join Inner, (b#x = b#x)
                     :- SubqueryAlias inner_table
                     :  +- View (`inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join LeftOuter, (b#x = b#x)
                     :- SubqueryAlias inner_table
                     :  +- View (`inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join RightOuter, (b#x = b#x)
                     :- SubqueryAlias inner_table
                     :  +- View (`inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Intersect false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias inner_table
                        :     +- View (`inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Distinct
                        +- Union false, false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias inner_table
                           :     +- View (`inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Except false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias inner_table
                        :     +- View (`inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join Inner, (b#x = b#x)
      :                       :- SubqueryAlias inner_table
      :                       :  +- View (`inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join LeftOuter, (b#x = b#x)
      :                       :- SubqueryAlias inner_table
      :                       :  +- View (`inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join RightOuter, (b#x = b#x)
      :                       :- SubqueryAlias inner_table
      :                       :  +- View (`inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Intersect false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Distinct
      :                          +- Union false, false
      :                             :- Project [a#x, b#x]
      :                             :  +- SubqueryAlias inner_table
      :                             :     +- View (`inner_table`, [a#x, b#x])
      :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             :           +- LocalRelation [col1#x, col2#x]
      :                             +- Project [a#x, b#x]
      :                                +- SubqueryAlias join_table
      :                                   +- View (`join_table`, [a#x, b#x])
      :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                         +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Except false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join Inner, (b#x = b#x)
      :                 :- SubqueryAlias inner_table
      :                 :  +- View (`inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join LeftOuter, (b#x = b#x)
      :                 :- SubqueryAlias inner_table
      :                 :  +- View (`inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join RightOuter, (b#x = b#x)
      :                 :- SubqueryAlias inner_table
      :                 :  +- View (`inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Intersect false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Distinct
      :                    +- Union false, false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Except false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join Inner, (b#x = b#x)
   :                       :- SubqueryAlias no_match_inner_table
   :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join LeftOuter, (b#x = b#x)
   :                       :- SubqueryAlias no_match_inner_table
   :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join RightOuter, (b#x = b#x)
   :                       :- SubqueryAlias no_match_inner_table
   :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Intersect false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Distinct
   :                          +- Union false, false
   :                             :- Project [a#x, b#x]
   :                             :  +- SubqueryAlias no_match_inner_table
   :                             :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             :           +- LocalRelation [col1#x, col2#x]
   :                             +- Project [a#x, b#x]
   :                                +- SubqueryAlias join_table
   :                                   +- View (`join_table`, [a#x, b#x])
   :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                         +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Except false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join Inner, (b#x = b#x)
   :                 :- SubqueryAlias no_match_inner_table
   :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join LeftOuter, (b#x = b#x)
   :                 :- SubqueryAlias no_match_inner_table
   :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join RightOuter, (b#x = b#x)
   :                 :- SubqueryAlias no_match_inner_table
   :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Intersect false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias no_match_inner_table
   :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Distinct
   :                    +- Union false, false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM outer_table ORDER BY outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Except false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias no_match_inner_table
   :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias outer_table
      +- View (`outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Distinct
            +- Project [a#x AS subquery_column_alias#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join Inner, (b#x = b#x)
               :- SubqueryAlias no_match_inner_table
               :  +- View (`no_match_inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join LeftOuter, (b#x = b#x)
               :- SubqueryAlias no_match_inner_table
               :  +- View (`no_match_inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join RightOuter, (b#x = b#x)
               :- SubqueryAlias no_match_inner_table
               :  +- View (`no_match_inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Intersect false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias no_match_inner_table
                  :     +- View (`no_match_inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Distinct
                  +- Union false, false
                     :- Project [a#x, b#x]
                     :  +- SubqueryAlias no_match_inner_table
                     :     +- View (`no_match_inner_table`, [a#x, b#x])
                     :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :           +- LocalRelation [col1#x, col2#x]
                     +- Project [a#x, b#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Except false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias no_match_inner_table
                  :     +- View (`no_match_inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join Inner, (b#x = b#x)
            :- SubqueryAlias no_match_inner_table
            :  +- View (`no_match_inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join LeftOuter, (b#x = b#x)
            :- SubqueryAlias no_match_inner_table
            :  +- View (`no_match_inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join RightOuter, (b#x = b#x)
            :- SubqueryAlias no_match_inner_table
            :  +- View (`no_match_inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Intersect false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias no_match_inner_table
               :     +- View (`no_match_inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Distinct
               +- Union false, false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias no_match_inner_table
                  :     +- View (`no_match_inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Except false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias no_match_inner_table
               :     +- View (`no_match_inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Distinct
            +- Project [a#x AS subquery_column_alias#x]
               +- SubqueryAlias no_match_inner_table
                  +- View (`no_match_inner_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join Inner, (b#x = b#x)
               :- SubqueryAlias no_match_inner_table
               :  +- View (`no_match_inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join LeftOuter, (b#x = b#x)
               :- SubqueryAlias no_match_inner_table
               :  +- View (`no_match_inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- Join RightOuter, (b#x = b#x)
               :- SubqueryAlias no_match_inner_table
               :  +- View (`no_match_inner_table`, [a#x, b#x])
               :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :        +- LocalRelation [col1#x, col2#x]
               +- SubqueryAlias join_table
                  +- View (`join_table`, [a#x, b#x])
                     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Intersect false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias no_match_inner_table
                  :     +- View (`no_match_inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Distinct
                  +- Union false, false
                     :- Project [a#x, b#x]
                     :  +- SubqueryAlias no_match_inner_table
                     :     +- View (`no_match_inner_table`, [a#x, b#x])
                     :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :           +- LocalRelation [col1#x, col2#x]
                     +- Project [a#x, b#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Distinct
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias subquery_set_operation_alias
               +- Except false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias no_match_inner_table
                  :     +- View (`no_match_inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
         +- SubqueryAlias no_match_inner_table
            +- View (`no_match_inner_table`, [a#x, b#x])
               +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 10
         +- LocalLimit 10
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
         +- Project [a#x AS subquery_column_alias#x]
            +- SubqueryAlias no_match_inner_table
               +- View (`no_match_inner_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join Inner, (b#x = b#x)
            :- SubqueryAlias no_match_inner_table
            :  +- View (`no_match_inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join LeftOuter, (b#x = b#x)
            :- SubqueryAlias no_match_inner_table
            :  +- View (`no_match_inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- Join RightOuter, (b#x = b#x)
            :- SubqueryAlias no_match_inner_table
            :  +- View (`no_match_inner_table`, [a#x, b#x])
            :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            :        +- LocalRelation [col1#x, col2#x]
            +- SubqueryAlias join_table
               +- View (`join_table`, [a#x, b#x])
                  +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Intersect false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias no_match_inner_table
               :     +- View (`no_match_inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Distinct
               +- Union false, false
                  :- Project [a#x, b#x]
                  :  +- SubqueryAlias no_match_inner_table
                  :     +- View (`no_match_inner_table`, [a#x, b#x])
                  :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                  :           +- LocalRelation [col1#x, col2#x]
                  +- Project [a#x, b#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- Project [a#x AS subquery_column_alias#x]
         +- SubqueryAlias subquery_set_operation_alias
            +- Except false
               :- Project [a#x, b#x]
               :  +- SubqueryAlias no_match_inner_table
               :     +- View (`no_match_inner_table`, [a#x, b#x])
               :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               :           +- LocalRelation [col1#x, col2#x]
               +- Project [a#x, b#x]
                  +- SubqueryAlias join_table
                     +- View (`join_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join Inner, (b#x = b#x)
                        :- SubqueryAlias no_match_inner_table
                        :  +- View (`no_match_inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join LeftOuter, (b#x = b#x)
                        :- SubqueryAlias no_match_inner_table
                        :  +- View (`no_match_inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join RightOuter, (b#x = b#x)
                        :- SubqueryAlias no_match_inner_table
                        :  +- View (`no_match_inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Intersect false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias no_match_inner_table
                           :     +- View (`no_match_inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Distinct
                           +- Union false, false
                              :- Project [a#x, b#x]
                              :  +- SubqueryAlias no_match_inner_table
                              :     +- View (`no_match_inner_table`, [a#x, b#x])
                              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              :           +- LocalRelation [col1#x, col2#x]
                              +- Project [a#x, b#x]
                                 +- SubqueryAlias join_table
                                    +- View (`join_table`, [a#x, b#x])
                                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                          +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Except false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias no_match_inner_table
                           :     +- View (`no_match_inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join Inner, (b#x = b#x)
                     :- SubqueryAlias no_match_inner_table
                     :  +- View (`no_match_inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join LeftOuter, (b#x = b#x)
                     :- SubqueryAlias no_match_inner_table
                     :  +- View (`no_match_inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join RightOuter, (b#x = b#x)
                     :- SubqueryAlias no_match_inner_table
                     :  +- View (`no_match_inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Intersect false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias no_match_inner_table
                        :     +- View (`no_match_inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Distinct
                        +- Union false, false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias no_match_inner_table
                           :     +- View (`no_match_inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Except false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias no_match_inner_table
                        :     +- View (`no_match_inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Distinct
                  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias no_match_inner_table
                        +- View (`no_match_inner_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join Inner, (b#x = b#x)
                        :- SubqueryAlias no_match_inner_table
                        :  +- View (`no_match_inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join LeftOuter, (b#x = b#x)
                        :- SubqueryAlias no_match_inner_table
                        :  +- View (`no_match_inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- Join RightOuter, (b#x = b#x)
                        :- SubqueryAlias no_match_inner_table
                        :  +- View (`no_match_inner_table`, [a#x, b#x])
                        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :        +- LocalRelation [col1#x, col2#x]
                        +- SubqueryAlias join_table
                           +- View (`join_table`, [a#x, b#x])
                              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                 +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Intersect false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias no_match_inner_table
                           :     +- View (`no_match_inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Distinct
                           +- Union false, false
                              :- Project [a#x, b#x]
                              :  +- SubqueryAlias no_match_inner_table
                              :     +- View (`no_match_inner_table`, [a#x, b#x])
                              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              :           +- LocalRelation [col1#x, col2#x]
                              +- Project [a#x, b#x]
                                 +- SubqueryAlias join_table
                                    +- View (`join_table`, [a#x, b#x])
                                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                          +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Distinct
                  +- Project [a#x AS subquery_column_alias#x]
                     +- SubqueryAlias subquery_set_operation_alias
                        +- Except false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias no_match_inner_table
                           :     +- View (`no_match_inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#xL ASC NULLS FIRST], true
+- Project [subquery_column_alias#xL]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
               +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias no_match_inner_table
                     +- View (`no_match_inner_table`, [a#x, b#x])
                        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join Inner, (b#x = b#x)
                     :- SubqueryAlias no_match_inner_table
                     :  +- View (`no_match_inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join LeftOuter, (b#x = b#x)
                     :- SubqueryAlias no_match_inner_table
                     :  +- View (`no_match_inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- Join RightOuter, (b#x = b#x)
                     :- SubqueryAlias no_match_inner_table
                     :  +- View (`no_match_inner_table`, [a#x, b#x])
                     :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                     :        +- LocalRelation [col1#x, col2#x]
                     +- SubqueryAlias join_table
                        +- View (`join_table`, [a#x, b#x])
                           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                              +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Intersect false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias no_match_inner_table
                        :     +- View (`no_match_inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Distinct
                        +- Union false, false
                           :- Project [a#x, b#x]
                           :  +- SubqueryAlias no_match_inner_table
                           :     +- View (`no_match_inner_table`, [a#x, b#x])
                           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                           :           +- LocalRelation [col1#x, col2#x]
                           +- Project [a#x, b#x]
                              +- SubqueryAlias join_table
                                 +- View (`join_table`, [a#x, b#x])
                                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                       +- LocalRelation [col1#x, col2#x]


-- !query
SELECT subquery_column_alias FROM (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias ORDER BY subquery_column_alias NULLS FIRST
-- !query analysis
Sort [subquery_column_alias#x ASC NULLS FIRST], true
+- Project [subquery_column_alias#x]
   +- SubqueryAlias subquery_alias
      +- GlobalLimit 1
         +- LocalLimit 1
            +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
               +- Project [a#x AS subquery_column_alias#x]
                  +- SubqueryAlias subquery_set_operation_alias
                     +- Except false
                        :- Project [a#x, b#x]
                        :  +- SubqueryAlias no_match_inner_table
                        :     +- View (`no_match_inner_table`, [a#x, b#x])
                        :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                        :           +- LocalRelation [col1#x, col2#x]
                        +- Project [a#x, b#x]
                           +- SubqueryAlias join_table
                              +- View (`join_table`, [a#x, b#x])
                                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
                                    +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join Inner, (b#x = b#x)
      :                       :- SubqueryAlias no_match_inner_table
      :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join LeftOuter, (b#x = b#x)
      :                       :- SubqueryAlias no_match_inner_table
      :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join RightOuter, (b#x = b#x)
      :                       :- SubqueryAlias no_match_inner_table
      :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Intersect false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Distinct
      :                          +- Union false, false
      :                             :- Project [a#x, b#x]
      :                             :  +- SubqueryAlias no_match_inner_table
      :                             :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             :           +- LocalRelation [col1#x, col2#x]
      :                             +- Project [a#x, b#x]
      :                                +- SubqueryAlias join_table
      :                                   +- View (`join_table`, [a#x, b#x])
      :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                         +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Except false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join Inner, (b#x = b#x)
      :                 :- SubqueryAlias no_match_inner_table
      :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join LeftOuter, (b#x = b#x)
      :                 :- SubqueryAlias no_match_inner_table
      :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join RightOuter, (b#x = b#x)
      :                 :- SubqueryAlias no_match_inner_table
      :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Intersect false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Distinct
      :                    +- Union false, false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM outer_table WHERE outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Except false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias outer_table
         +- View (`outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias inner_table
   :                       +- View (`inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join Inner, (b#x = b#x)
   :                       :- SubqueryAlias inner_table
   :                       :  +- View (`inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join LeftOuter, (b#x = b#x)
   :                       :- SubqueryAlias inner_table
   :                       :  +- View (`inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join RightOuter, (b#x = b#x)
   :                       :- SubqueryAlias inner_table
   :                       :  +- View (`inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Intersect false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Distinct
   :                          +- Union false, false
   :                             :- Project [a#x, b#x]
   :                             :  +- SubqueryAlias inner_table
   :                             :     +- View (`inner_table`, [a#x, b#x])
   :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             :           +- LocalRelation [col1#x, col2#x]
   :                             +- Project [a#x, b#x]
   :                                +- SubqueryAlias join_table
   :                                   +- View (`join_table`, [a#x, b#x])
   :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                         +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Except false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias inner_table
   :                    +- View (`inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias inner_table
   :                    :  +- View (`inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias inner_table
   :                          :     +- View (`inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias inner_table
   :                 +- View (`inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join Inner, (b#x = b#x)
   :                 :- SubqueryAlias inner_table
   :                 :  +- View (`inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join LeftOuter, (b#x = b#x)
   :                 :- SubqueryAlias inner_table
   :                 :  +- View (`inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join RightOuter, (b#x = b#x)
   :                 :- SubqueryAlias inner_table
   :                 :  +- View (`inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Intersect false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias inner_table
   :                    :     +- View (`inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Distinct
   :                    +- Union false, false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias inner_table
   :                       :     +- View (`inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Except false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias inner_table
   :                    :     +- View (`inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias inner_table
      :              :  +- View (`inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias inner_table
      :              +- View (`inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias inner_table
      :           :  +- View (`inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias inner_table
      :                 :     +- View (`inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias inner_table
      :        +- View (`inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias inner_table
      :           +- View (`inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias inner_table
      :        :  +- View (`inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias inner_table
      :              :     +- View (`inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias inner_table
      :           :     +- View (`inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias inner_table
      :                       +- View (`inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join Inner, (b#x = b#x)
      :                       :- SubqueryAlias inner_table
      :                       :  +- View (`inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join LeftOuter, (b#x = b#x)
      :                       :- SubqueryAlias inner_table
      :                       :  +- View (`inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join RightOuter, (b#x = b#x)
      :                       :- SubqueryAlias inner_table
      :                       :  +- View (`inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Intersect false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Distinct
      :                          +- Union false, false
      :                             :- Project [a#x, b#x]
      :                             :  +- SubqueryAlias inner_table
      :                             :     +- View (`inner_table`, [a#x, b#x])
      :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             :           +- LocalRelation [col1#x, col2#x]
      :                             +- Project [a#x, b#x]
      :                                +- SubqueryAlias join_table
      :                                   +- View (`join_table`, [a#x, b#x])
      :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                         +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Except false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b WHERE inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias inner_table
      :                    +- View (`inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias inner_table
      :                    :  +- View (`inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias inner_table
      :                          :     +- View (`inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(inner_table.a) AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT COUNT(inner_table.a) AS subquery_column_alias FROM inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias inner_table
      :                 +- View (`inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table INNER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join Inner, (b#x = b#x)
      :                 :- SubqueryAlias inner_table
      :                 :  +- View (`inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table LEFT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join LeftOuter, (b#x = b#x)
      :                 :- SubqueryAlias inner_table
      :                 :  +- View (`inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT inner_table.a AS subquery_column_alias FROM inner_table RIGHT OUTER JOIN join_table ON inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join RightOuter, (b#x = b#x)
      :                 :- SubqueryAlias inner_table
      :                 :  +- View (`inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Intersect false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Distinct
      :                    +- Union false, false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias inner_table
      :                       :     +- View (`inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Except false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias inner_table
      :                    :     +- View (`inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias no_match_inner_table
   :                       +- View (`no_match_inner_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join Inner, (b#x = b#x)
   :                       :- SubqueryAlias no_match_inner_table
   :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join LeftOuter, (b#x = b#x)
   :                       :- SubqueryAlias no_match_inner_table
   :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- Join RightOuter, (b#x = b#x)
   :                       :- SubqueryAlias no_match_inner_table
   :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :        +- LocalRelation [col1#x, col2#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Intersect false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Distinct
   :                          +- Union false, false
   :                             :- Project [a#x, b#x]
   :                             :  +- SubqueryAlias no_match_inner_table
   :                             :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             :           +- LocalRelation [col1#x, col2#x]
   :                             +- Project [a#x, b#x]
   :                                +- SubqueryAlias join_table
   :                                   +- View (`join_table`, [a#x, b#x])
   :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                         +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Filter (a#x = outer(a#x))
   :                    +- SubqueryAlias subquery_set_operation_alias
   :                       +- Except false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [a#x] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Filter (a#x = outer(a#x))
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias no_match_inner_table
   :                    +- View (`no_match_inner_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join Inner, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join LeftOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- Join RightOuter, (b#x = b#x)
   :                    :- SubqueryAlias no_match_inner_table
   :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :        +- LocalRelation [col1#x, col2#x]
   :                    +- SubqueryAlias join_table
   :                       +- View (`join_table`, [a#x, b#x])
   :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                             +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Intersect false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Distinct
   :                       +- Union false, false
   :                          :- Project [a#x, b#x]
   :                          :  +- SubqueryAlias no_match_inner_table
   :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          :           +- LocalRelation [col1#x, col2#x]
   :                          +- Project [a#x, b#x]
   :                             +- SubqueryAlias join_table
   :                                +- View (`join_table`, [a#x, b#x])
   :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                      +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Distinct
   :              +- Project [a#x AS subquery_column_alias#x]
   :                 +- SubqueryAlias subquery_set_operation_alias
   :                    +- Except false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#xL ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#xL]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
   :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias no_match_inner_table
   :                 +- View (`no_match_inner_table`, [a#x, b#x])
   :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join Inner, (b#x = b#x)
   :                 :- SubqueryAlias no_match_inner_table
   :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join LeftOuter, (b#x = b#x)
   :                 :- SubqueryAlias no_match_inner_table
   :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- Join RightOuter, (b#x = b#x)
   :                 :- SubqueryAlias no_match_inner_table
   :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
   :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                 :        +- LocalRelation [col1#x, col2#x]
   :                 +- SubqueryAlias join_table
   :                    +- View (`join_table`, [a#x, b#x])
   :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                          +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Intersect false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias no_match_inner_table
   :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Distinct
   :                    +- Union false, false
   :                       :- Project [a#x, b#x]
   :                       :  +- SubqueryAlias no_match_inner_table
   :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                       :           +- LocalRelation [col1#x, col2#x]
   :                       +- Project [a#x, b#x]
   :                          +- SubqueryAlias join_table
   :                             +- View (`join_table`, [a#x, b#x])
   :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                   +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT no_match_outer_table.b, (SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) AS subquery_alias FROM no_match_outer_table ORDER BY no_match_outer_table.b, subquery_alias NULLS FIRST
-- !query analysis
Sort [b#x ASC NULLS FIRST, subquery_alias#x ASC NULLS FIRST], true
+- Project [b#x, scalar-subquery#x [] AS subquery_alias#x]
   :  +- GlobalLimit 1
   :     +- LocalLimit 1
   :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
   :           +- Project [a#x AS subquery_column_alias#x]
   :              +- SubqueryAlias subquery_set_operation_alias
   :                 +- Except false
   :                    :- Project [a#x, b#x]
   :                    :  +- SubqueryAlias no_match_inner_table
   :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
   :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                    :           +- LocalRelation [col1#x, col2#x]
   :                    +- Project [a#x, b#x]
   :                       +- SubqueryAlias join_table
   :                          +- View (`join_table`, [a#x, b#x])
   :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
   :                                +- LocalRelation [col1#x, col2#x]
   +- SubqueryAlias no_match_outer_table
      +- View (`no_match_outer_table`, [a#x, b#x])
         +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [a#x])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [a#x])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Distinct
      :        +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT cast(a#x as bigint) IN (list#x [])
      :  +- Project [subquery_column_alias#xL]
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a NOT IN(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT a#x IN (list#x [])
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- Filter (a#x = outer(a#x))
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join Inner, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join LeftOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- Join RightOuter, (b#x = b#x)
      :              :- SubqueryAlias no_match_inner_table
      :              :  +- View (`no_match_inner_table`, [a#x, b#x])
      :              :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :        +- LocalRelation [col1#x, col2#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Intersect false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Distinct
      :                 +- Union false, false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias subquery_set_operation_alias
      :              +- Except false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Filter (a#x = outer(a#x))
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a   ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x [a#x]
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Filter (a#x = outer(a#x))
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Distinct
      :        +- Project [a#x AS subquery_column_alias#x]
      :           +- SubqueryAlias no_match_inner_table
      :              +- View (`no_match_inner_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join Inner, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join LeftOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- Join RightOuter, (b#x = b#x)
      :           :- SubqueryAlias no_match_inner_table
      :           :  +- View (`no_match_inner_table`, [a#x, b#x])
      :           :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :        +- LocalRelation [col1#x, col2#x]
      :           +- SubqueryAlias join_table
      :              +- View (`join_table`, [a#x, b#x])
      :                 +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Intersect false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Distinct
      :              +- Union false, false
      :                 :- Project [a#x, b#x]
      :                 :  +- SubqueryAlias no_match_inner_table
      :                 :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :           +- LocalRelation [col1#x, col2#x]
      :                 +- Project [a#x, b#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Distinct
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias subquery_set_operation_alias
      :           +- Except false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a  ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :     +- SubqueryAlias no_match_inner_table
      :        +- View (`no_match_inner_table`, [a#x, b#x])
      :           +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 10) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- GlobalLimit 10
      :     +- LocalLimit 10
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :     +- Project [a#x AS subquery_column_alias#x]
      :        +- SubqueryAlias no_match_inner_table
      :           +- View (`no_match_inner_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join Inner, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join LeftOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- Join RightOuter, (b#x = b#x)
      :        :- SubqueryAlias no_match_inner_table
      :        :  +- View (`no_match_inner_table`, [a#x, b#x])
      :        :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :        :        +- LocalRelation [col1#x, col2#x]
      :        +- SubqueryAlias join_table
      :           +- View (`join_table`, [a#x, b#x])
      :              +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Intersect false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Distinct
      :           +- Union false, false
      :              :- Project [a#x, b#x]
      :              :  +- SubqueryAlias no_match_inner_table
      :              :     +- View (`no_match_inner_table`, [a#x, b#x])
      :              :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :              :           +- LocalRelation [col1#x, col2#x]
      :              +- Project [a#x, b#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE NOT EXISTS(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias    ) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter NOT exists#x []
      :  +- Project [a#x AS subquery_column_alias#x]
      :     +- SubqueryAlias subquery_set_operation_alias
      :        +- Except false
      :           :- Project [a#x, b#x]
      :           :  +- SubqueryAlias no_match_inner_table
      :           :     +- View (`no_match_inner_table`, [a#x, b#x])
      :           :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :           :           +- LocalRelation [col1#x, col2#x]
      :           +- Project [a#x, b#x]
      :              +- SubqueryAlias join_table
      :                 +- View (`join_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias no_match_inner_table
      :                       +- View (`no_match_inner_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join Inner, (b#x = b#x)
      :                       :- SubqueryAlias no_match_inner_table
      :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join LeftOuter, (b#x = b#x)
      :                       :- SubqueryAlias no_match_inner_table
      :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- Join RightOuter, (b#x = b#x)
      :                       :- SubqueryAlias no_match_inner_table
      :                       :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :        +- LocalRelation [col1#x, col2#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Intersect false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Distinct
      :                          +- Union false, false
      :                             :- Project [a#x, b#x]
      :                             :  +- SubqueryAlias no_match_inner_table
      :                             :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                             :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             :           +- LocalRelation [col1#x, col2#x]
      :                             +- Project [a#x, b#x]
      :                                +- SubqueryAlias join_table
      :                                   +- View (`join_table`, [a#x, b#x])
      :                                      +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                         +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Filter (a#x = outer(a#x))
      :                    +- SubqueryAlias subquery_set_operation_alias
      :                       +- Except false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b WHERE no_match_inner_table.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias WHERE subquery_set_operation_alias.a = no_match_outer_table.a  ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [a#x])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Filter (a#x = outer(a#x))
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias no_match_inner_table
      :                    +- View (`no_match_inner_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join Inner, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join LeftOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- Join RightOuter, (b#x = b#x)
      :                    :- SubqueryAlias no_match_inner_table
      :                    :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :        +- LocalRelation [col1#x, col2#x]
      :                    +- SubqueryAlias join_table
      :                       +- View (`join_table`, [a#x, b#x])
      :                          +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                             +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Intersect false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Distinct
      :                       +- Union false, false
      :                          :- Project [a#x, b#x]
      :                          :  +- SubqueryAlias no_match_inner_table
      :                          :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                          :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          :           +- LocalRelation [col1#x, col2#x]
      :                          +- Project [a#x, b#x]
      :                             +- SubqueryAlias join_table
      :                                +- View (`join_table`, [a#x, b#x])
      :                                   +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                      +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT DISTINCT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Distinct
      :              +- Project [a#x AS subquery_column_alias#x]
      :                 +- SubqueryAlias subquery_set_operation_alias
      :                    +- Except false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT SUM(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [sum(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT COUNT(no_match_inner_table.a) AS subquery_column_alias FROM no_match_inner_table  GROUP BY a ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (cast(a#x as bigint) = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#xL DESC NULLS FIRST], true
      :           +- Aggregate [a#x], [count(a#x) AS subquery_column_alias#xL]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias no_match_inner_table
      :                 +- View (`no_match_inner_table`, [a#x, b#x])
      :                    +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table INNER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join Inner, (b#x = b#x)
      :                 :- SubqueryAlias no_match_inner_table
      :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table LEFT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join LeftOuter, (b#x = b#x)
      :                 :- SubqueryAlias no_match_inner_table
      :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT no_match_inner_table.a AS subquery_column_alias FROM no_match_inner_table RIGHT OUTER JOIN join_table ON no_match_inner_table.b = join_table.b   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- Join RightOuter, (b#x = b#x)
      :                 :- SubqueryAlias no_match_inner_table
      :                 :  +- View (`no_match_inner_table`, [a#x, b#x])
      :                 :     +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                 :        +- LocalRelation [col1#x, col2#x]
      :                 +- SubqueryAlias join_table
      :                    +- View (`join_table`, [a#x, b#x])
      :                       +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                          +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table INTERSECT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Intersect false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table UNION SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Distinct
      :                    +- Union false, false
      :                       :- Project [a#x, b#x]
      :                       :  +- SubqueryAlias no_match_inner_table
      :                       :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                       :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                       :           +- LocalRelation [col1#x, col2#x]
      :                       +- Project [a#x, b#x]
      :                          +- SubqueryAlias join_table
      :                             +- View (`join_table`, [a#x, b#x])
      :                                +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                   +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]


-- !query
SELECT a, b FROM no_match_outer_table WHERE no_match_outer_table.a =(SELECT subquery_set_operation_alias.a AS subquery_column_alias FROM (SELECT a, b FROM no_match_inner_table EXCEPT SELECT a, b FROM join_table) AS subquery_set_operation_alias   ORDER BY subquery_column_alias DESC NULLS FIRST LIMIT 1) ORDER BY a, b NULLS FIRST
-- !query analysis
Sort [a#x ASC NULLS FIRST, b#x ASC NULLS FIRST], true
+- Project [a#x, b#x]
   +- Filter (a#x = scalar-subquery#x [])
      :  +- GlobalLimit 1
      :     +- LocalLimit 1
      :        +- Sort [subquery_column_alias#x DESC NULLS FIRST], true
      :           +- Project [a#x AS subquery_column_alias#x]
      :              +- SubqueryAlias subquery_set_operation_alias
      :                 +- Except false
      :                    :- Project [a#x, b#x]
      :                    :  +- SubqueryAlias no_match_inner_table
      :                    :     +- View (`no_match_inner_table`, [a#x, b#x])
      :                    :        +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                    :           +- LocalRelation [col1#x, col2#x]
      :                    +- Project [a#x, b#x]
      :                       +- SubqueryAlias join_table
      :                          +- View (`join_table`, [a#x, b#x])
      :                             +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
      :                                +- LocalRelation [col1#x, col2#x]
      +- SubqueryAlias no_match_outer_table
         +- View (`no_match_outer_table`, [a#x, b#x])
            +- Project [cast(col1#x as int) AS a#x, cast(col2#x as int) AS b#x]
               +- LocalRelation [col1#x, col2#x]
