-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW m AS SELECT * FROM VALUES
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b)
-- !query analysis
CreateViewCommand `m`, SELECT * FROM VALUES
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [a#x, b#x]
      +- SubqueryAlias m
         +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  a NOT IN (null)
-- !query analysis
Project [a#x, b#x]
+- Filter NOT cast(a#x as int) IN (cast(null as int))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 1.0 -- Only matches (null, 1.0)
       AND a NOT IN (2)
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 1.0) AND NOT a#x IN (2))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 3.0 -- Only matches (2, 3.0)
       AND a NOT IN (2)
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 3.0) AND NOT a#x IN (2))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 3.0 -- Only matches (2, 3.0)
       AND a NOT IN (6)
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 3.0) AND NOT a#x IN (6))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]
