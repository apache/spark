-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW m AS SELECT * FROM VALUES
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b)
-- !query analysis
CreateViewCommand `m`, SELECT * FROM VALUES
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [a#x, b#x]
      +- SubqueryAlias m
         +- LocalRelation [a#x, b#x]


-- !query
CREATE TEMPORARY VIEW s AS SELECT * FROM VALUES
  (null, 1.0),
  (2, 3.0),
  (6, 7.0)
  AS s(c, d)
-- !query analysis
CreateViewCommand `s`, SELECT * FROM VALUES
  (null, 1.0),
  (2, 3.0),
  (6, 7.0)
  AS s(c, d), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [c#x, d#x]
      +- SubqueryAlias s
         +- LocalRelation [c#x, d#x]


-- !query
SELECT *
FROM   m
WHERE  a NOT IN (SELECT c
                 FROM   s
                 WHERE  d > 10.0) -- (empty subquery)
-- !query analysis
Project [a#x, b#x]
+- Filter NOT a#x IN (list#x [])
   :  +- Project [c#x]
   :     +- Filter (cast(d#x as decimal(3,1)) > 10.0)
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  a NOT IN (SELECT c
                 FROM   s
                 WHERE  d = 1.0) -- Only matches (null, 1.0)
-- !query analysis
Project [a#x, b#x]
+- Filter NOT a#x IN (list#x [])
   :  +- Project [c#x]
   :     +- Filter (d#x = 1.0)
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 1.0 -- Only matches (null, 1.0)
       AND a NOT IN (SELECT c
                     FROM   s
                     WHERE  d = 3.0) -- Matches (2, 3.0)
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 1.0) AND NOT a#x IN (list#x []))
   :  +- Project [c#x]
   :     +- Filter (d#x = 3.0)
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 3.0 -- Only matches (2, 3.0)
       AND a NOT IN (SELECT c
                     FROM   s
                     WHERE  d = 3.0) -- Matches (2, 3.0)
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 3.0) AND NOT a#x IN (list#x []))
   :  +- Project [c#x]
   :     +- Filter (d#x = 3.0)
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 3.0 -- Only matches (2, 3.0)
       AND a NOT IN (SELECT c
                     FROM   s
                     WHERE  d = 7.0) -- Matches (6, 7.0)
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 3.0) AND NOT a#x IN (list#x []))
   :  +- Project [c#x]
   :     +- Filter (d#x = 7.0)
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE a NOT IN (SELECT c
                FROM   s
                WHERE  d = b + 10) -- Matches no row
-- !query analysis
Project [a#x, b#x]
+- Filter NOT a#x IN (list#x [b#x])
   :  +- Project [c#x]
   :     +- Filter (cast(d#x as decimal(4,1)) = (outer(b#x) + cast(10 as decimal(2,0))))
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 1.0 -- Only matches (null, 1.0)
       AND a NOT IN (SELECT c
                     FROM   s
                     WHERE  d = b + 10) -- Matches no row
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 1.0) AND NOT a#x IN (list#x [b#x]))
   :  +- Project [c#x]
   :     +- Filter (cast(d#x as decimal(4,1)) = (outer(b#x) + cast(10 as decimal(2,0))))
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 3.0 -- Only matches (2, 3.0)
       AND a NOT IN (SELECT c
                     FROM   s
                     WHERE  d = b + 10) -- Matches no row
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 3.0) AND NOT a#x IN (list#x [b#x]))
   :  +- Project [c#x]
   :     +- Filter (cast(d#x as decimal(4,1)) = (outer(b#x) + cast(10 as decimal(2,0))))
   :        +- SubqueryAlias s
   :           +- View (`s`, [c#x, d#x])
   :              +- Project [cast(c#x as int) AS c#x, cast(d#x as decimal(2,1)) AS d#x]
   :                 +- Project [c#x, d#x]
   :                    +- SubqueryAlias s
   :                       +- LocalRelation [c#x, d#x]
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]
