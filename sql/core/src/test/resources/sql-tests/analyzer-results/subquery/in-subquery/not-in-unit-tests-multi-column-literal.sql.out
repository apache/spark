-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW m AS SELECT * FROM VALUES
  (null, null),
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b)
-- !query analysis
CreateViewCommand `m`, SELECT * FROM VALUES
  (null, null),
  (null, 1.0),
  (2, 3.0),
  (4, 5.0)
  AS m(a, b), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [a#x, b#x]
      +- SubqueryAlias m
         +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 1.0 -- Matches (null, 1.0)
       AND (a, b) NOT IN ((2, 3.0))
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 1.0) AND NOT named_struct(a, a#x, b, b#x) IN (named_struct(col1, 2, col2, 3.0)))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 3.0 -- Matches (2, 3.0)
       AND (a, b) NOT IN ((2, 3.0))
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 3.0) AND NOT named_struct(a, a#x, b, b#x) IN (named_struct(col1, 2, col2, 3.0)))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]


-- !query
SELECT *
FROM   m
WHERE  b = 5.0 -- Matches (4, 5.0)
       AND (a, b) NOT IN ((2, 3.0))
-- !query analysis
Project [a#x, b#x]
+- Filter ((b#x = 5.0) AND NOT named_struct(a, a#x, b, b#x) IN (named_struct(col1, 2, col2, 3.0)))
   +- SubqueryAlias m
      +- View (`m`, [a#x, b#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as decimal(2,1)) AS b#x]
            +- Project [a#x, b#x]
               +- SubqueryAlias m
                  +- LocalRelation [a#x, b#x]
