-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT mask('AbCD123-@$#')
-- !query analysis
Project [mask(AbCD123-@$#, X, x, n, null) AS mask(AbCD123-@$#, X, x, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', 'Q')
-- !query analysis
Project [mask(AbCD123-@$#, Q, x, n, null) AS mask(AbCD123-@$#, Q, x, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', 'Q', 'q')
-- !query analysis
Project [mask(AbCD123-@$#, Q, q, n, null) AS mask(AbCD123-@$#, Q, q, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', 'Q', 'q', 'd')
-- !query analysis
Project [mask(AbCD123-@$#, Q, q, d, null) AS mask(AbCD123-@$#, Q, q, d, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', 'Q', 'q', 'd', 'o')
-- !query analysis
Project [mask(AbCD123-@$#, Q, q, d, o) AS mask(AbCD123-@$#, Q, q, d, o)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', 'Qa', 'qa', 'da', 'oa')
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.INPUT_SIZE_NOT_ONE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "exprName" : "upperChar",
    "sqlExpr" : "\"mask(AbCD123-@$#, Qa, qa, da, oa)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 50,
    "fragment" : "mask('AbCD123-@$#', 'Qa', 'qa', 'da', 'oa')"
  } ]
}


-- !query
SELECT mask('AbCD123-@$#', NULL, 'q', 'd', 'o')
-- !query analysis
Project [mask(AbCD123-@$#, null, q, d, o) AS mask(AbCD123-@$#, NULL, q, d, o)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', NULL, NULL, 'd', 'o')
-- !query analysis
Project [mask(AbCD123-@$#, null, null, d, o) AS mask(AbCD123-@$#, NULL, NULL, d, o)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', NULL, NULL, NULL, 'o')
-- !query analysis
Project [mask(AbCD123-@$#, null, null, null, o) AS mask(AbCD123-@$#, NULL, NULL, NULL, o)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', NULL, NULL, NULL, NULL)
-- !query analysis
Project [mask(AbCD123-@$#, null, null, null, null) AS mask(AbCD123-@$#, NULL, NULL, NULL, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL)
-- !query analysis
Project [mask(null, X, x, n, null) AS mask(NULL, X, x, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, 'q', 'd', 'o')
-- !query analysis
Project [mask(null, null, q, d, o) AS mask(NULL, NULL, q, d, o)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, NULL, 'd', 'o')
-- !query analysis
Project [mask(null, null, null, d, o) AS mask(NULL, NULL, NULL, d, o)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, NULL, NULL, 'o')
-- !query analysis
Project [mask(null, null, null, null, o) AS mask(NULL, NULL, NULL, NULL, o)#x]
+- OneRowRelation


-- !query
SELECT mask('AbCD123-@$#', NULL, NULL, NULL, NULL)
-- !query analysis
Project [mask(AbCD123-@$#, null, null, null, null) AS mask(AbCD123-@$#, NULL, NULL, NULL, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask(c1) from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, X, x, n, null) AS mask(c1, X, x, n, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, x, n, null) AS mask(c1, Q, x, n, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q')from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, n, null) AS mask(c1, Q, q, n, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q', 'd') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, d, null) AS mask(c1, Q, q, d, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q', 'd', 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, d, o) AS mask(c1, Q, q, d, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, 'q', 'd', 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, q, d, o) AS mask(c1, NULL, q, d, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, NULL, 'd', 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, null, d, o) AS mask(c1, NULL, NULL, d, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, NULL, NULL, 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, null, null, o) AS mask(c1, NULL, NULL, NULL, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, NULL, NULL, NULL) from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, null, null, null) AS mask(c1, NULL, NULL, NULL, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, 'q', 'd', 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, q, d, o) AS mask(c1, NULL, q, d, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', NULL, 'd', 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, null, d, o) AS mask(c1, Q, NULL, d, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q', NULL, 'o') from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, null, o) AS mask(c1, Q, q, NULL, o)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q', 'd', NULL) from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, d, null) AS mask(c1, Q, q, d, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(NULL, 'Q', 'q', 'd', NULL) from values ('AbCD123-@$#') as tab(c1)
-- !query analysis
Project [mask(null, Q, q, d, null) AS mask(NULL, Q, q, d, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask('abcd-EFGH-8765-4321')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, X, x, n, null) AS mask(abcd-EFGH-8765-4321, X, x, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', 'Q')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, Q, x, n, null) AS mask(abcd-EFGH-8765-4321, Q, x, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', 'Q', 'q')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, Q, q, n, null) AS mask(abcd-EFGH-8765-4321, Q, q, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', 'Q', 'q', 'd')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, Q, q, d, null) AS mask(abcd-EFGH-8765-4321, Q, q, d, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', 'Q', 'q', 'd', '*')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, Q, q, d, *) AS mask(abcd-EFGH-8765-4321, Q, q, d, *)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', NULL, 'q', 'd', '*')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, null, q, d, *) AS mask(abcd-EFGH-8765-4321, NULL, q, d, *)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', NULL, NULL, 'd', '*')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, null, null, d, *) AS mask(abcd-EFGH-8765-4321, NULL, NULL, d, *)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', NULL, NULL, NULL, '*')
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, null, null, null, *) AS mask(abcd-EFGH-8765-4321, NULL, NULL, NULL, *)#x]
+- OneRowRelation


-- !query
SELECT mask('abcd-EFGH-8765-4321', NULL, NULL, NULL, NULL)
-- !query analysis
Project [mask(abcd-EFGH-8765-4321, null, null, null, null) AS mask(abcd-EFGH-8765-4321, NULL, NULL, NULL, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL)
-- !query analysis
Project [mask(null, X, x, n, null) AS mask(NULL, X, x, n, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, 'q', 'd', '*')
-- !query analysis
Project [mask(null, null, q, d, *) AS mask(NULL, NULL, q, d, *)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, NULL, 'd', '*')
-- !query analysis
Project [mask(null, null, null, d, *) AS mask(NULL, NULL, NULL, d, *)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, NULL, NULL, '*')
-- !query analysis
Project [mask(null, null, null, null, *) AS mask(NULL, NULL, NULL, NULL, *)#x]
+- OneRowRelation


-- !query
SELECT mask(NULL, NULL, NULL, NULL, NULL)
-- !query analysis
Project [mask(null, null, null, null, null) AS mask(NULL, NULL, NULL, NULL, NULL)#x]
+- OneRowRelation


-- !query
SELECT mask(c1) from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, X, x, n, null) AS mask(c1, X, x, n, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q') from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, x, n, null) AS mask(c1, Q, x, n, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q')from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, n, null) AS mask(c1, Q, q, n, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q', 'd') from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, d, null) AS mask(c1, Q, q, d, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, 'Q', 'q', 'd', '*') from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, Q, q, d, *) AS mask(c1, Q, q, d, *)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, 'q', 'd', '*') from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, q, d, *) AS mask(c1, NULL, q, d, *)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, NULL, 'd', '*') from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, null, d, *) AS mask(c1, NULL, NULL, d, *)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, NULL, NULL, '*') from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, null, null, *) AS mask(c1, NULL, NULL, NULL, *)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, NULL, NULL, NULL, NULL) from values ('abcd-EFGH-8765-4321') as tab(c1)
-- !query analysis
Project [mask(c1#x, null, null, null, null) AS mask(c1, NULL, NULL, NULL, NULL)#x]
+- SubqueryAlias tab
   +- LocalRelation [c1#x]


-- !query
SELECT mask(c1, replaceArg) from values('abcd-EFGH-8765-4321', 'a') as t(c1, replaceArg)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "\"replaceArg\"",
    "inputName" : "`upperChar`",
    "inputType" : "\"STRING\"",
    "sqlExpr" : "\"mask(c1, replaceArg, x, n, NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 27,
    "fragment" : "mask(c1, replaceArg)"
  } ]
}


-- !query
SELECT mask(c1, replaceArg) from values('abcd-EFGH-8765-4321', 'ABC') as t(c1, replaceArg)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.NON_FOLDABLE_INPUT",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputExpr" : "\"replaceArg\"",
    "inputName" : "`upperChar`",
    "inputType" : "\"STRING\"",
    "sqlExpr" : "\"mask(c1, replaceArg, x, n, NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 27,
    "fragment" : "mask(c1, replaceArg)"
  } ]
}


-- !query
SELECT mask(c1, replaceArg) from values('abcd-EFGH-8765-4321', 123) as t(c1, replaceArg)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.UNEXPECTED_INPUT_TYPE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "inputSql" : "\"replaceArg\"",
    "inputType" : "\"INT\"",
    "paramIndex" : "second",
    "requiredType" : "\"STRING\"",
    "sqlExpr" : "\"mask(c1, replaceArg, x, n, NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 27,
    "fragment" : "mask(c1, replaceArg)"
  } ]
}


-- !query
SELECT mask('abcd-EFGH-8765-4321', 'A', 'w', '')
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.INPUT_SIZE_NOT_ONE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "exprName" : "digitChar",
    "sqlExpr" : "\"mask(abcd-EFGH-8765-4321, A, w, , NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 48,
    "fragment" : "mask('abcd-EFGH-8765-4321', 'A', 'w', '')"
  } ]
}


-- !query
SELECT mask('abcd-EFGH-8765-4321', 'A', 'abc')
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.INPUT_SIZE_NOT_ONE",
  "sqlState" : "42K09",
  "messageParameters" : {
    "exprName" : "lowerChar",
    "sqlExpr" : "\"mask(abcd-EFGH-8765-4321, A, abc, n, NULL)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 46,
    "fragment" : "mask('abcd-EFGH-8765-4321', 'A', 'abc')"
  } ]
}
