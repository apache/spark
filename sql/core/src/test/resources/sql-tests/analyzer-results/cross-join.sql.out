-- Automatically generated by SQLQueryTestSuite
-- !query
create temporary view nt1 as select * from values
  ("one", 1),
  ("two", 2),
  ("three", 3)
  as nt1(k, v1)
-- !query analysis
CreateViewCommand `nt1`, select * from values
  ("one", 1),
  ("two", 2),
  ("three", 3)
  as nt1(k, v1), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [k#x, v1#x]
      +- SubqueryAlias nt1
         +- LocalRelation [k#x, v1#x]


-- !query
create temporary view nt2 as select * from values
  ("one", 1),
  ("two", 22),
  ("one", 5)
  as nt2(k, v2)
-- !query analysis
CreateViewCommand `nt2`, select * from values
  ("one", 1),
  ("two", 22),
  ("one", 5)
  as nt2(k, v2), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [k#x, v2#x]
      +- SubqueryAlias nt2
         +- LocalRelation [k#x, v2#x]


-- !query
SELECT * FROM nt1 cross join nt2
-- !query analysis
Project [k#x, v1#x, k#x, v2#x]
+- Join Cross
   :- SubqueryAlias nt1
   :  +- View (`nt1`, [k#x, v1#x])
   :     +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :        +- Project [k#x, v1#x]
   :           +- SubqueryAlias nt1
   :              +- LocalRelation [k#x, v1#x]
   +- SubqueryAlias nt2
      +- View (`nt2`, [k#x, v2#x])
         +- Project [cast(k#x as string) AS k#x, cast(v2#x as int) AS v2#x]
            +- Project [k#x, v2#x]
               +- SubqueryAlias nt2
                  +- LocalRelation [k#x, v2#x]


-- !query
SELECT * FROM nt1 cross join nt2 where nt1.k = nt2.k
-- !query analysis
Project [k#x, v1#x, k#x, v2#x]
+- Filter (k#x = k#x)
   +- Join Cross
      :- SubqueryAlias nt1
      :  +- View (`nt1`, [k#x, v1#x])
      :     +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
      :        +- Project [k#x, v1#x]
      :           +- SubqueryAlias nt1
      :              +- LocalRelation [k#x, v1#x]
      +- SubqueryAlias nt2
         +- View (`nt2`, [k#x, v2#x])
            +- Project [cast(k#x as string) AS k#x, cast(v2#x as int) AS v2#x]
               +- Project [k#x, v2#x]
                  +- SubqueryAlias nt2
                     +- LocalRelation [k#x, v2#x]


-- !query
SELECT * FROM nt1 cross join nt2 on (nt1.k = nt2.k)
-- !query analysis
Project [k#x, v1#x, k#x, v2#x]
+- Join Cross, (k#x = k#x)
   :- SubqueryAlias nt1
   :  +- View (`nt1`, [k#x, v1#x])
   :     +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :        +- Project [k#x, v1#x]
   :           +- SubqueryAlias nt1
   :              +- LocalRelation [k#x, v1#x]
   +- SubqueryAlias nt2
      +- View (`nt2`, [k#x, v2#x])
         +- Project [cast(k#x as string) AS k#x, cast(v2#x as int) AS v2#x]
            +- Project [k#x, v2#x]
               +- SubqueryAlias nt2
                  +- LocalRelation [k#x, v2#x]


-- !query
SELECT * FROM nt1 cross join nt2 where nt1.v1 = 1 and nt2.v2 = 22
-- !query analysis
Project [k#x, v1#x, k#x, v2#x]
+- Filter ((v1#x = 1) AND (v2#x = 22))
   +- Join Cross
      :- SubqueryAlias nt1
      :  +- View (`nt1`, [k#x, v1#x])
      :     +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
      :        +- Project [k#x, v1#x]
      :           +- SubqueryAlias nt1
      :              +- LocalRelation [k#x, v1#x]
      +- SubqueryAlias nt2
         +- View (`nt2`, [k#x, v2#x])
            +- Project [cast(k#x as string) AS k#x, cast(v2#x as int) AS v2#x]
               +- Project [k#x, v2#x]
                  +- SubqueryAlias nt2
                     +- LocalRelation [k#x, v2#x]


-- !query
SELECT a.key, b.key FROM
(SELECT k key FROM nt1 WHERE v1 < 2) a
CROSS JOIN
(SELECT k key FROM nt2 WHERE v2 = 22) b
-- !query analysis
Project [key#x, key#x]
+- Join Cross
   :- SubqueryAlias a
   :  +- Project [k#x AS key#x]
   :     +- Filter (v1#x < 2)
   :        +- SubqueryAlias nt1
   :           +- View (`nt1`, [k#x, v1#x])
   :              +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :                 +- Project [k#x, v1#x]
   :                    +- SubqueryAlias nt1
   :                       +- LocalRelation [k#x, v1#x]
   +- SubqueryAlias b
      +- Project [k#x AS key#x]
         +- Filter (v2#x = 22)
            +- SubqueryAlias nt2
               +- View (`nt2`, [k#x, v2#x])
                  +- Project [cast(k#x as string) AS k#x, cast(v2#x as int) AS v2#x]
                     +- Project [k#x, v2#x]
                        +- SubqueryAlias nt2
                           +- LocalRelation [k#x, v2#x]


-- !query
create temporary view A(a, va) as select * from nt1
-- !query analysis
CreateViewCommand `A`, [(a,None), (va,None)], select * from nt1, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [k#x, v1#x]
      +- SubqueryAlias nt1
         +- View (`nt1`, [k#x, v1#x])
            +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
               +- Project [k#x, v1#x]
                  +- SubqueryAlias nt1
                     +- LocalRelation [k#x, v1#x]


-- !query
create temporary view B(b, vb) as select * from nt1
-- !query analysis
CreateViewCommand `B`, [(b,None), (vb,None)], select * from nt1, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [k#x, v1#x]
      +- SubqueryAlias nt1
         +- View (`nt1`, [k#x, v1#x])
            +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
               +- Project [k#x, v1#x]
                  +- SubqueryAlias nt1
                     +- LocalRelation [k#x, v1#x]


-- !query
create temporary view C(c, vc) as select * from nt1
-- !query analysis
CreateViewCommand `C`, [(c,None), (vc,None)], select * from nt1, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [k#x, v1#x]
      +- SubqueryAlias nt1
         +- View (`nt1`, [k#x, v1#x])
            +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
               +- Project [k#x, v1#x]
                  +- SubqueryAlias nt1
                     +- LocalRelation [k#x, v1#x]


-- !query
create temporary view D(d, vd) as select * from nt1
-- !query analysis
CreateViewCommand `D`, [(d,None), (vd,None)], select * from nt1, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [k#x, v1#x]
      +- SubqueryAlias nt1
         +- View (`nt1`, [k#x, v1#x])
            +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
               +- Project [k#x, v1#x]
                  +- SubqueryAlias nt1
                     +- LocalRelation [k#x, v1#x]


-- !query
select * from ((A join B on (a = b)) cross join C) join D on (a = d)
-- !query analysis
Project [a#x, va#x, b#x, vb#x, c#x, vc#x, d#x, vd#x]
+- Join Inner, (a#x = d#x)
   :- Join Cross
   :  :- Join Inner, (a#x = b#x)
   :  :  :- SubqueryAlias a
   :  :  :  +- View (`A`, [a#x, va#x])
   :  :  :     +- Project [cast(k#x as string) AS a#x, cast(v1#x as int) AS va#x]
   :  :  :        +- Project [k#x, v1#x]
   :  :  :           +- SubqueryAlias nt1
   :  :  :              +- View (`nt1`, [k#x, v1#x])
   :  :  :                 +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :  :  :                    +- Project [k#x, v1#x]
   :  :  :                       +- SubqueryAlias nt1
   :  :  :                          +- LocalRelation [k#x, v1#x]
   :  :  +- SubqueryAlias b
   :  :     +- View (`B`, [b#x, vb#x])
   :  :        +- Project [cast(k#x as string) AS b#x, cast(v1#x as int) AS vb#x]
   :  :           +- Project [k#x, v1#x]
   :  :              +- SubqueryAlias nt1
   :  :                 +- View (`nt1`, [k#x, v1#x])
   :  :                    +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :  :                       +- Project [k#x, v1#x]
   :  :                          +- SubqueryAlias nt1
   :  :                             +- LocalRelation [k#x, v1#x]
   :  +- SubqueryAlias c
   :     +- View (`C`, [c#x, vc#x])
   :        +- Project [cast(k#x as string) AS c#x, cast(v1#x as int) AS vc#x]
   :           +- Project [k#x, v1#x]
   :              +- SubqueryAlias nt1
   :                 +- View (`nt1`, [k#x, v1#x])
   :                    +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :                       +- Project [k#x, v1#x]
   :                          +- SubqueryAlias nt1
   :                             +- LocalRelation [k#x, v1#x]
   +- SubqueryAlias d
      +- View (`D`, [d#x, vd#x])
         +- Project [cast(k#x as string) AS d#x, cast(v1#x as int) AS vd#x]
            +- Project [k#x, v1#x]
               +- SubqueryAlias nt1
                  +- View (`nt1`, [k#x, v1#x])
                     +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
                        +- Project [k#x, v1#x]
                           +- SubqueryAlias nt1
                              +- LocalRelation [k#x, v1#x]


-- !query
SELECT * FROM nt1 CROSS JOIN nt2 ON (nt1.k > nt2.k)
-- !query analysis
Project [k#x, v1#x, k#x, v2#x]
+- Join Cross, (k#x > k#x)
   :- SubqueryAlias nt1
   :  +- View (`nt1`, [k#x, v1#x])
   :     +- Project [cast(k#x as string) AS k#x, cast(v1#x as int) AS v1#x]
   :        +- Project [k#x, v1#x]
   :           +- SubqueryAlias nt1
   :              +- LocalRelation [k#x, v1#x]
   +- SubqueryAlias nt2
      +- View (`nt2`, [k#x, v2#x])
         +- Project [cast(k#x as string) AS k#x, cast(v2#x as int) AS v2#x]
            +- Project [k#x, v2#x]
               +- SubqueryAlias nt2
                  +- LocalRelation [k#x, v2#x]
