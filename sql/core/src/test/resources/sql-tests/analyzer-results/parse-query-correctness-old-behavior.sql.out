-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num
  UNION
  SELECT 2
  UNION
  SELECT 3
  UNION
  SELECT 4
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num
  UNION
  SELECT 2
  UNION
  SELECT 3
  UNION
  SELECT 4, false, true, LocalTempView, UNSUPPORTED, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS num#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x]
+- SubqueryAlias v1
   +- View (`v1`, [num#x])
      +- Project [cast(num#x as int) AS num#x]
         +- Distinct
            +- Union false, false
               :- Project [1 AS num#x]
               :  +- OneRowRelation
               +- Project [2 AS UNION#x]
                  +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1
  UNION
  SELECT 2
  UNION
  SELECT 3
  UNION
  SELECT 4
-- !query analysis
CreateViewCommand `v1`, SELECT 1
  UNION
  SELECT 2
  UNION
  SELECT 3
  UNION
  SELECT 4, false, true, LocalTempView, UNSUPPORTED, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS 1#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `v1`, SELECT 1, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, LocalTempView, UNSUPPORTED, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS 1#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, LocalTempView, UNSUPPORTED, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS num#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `v1`, SELECT 1, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, LocalTempView, UNSUPPORTED, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS 1#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [1#x, a#x]
+- SubqueryAlias v1
   +- View (`v1`, [1#x, a#x])
      +- Project [cast(1#x as int) AS 1#x, cast(a#x as string) AS a#x]
         +- Distinct
            +- Union false, false
               :- Project [1 AS 1#x, a AS a#x]
               :  +- OneRowRelation
               +- Project [2 AS 2#x, b AS UNION#x]
                  +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, LocalTempView, UNSUPPORTED, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS num#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x, a#x]
+- SubqueryAlias v1
   +- View (`v1`, [num#x, a#x])
      +- Project [cast(num#x as int) AS num#x, cast(a#x as string) AS a#x]
         +- Distinct
            +- Union false, false
               :- Project [1 AS num#x, a AS a#x]
               :  +- OneRowRelation
               +- Project [2 AS 2#x, b AS UNION#x]
                  +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num
  EXCEPT
  SELECT 2
  EXCEPT
  SELECT 1
  EXCEPT
  SELECT 2
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num
  EXCEPT
  SELECT 2
  EXCEPT
  SELECT 1
  EXCEPT
  SELECT 2, false, true, LocalTempView, UNSUPPORTED, true
   +- Except false
      :- Except false
      :  :- Except false
      :  :  :- Project [1 AS num#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [2 AS 2#x]
      :  :     +- OneRowRelation
      :  +- Project [1 AS 1#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x]
+- SubqueryAlias v1
   +- View (`v1`, [num#x])
      +- Project [cast(num#x as int) AS num#x]
         +- Except false
            :- Project [1 AS num#x]
            :  +- OneRowRelation
            +- Project [2 AS EXCEPT#x]
               +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1
  EXCEPT
  SELECT 2
  EXCEPT
  SELECT 1
  EXCEPT
  SELECT 2
-- !query analysis
CreateViewCommand `v1`, SELECT 1
  EXCEPT
  SELECT 2
  EXCEPT
  SELECT 1
  EXCEPT
  SELECT 2, false, true, LocalTempView, UNSUPPORTED, true
   +- Except false
      :- Except false
      :  :- Except false
      :  :  :- Project [1 AS 1#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [2 AS 2#x]
      :  :     +- OneRowRelation
      :  +- Project [1 AS 1#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Except false
      :- Except false
      :  :- Except false
      :  :  :- Project [1 AS 1#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [2 AS 2#x, b AS b#x]
      :  :     +- OneRowRelation
      :  +- Project [1 AS 1#x, a AS a#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a'
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num, 'a'
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Except false
      :- Except false
      :  :- Except false
      :  :  :- Project [1 AS num#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [2 AS 2#x, b AS b#x]
      :  :     +- OneRowRelation
      :  +- Project [1 AS 1#x, a AS a#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a' AS a
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1, 'a' AS a
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Except false
      :- Except false
      :  :- Except false
      :  :  :- Project [1 AS 1#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [2 AS 2#x, b AS b#x]
      :  :     +- OneRowRelation
      :  +- Project [1 AS 1#x, a AS a#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [1#x, a#x]
+- SubqueryAlias v1
   +- View (`v1`, [1#x, a#x])
      +- Project [cast(1#x as int) AS 1#x, cast(a#x as string) AS a#x]
         +- Except false
            :- Project [1 AS 1#x, a AS a#x]
            :  +- OneRowRelation
            +- Project [2 AS 2#x, b AS EXCEPT#x]
               +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a' AS a
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num, 'a' AS a
  EXCEPT
  SELECT 2, 'b'
  EXCEPT
  SELECT 1, 'a'
  EXCEPT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Except false
      :- Except false
      :  :- Except false
      :  :  :- Project [1 AS num#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [2 AS 2#x, b AS b#x]
      :  :     +- OneRowRelation
      :  +- Project [1 AS 1#x, a AS a#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x, a#x]
+- SubqueryAlias v1
   +- View (`v1`, [num#x, a#x])
      +- Project [cast(num#x as int) AS num#x, cast(a#x as string) AS a#x]
         +- Except false
            :- Project [1 AS num#x, a AS a#x]
            :  +- OneRowRelation
            +- Project [2 AS 2#x, b AS EXCEPT#x]
               +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num
  INTERSECT
  SELECT 1
  INTERSECT
  SELECT 2
  INTERSECT
  SELECT 2
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num
  INTERSECT
  SELECT 1
  INTERSECT
  SELECT 2
  INTERSECT
  SELECT 2, false, true, LocalTempView, UNSUPPORTED, true
   +- Intersect false
      :- Intersect false
      :  :- Intersect false
      :  :  :- Project [1 AS num#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [1 AS 1#x]
      :  :     +- OneRowRelation
      :  +- Project [2 AS 2#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x]
+- SubqueryAlias v1
   +- View (`v1`, [num#x])
      +- Project [cast(num#x as int) AS num#x]
         +- Intersect false
            :- Project [1 AS num#x]
            :  +- OneRowRelation
            +- Project [1 AS INTERSECT#x]
               +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1
  INTERSECT
  SELECT 1
  INTERSECT
  SELECT 2
  INTERSECT
  SELECT 2
-- !query analysis
CreateViewCommand `v1`, SELECT 1
  INTERSECT
  SELECT 1
  INTERSECT
  SELECT 2
  INTERSECT
  SELECT 2, false, true, LocalTempView, UNSUPPORTED, true
   +- Intersect false
      :- Intersect false
      :  :- Intersect false
      :  :  :- Project [1 AS 1#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [1 AS 1#x]
      :  :     +- OneRowRelation
      :  +- Project [2 AS 2#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "1",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a'
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1, 'a'
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Intersect false
      :- Intersect false
      :  :- Intersect false
      :  :  :- Project [1 AS 1#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [1 AS 1#x, a AS a#x]
      :  :     +- OneRowRelation
      :  +- Project [2 AS 2#x, b AS b#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a'
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num, 'a'
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Intersect false
      :- Intersect false
      :  :- Intersect false
      :  :  :- Project [1 AS num#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [1 AS 1#x, a AS a#x]
      :  :     +- OneRowRelation
      :  +- Project [2 AS 2#x, b AS b#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INCOMPATIBLE_VIEW_SCHEMA_CHANGE",
  "sqlState" : "51024",
  "messageParameters" : {
    "actualCols" : "[]",
    "colName" : "a",
    "expectedNum" : "1",
    "suggestion" : "CREATE OR REPLACE TEMPORARY VIEW",
    "viewName" : "`v1`"
  }
}


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1, 'a' AS a
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1, 'a' AS a
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Intersect false
      :- Intersect false
      :  :- Intersect false
      :  :  :- Project [1 AS 1#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [1 AS 1#x, a AS a#x]
      :  :     +- OneRowRelation
      :  +- Project [2 AS 2#x, b AS b#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [1#x, a#x]
+- SubqueryAlias v1
   +- View (`v1`, [1#x, a#x])
      +- Project [cast(1#x as int) AS 1#x, cast(a#x as string) AS a#x]
         +- Intersect false
            :- Project [1 AS 1#x, a AS a#x]
            :  +- OneRowRelation
            +- Project [1 AS 1#x, a AS INTERSECT#x]
               +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY VIEW v1 AS
  SELECT 1 AS num, 'a' AS a
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b'
-- !query analysis
CreateViewCommand `v1`, SELECT 1 AS num, 'a' AS a
  INTERSECT
  SELECT 1, 'a'
  INTERSECT
  SELECT 2, 'b'
  INTERSECT
  SELECT 2, 'b', false, true, LocalTempView, UNSUPPORTED, true
   +- Intersect false
      :- Intersect false
      :  :- Intersect false
      :  :  :- Project [1 AS num#x, a AS a#x]
      :  :  :  +- OneRowRelation
      :  :  +- Project [1 AS 1#x, a AS a#x]
      :  :     +- OneRowRelation
      :  +- Project [2 AS 2#x, b AS b#x]
      :     +- OneRowRelation
      +- Project [2 AS 2#x, b AS b#x]
         +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x, a#x]
+- SubqueryAlias v1
   +- View (`v1`, [num#x, a#x])
      +- Project [cast(num#x as int) AS num#x, cast(a#x as string) AS a#x]
         +- Intersect false
            :- Project [1 AS num#x, a AS a#x]
            :  +- OneRowRelation
            +- Project [1 AS 1#x, a AS INTERSECT#x]
               +- OneRowRelation


-- !query
DROP VIEW v1
-- !query analysis
DropTempViewCommand v1


-- !query
CREATE OR REPLACE VIEW v1 WITH SCHEMA EVOLUTION AS
  SELECT 1, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `spark_catalog`.`default`.`v1`, SELECT 1, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, PersistedView, EVOLUTION, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS 1#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [1#x, UNION#x]
+- SubqueryAlias spark_catalog.default.v1
   +- View (`spark_catalog`.`default`.`v1`, [1#x, UNION#x])
      +- Project [1 AS 1#x, a AS UNION#x]
         +- OneRowRelation


-- !query
CREATE OR REPLACE VIEW v1 WITH SCHEMA EVOLUTION AS
  SELECT 1 AS num, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `spark_catalog`.`default`.`v1`, SELECT 1 AS num, 'a'
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, PersistedView, EVOLUTION, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS num#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x, UNION#x]
+- SubqueryAlias spark_catalog.default.v1
   +- View (`spark_catalog`.`default`.`v1`, [num#x, UNION#x])
      +- Project [1 AS num#x, a AS UNION#x]
         +- OneRowRelation


-- !query
CREATE OR REPLACE VIEW v1 WITH SCHEMA EVOLUTION AS
  SELECT 1 AS num, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd'
-- !query analysis
CreateViewCommand `spark_catalog`.`default`.`v1`, SELECT 1 AS num, 'a' AS a
  UNION
  SELECT 2, 'b'
  UNION
  SELECT 3, 'c'
  UNION
  SELECT 4, 'd', false, true, PersistedView, EVOLUTION, true
   +- Distinct
      +- Union false, false
         :- Distinct
         :  +- Union false, false
         :     :- Distinct
         :     :  +- Union false, false
         :     :     :- Project [1 AS num#x, a AS a#x]
         :     :     :  +- OneRowRelation
         :     :     +- Project [2 AS 2#x, b AS b#x]
         :     :        +- OneRowRelation
         :     +- Project [3 AS 3#x, c AS c#x]
         :        +- OneRowRelation
         +- Project [4 AS 4#x, d AS d#x]
            +- OneRowRelation


-- !query
SELECT * FROM v1
-- !query analysis
Project [num#x, a#x]
+- SubqueryAlias spark_catalog.default.v1
   +- View (`spark_catalog`.`default`.`v1`, [num#x, a#x])
      +- Distinct
         +- Union false, false
            :- Project [1 AS num#x, a AS a#x]
            :  +- OneRowRelation
            +- Project [2 AS 2#x, b AS UNION#x]
               +- OneRowRelation


-- !query
DROP VIEW v1
-- !query analysis
DropTableCommand `spark_catalog`.`default`.`v1`, false, true, false


-- !query
DECLARE v1 INT
-- !query analysis
CreateVariable defaultvalueexpression(null, null), false
+- ResolvedIdentifier org.apache.spark.sql.catalyst.analysis.FakeSystemCatalog$@xxxxxxxx, session.v1


-- !query
EXECUTE IMMEDIATE 'SELECT 1 UNION SELECT 2 UNION SELECT 3' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=CAST(NULL AS INT))]
+- Project [1 AS UNION#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 UNION SELECT 1 UNION SELECT 1' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS UNION#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 EXCEPT SELECT 2 EXCEPT SELECT 3' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS EXCEPT#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 EXCEPT SELECT 1 EXCEPT SELECT 1' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS EXCEPT#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 INTERSECT SELECT 2 INTERSECT SELECT 3' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS INTERSECT#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 INTERSECT SELECT 1 INTERSECT SELECT 1' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS INTERSECT#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 JOIN SELECT 2' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS JOIN#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 VALUES (1)' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS VALUES#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 alias garbage garbage garbage' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS alias#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
EXECUTE IMMEDIATE 'SELECT 1 WITH abc' INTO v1
-- !query analysis
SetVariable [variablereference(system.session.v1=1)]
+- Project [1 AS WITH#x]
   +- OneRowRelation


-- !query
SELECT v1
-- !query analysis
Project [variablereference(system.session.v1=1) AS v1#x]
+- OneRowRelation


-- !query
DROP TEMPORARY VARIABLE v1
-- !query analysis
DropVariable false
+- ResolvedIdentifier org.apache.spark.sql.catalyst.analysis.FakeSystemCatalog$@xxxxxxxx, session.v1
