-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMP VIEW variant_test_data AS
SELECT
  parse_json('{ "price": 30 }') as int_price_variant,
  parse_json('{ "price": 12345.678 }') as double_price_variant,
  parse_json('{ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }') as multi_field_variant,
  parse_json('{ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }') as array_value_variant,
  parse_json('[{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }]') as array_variant,
  parse_json('{ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }') as nested_variant,
  parse_json('{ "field-name": "value1", "field.name": "value2", "field_name": "value3" }') as special_chars_variant
-- !query analysis
CreateViewCommand `variant_test_data`, SELECT
  parse_json('{ "price": 30 }') as int_price_variant,
  parse_json('{ "price": 12345.678 }') as double_price_variant,
  parse_json('{ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }') as multi_field_variant,
  parse_json('{ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }') as array_value_variant,
  parse_json('[{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }]') as array_variant,
  parse_json('{ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }') as nested_variant,
  parse_json('{ "field-name": "value1", "field.name": "value2", "field_name": "value3" }') as special_chars_variant, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
      +- OneRowRelation


-- !query
select int_price_variant:price from variant_test_data
-- !query analysis
Project [variant_get(int_price_variant#x, $.price, VariantType, true, Some(America/Los_Angeles)) AS price#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select int_price_variant:price::decimal(5, 2) from variant_test_data
-- !query analysis
Project [cast(variant_get(int_price_variant#x, $.price, VariantType, true, Some(America/Los_Angeles)) as decimal(5,2)) AS price#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select int_price_variant:price::string from variant_test_data
-- !query analysis
Project [cast(variant_get(int_price_variant#x, $.price, VariantType, true, Some(America/Los_Angeles)) as string) AS price#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select double_price_variant:price::decimal(3, 2) from variant_test_data
-- !query analysis
Project [cast(variant_get(double_price_variant#x, $.price, VariantType, true, Some(America/Los_Angeles)) as decimal(3,2)) AS price#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select multi_field_variant:name, multi_field_variant:age, multi_field_variant:city from variant_test_data
-- !query analysis
Project [variant_get(multi_field_variant#x, $.name, VariantType, true, Some(America/Los_Angeles)) AS name#x, variant_get(multi_field_variant#x, $.age, VariantType, true, Some(America/Los_Angeles)) AS age#x, variant_get(multi_field_variant#x, $.city, VariantType, true, Some(America/Los_Angeles)) AS city#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select multi_field_variant:name::string, multi_field_variant:age::int, multi_field_variant:active::boolean from variant_test_data
-- !query analysis
Project [cast(variant_get(multi_field_variant#x, $.name, VariantType, true, Some(America/Los_Angeles)) as string) AS name#x, cast(variant_get(multi_field_variant#x, $.age, VariantType, true, Some(America/Los_Angeles)) as int) AS age#x, cast(variant_get(multi_field_variant#x, $.active, VariantType, true, Some(America/Los_Angeles)) as boolean) AS active#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select multi_field_variant:['name'] from variant_test_data
-- !query analysis
Project [variant_get(multi_field_variant#x, $['name'], VariantType, true, Some(America/Los_Angeles)) AS name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select multi_field_variant:['age'] from variant_test_data
-- !query analysis
Project [variant_get(multi_field_variant#x, $['age'], VariantType, true, Some(America/Los_Angeles)) AS age#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_value_variant:item[0].model from variant_test_data
-- !query analysis
Project [variant_get(array_value_variant#x, $.item[0].model, VariantType, true, Some(America/Los_Angeles)) AS model#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_value_variant:item[0].price from variant_test_data
-- !query analysis
Project [variant_get(array_value_variant#x, $.item[0].price, VariantType, true, Some(America/Los_Angeles)) AS price#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_value_variant:item[1].model from variant_test_data
-- !query analysis
Project [variant_get(array_value_variant#x, $.item[1].model, VariantType, true, Some(America/Los_Angeles)) AS model#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_value_variant:item[1].price from variant_test_data
-- !query analysis
Project [variant_get(array_value_variant#x, $.item[1].price, VariantType, true, Some(America/Los_Angeles)) AS price#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_variant:[0].id from variant_test_data
-- !query analysis
Project [variant_get(array_variant#x, $[0].id, VariantType, true, Some(America/Los_Angeles)) AS id#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_variant:[0].name from variant_test_data
-- !query analysis
Project [variant_get(array_variant#x, $[0].name, VariantType, true, Some(America/Los_Angeles)) AS name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_variant:[1].id from variant_test_data
-- !query analysis
Project [variant_get(array_variant#x, $[1].id, VariantType, true, Some(America/Los_Angeles)) AS id#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select array_variant:[1].name from variant_test_data
-- !query analysis
Project [variant_get(array_variant#x, $[1].name, VariantType, true, Some(America/Los_Angeles)) AS name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select nested_variant:metadata.version from variant_test_data
-- !query analysis
Project [variant_get(nested_variant#x, $.metadata.version, VariantType, true, Some(America/Los_Angeles)) AS version#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select nested_variant:metadata.tags[0] from variant_test_data
-- !query analysis
Project [variant_get(nested_variant#x, $.metadata.tags[0], VariantType, true, Some(America/Los_Angeles)) AS tags#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select nested_variant:metadata.nested.level from variant_test_data
-- !query analysis
Project [variant_get(nested_variant#x, $.metadata.nested.level, VariantType, true, Some(America/Los_Angeles)) AS level#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select nested_variant:metadata.nested.value from variant_test_data
-- !query analysis
Project [variant_get(nested_variant#x, $.metadata.nested.value, VariantType, true, Some(America/Los_Angeles)) AS value#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select nested_variant:metadata['version'] from variant_test_data
-- !query analysis
Project [variant_get(nested_variant#x, $.metadata['version'], VariantType, true, Some(America/Los_Angeles)) AS version#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select nested_variant:metadata['tags'] from variant_test_data
-- !query analysis
Project [variant_get(nested_variant#x, $.metadata['tags'], VariantType, true, Some(America/Los_Angeles)) AS tags#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select special_chars_variant:`field-name`::string from variant_test_data
-- !query analysis
Project [cast(variant_get(special_chars_variant#x, $.field-name, VariantType, true, Some(America/Los_Angeles)) as string) AS field-name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select special_chars_variant:['field-name']::string from variant_test_data
-- !query analysis
Project [cast(variant_get(special_chars_variant#x, $['field-name'], VariantType, true, Some(America/Los_Angeles)) as string) AS field-name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select special_chars_variant:field_name::string from variant_test_data
-- !query analysis
Project [cast(variant_get(special_chars_variant#x, $.field_name, VariantType, true, Some(America/Los_Angeles)) as string) AS field_name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select special_chars_variant:['field_name']::string from variant_test_data
-- !query analysis
Project [cast(variant_get(special_chars_variant#x, $['field_name'], VariantType, true, Some(America/Los_Angeles)) as string) AS field_name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select special_chars_variant:`field.name`::string from variant_test_data
-- !query analysis
Project [cast(variant_get(special_chars_variant#x, $.field.name, VariantType, true, Some(America/Los_Angeles)) as string) AS name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select special_chars_variant:['field.name']::string from variant_test_data
-- !query analysis
Project [cast(variant_get(special_chars_variant#x, $['field.name'], VariantType, true, Some(America/Los_Angeles)) as string) AS field.name#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select multi_field_variant:scores[0]::int + multi_field_variant:scores[1]::int from variant_test_data
-- !query analysis
Project [(cast(variant_get(multi_field_variant#x, $.scores[0], VariantType, true, Some(America/Los_Angeles)) as int) + cast(variant_get(multi_field_variant#x, $.scores[1], VariantType, true, Some(America/Los_Angeles)) as int)) AS (CAST(variant_get(multi_field_variant, $.scores[0]) AS scores AS INT) + CAST(variant_get(multi_field_variant, $.scores[1]) AS scores AS INT))#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select count(*) from (select explode(cast(multi_field_variant:scores as array<int>)) as score from variant_test_data)
-- !query analysis
Aggregate [count(1) AS count(1)#xL]
+- SubqueryAlias __auto_generated_subquery_name
   +- Project [score#x]
      +- Generate explode(cast(variant_get(multi_field_variant#x, $.scores, VariantType, true, Some(America/Los_Angeles)) as array<int>)), false, [score#x]
         +- SubqueryAlias variant_test_data
            +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
               +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
                  +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
                     +- OneRowRelation


-- !query
select * from variant_test_data
-- !query analysis
Project [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select multi_field_variant:* from variant_test_data
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'*'",
    "hint" : ""
  }
}


-- !query
select typeof(multi_field_variant:name) from variant_test_data
-- !query analysis
Project [typeof(variant_get(multi_field_variant#x, $.name, VariantType, true, Some(America/Los_Angeles))) AS typeof(variant_get(multi_field_variant, $.name) AS name)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select typeof(multi_field_variant:age) from variant_test_data
-- !query analysis
Project [typeof(variant_get(multi_field_variant#x, $.age, VariantType, true, Some(America/Los_Angeles))) AS typeof(variant_get(multi_field_variant, $.age) AS age)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select typeof(multi_field_variant:active) from variant_test_data
-- !query analysis
Project [typeof(variant_get(multi_field_variant#x, $.active, VariantType, true, Some(America/Los_Angeles))) AS typeof(variant_get(multi_field_variant, $.active) AS active)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select typeof(multi_field_variant:scores) from variant_test_data
-- !query analysis
Project [typeof(variant_get(multi_field_variant#x, $.scores, VariantType, true, Some(America/Los_Angeles))) AS typeof(variant_get(multi_field_variant, $.scores) AS scores)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select isnull(multi_field_variant:missing_field) from variant_test_data
-- !query analysis
Project [isnull(variant_get(multi_field_variant#x, $.missing_field, VariantType, true, Some(America/Los_Angeles))) AS (variant_get(multi_field_variant, $.missing_field) AS missing_field IS NULL)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select isnotnull(multi_field_variant:name) from variant_test_data
-- !query analysis
Project [isnotnull(variant_get(multi_field_variant#x, $.name, VariantType, true, Some(America/Los_Angeles))) AS (variant_get(multi_field_variant, $.name) AS name IS NOT NULL)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation


-- !query
select coalesce(multi_field_variant:missing_field, 'default_value') from variant_test_data
-- !query analysis
Project [coalesce(variant_get(multi_field_variant#x, $.missing_field, VariantType, true, Some(America/Los_Angeles)), cast(default_value as variant)) AS coalesce(variant_get(multi_field_variant, $.missing_field) AS missing_field, default_value)#x]
+- SubqueryAlias variant_test_data
   +- View (`variant_test_data`, [int_price_variant#x, double_price_variant#x, multi_field_variant#x, array_value_variant#x, array_variant#x, nested_variant#x, special_chars_variant#x])
      +- Project [cast(int_price_variant#x as variant) AS int_price_variant#x, cast(double_price_variant#x as variant) AS double_price_variant#x, cast(multi_field_variant#x as variant) AS multi_field_variant#x, cast(array_value_variant#x as variant) AS array_value_variant#x, cast(array_variant#x as variant) AS array_variant#x, cast(nested_variant#x as variant) AS nested_variant#x, cast(special_chars_variant#x as variant) AS special_chars_variant#x]
         +- Project [parse_json({ "price": 30 }, true) AS int_price_variant#x, parse_json({ "price": 12345.678 }, true) AS double_price_variant#x, parse_json({ "name": "John", "age": 30, "city": "New York", "active": true, "scores": [85, 92, 78] }, true) AS multi_field_variant#x, parse_json({ "item": [ { "model" : "basic", "price" : 6.12 }, { "model" : "medium", "price" : 9.24 } ] }, true) AS array_value_variant#x, parse_json([{ "id": 1, "name": "Alice" }, { "id": 2, "name": "Bob" }, { "id": 3, "name": "Charlie" }], true) AS array_variant#x, parse_json({ "metadata": { "version": "1.0", "tags": ["important", "urgent"], "nested": { "level": 2, "value": "deep" } } }, true) AS nested_variant#x, parse_json({ "field-name": "value1", "field.name": "value2", "field_name": "value3" }, true) AS special_chars_variant#x]
            +- OneRowRelation
