-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT system.builtin.abs(-5)
-- !query analysis
Project [abs(-5) AS abs(-5)#x]
+- OneRowRelation


-- !query
SELECT builtin.abs(-5)
-- !query analysis
Project [abs(-5) AS abs(-5)#x]
+- OneRowRelation


-- !query
CREATE TEMPORARY FUNCTION abs() RETURNS INT RETURN 999
-- !query analysis
CreateSQLFunctionCommand abs, INT, 999, false, true, false, false


-- !query
SELECT abs()
-- !query analysis
Project [abs() AS abs()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT system.session.abs()
-- !query analysis
Project [abs() AS abs()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT session.abs()
-- !query analysis
Project [abs() AS abs()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT system.builtin.abs(-10)
-- !query analysis
Project [abs(-10) AS abs(-10)#x]
+- OneRowRelation


-- !query
SELECT builtin.abs(-10)
-- !query analysis
Project [abs(-10) AS abs(-10)#x]
+- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION abs
-- !query analysis
DropFunctionCommand abs, false, true


-- !query
SELECT abs(-5)
-- !query analysis
Project [abs(-5) AS abs(-5)#x]
+- OneRowRelation


-- !query
CREATE TEMPORARY FUNCTION session.my_temp() RETURNS STRING RETURN 'temp'
-- !query analysis
CreateSQLFunctionCommand my_temp, STRING, 'temp', false, true, false, false


-- !query
SELECT my_temp()
-- !query analysis
Project [my_temp() AS my_temp()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT session.my_temp()
-- !query analysis
Project [my_temp() AS my_temp()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT system.session.my_temp()
-- !query analysis
Project [my_temp() AS my_temp()#x]
+- Project
   +- OneRowRelation


-- !query
CREATE TEMPORARY FUNCTION system.session.my_temp2() RETURNS STRING RETURN 'temp2'
-- !query analysis
CreateSQLFunctionCommand my_temp2, STRING, 'temp2', false, true, false, false


-- !query
SELECT my_temp2()
-- !query analysis
Project [my_temp2() AS my_temp2()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT session.my_temp2()
-- !query analysis
Project [my_temp2() AS my_temp2()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT system.session.my_temp2()
-- !query analysis
Project [my_temp2() AS my_temp2()#x]
+- Project
   +- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION session.my_temp
-- !query analysis
DropFunctionCommand my_temp, false, true


-- !query
DROP TEMPORARY FUNCTION system.session.my_temp2
-- !query analysis
DropFunctionCommand my_temp2, false, true


-- !query
CREATE TEMPORARY FUNCTION my_func() RETURNS INT RETURN 42
-- !query analysis
CreateSQLFunctionCommand my_func, INT, 42, false, true, false, false


-- !query
SELECT SESSION.my_func()
-- !query analysis
Project [my_func() AS my_func()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT SYSTEM.SESSION.my_func()
-- !query analysis
Project [my_func() AS my_func()#x]
+- Project
   +- OneRowRelation


-- !query
SELECT SyStEm.SeSsIoN.my_func()
-- !query analysis
Project [my_func() AS my_func()#x]
+- Project
   +- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION my_func
-- !query analysis
DropFunctionCommand my_func, false, true


-- !query
CREATE TEMPORARY FUNCTION system.builtin.my_builtin() RETURNS INT RETURN 1
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TEMP_OBJ_QUALIFIER",
  "sqlState" : "42602",
  "messageParameters" : {
    "objectName" : "`my_builtin`",
    "objectType" : "FUNCTION",
    "qualifier" : "`system`.`builtin`"
  }
}


-- !query
CREATE TEMPORARY FUNCTION mydb.my_func() RETURNS INT RETURN 1
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TEMP_OBJ_QUALIFIER",
  "sqlState" : "42602",
  "messageParameters" : {
    "objectName" : "`my_func`",
    "objectType" : "FUNCTION",
    "qualifier" : "`mydb`"
  }
}


-- !query
DROP TEMPORARY FUNCTION system.builtin.abs
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_TEMP_OBJ_QUALIFIER",
  "sqlState" : "42602",
  "messageParameters" : {
    "objectName" : "`abs`",
    "objectType" : "FUNCTION",
    "qualifier" : "`system`.`builtin`"
  }
}


-- !query
CREATE TEMPORARY FUNCTION desc_test() RETURNS INT RETURN 100
-- !query analysis
CreateSQLFunctionCommand desc_test, INT, 100, false, true, false, false


-- !query
DESCRIBE FUNCTION system.session.desc_test
-- !query analysis
DescribeFunctionCommand org.apache.spark.sql.catalyst.expressions.ExpressionInfo@xxxxxxxx, false


-- !query
DESCRIBE FUNCTION session.desc_test
-- !query analysis
DescribeFunctionCommand org.apache.spark.sql.catalyst.expressions.ExpressionInfo@xxxxxxxx, false


-- !query
DESCRIBE FUNCTION desc_test
-- !query analysis
DescribeFunctionCommand org.apache.spark.sql.catalyst.expressions.ExpressionInfo@xxxxxxxx, false


-- !query
DROP TEMPORARY FUNCTION desc_test
-- !query analysis
DropFunctionCommand desc_test, false, true


-- !query
DESCRIBE FUNCTION system.builtin.abs
-- !query analysis
DescribeFunctionCommand org.apache.spark.sql.catalyst.expressions.ExpressionInfo@xxxxxxxx, false


-- !query
DESCRIBE FUNCTION builtin.abs
-- !query analysis
DescribeFunctionCommand org.apache.spark.sql.catalyst.expressions.ExpressionInfo@xxxxxxxx, false


-- !query
CREATE TEMPORARY FUNCTION my_range() RETURNS TABLE(id INT) RETURN SELECT * FROM range(3)
-- !query analysis
CreateSQLFunctionCommand my_range, id INT, SELECT * FROM range(3), true, true, false, false


-- !query
SELECT * FROM my_range()
-- !query analysis
Project [id#x]
+- SQLFunctionNode my_range
   +- SubqueryAlias my_range
      +- Project [cast(id#xL as int) AS id#x]
         +- Project [id#xL]
            +- Range (0, 3, step=1)


-- !query
SELECT * FROM session.my_range()
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_SQL_SYNTAX.INVALID_TABLE_VALUED_FUNC_NAME",
  "sqlState" : "42000",
  "messageParameters" : {
    "funcName" : "`session`.`my_range`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 32,
    "fragment" : "session.my_range()"
  } ]
}


-- !query
SELECT * FROM system.session.my_range()
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_SQL_SYNTAX.INVALID_TABLE_VALUED_FUNC_NAME",
  "sqlState" : "42000",
  "messageParameters" : {
    "funcName" : "`system`.`session`.`my_range`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 39,
    "fragment" : "system.session.my_range()"
  } ]
}


-- !query
DROP TEMPORARY FUNCTION my_range
-- !query analysis
DropFunctionCommand my_range, false, true


-- !query
CREATE TEMPORARY FUNCTION abs() RETURNS TABLE(val INT) RETURN SELECT 42
-- !query analysis
CreateSQLFunctionCommand abs, val INT, SELECT 42, true, true, false, false


-- !query
SELECT abs(-5)
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "NOT_A_SCALAR_FUNCTION",
  "sqlState" : "42887",
  "messageParameters" : {
    "functionName" : "`abs`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 14,
    "fragment" : "abs(-5)"
  } ]
}


-- !query
SELECT * FROM abs()
-- !query analysis
Project [val#x]
+- SQLFunctionNode abs
   +- SubqueryAlias abs
      +- Project [cast(42#x as int) AS val#x]
         +- Project [42 AS 42#x]
            +- OneRowRelation


-- !query
SELECT system.builtin.abs(-5)
-- !query analysis
Project [abs(-5) AS abs(-5)#x]
+- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION abs
-- !query analysis
DropFunctionCommand abs, false, true


-- !query
CREATE TEMPORARY FUNCTION session_test() RETURNS STRING RETURN 'session-scoped'
-- !query analysis
CreateSQLFunctionCommand session_test, STRING, 'session-scoped', false, true, false, false


-- !query
SELECT session_test()
-- !query analysis
Project [session_test() AS session_test()#x]
+- Project
   +- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION session_test
-- !query analysis
DropFunctionCommand session_test, false, true


-- !query
CREATE TEMPORARY FUNCTION replace_test() RETURNS INT RETURN 1
-- !query analysis
CreateSQLFunctionCommand replace_test, INT, 1, false, true, false, false


-- !query
SELECT replace_test()
-- !query analysis
Project [replace_test() AS replace_test()#x]
+- Project
   +- OneRowRelation


-- !query
CREATE OR REPLACE TEMPORARY FUNCTION session.replace_test() RETURNS INT RETURN 2
-- !query analysis
CreateSQLFunctionCommand replace_test, INT, 2, false, true, false, true


-- !query
SELECT replace_test()
-- !query analysis
Project [replace_test() AS replace_test()#x]
+- Project
   +- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION replace_test
-- !query analysis
DropFunctionCommand replace_test, false, true


-- !query
CREATE TEMPORARY FUNCTION IF NOT EXISTS exists_test() RETURNS INT RETURN 1
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_SQL_SYNTAX.CREATE_TEMP_FUNC_WITH_IF_NOT_EXISTS",
  "sqlState" : "42000",
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 1,
    "stopIndex" : 74,
    "fragment" : "CREATE TEMPORARY FUNCTION IF NOT EXISTS exists_test() RETURNS INT RETURN 1"
  } ]
}


-- !query
SELECT exists_test()
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`exists_test`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "exists_test()"
  } ]
}


-- !query
CREATE TEMPORARY FUNCTION IF NOT EXISTS system.session.exists_test() RETURNS INT RETURN 2
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "errorClass" : "INVALID_SQL_SYNTAX.CREATE_TEMP_FUNC_WITH_IF_NOT_EXISTS",
  "sqlState" : "42000",
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 1,
    "stopIndex" : 89,
    "fragment" : "CREATE TEMPORARY FUNCTION IF NOT EXISTS system.session.exists_test() RETURNS INT RETURN 2"
  } ]
}


-- !query
SELECT exists_test()
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`exists_test`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "exists_test()"
  } ]
}


-- !query
DROP TEMPORARY FUNCTION exists_test
-- !query analysis
org.apache.spark.sql.catalyst.analysis.NoSuchTempFunctionException
{
  "errorClass" : "ROUTINE_NOT_FOUND",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`exists_test`"
  }
}
