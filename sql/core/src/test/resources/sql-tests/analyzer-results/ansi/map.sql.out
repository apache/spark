-- Automatically generated by SQLQueryTestSuite
-- !query
select element_at(map(1, 'a', 2, 'b'), 5)
-- !query analysis
Project [element_at(map(1, a, 2, b), 5, None, true) AS element_at(map(1, a, 2, b), 5)#x]
+- OneRowRelation


-- !query
select map(1, 'a', 2, 'b')[5]
-- !query analysis
Project [map(1, a, 2, b)[5] AS map(1, a, 2, b)[5]#x]
+- OneRowRelation


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 5)
-- !query analysis
Project [map_contains_key(map(1, a, 2, b), 5) AS map_contains_key(map(1, a, 2, b), 5)#x]
+- OneRowRelation


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 1)
-- !query analysis
Project [map_contains_key(map(1, a, 2, b), 1) AS map_contains_key(map(1, a, 2, b), 1)#x]
+- OneRowRelation


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 5.0)
-- !query analysis
Project [map_contains_key(cast(map(1, a, 2, b) as map<decimal(11,1),string>), cast(5.0 as decimal(11,1))) AS map_contains_key(map(1, a, 2, b), 5.0)#x]
+- OneRowRelation


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 1.0)
-- !query analysis
Project [map_contains_key(cast(map(1, a, 2, b) as map<decimal(11,1),string>), cast(1.0 as decimal(11,1))) AS map_contains_key(map(1, a, 2, b), 1.0)#x]
+- OneRowRelation


-- !query
select map_contains_key(map(1.0, 'a', 2, 'b'), 5)
-- !query analysis
Project [map_contains_key(map(cast(1.0 as decimal(11,1)), a, cast(2 as decimal(11,1)), b), cast(5 as decimal(11,1))) AS map_contains_key(map(1.0, a, 2, b), 5)#x]
+- OneRowRelation


-- !query
select map_contains_key(map(1.0, 'a', 2, 'b'), 1)
-- !query analysis
Project [map_contains_key(map(cast(1.0 as decimal(11,1)), a, cast(2 as decimal(11,1)), b), cast(1 as decimal(11,1))) AS map_contains_key(map(1.0, a, 2, b), 1)#x]
+- OneRowRelation


-- !query
select map_contains_key(map('1', 'a', '2', 'b'), 1)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "DATATYPE_MISMATCH.MAP_FUNCTION_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "\"MAP\"",
    "functionName" : "`map_contains_key`",
    "leftType" : "\"MAP<STRING, STRING>\"",
    "rightType" : "\"INT\"",
    "sqlExpr" : "\"map_contains_key(map(1, a, 2, b), 1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 51,
    "fragment" : "map_contains_key(map('1', 'a', '2', 'b'), 1)"
  } ]
}


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), '1')
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "DATATYPE_MISMATCH.MAP_FUNCTION_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "\"MAP\"",
    "functionName" : "`map_contains_key`",
    "leftType" : "\"MAP<INT, STRING>\"",
    "rightType" : "\"STRING\"",
    "sqlExpr" : "\"map_contains_key(map(1, a, 2, b), 1)\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 49,
    "fragment" : "map_contains_key(map(1, 'a', 2, 'b'), '1')"
  } ]
}
