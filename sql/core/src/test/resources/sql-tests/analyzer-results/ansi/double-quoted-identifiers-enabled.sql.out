-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT 1 FROM "not_exist"
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 25,
    "fragment" : "\"not_exist\""
  } ]
}


-- !query
USE SCHEMA "not_exist"
-- !query analysis
org.apache.spark.sql.catalyst.analysis.NoSuchNamespaceException
{
  "condition" : "SCHEMA_NOT_FOUND",
  "sqlState" : "42704",
  "messageParameters" : {
    "schemaName" : "`spark_catalog`.`not_exist`"
  }
}


-- !query
ALTER TABLE "not_exist" ADD COLUMN not_exist int
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 13,
    "stopIndex" : 23,
    "fragment" : "\"not_exist\""
  } ]
}


-- !query
ALTER TABLE not_exist ADD COLUMN "not_exist" int
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 13,
    "stopIndex" : 21,
    "fragment" : "not_exist"
  } ]
}


-- !query
SELECT 1 AS "not_exist" FROM not_exist
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 38,
    "fragment" : "not_exist"
  } ]
}


-- !query
SELECT 1 FROM not_exist AS X("hello")
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 23,
    "fragment" : "not_exist"
  } ]
}


-- !query
SELECT "not_exist"()
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "condition" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`not_exist`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "\"not_exist\"()"
  } ]
}


-- !query
SELECT "not_exist".not_exist()
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "condition" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`not_exist`.`not_exist`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "\"not_exist\".not_exist()"
  } ]
}


-- !query
SELECT 1 FROM `hello`
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`hello`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 21,
    "fragment" : "`hello`"
  } ]
}


-- !query
USE SCHEMA `not_exist`
-- !query analysis
org.apache.spark.sql.catalyst.analysis.NoSuchNamespaceException
{
  "condition" : "SCHEMA_NOT_FOUND",
  "sqlState" : "42704",
  "messageParameters" : {
    "schemaName" : "`spark_catalog`.`not_exist`"
  }
}


-- !query
ALTER TABLE `not_exist` ADD COLUMN not_exist int
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 13,
    "stopIndex" : 23,
    "fragment" : "`not_exist`"
  } ]
}


-- !query
ALTER TABLE not_exist ADD COLUMN `not_exist` int
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 13,
    "stopIndex" : 21,
    "fragment" : "not_exist"
  } ]
}


-- !query
SELECT 1 AS `not_exist` FROM `not_exist`
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 30,
    "stopIndex" : 40,
    "fragment" : "`not_exist`"
  } ]
}


-- !query
SELECT 1 FROM not_exist AS X(`hello`)
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`not_exist`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 23,
    "fragment" : "not_exist"
  } ]
}


-- !query
SELECT `not_exist`()
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "condition" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`not_exist`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 20,
    "fragment" : "`not_exist`()"
  } ]
}


-- !query
SELECT `not_exist`.not_exist()
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "condition" : "UNRESOLVED_ROUTINE",
  "sqlState" : "42883",
  "messageParameters" : {
    "routineName" : "`not_exist`.`not_exist`",
    "searchPath" : "[`system`.`builtin`, `system`.`session`, `spark_catalog`.`default`]"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 30,
    "fragment" : "`not_exist`.not_exist()"
  } ]
}


-- !query
SELECT "hello"
-- !query analysis
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "condition" : "UNRESOLVED_COLUMN.WITHOUT_SUGGESTION",
  "sqlState" : "42703",
  "messageParameters" : {
    "objectName" : "`hello`"
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 14,
    "fragment" : "\"hello\""
  } ]
}


-- !query
CREATE TEMPORARY VIEW v(c1 COMMENT "hello") AS SELECT 1
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "condition" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'\"hello\"'",
    "hint" : ""
  }
}


-- !query
DROP VIEW v
-- !query analysis
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
{
  "condition" : "TABLE_OR_VIEW_NOT_FOUND",
  "sqlState" : "42P01",
  "messageParameters" : {
    "relationName" : "`spark_catalog`.`default`.`v`"
  }
}


-- !query
SELECT INTERVAL "1" YEAR
-- !query analysis
org.apache.spark.sql.catalyst.parser.ParseException
{
  "condition" : "PARSE_SYNTAX_ERROR",
  "sqlState" : "42601",
  "messageParameters" : {
    "error" : "'\"1\"'",
    "hint" : ""
  }
}


-- !query
SELECT 'hello'
-- !query analysis
Project [hello AS hello#x]
+- OneRowRelation


-- !query
CREATE TEMPORARY VIEW v(c1 COMMENT 'hello') AS SELECT 1
-- !query analysis
CreateViewCommand `v`, [(c1,Some(hello))], SELECT 1, false, false, LocalTempView, UNSUPPORTED, true
   +- Project [1 AS 1#x]
      +- OneRowRelation


-- !query
DROP VIEW v
-- !query analysis
DropTempViewCommand v


-- !query
SELECT INTERVAL '1' YEAR
-- !query analysis
Project [INTERVAL '1' YEAR AS INTERVAL '1' YEAR#x]
+- OneRowRelation


-- !query
CREATE SCHEMA "myschema"
-- !query analysis
CreateNamespace false
+- ResolvedNamespace V2SessionCatalog(spark_catalog), [myschema]


-- !query
CREATE TEMPORARY VIEW "myview"("c1") AS
  WITH "v"("a") AS (SELECT 1) SELECT "a" FROM "v"
-- !query analysis
CreateViewCommand `myview`, [(c1,None)], WITH "v"("a") AS (SELECT 1) SELECT "a" FROM "v", false, false, LocalTempView, UNSUPPORTED, true
   +- WithCTE
      :- CTERelationDef xxxx, false
      :  +- SubqueryAlias v
      :     +- Project [1#x AS a#x]
      :        +- Project [1 AS 1#x]
      :           +- OneRowRelation
      +- Project [a#x]
         +- SubqueryAlias v
            +- CTERelationRef xxxx, true, [a#x], false


-- !query
SELECT "a1" AS "a2" FROM "myview" AS "atab"("a1")
-- !query analysis
Project [a1#x AS a2#x]
+- SubqueryAlias atab
   +- Project [c1#x AS a1#x]
      +- SubqueryAlias myview
         +- View (`myview`, [c1#x])
            +- Project [cast(a#x as int) AS c1#x]
               +- WithCTE
                  :- CTERelationDef xxxx, false
                  :  +- SubqueryAlias v
                  :     +- Project [1#x AS a#x]
                  :        +- Project [1 AS 1#x]
                  :           +- OneRowRelation
                  +- Project [a#x]
                     +- SubqueryAlias v
                        +- CTERelationRef xxxx, true, [a#x], false


-- !query
DROP TABLE "myview"
-- !query analysis
DropTempViewCommand myview


-- !query
DROP SCHEMA "myschema"
-- !query analysis
DropNamespace false, false
+- ResolvedNamespace V2SessionCatalog(spark_catalog), [myschema]
