-- Automatically generated by SQLQueryTestSuite
-- !query
SET spark.sql.ansi.enabled = true
-- !query analysis
SetCommand (spark.sql.ansi.enabled,Some(true))


-- !query
SELECT 'Test 1: Builtin function qualification' AS test_name
-- !query analysis
Project [Test 1: Builtin function qualification AS test_name#x]
+- OneRowRelation


-- !query
SELECT abs(-5) AS unqualified
-- !query analysis
Project [abs(-5) AS unqualified#x]
+- OneRowRelation


-- !query
SELECT builtin.abs(-5) AS schema_qualified
-- !query analysis
Project [abs(-5) AS schema_qualified#x]
+- OneRowRelation


-- !query
SELECT system.builtin.abs(-5) AS fully_qualified
-- !query analysis
Project [abs(-5) AS fully_qualified#x]
+- OneRowRelation


-- !query
SELECT BUILTIN.ABS(-5) AS uppercase
-- !query analysis
Project [abs(-5) AS uppercase#x]
+- OneRowRelation


-- !query
SELECT System.Builtin.Abs(-5) AS mixed_case
-- !query analysis
Project [abs(-5) AS mixed_case#x]
+- OneRowRelation


-- !query
SELECT 'Test 2: Temporary function without shadowing' AS test_name
-- !query analysis
Project [Test 2: Temporary function without shadowing AS test_name#x]
+- OneRowRelation


-- !query
CREATE TEMPORARY FUNCTION my_temp_upper() RETURNS STRING RETURN 'UPPERCASE'
-- !query analysis
CreateSQLFunctionCommand my_temp_upper, STRING, 'UPPERCASE', false, true, false, false


-- !query
SELECT my_temp_upper() AS unqualified
-- !query analysis
Project [my_temp_upper() AS unqualified#x]
+- Project
   +- OneRowRelation


-- !query
SELECT session.my_temp_upper() AS schema_qualified
-- !query analysis
Project [my_temp_upper() AS schema_qualified#x]
+- Project
   +- OneRowRelation


-- !query
SELECT system.session.my_temp_upper() AS fully_qualified
-- !query analysis
Project [my_temp_upper() AS fully_qualified#x]
+- Project
   +- OneRowRelation


-- !query
SELECT SESSION.my_temp_upper() AS uppercase
-- !query analysis
Project [my_temp_upper() AS uppercase#x]
+- Project
   +- OneRowRelation


-- !query
SELECT System.Session.my_temp_upper() AS mixed_case
-- !query analysis
Project [my_temp_upper() AS mixed_case#x]
+- Project
   +- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION my_temp_upper
-- !query analysis
DropFunctionCommand my_temp_upper, false, true


-- !query
SELECT 'Test 3: Temporary function shadows builtin' AS test_name
-- !query analysis
Project [Test 3: Temporary function shadows builtin AS test_name#x]
+- OneRowRelation


-- !query
SELECT abs(-10) AS builtin_before
-- !query analysis
Project [abs(-10) AS builtin_before#x]
+- OneRowRelation


-- !query
CREATE TEMPORARY FUNCTION my_abs(x INT) RETURNS INT RETURN x * 100
-- !query analysis
CreateSQLFunctionCommand my_abs, x INT, INT, x * 100, false, true, false, false


-- !query
SELECT my_abs(-10) AS unqualified_shadowed
-- !query analysis
Project [my_abs(x#x) AS unqualified_shadowed#x]
+- Project [cast(-10 as int) AS x#x]
   +- OneRowRelation


-- !query
SELECT builtin.abs(-10) AS builtin_still_works
-- !query analysis
Project [abs(-10) AS builtin_still_works#x]
+- OneRowRelation


-- !query
SELECT system.builtin.abs(-10) AS builtin_fully_qualified
-- !query analysis
Project [abs(-10) AS builtin_fully_qualified#x]
+- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION my_abs
-- !query analysis
DropFunctionCommand my_abs, false, true


-- !query
SELECT abs(-10) AS builtin_after
-- !query analysis
Project [abs(-10) AS builtin_after#x]
+- OneRowRelation


-- !query
SELECT 'Test 4: Multiple builtin functions' AS test_name
-- !query analysis
Project [Test 4: Multiple builtin functions AS test_name#x]
+- OneRowRelation


-- !query
SELECT
  builtin.abs(-5) AS abs_result,
  builtin.upper('hello') AS upper_result,
  builtin.length('test') AS length_result,
  builtin.round(3.14159, 2) AS round_result
-- !query analysis
Project [abs(-5) AS abs_result#x, upper(hello) AS upper_result#x, length(test) AS length_result#x, round(3.14159, 2) AS round_result#x]
+- OneRowRelation


-- !query
SELECT 'Test 5: Temp and builtin registries are separate' AS test_name
-- !query analysis
Project [Test 5: Temp and builtin registries are separate AS test_name#x]
+- OneRowRelation


-- !query
CREATE TEMPORARY FUNCTION my_custom(s STRING) RETURNS STRING RETURN CONCAT('CUSTOM: ', s)
-- !query analysis
CreateSQLFunctionCommand my_custom, s STRING, STRING, CONCAT('CUSTOM: ', s), false, true, false, false


-- !query
SELECT
  my_custom('test') AS temp_func,
  builtin.abs(-20) AS builtin_func,
  session.my_custom('test') AS temp_qualified
-- !query analysis
Project [my_custom(s#x) AS temp_func#x, abs(-20) AS builtin_func#x, my_custom(s#x) AS temp_qualified#x]
+- Project [cast(test as string) AS s#x, cast(test as string) AS s#x]
   +- OneRowRelation


-- !query
DROP TEMPORARY FUNCTION my_custom
-- !query analysis
DropFunctionCommand my_custom, false, true


-- !query
SET spark.sql.ansi.enabled = false
-- !query analysis
SetCommand (spark.sql.ansi.enabled,Some(false))
