-- Automatically generated by SQLQueryTestSuite
-- !query
SELECT col1 + 1 AS a FROM VALUES(1) GROUP BY a ORDER BY col1 + 1
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Aggregate [(col1#x + 1)], [(col1#x + 1) AS a#x]
   +- LocalRelation [col1#x]


-- !query
SELECT col1 + 1 AS a, a AS b FROM VALUES(1) GROUP BY a ORDER BY col1 + 1
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x, a#x AS b#x]
   +- Project [(col1 + 1)#x, (col1 + 1)#x AS a#x]
      +- Aggregate [(col1#x + 1)], [(col1#x + 1) AS (col1 + 1)#x]
         +- LocalRelation [col1#x]


-- !query
SELECT col1 + 1 AS a FROM VALUES(1) GROUP BY a HAVING col1 + 1 > 0
-- !query analysis
Filter (a#x > 0)
+- Aggregate [(col1#x + 1)], [(col1#x + 1) AS a#x]
   +- LocalRelation [col1#x]


-- !query
SELECT col1 + 1 AS a, a AS b FROM VALUES(1) GROUP BY a HAVING col1 + 1 > 0
-- !query analysis
Filter (a#x > 0)
+- Project [a#x, a#x AS b#x]
   +- Project [(col1 + 1)#x, (col1 + 1)#x AS a#x]
      +- Aggregate [(col1#x + 1)], [(col1#x + 1) AS (col1 + 1)#x]
         +- LocalRelation [col1#x]


-- !query
SELECT col1, col2, GROUPING(col1) FROM VALUES("abc", 1) GROUP BY CUBE(col1, col2) ORDER BY GROUPING(col1)
-- !query analysis
Sort [grouping(col1)#x ASC NULLS FIRST], true
+- Aggregate [col1#x, col2#x, spark_grouping_id#xL], [col1#x, col2#x, cast((shiftright(spark_grouping_id#xL, 1) & 1) as tinyint) AS grouping(col1)#x]
   +- Expand [[col1#x, col2#x, col1#x, col2#x, 0], [col1#x, col2#x, col1#x, null, 1], [col1#x, col2#x, null, col2#x, 2], [col1#x, col2#x, null, null, 3]], [col1#x, col2#x, col1#x, col2#x, spark_grouping_id#xL]
      +- Project [col1#x, col2#x, col1#x AS col1#x, col2#x AS col2#x]
         +- LocalRelation [col1#x, col2#x]


-- !query
SELECT col1, col2, GROUPING(col1) FROM VALUES("abc", 1) GROUP BY CUBE(col1, col2) HAVING GROUPING(col1) != NULL
-- !query analysis
Filter NOT (grouping(col1)#x = cast(null as tinyint))
+- Aggregate [col1#x, col2#x, spark_grouping_id#xL], [col1#x, col2#x, cast((shiftright(spark_grouping_id#xL, 1) & 1) as tinyint) AS grouping(col1)#x]
   +- Expand [[col1#x, col2#x, col1#x, col2#x, 0], [col1#x, col2#x, col1#x, null, 1], [col1#x, col2#x, null, col2#x, 2], [col1#x, col2#x, null, null, 3]], [col1#x, col2#x, col1#x, col2#x, spark_grouping_id#xL]
      +- Project [col1#x, col2#x, col1#x AS col1#x, col2#x AS col2#x]
         +- LocalRelation [col1#x, col2#x]


-- !query
SELECT make_date(col1, col2, col3) AS a FROM VALUES(1,2,3) GROUP BY make_date(col1, col2, col3) ORDER BY make_date(col1, col2, col3)
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Aggregate [make_date(col1#x, col2#x, col3#x, true)], [make_date(col1#x, col2#x, col3#x, true) AS a#x]
   +- LocalRelation [col1#x, col2#x, col3#x]


-- !query
SELECT make_date(col1, col2, col3) AS a, a AS b FROM VALUES(1,2,3) GROUP BY make_date(col1, col2, col3) ORDER BY make_date(col1, col2, col3)
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [a#x, a#x AS b#x]
   +- Project [make_date(col1, col2, col3)#x, make_date(col1, col2, col3)#x AS a#x]
      +- Aggregate [make_date(col1#x, col2#x, col3#x, true)], [make_date(col1#x, col2#x, col3#x, true) AS make_date(col1, col2, col3)#x]
         +- LocalRelation [col1#x, col2#x, col3#x]


-- !query
SELECT make_date(col1, col2, col3) AS a FROM VALUES(1,2,3) GROUP BY make_date(col1, col2, col3) HAVING make_date(col1, col2, col3) > '2025-01-01'
-- !query analysis
Filter (a#x > cast(2025-01-01 as date))
+- Aggregate [make_date(col1#x, col2#x, col3#x, true)], [make_date(col1#x, col2#x, col3#x, true) AS a#x]
   +- LocalRelation [col1#x, col2#x, col3#x]


-- !query
SELECT make_date(col1, col2, col3) AS a, a AS b FROM VALUES(1,2,3) GROUP BY make_date(col1, col2, col3) HAVING make_date(col1, col2, col3) > '2025-01-01'
-- !query analysis
Filter (a#x > cast(2025-01-01 as date))
+- Project [a#x, a#x AS b#x]
   +- Project [make_date(col1, col2, col3)#x, make_date(col1, col2, col3)#x AS a#x]
      +- Aggregate [make_date(col1#x, col2#x, col3#x, true)], [make_date(col1#x, col2#x, col3#x, true) AS make_date(col1, col2, col3)#x]
         +- LocalRelation [col1#x, col2#x, col3#x]


-- !query
SELECT make_date(col1, col2, col3) AS a FROM VALUES(1,2,3) ORDER BY make_date(col1, col2, col3)
-- !query analysis
Project [a#x]
+- Sort [make_date(col1#x, col2#x, col3#x, true) ASC NULLS FIRST], true
   +- Project [make_date(col1#x, col2#x, col3#x, true) AS a#x, col1#x, col2#x, col3#x]
      +- LocalRelation [col1#x, col2#x, col3#x]


-- !query
SELECT make_date(col1, col2, col3) AS a, a AS b FROM VALUES(1,2,3) ORDER BY make_date(col1, col2, col3)
-- !query analysis
Project [a#x, b#x]
+- Sort [make_date(col1#x, col2#x, col3#x, true) ASC NULLS FIRST], true
   +- Project [a#x, a#x AS b#x, col1#x, col2#x, col3#x]
      +- Project [col1#x, col2#x, col3#x, make_date(col1#x, col2#x, col3#x, true) AS a#x]
         +- LocalRelation [col1#x, col2#x, col3#x]


-- !query
SELECT col1, col1 AS a FROM VALUES(1) GROUP BY col1 ORDER BY col1 ASC
-- !query analysis
Sort [col1#x ASC NULLS FIRST], true
+- Aggregate [col1#x], [col1#x, col1#x AS a#x]
   +- LocalRelation [col1#x]


-- !query
SELECT col1 AS a, col1 FROM VALUES(1) GROUP BY col1 ORDER BY col1 ASC
-- !query analysis
Sort [col1#x ASC NULLS FIRST], true
+- Aggregate [col1#x], [col1#x AS a#x, col1#x]
   +- LocalRelation [col1#x]


-- !query
SELECT col1, col1 AS a FROM VALUES(1) GROUP BY col1 HAVING col1 > 0
-- !query analysis
Filter (col1#x > 0)
+- Aggregate [col1#x], [col1#x, col1#x AS a#x]
   +- LocalRelation [col1#x]


-- !query
SELECT col1 AS a, col1 FROM VALUES(1) GROUP BY col1 HAVING col1 > 0
-- !query analysis
Filter (col1#x > 0)
+- Aggregate [col1#x], [col1#x AS a#x, col1#x]
   +- LocalRelation [col1#x]


-- !query
SELECT col2 AS b, col2 FROM VALUES(1,2) GROUP BY 1,2 ORDER BY ALL
-- !query analysis
Sort [b#x ASC NULLS FIRST, col2#x ASC NULLS FIRST], true
+- Aggregate [col2#x, col2#x], [col2#x AS b#x, col2#x]
   +- LocalRelation [col1#x, col2#x]


-- !query
SELECT col2 AS b, col2 FROM VALUES(1,2) GROUP BY 1,2 HAVING col2 > 0 ORDER BY ALL
-- !query analysis
Sort [b#x ASC NULLS FIRST, col2#x ASC NULLS FIRST], true
+- Filter (col2#x > 0)
   +- Aggregate [col2#x, col2#x], [col2#x AS b#x, col2#x]
      +- LocalRelation [col1#x, col2#x]


-- !query
SELECT col2 AS b, col2, b as c FROM VALUES(1,2) GROUP BY 1,2 ORDER BY ALL
-- !query analysis
Sort [b#x ASC NULLS FIRST, col2#x ASC NULLS FIRST, c#x ASC NULLS FIRST], true
+- Project [b#x, col2#x, b#x AS c#x]
   +- Project [col2#x, col2#x AS b#x]
      +- Aggregate [col2#x, col2#x], [col2#x]
         +- LocalRelation [col1#x, col2#x]


-- !query
SELECT col2 AS b, col2, b as c FROM VALUES(1,2) GROUP BY 1,2 HAVING col2 > 0 ORDER BY ALL
-- !query analysis
Sort [b#x ASC NULLS FIRST, col2#x ASC NULLS FIRST, c#x ASC NULLS FIRST], true
+- Filter (col2#x > 0)
   +- Project [b#x, col2#x, b#x AS c#x]
      +- Project [col2#x, col2#x AS b#x]
         +- Aggregate [col2#x, col2#x], [col2#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT col1 AS a FROM VALUES(1,2) GROUP BY col1, col2 HAVING col2 > 1 ORDER BY col1
-- !query analysis
Project [a#x]
+- Sort [col1#x ASC NULLS FIRST], true
   +- Project [a#x, col1#x]
      +- Filter (col2#x > 1)
         +- Aggregate [col1#x, col2#x], [col1#x AS a#x, col2#x, col1#x]
            +- LocalRelation [col1#x, col2#x]


-- !query
SELECT col1 AS a, a AS b FROM VALUES(1,2) GROUP BY col1, col2 HAVING col2 > 1 ORDER BY col1
-- !query analysis
Project [a#x, b#x]
+- Sort [col1#x ASC NULLS FIRST], true
   +- Project [a#x, b#x, col1#x]
      +- Filter (col2#x > 1)
         +- Project [a#x, a#x AS b#x, col2#x, col1#x]
            +- Project [col1#x, col2#x, col1#x AS a#x]
               +- Aggregate [col1#x, col2#x], [col1#x, col2#x]
                  +- LocalRelation [col1#x, col2#x]
