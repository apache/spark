-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW v1 AS VALUES (1, 2, 2), (2, 1, 1) AS t(a, b, k)
-- !query analysis
CreateViewCommand `v1`, VALUES (1, 2, 2), (2, 1, 1) AS t(a, b, k), false, false, LocalTempView, UNSUPPORTED, true
   +- SubqueryAlias t
      +- LocalRelation [a#x, b#x, k#x]


-- !query
CREATE TEMPORARY VIEW v2 AS VALUES (1, 2, 2), (2, 1, 1) AS t(a, b, all)
-- !query analysis
CreateViewCommand `v2`, VALUES (1, 2, 2), (2, 1, 1) AS t(a, b, all), false, false, LocalTempView, UNSUPPORTED, true
   +- SubqueryAlias t
      +- LocalRelation [a#x, b#x, all#x]


-- !query
SELECT max(a) AS b FROM v1 GROUP BY k ORDER BY b
-- !query analysis
Sort [b#x ASC NULLS FIRST], true
+- Aggregate [k#x], [max(a#x) AS b#x]
   +- SubqueryAlias v1
      +- View (`v1`, [a#x, b#x, k#x])
         +- Project [cast(a#x as int) AS a#x, cast(b#x as int) AS b#x, cast(k#x as int) AS k#x]
            +- SubqueryAlias t
               +- LocalRelation [a#x, b#x, k#x]


-- !query
SELECT max(a) FROM v2 GROUP BY all ORDER BY all
-- !query analysis
Project [max(a)#x]
+- Sort [all#x ASC NULLS FIRST], true
   +- Aggregate [all#x], [max(a#x) AS max(a)#x, all#x]
      +- SubqueryAlias v2
         +- View (`v2`, [a#x, b#x, all#x])
            +- Project [cast(a#x as int) AS a#x, cast(b#x as int) AS b#x, cast(all#x as int) AS all#x]
               +- SubqueryAlias t
                  +- LocalRelation [a#x, b#x, all#x]


-- !query
SELECT (SELECT b FROM v1 ORDER BY all LIMIT 1) FROM v2
-- !query analysis
Project [scalar-subquery#x [] AS scalarsubquery()#x]
:  +- GlobalLimit 1
:     +- LocalLimit 1
:        +- Sort [b#x ASC NULLS FIRST], true
:           +- Project [b#x]
:              +- SubqueryAlias v1
:                 +- View (`v1`, [a#x, b#x, k#x])
:                    +- Project [cast(a#x as int) AS a#x, cast(b#x as int) AS b#x, cast(k#x as int) AS k#x]
:                       +- SubqueryAlias t
:                          +- LocalRelation [a#x, b#x, k#x]
+- SubqueryAlias v2
   +- View (`v2`, [a#x, b#x, all#x])
      +- Project [cast(a#x as int) AS a#x, cast(b#x as int) AS b#x, cast(all#x as int) AS all#x]
         +- SubqueryAlias t
            +- LocalRelation [a#x, b#x, all#x]
