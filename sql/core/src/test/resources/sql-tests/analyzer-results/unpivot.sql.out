-- Automatically generated by SQLQueryTestSuite
-- !query
create temporary view courseEarnings as select * from values
  ("dotNET", 15000, 48000, 22500),
  ("Java", 20000, 30000, NULL)
  as courseEarnings(course, `2012`, `2013`, `2014`)
-- !query analysis
CreateViewCommand `courseEarnings`, select * from values
  ("dotNET", 15000, 48000, 22500),
  ("Java", 20000, 30000, NULL)
  as courseEarnings(course, `2012`, `2013`, `2014`), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [course#x, 2012#x, 2013#x, 2014#x]
      +- SubqueryAlias courseEarnings
         +- LocalRelation [course#x, 2012#x, 2013#x, 2014#x]


-- !query
SELECT * FROM courseEarnings
UNPIVOT (
  earningsYear FOR year IN (`2012`, `2013`, `2014`)
)
-- !query analysis
Project [course#x, year#x, earningsYear#x]
+- Filter isnotnull(coalesce(earningsYear#x))
   +- Expand [[course#x, 2012, 2012#x], [course#x, 2013, 2013#x], [course#x, 2014, 2014#x]], [course#x, year#x, earningsYear#x]
      +- SubqueryAlias courseearnings
         +- View (`courseEarnings`, [course#x, 2012#x, 2013#x, 2014#x])
            +- Project [cast(course#x as string) AS course#x, cast(2012#x as int) AS 2012#x, cast(2013#x as int) AS 2013#x, cast(2014#x as int) AS 2014#x]
               +- Project [course#x, 2012#x, 2013#x, 2014#x]
                  +- SubqueryAlias courseEarnings
                     +- LocalRelation [course#x, 2012#x, 2013#x, 2014#x]


-- !query
SELECT * FROM courseEarnings
UNPIVOT INCLUDE NULLS (
  earningsYear FOR year IN (`2012`, `2013`, `2014`)
)
-- !query analysis
Project [course#x, year#x, earningsYear#x]
+- Expand [[course#x, 2012, 2012#x], [course#x, 2013, 2013#x], [course#x, 2014, 2014#x]], [course#x, year#x, earningsYear#x]
   +- SubqueryAlias courseearnings
      +- View (`courseEarnings`, [course#x, 2012#x, 2013#x, 2014#x])
         +- Project [cast(course#x as string) AS course#x, cast(2012#x as int) AS 2012#x, cast(2013#x as int) AS 2013#x, cast(2014#x as int) AS 2014#x]
            +- Project [course#x, 2012#x, 2013#x, 2014#x]
               +- SubqueryAlias courseEarnings
                  +- LocalRelation [course#x, 2012#x, 2013#x, 2014#x]


-- !query
SELECT * FROM courseEarnings
UNPIVOT (
  earningsYear FOR year IN (`2012` as `twenty-twelve`, `2013` as `twenty-thirteen`, `2014` as `twenty-fourteen`)
)
-- !query analysis
Project [course#x, year#x, earningsYear#x]
+- Filter isnotnull(coalesce(earningsYear#x))
   +- Expand [[course#x, twenty-twelve, 2012#x], [course#x, twenty-thirteen, 2013#x], [course#x, twenty-fourteen, 2014#x]], [course#x, year#x, earningsYear#x]
      +- SubqueryAlias courseearnings
         +- View (`courseEarnings`, [course#x, 2012#x, 2013#x, 2014#x])
            +- Project [cast(course#x as string) AS course#x, cast(2012#x as int) AS 2012#x, cast(2013#x as int) AS 2013#x, cast(2014#x as int) AS 2014#x]
               +- Project [course#x, 2012#x, 2013#x, 2014#x]
                  +- SubqueryAlias courseEarnings
                     +- LocalRelation [course#x, 2012#x, 2013#x, 2014#x]


-- !query
create temporary view courseEarningsAndSales as select * from values
  ("dotNET", 15000, NULL, 48000, 1, 22500, 1),
  ("Java", 20000, 1, 30000, 2, NULL, NULL)
  as courseEarningsAndSales(course, earnings2012, sales2012, earnings2013, sales2013, earnings2014, sales2014)
-- !query analysis
CreateViewCommand `courseEarningsAndSales`, select * from values
  ("dotNET", 15000, NULL, 48000, 1, 22500, 1),
  ("Java", 20000, 1, 30000, 2, NULL, NULL)
  as courseEarningsAndSales(course, earnings2012, sales2012, earnings2013, sales2013, earnings2014, sales2014), false, false, LocalTempView, UNSUPPORTED, true
   +- Project [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]
      +- SubqueryAlias courseEarningsAndSales
         +- LocalRelation [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]


-- !query
SELECT * FROM courseEarningsAndSales
UNPIVOT (
  (earnings, sales) FOR year IN ((earnings2012, sales2012), (earnings2013, sales2013), (earnings2014, sales2014))
)
-- !query analysis
Project [course#x, year#x, earnings#x, sales#x]
+- Filter isnotnull(coalesce(earnings#x, sales#x))
   +- Expand [[course#x, earnings2012_sales2012, earnings2012#x, sales2012#x], [course#x, earnings2013_sales2013, earnings2013#x, sales2013#x], [course#x, earnings2014_sales2014, earnings2014#x, sales2014#x]], [course#x, year#x, earnings#x, sales#x]
      +- SubqueryAlias courseearningsandsales
         +- View (`courseEarningsAndSales`, [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x])
            +- Project [cast(course#x as string) AS course#x, cast(earnings2012#x as int) AS earnings2012#x, cast(sales2012#x as int) AS sales2012#x, cast(earnings2013#x as int) AS earnings2013#x, cast(sales2013#x as int) AS sales2013#x, cast(earnings2014#x as int) AS earnings2014#x, cast(sales2014#x as int) AS sales2014#x]
               +- Project [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]
                  +- SubqueryAlias courseEarningsAndSales
                     +- LocalRelation [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]


-- !query
SELECT * FROM courseEarningsAndSales
UNPIVOT INCLUDE NULLS (
  (earnings, sales) FOR year IN ((earnings2012, sales2012), (earnings2013, sales2013), (earnings2014, sales2014))
)
-- !query analysis
Project [course#x, year#x, earnings#x, sales#x]
+- Expand [[course#x, earnings2012_sales2012, earnings2012#x, sales2012#x], [course#x, earnings2013_sales2013, earnings2013#x, sales2013#x], [course#x, earnings2014_sales2014, earnings2014#x, sales2014#x]], [course#x, year#x, earnings#x, sales#x]
   +- SubqueryAlias courseearningsandsales
      +- View (`courseEarningsAndSales`, [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x])
         +- Project [cast(course#x as string) AS course#x, cast(earnings2012#x as int) AS earnings2012#x, cast(sales2012#x as int) AS sales2012#x, cast(earnings2013#x as int) AS earnings2013#x, cast(sales2013#x as int) AS sales2013#x, cast(earnings2014#x as int) AS earnings2014#x, cast(sales2014#x as int) AS sales2014#x]
            +- Project [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]
               +- SubqueryAlias courseEarningsAndSales
                  +- LocalRelation [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]


-- !query
SELECT * FROM courseEarningsAndSales
UNPIVOT (
  (earnings, sales) FOR year IN ((earnings2012, sales2012) as `2012`, (earnings2013, sales2013) as `2013`, (earnings2014, sales2014) as `2014`)
)
-- !query analysis
Project [course#x, year#x, earnings#x, sales#x]
+- Filter isnotnull(coalesce(earnings#x, sales#x))
   +- Expand [[course#x, 2012, earnings2012#x, sales2012#x], [course#x, 2013, earnings2013#x, sales2013#x], [course#x, 2014, earnings2014#x, sales2014#x]], [course#x, year#x, earnings#x, sales#x]
      +- SubqueryAlias courseearningsandsales
         +- View (`courseEarningsAndSales`, [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x])
            +- Project [cast(course#x as string) AS course#x, cast(earnings2012#x as int) AS earnings2012#x, cast(sales2012#x as int) AS sales2012#x, cast(earnings2013#x as int) AS earnings2013#x, cast(sales2013#x as int) AS sales2013#x, cast(earnings2014#x as int) AS earnings2014#x, cast(sales2014#x as int) AS sales2014#x]
               +- Project [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]
                  +- SubqueryAlias courseEarningsAndSales
                     +- LocalRelation [course#x, earnings2012#x, sales2012#x, earnings2013#x, sales2013#x, earnings2014#x, sales2014#x]
