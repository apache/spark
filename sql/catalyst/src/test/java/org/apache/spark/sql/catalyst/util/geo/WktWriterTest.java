/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.spark.sql.catalyst.util.geo;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import java.util.Arrays;
import java.util.List;

/**
 * Test suite for WKT (Well-Known Text) writing functionality.
 */
public class WktWriterTest extends WkbTestBase {

  /** Tests for: POINT */

  @Test
  public void testEmptyPointToString() {
    Point point = new Point(new double[]{Double.NaN, Double.NaN}, 0);
    String wkt = point.toString();
    Assertions.assertEquals("POINT EMPTY", wkt);
  }

  @Test
  public void testPointToString() {
    Point point = new Point(new double[]{1.0, 2.0}, 0);
    String wkt = point.toString();
    Assertions.assertEquals("POINT(1 2)", wkt);
  }

  @Test
  public void testPointZToString() {
    Point point = new Point(new double[]{1.0, 2.0, 3.0}, 0, true, false);
    String wkt = point.toString();
    Assertions.assertEquals("POINT Z (1 2 3)", wkt);
  }

  @Test
  public void testPointMToString() {
    Point point = new Point(new double[]{1.0, 2.0, 4.0}, 0, false, true);
    String wkt = point.toString();
    Assertions.assertEquals("POINT M (1 2 4)", wkt);
  }

  @Test
  public void testPointZMToString() {
    Point point = new Point(new double[]{1.0, 2.0, 3.0, 4.0}, 0, true, true);
    String wkt = point.toString();
    Assertions.assertEquals("POINT ZM (1 2 3 4)", wkt);
  }

  @Test
  public void testPointWithNegativeCoordinatesToString() {
    Point point = new Point(new double[]{-180.0, -90.0}, 0);
    String wkt = point.toString();
    Assertions.assertEquals("POINT(-180 -90)", wkt);
  }

  /** Tests for: LINESTRING */

  @Test
  public void testEmptyLineStringToString() {
    LineString lineString = new LineString(Arrays.asList(), 0, false, false);
    String wkt = lineString.toString();
    Assertions.assertEquals("LINESTRING EMPTY", wkt);
  }

  @Test
  public void testLineStringToString() {
    List<Point> points = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{1.0, 1.0}, 0),
        new Point(new double[]{2.0, 2.0}, 0)
    );
    LineString lineString = new LineString(points, 0, false, false);
    String wkt = lineString.toString();
    Assertions.assertEquals("LINESTRING(0 0,1 1,2 2)", wkt);
  }

  @Test
  public void testLineStringZToString() {
    List<Point> points = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{1.0, 1.0, 1.0}, 0, true, false)
    );
    LineString lineString = new LineString(points, 0, true, false);
    String wkt = lineString.toString();
    Assertions.assertEquals("LINESTRING Z (0 0 0,1 1 1)", wkt);
  }

  @Test
  public void testLineStringMToString() {
    List<Point> points = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 10.0}, 0, false, true),
        new Point(new double[]{1.0, 1.0, 20.0}, 0, false, true)
    );
    LineString lineString = new LineString(points, 0, false, true);
    String wkt = lineString.toString();
    Assertions.assertEquals("LINESTRING M (0 0 10,1 1 20)", wkt);
  }

  @Test
  public void testLineStringZMToString() {
    List<Point> points = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0, 10.0}, 0, true, true),
        new Point(new double[]{1.0, 1.0, 1.0, 20.0}, 0, true, true)
    );
    LineString lineString = new LineString(points, 0, true, true);
    String wkt = lineString.toString();
    Assertions.assertEquals("LINESTRING ZM (0 0 0 10,1 1 1 20)", wkt);
  }

  /** Tests for: POLYGON */

  @Test
  public void testEmptyPolygonToString() {
    Polygon polygon = new Polygon(Arrays.asList(), 0, false, false);
    String wkt = polygon.toString();
    Assertions.assertEquals("POLYGON EMPTY", wkt);
  }

  @Test
  public void testPolygonToString() {
    List<Point> ringPoints = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{4.0, 0.0}, 0),
        new Point(new double[]{4.0, 4.0}, 0),
        new Point(new double[]{0.0, 4.0}, 0),
        new Point(new double[]{0.0, 0.0}, 0)
    );
    Ring ring = new Ring(ringPoints);
    Polygon polygon = new Polygon(Arrays.asList(ring), 0, false, false);
    String wkt = polygon.toString();
    Assertions.assertEquals("POLYGON((0 0,4 0,4 4,0 4,0 0))", wkt);
  }

  @Test
  public void testPolygonWithHoleToString() {
    // Exterior ring
    List<Point> exteriorPoints = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{10.0, 0.0}, 0),
        new Point(new double[]{10.0, 10.0}, 0),
        new Point(new double[]{0.0, 10.0}, 0),
        new Point(new double[]{0.0, 0.0}, 0)
    );
    Ring exteriorRing = new Ring(exteriorPoints);

    // Interior ring (hole)
    List<Point> interiorPoints = Arrays.asList(
        new Point(new double[]{2.0, 2.0}, 0),
        new Point(new double[]{8.0, 2.0}, 0),
        new Point(new double[]{8.0, 8.0}, 0),
        new Point(new double[]{2.0, 8.0}, 0),
        new Point(new double[]{2.0, 2.0}, 0)
    );
    Ring interiorRing = new Ring(interiorPoints);

    Polygon polygon = new Polygon(Arrays.asList(exteriorRing, interiorRing), 0, false, false);
    String wkt = polygon.toString();
    Assertions.assertEquals(
        "POLYGON((0 0,10 0,10 10,0 10,0 0),(2 2,8 2,8 8,2 8,2 2))", wkt);
  }

  @Test
  public void testPolygonZToString() {
    List<Point> ringPoints = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{4.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{4.0, 4.0, 0.0}, 0, true, false),
        new Point(new double[]{0.0, 4.0, 0.0}, 0, true, false),
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false)
    );
    Ring ring = new Ring(ringPoints);
    Polygon polygon = new Polygon(Arrays.asList(ring), 0, true, false);
    String wkt = polygon.toString();
    Assertions.assertEquals("POLYGON Z ((0 0 0,4 0 0,4 4 0,0 4 0,0 0 0))", wkt);
  }

  /** Tests for: MULTIPOINT */

  @Test
  public void testEmptyMultiPointToString() {
    MultiPoint multiPoint = new MultiPoint(Arrays.asList(), 0, false, false);
    String wkt = multiPoint.toString();
    Assertions.assertEquals("MULTIPOINT EMPTY", wkt);
  }

  @Test
  public void testMultiPointToString() {
    List<Point> points = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{1.0, 1.0}, 0),
        new Point(new double[]{2.0, 2.0}, 0)
    );
    MultiPoint multiPoint = new MultiPoint(points, 0, false, false);
    String wkt = multiPoint.toString();
    Assertions.assertEquals("MULTIPOINT((0 0),(1 1),(2 2))", wkt);
  }

  @Test
  public void testMultiPointZToString() {
    List<Point> points = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{1.0, 1.0, 1.0}, 0, true, false)
    );
    MultiPoint multiPoint = new MultiPoint(points, 0, true, false);
    String wkt = multiPoint.toString();
    Assertions.assertEquals("MULTIPOINT Z ((0 0 0),(1 1 1))", wkt);
  }

  /** Tests for: MULTILINESTRING */

  @Test
  public void testEmptyMultiLineStringToString() {
    MultiLineString multiLineString = new MultiLineString(Arrays.asList(), 0, false, false);
    String wkt = multiLineString.toString();
    Assertions.assertEquals("MULTILINESTRING EMPTY", wkt);
  }

  @Test
  public void testMultiLineStringToString() {
    List<Point> ls1Points = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{1.0, 1.0}, 0)
    );
    LineString ls1 = new LineString(ls1Points, 0, false, false);

    List<Point> ls2Points = Arrays.asList(
        new Point(new double[]{2.0, 2.0}, 0),
        new Point(new double[]{3.0, 3.0}, 0)
    );
    LineString ls2 = new LineString(ls2Points, 0, false, false);

    MultiLineString multiLineString = new MultiLineString(Arrays.asList(ls1, ls2), 0, false, false);
    String wkt = multiLineString.toString();
    Assertions.assertEquals("MULTILINESTRING((0 0,1 1),(2 2,3 3))", wkt);
  }

  @Test
  public void testMultiLineStringZToString() {
    List<Point> ls1Points = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{1.0, 1.0, 1.0}, 0, true, false)
    );
    LineString ls1 = new LineString(ls1Points, 0, true, false);

    List<Point> ls2Points = Arrays.asList(
        new Point(new double[]{2.0, 2.0, 2.0}, 0, true, false),
        new Point(new double[]{3.0, 3.0, 3.0}, 0, true, false)
    );
    LineString ls2 = new LineString(ls2Points, 0, true, false);

    MultiLineString multiLineString = new MultiLineString(Arrays.asList(ls1, ls2), 0, true, false);
    String wkt = multiLineString.toString();
    Assertions.assertEquals("MULTILINESTRING Z ((0 0 0,1 1 1),(2 2 2,3 3 3))", wkt);
  }

  /** Tests for: MULTIPOLYGON */

  @Test
  public void testEmptyMultiPolygonToString() {
    MultiPolygon multiPolygon = new MultiPolygon(Arrays.asList(), 0, false, false);
    String wkt = multiPolygon.toString();
    Assertions.assertEquals("MULTIPOLYGON EMPTY", wkt);
  }

  @Test
  public void testMultiPolygonToString() {
    // First polygon
    List<Point> poly1Points = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{1.0, 0.0}, 0),
        new Point(new double[]{1.0, 1.0}, 0),
        new Point(new double[]{0.0, 1.0}, 0),
        new Point(new double[]{0.0, 0.0}, 0)
    );
    Polygon poly1 = new Polygon(Arrays.asList(new Ring(poly1Points)), 0, false, false);

    // Second polygon
    List<Point> poly2Points = Arrays.asList(
        new Point(new double[]{2.0, 2.0}, 0),
        new Point(new double[]{3.0, 2.0}, 0),
        new Point(new double[]{3.0, 3.0}, 0),
        new Point(new double[]{2.0, 3.0}, 0),
        new Point(new double[]{2.0, 2.0}, 0)
    );
    Polygon poly2 = new Polygon(Arrays.asList(new Ring(poly2Points)), 0, false, false);

    MultiPolygon multiPolygon = new MultiPolygon(Arrays.asList(poly1, poly2), 0, false, false);
    String wkt = multiPolygon.toString();
    Assertions.assertEquals(
        "MULTIPOLYGON(((0 0,1 0,1 1,0 1,0 0)),((2 2,3 2,3 3,2 3,2 2)))", wkt);
  }

  @Test
  public void testMultiPolygonZToString() {
    List<Point> poly1Points = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{1.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{1.0, 1.0, 0.0}, 0, true, false),
        new Point(new double[]{0.0, 1.0, 0.0}, 0, true, false),
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false)
    );
    Polygon poly1 = new Polygon(Arrays.asList(new Ring(poly1Points)), 0, true, false);

    MultiPolygon multiPolygon = new MultiPolygon(Arrays.asList(poly1), 0, true, false);
    String wkt = multiPolygon.toString();
    Assertions.assertEquals("MULTIPOLYGON Z (((0 0 0,1 0 0,1 1 0,0 1 0,0 0 0)))", wkt);
  }

  /** Tests for: GEOMETRYCOLLECTION */

  @Test
  public void testEmptyGeometryCollectionToString() {
    GeometryCollection collection = new GeometryCollection(Arrays.asList(), 0, false, false);
    String wkt = collection.toString();
    Assertions.assertEquals("GEOMETRYCOLLECTION EMPTY", wkt);
  }

  @Test
  public void testGeometryCollectionToString() {
    Point point = new Point(new double[]{1.0, 2.0}, 0);

    List<Point> lsPoints = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{1.0, 1.0}, 0)
    );
    LineString lineString = new LineString(lsPoints, 0, false, false);

    GeometryCollection collection = new GeometryCollection(
        Arrays.asList(point, lineString), 0, false, false);
    String wkt = collection.toString();
    Assertions.assertEquals("GEOMETRYCOLLECTION(POINT(1 2),LINESTRING(0 0,1 1))", wkt);
  }

  @Test
  public void testGeometryCollectionZToString() {
    Point point = new Point(new double[]{1.0, 2.0, 3.0}, 0, true, false);

    List<Point> lsPoints = Arrays.asList(
        new Point(new double[]{0.0, 0.0, 0.0}, 0, true, false),
        new Point(new double[]{1.0, 1.0, 1.0}, 0, true, false)
    );
    LineString lineString = new LineString(lsPoints, 0, true, false);

    GeometryCollection collection = new GeometryCollection(
        Arrays.asList(point, lineString), 0, true, false);
    String wkt = collection.toString();
    Assertions.assertEquals(
        "GEOMETRYCOLLECTION Z (POINT Z (1 2 3),LINESTRING Z (0 0 0,1 1 1))", wkt);
  }

  @Test
  public void testNestedGeometryCollectionToString() {
    Point point = new Point(new double[]{1.0, 2.0}, 0);

    List<Point> lsPoints = Arrays.asList(
        new Point(new double[]{0.0, 0.0}, 0),
        new Point(new double[]{1.0, 1.0}, 0)
    );
    LineString lineString = new LineString(lsPoints, 0, false, false);

    GeometryCollection innerCollection = new GeometryCollection(
        Arrays.asList(point), 0, false, false);

    GeometryCollection outerCollection = new GeometryCollection(
        Arrays.asList(innerCollection, lineString), 0, false, false);
    String wkt = outerCollection.toString();
    Assertions.assertEquals(
        "GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(1 2)),LINESTRING(0 0,1 1))", wkt);
  }

  /** End-to-end Tests: WKB -> Geometry -> WKT */

  @Test
  public void testWkbToWktRoundTripPoint() {
    List<String[]> testCases = Arrays.asList(
      new String[]{"POINT EMPTY", "0101000000000000000000F87F000000000000F87F"},
      new String[]{"POINT(1 2)", "0101000000000000000000F03F0000000000000040"},
      new String[]{"POINT Z EMPTY", "01E9030000000000000000F87F000000000000F87F000000000000F87F"},
      new String[]{"POINT Z (1 2 3)", "01E9030000000000000000F03F00000000000000400000000000000840"},
      new String[]{"POINT M EMPTY", "01D1070000000000000000F87F000000000000F87F000000000000F87F"},
      new String[]{"POINT M (1 2 3)", "01D1070000000000000000F03F00000000000000400000000000000840"},
      new String[]{"POINT ZM EMPTY", "01B90B0000000000000000F87F000000000000F87F000000000000F87F000000000000F87F"}, // checkstyle.off: LineLength
      new String[]{"POINT ZM (1 2 3 4)", "01B90B0000000000000000F03F000000000000004000000000000008400000000000001040"}, // checkstyle.off: LineLength
      new String[]{"LINESTRING EMPTY", "010200000000000000"},
      new String[]{"LINESTRING(0 1,1 0,2 -1,-1 -2,0 1)", "0102000000050000000000000000000000000000000000F03F000000000000F03F00000000000000000000000000000040000000000000F0BF000000000000F0BF00000000000000C00000000000000000000000000000F03F"}, // checkstyle.off: LineLength
      new String[]{"LINESTRING Z EMPTY", "01EA03000000000000"},
      new String[]{"LINESTRING Z (0 1 -1,1 0 -2,2 -1 17,-1 -2 58,0 1 45)", "01EA030000050000000000000000000000000000000000F03F000000000000F0BF000000000000F03F000000000000000000000000000000C00000000000000040000000000000F0BF0000000000003140000000000000F0BF00000000000000C00000000000004D400000000000000000000000000000F03F0000000000804640"}, // checkstyle.off: LineLength
      new String[]{"LINESTRING M EMPTY", "01D207000000000000"},
      new String[]{"LINESTRING M (0 1 -1,1 0 -2,2 -1 17,-1 -2 58,0 1 45)", "01D2070000050000000000000000000000000000000000F03F000000000000F0BF000000000000F03F000000000000000000000000000000C00000000000000040000000000000F0BF0000000000003140000000000000F0BF00000000000000C00000000000004D400000000000000000000000000000F03F0000000000804640"}, // checkstyle.off: LineLength
      new String[]{"LINESTRING ZM EMPTY", "01BA0B000000000000"},
      new String[]{"LINESTRING ZM (0 1 -1 100,1 0 -2 200,2 -1 17 500,-1 -2 58 400,0 1 45 300)", "01BA0B0000050000000000000000000000000000000000F03F000000000000F0BF0000000000005940000000000000F03F000000000000000000000000000000C000000000000069400000000000000040000000000000F0BF00000000000031400000000000407F40000000000000F0BF00000000000000C00000000000004D4000000000000079400000000000000000000000000000F03F00000000008046400000000000C07240"}, // checkstyle.off: LineLength
      new String[]{"POLYGON EMPTY", "010300000000000000"},
      new String[]{"POLYGON((0 0,50 0,50 50,0 50,0 0),(20 20,25 30,30 20,20 20))", "010300000002000000050000000000000000000000000000000000000000000000000049400000000000000000000000000000494000000000000049400000000000000000000000000000494000000000000000000000000000000000040000000000000000003440000000000000344000000000000039400000000000003E400000000000003E40000000000000344000000000000034400000000000003440"}, // checkstyle.off: LineLength
      new String[]{"POLYGON Z EMPTY", "01EB03000000000000"},
      new String[]{"POLYGON Z ((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4))", "01EB030000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C0"}, // checkstyle.off: LineLength
      new String[]{"POLYGON M EMPTY", "01D307000000000000"},
      new String[]{"POLYGON M ((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4))", "01D3070000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C0"}, // checkstyle.off: LineLength
      new String[]{"POLYGON ZM EMPTY", "01BB0B000000000000"},
      new String[]{"POLYGON ZM ((0 0 -1 1,50 0 -2 2,50 50 -3 3,0 50 -4 4,0 0 -5 5),(20 20 -1 1,25 30 -2 2,30 20 -3 3,20 20 -4 4))", "01BB0B0000020000000500000000000000000000000000000000000000000000000000F0BF000000000000F03F0000000000004940000000000000000000000000000000C000000000000000400000000000004940000000000000494000000000000008C000000000000008400000000000000000000000000000494000000000000010C000000000000010400000000000000000000000000000000000000000000014C000000000000014400400000000000000000034400000000000003440000000000000F0BF000000000000F03F00000000000039400000000000003E4000000000000000C000000000000000400000000000003E40000000000000344000000000000008C000000000000008400000000000003440000000000000344000000000000010C00000000000001040"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOINT EMPTY", "010400000000000000"},
      new String[]{"MULTIPOINT((1 2),EMPTY,EMPTY,(3 4))", "0104000000040000000101000000000000000000F03F00000000000000400101000000000000000000F87F000000000000F87F0101000000000000000000F87F000000000000F87F010100000000000000000008400000000000001040"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOINT Z EMPTY", "01EC03000000000000"},
      new String[]{"MULTIPOINT Z ((1 2 3),EMPTY,EMPTY,(4 5 6))", "01EC0300000400000001E9030000000000000000F03F0000000000000040000000000000084001E9030000000000000000F87F000000000000F87F000000000000F87F01E9030000000000000000F87F000000000000F87F000000000000F87F01E9030000000000000000104000000000000014400000000000001840"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOINT M EMPTY", "01D407000000000000"},
      new String[]{"MULTIPOINT M ((1 2 3),EMPTY,EMPTY,(4 5 6))", "01D40700000400000001D1070000000000000000F03F0000000000000040000000000000084001D1070000000000000000F87F000000000000F87F000000000000F87F01D1070000000000000000F87F000000000000F87F000000000000F87F01D1070000000000000000104000000000000014400000000000001840"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOINT ZM EMPTY", "01BC0B000000000000"},
      new String[]{"MULTIPOINT ZM ((1 2 3 4),EMPTY,EMPTY,(5 6 7 8))", "01BC0B00000400000001B90B0000000000000000F03F00000000000000400000000000000840000000000000104001B90B0000000000000000F87F000000000000F87F000000000000F87F000000000000F87F01B90B0000000000000000F87F000000000000F87F000000000000F87F000000000000F87F01B90B0000000000000000144000000000000018400000000000001C400000000000002040"}, // checkstyle.off: LineLength
      new String[]{"MULTILINESTRING EMPTY", "010500000000000000"},
      new String[]{"MULTILINESTRING(EMPTY,(1 2,3 4),(5 6,7 8),EMPTY)", "010500000004000000010200000000000000010200000002000000000000000000F03F000000000000004000000000000008400000000000001040010200000002000000000000000000144000000000000018400000000000001C400000000000002040010200000000000000"}, // checkstyle.off: LineLength
      new String[]{"MULTILINESTRING Z EMPTY", "01ED03000000000000"},
      new String[]{"MULTILINESTRING Z (EMPTY,(1 2 3,4 5 6),(7 8 9,10 11 12),EMPTY)", "01ED0300000400000001EA0300000000000001EA03000002000000000000000000F03F0000000000000040000000000000084000000000000010400000000000001440000000000000184001EA030000020000000000000000001C400000000000002040000000000000224000000000000024400000000000002640000000000000284001EA03000000000000"}, // checkstyle.off: LineLength
      new String[]{"MULTILINESTRING M EMPTY", "01D507000000000000"},
      new String[]{"MULTILINESTRING M (EMPTY,(1 2 3,4 5 6),(7 8 9,10 11 12),EMPTY)", "01D50700000400000001D20700000000000001D207000002000000000000000000F03F0000000000000040000000000000084000000000000010400000000000001440000000000000184001D2070000020000000000000000001C400000000000002040000000000000224000000000000024400000000000002640000000000000284001D207000000000000"}, // checkstyle.off: LineLength
      new String[]{"MULTILINESTRING ZM EMPTY", "01BD0B000000000000"},
      new String[]{"MULTILINESTRING ZM (EMPTY,(1 2 3 4,5 6 7 8),(7 8 9 10,11 12 13 14),EMPTY)", "01BD0B00000400000001BA0B00000000000001BA0B000002000000000000000000F03F000000000000004000000000000008400000000000001040000000000000144000000000000018400000000000001C40000000000000204001BA0B0000020000000000000000001C40000000000000204000000000000022400000000000002440000000000000264000000000000028400000000000002A400000000000002C4001BA0B000000000000"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOLYGON EMPTY", "010600000000000000"},
      new String[]{"MULTIPOLYGON(EMPTY,((0 0,50 0,50 50,0 50,0 0),(20 20,25 30,30 20,20 20)),EMPTY,((0 0,20 0,20 20,0 20,0 0),(9 9,10 11,11 9,9 9)))", "010600000004000000010300000000000000010300000002000000050000000000000000000000000000000000000000000000000049400000000000000000000000000000494000000000000049400000000000000000000000000000494000000000000000000000000000000000040000000000000000003440000000000000344000000000000039400000000000003E400000000000003E400000000000003440000000000000344000000000000034400103000000000000000103000000020000000500000000000000000000000000000000000000000000000000344000000000000000000000000000003440000000000000344000000000000000000000000000003440000000000000000000000000000000000400000000000000000022400000000000002240000000000000244000000000000026400000000000002640000000000000224000000000000022400000000000002240"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOLYGON Z EMPTY", "01EE03000000000000"},
      new String[]{"MULTIPOLYGON Z (EMPTY,((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4)),EMPTY,((0 0 -1,20 0 -2,20 20 -3,0 20 -4,0 0 -5),(9 9 -1,10 11 -2,11 9 -3,9 9 -4)))", "01EE0300000400000001EB0300000000000001EB030000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C001EB0300000000000001EB030000020000000500000000000000000000000000000000000000000000000000F0BF0000000000003440000000000000000000000000000000C00000000000003440000000000000344000000000000008C00000000000000000000000000000344000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000022400000000000002240000000000000F0BF0000000000002440000000000000264000000000000000C00000000000002640000000000000224000000000000008C00000000000002240000000000000224000000000000010C0"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOLYGON M EMPTY", "01D607000000000000"},
      new String[]{"MULTIPOLYGON M (EMPTY,((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4)),EMPTY,((0 0 -1,20 0 -2,20 20 -3,0 20 -4,0 0 -5),(9 9 -1,10 11 -2,11 9 -3,9 9 -4)))", "01D60700000400000001D30700000000000001D3070000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C001D30700000000000001D3070000020000000500000000000000000000000000000000000000000000000000F0BF0000000000003440000000000000000000000000000000C00000000000003440000000000000344000000000000008C00000000000000000000000000000344000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000022400000000000002240000000000000F0BF0000000000002440000000000000264000000000000000C00000000000002640000000000000224000000000000008C00000000000002240000000000000224000000000000010C0"}, // checkstyle.off: LineLength
      new String[]{"MULTIPOLYGON ZM EMPTY", "01BE0B000000000000"},
      new String[]{"MULTIPOLYGON ZM (EMPTY,((0 0 -1 1,50 0 -2 2,50 50 -3 3,0 50 -4 4,0 0 -5 5),(20 20 -1 1,25 30 -2 2,30 20 -3 3,20 20 -4 4)),EMPTY,((0 0 -1 1,20 0 -2 2,20 20 -3 3,0 20 -4 4,0 0 -5 5),(9 9 -1 1,10 11 -2 2,11 9 -3 3,9 9 -4 4)))", "01BE0B00000400000001BB0B00000000000001BB0B0000020000000500000000000000000000000000000000000000000000000000F0BF000000000000F03F0000000000004940000000000000000000000000000000C000000000000000400000000000004940000000000000494000000000000008C000000000000008400000000000000000000000000000494000000000000010C000000000000010400000000000000000000000000000000000000000000014C000000000000014400400000000000000000034400000000000003440000000000000F0BF000000000000F03F00000000000039400000000000003E4000000000000000C000000000000000400000000000003E40000000000000344000000000000008C000000000000008400000000000003440000000000000344000000000000010C0000000000000104001BB0B00000000000001BB0B0000020000000500000000000000000000000000000000000000000000000000F0BF000000000000F03F0000000000003440000000000000000000000000000000C000000000000000400000000000003440000000000000344000000000000008C000000000000008400000000000000000000000000000344000000000000010C000000000000010400000000000000000000000000000000000000000000014C000000000000014400400000000000000000022400000000000002240000000000000F0BF000000000000F03F0000000000002440000000000000264000000000000000C000000000000000400000000000002640000000000000224000000000000008C000000000000008400000000000002240000000000000224000000000000010C00000000000001040"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION EMPTY", "010700000000000000"},
      new String[]{"GEOMETRYCOLLECTION EMPTY", "0107000000050000000101000000000000000000F87F000000000000F87F010200000000000000010300000000000000010700000000000000010700000004000000010700000000000000010400000000000000010600000000000000010500000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION(POINT(1 2),LINESTRING(1 2,3 4),POLYGON((0 0,50 0,50 50,0 50,0 0),(20 20,25 30,30 20,20 20)),GEOMETRYCOLLECTION EMPTY,GEOMETRYCOLLECTION(GEOMETRYCOLLECTION EMPTY,MULTIPOINT((1 2),EMPTY,EMPTY,(3 4)),MULTIPOLYGON(EMPTY,((0 0,50 0,50 50,0 50,0 0),(20 20,25 30,30 20,20 20)),EMPTY,((0 0,20 0,20 20,0 20,0 0),(9 9,10 11,11 9,9 9))),MULTILINESTRING(EMPTY,(1 2,3 4),(5 6,7 8),EMPTY)))", "0107000000050000000101000000000000000000F03F0000000000000040010200000002000000000000000000F03F000000000000004000000000000008400000000000001040010300000002000000050000000000000000000000000000000000000000000000000049400000000000000000000000000000494000000000000049400000000000000000000000000000494000000000000000000000000000000000040000000000000000003440000000000000344000000000000039400000000000003E400000000000003E400000000000003440000000000000344000000000000034400107000000000000000107000000040000000107000000000000000104000000040000000101000000000000000000F03F00000000000000400101000000000000000000F87F000000000000F87F0101000000000000000000F87F000000000000F87F010100000000000000000008400000000000001040010600000004000000010300000000000000010300000002000000050000000000000000000000000000000000000000000000000049400000000000000000000000000000494000000000000049400000000000000000000000000000494000000000000000000000000000000000040000000000000000003440000000000000344000000000000039400000000000003E400000000000003E400000000000003440000000000000344000000000000034400103000000000000000103000000020000000500000000000000000000000000000000000000000000000000344000000000000000000000000000003440000000000000344000000000000000000000000000003440000000000000000000000000000000000400000000000000000022400000000000002240000000000000244000000000000026400000000000002640000000000000224000000000000022400000000000002240010500000004000000010200000000000000010200000002000000000000000000F03F000000000000004000000000000008400000000000001040010200000002000000000000000000144000000000000018400000000000001C400000000000002040010200000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION Z EMPTY", "01EF03000000000000"},
      new String[]{"GEOMETRYCOLLECTION Z EMPTY", "01EF0300000500000001E9030000000000000000F87F000000000000F87F000000000000F87F01EA0300000000000001EB0300000000000001EF0300000000000001EF0300000400000001EF0300000000000001EC0300000000000001EE0300000000000001ED03000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION Z (POINT Z (1 2 3),LINESTRING Z (0 1 -1,1 0 -2,2 -1 17,-1 -2 58,0 1 45),POLYGON Z ((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4)),GEOMETRYCOLLECTION Z EMPTY,GEOMETRYCOLLECTION Z (GEOMETRYCOLLECTION Z EMPTY,MULTIPOINT Z ((1 2 3),EMPTY,EMPTY,(4 5 6)),MULTIPOLYGON Z (EMPTY,((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4)),EMPTY,((0 0 -1,20 0 -2,20 20 -3,0 20 -4,0 0 -5),(9 9 -1,10 11 -2,11 9 -3,9 9 -4))),MULTILINESTRING Z (EMPTY,(1 2 3,4 5 6),(7 8 9,10 11 12),EMPTY)))", "01EF0300000500000001E9030000000000000000F03F0000000000000040000000000000084001EA030000050000000000000000000000000000000000F03F000000000000F0BF000000000000F03F000000000000000000000000000000C00000000000000040000000000000F0BF0000000000003140000000000000F0BF00000000000000C00000000000004D400000000000000000000000000000F03F000000000080464001EB030000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C001EF0300000000000001EF0300000400000001EF0300000000000001EC0300000400000001E9030000000000000000F03F0000000000000040000000000000084001E9030000000000000000F87F000000000000F87F000000000000F87F01E9030000000000000000F87F000000000000F87F000000000000F87F01E903000000000000000010400000000000001440000000000000184001EE0300000400000001EB0300000000000001EB030000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C001EB0300000000000001EB030000020000000500000000000000000000000000000000000000000000000000F0BF0000000000003440000000000000000000000000000000C00000000000003440000000000000344000000000000008C00000000000000000000000000000344000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000022400000000000002240000000000000F0BF0000000000002440000000000000264000000000000000C00000000000002640000000000000224000000000000008C00000000000002240000000000000224000000000000010C001ED0300000400000001EA0300000000000001EA03000002000000000000000000F03F0000000000000040000000000000084000000000000010400000000000001440000000000000184001EA030000020000000000000000001C400000000000002040000000000000224000000000000024400000000000002640000000000000284001EA03000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION M EMPTY", "01D707000000000000"},
      new String[]{"GEOMETRYCOLLECTION M EMPTY", "01D70700000500000001D1070000000000000000F87F000000000000F87F000000000000F87F01D20700000000000001D30700000000000001D70700000000000001D70700000400000001D70700000000000001D40700000000000001D60700000000000001D507000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION M (POINT M (1 2 3),LINESTRING M (0 1 -1,1 0 -2,2 -1 17,-1 -2 58,0 1 45),POLYGON M ((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4)),GEOMETRYCOLLECTION M EMPTY,GEOMETRYCOLLECTION M (GEOMETRYCOLLECTION M EMPTY,MULTIPOINT M ((1 2 3),EMPTY,EMPTY,(4 5 6)),MULTIPOLYGON M (EMPTY,((0 0 -1,50 0 -2,50 50 -3,0 50 -4,0 0 -5),(20 20 -1,25 30 -2,30 40 -3,20 20 -4)),EMPTY,((0 0 -1,20 0 -2,20 20 -3,0 20 -4,0 0 -5),(9 9 -1,10 11 -2,11 9 -3,9 9 -4))),MULTILINESTRING M (EMPTY,(1 2 3,4 5 6),(7 8 9,10 11 12),EMPTY)))", "01D70700000500000001D1070000000000000000F03F0000000000000040000000000000084001D2070000050000000000000000000000000000000000F03F000000000000F0BF000000000000F03F000000000000000000000000000000C00000000000000040000000000000F0BF0000000000003140000000000000F0BF00000000000000C00000000000004D400000000000000000000000000000F03F000000000080464001D3070000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C001D70700000000000001D70700000400000001D70700000000000001D40700000400000001D1070000000000000000F03F0000000000000040000000000000084001D1070000000000000000F87F000000000000F87F000000000000F87F01D1070000000000000000F87F000000000000F87F000000000000F87F01D107000000000000000010400000000000001440000000000000184001D60700000400000001D30700000000000001D3070000020000000500000000000000000000000000000000000000000000000000F0BF0000000000004940000000000000000000000000000000C00000000000004940000000000000494000000000000008C00000000000000000000000000000494000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000034400000000000003440000000000000F0BF00000000000039400000000000003E4000000000000000C00000000000003E40000000000000444000000000000008C00000000000003440000000000000344000000000000010C001D30700000000000001D3070000020000000500000000000000000000000000000000000000000000000000F0BF0000000000003440000000000000000000000000000000C00000000000003440000000000000344000000000000008C00000000000000000000000000000344000000000000010C00000000000000000000000000000000000000000000014C00400000000000000000022400000000000002240000000000000F0BF0000000000002440000000000000264000000000000000C00000000000002640000000000000224000000000000008C00000000000002240000000000000224000000000000010C001D50700000400000001D20700000000000001D207000002000000000000000000F03F0000000000000040000000000000084000000000000010400000000000001440000000000000184001D2070000020000000000000000001C400000000000002040000000000000224000000000000024400000000000002640000000000000284001D207000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION ZM EMPTY", "01BF0B000000000000"},
      new String[]{"GEOMETRYCOLLECTION ZM EMPTY", "01BF0B00000500000001B90B0000000000000000F87F000000000000F87F000000000000F87F000000000000F87F01BA0B00000000000001BB0B00000000000001BF0B00000000000001BF0B00000400000001BF0B00000000000001BC0B00000000000001BE0B00000000000001BD0B000000000000"}, // checkstyle.off: LineLength
      new String[]{"GEOMETRYCOLLECTION ZM (POINT ZM (1 2 3 4),LINESTRING ZM (0 1 -1 100,1 0 -2 200,2 -1 17 500,-1 -2 58 400,0 1 45 300),POLYGON ZM ((0 0 -1 1,50 0 -2 2,50 50 -3 3,0 50 -4 4,0 0 -5 5),(20 20 -1 1,25 30 -2 2,30 20 -3 3,20 20 -4 4)),GEOMETRYCOLLECTION ZM EMPTY,GEOMETRYCOLLECTION ZM (GEOMETRYCOLLECTION ZM EMPTY,MULTIPOINT ZM ((1 2 3 4),EMPTY,EMPTY,(5 6 7 8)),MULTIPOLYGON ZM (EMPTY,((0 0 -1 1,50 0 -2 2,50 50 -3 3,0 50 -4 4,0 0 -5 5),(20 20 -1 1,25 30 -2 2,30 20 -3 3,20 20 -4 4)),EMPTY,((0 0 -1 1,20 0 -2 2,20 20 -3 3,0 20 -4 4,0 0 -5 5),(9 9 -1 1,10 11 -2 2,11 9 -3 3,9 9 -4 4))),MULTILINESTRING ZM (EMPTY,(1 2 3 4,5 6 7 8),(7 8 9 10,11 12 13 14),EMPTY)))", "01BF0B00000500000001B90B0000000000000000F03F00000000000000400000000000000840000000000000104001BA0B0000050000000000000000000000000000000000F03F000000000000F0BF0000000000005940000000000000F03F000000000000000000000000000000C000000000000069400000000000000040000000000000F0BF00000000000031400000000000407F40000000000000F0BF00000000000000C00000000000004D4000000000000079400000000000000000000000000000F03F00000000008046400000000000C0724001BB0B0000020000000500000000000000000000000000000000000000000000000000F0BF000000000000F03F0000000000004940000000000000000000000000000000C000000000000000400000000000004940000000000000494000000000000008C000000000000008400000000000000000000000000000494000000000000010C000000000000010400000000000000000000000000000000000000000000014C000000000000014400400000000000000000034400000000000003440000000000000F0BF000000000000F03F00000000000039400000000000003E4000000000000000C000000000000000400000000000003E40000000000000344000000000000008C000000000000008400000000000003440000000000000344000000000000010C0000000000000104001BF0B00000000000001BF0B00000400000001BF0B00000000000001BC0B00000400000001B90B0000000000000000F03F00000000000000400000000000000840000000000000104001B90B0000000000000000F87F000000000000F87F000000000000F87F000000000000F87F01B90B0000000000000000F87F000000000000F87F000000000000F87F000000000000F87F01B90B0000000000000000144000000000000018400000000000001C40000000000000204001BE0B00000400000001BB0B00000000000001BB0B0000020000000500000000000000000000000000000000000000000000000000F0BF000000000000F03F0000000000004940000000000000000000000000000000C000000000000000400000000000004940000000000000494000000000000008C000000000000008400000000000000000000000000000494000000000000010C000000000000010400000000000000000000000000000000000000000000014C000000000000014400400000000000000000034400000000000003440000000000000F0BF000000000000F03F00000000000039400000000000003E4000000000000000C000000000000000400000000000003E40000000000000344000000000000008C000000000000008400000000000003440000000000000344000000000000010C0000000000000104001BB0B00000000000001BB0B0000020000000500000000000000000000000000000000000000000000000000F0BF000000000000F03F0000000000003440000000000000000000000000000000C000000000000000400000000000003440000000000000344000000000000008C000000000000008400000000000000000000000000000344000000000000010C000000000000010400000000000000000000000000000000000000000000014C000000000000014400400000000000000000022400000000000002240000000000000F0BF000000000000F03F0000000000002440000000000000264000000000000000C000000000000000400000000000002640000000000000224000000000000008C000000000000008400000000000002240000000000000224000000000000010C0000000000000104001BD0B00000400000001BA0B00000000000001BA0B000002000000000000000000F03F000000000000004000000000000008400000000000001040000000000000144000000000000018400000000000001C40000000000000204001BA0B0000020000000000000000001C40000000000000204000000000000022400000000000002440000000000000264000000000000028400000000000002A400000000000002C4001BA0B000000000000"} // checkstyle.off: LineLength
    );
    WkbReader reader = new WkbReader();
    for (String[] testCase : testCases) {
      String expectedWkt = testCase[0];
      String wkbHex = testCase[1];
      byte[] wkbBytes = hexToBytes(wkbHex);
      GeometryModel geom = reader.read(wkbBytes);
      Assertions.assertEquals(expectedWkt, geom.toString());
    }
  }
}
