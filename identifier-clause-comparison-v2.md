# IDENTIFIER Clause Test Comparison (v2)

Comprehensive comparison of IDENTIFIER clause behavior across different modes.

- **Total Tests**: 227
- **Tests from Master**: 128
- **New Tests Added**: 99
- **Tests Changed from Master**: 13
- **Tests with Legacy Mode Differences**: 47

## Legend

- **Query#**: Sequential test number
- **SQL Text**: The SQL query being tested
- **Master**: Result from master branch (before identifier-lite changes)
- **identifier-clause**: Result with identifier-lite enabled (default mode, current)
- **identifier-clause-legacy**: Result with `spark.sql.legacy.identifierClause=true`

### Result Values

- `SUCCESS`: Query executed successfully
- `<ERROR_CLASS>`: Query failed with the specified error class
- `NEW`: Test did not exist in master baseline

---

## Full Test Results

| Query# | SQL Text | Master | identifier-clause | identifier-clause-legacy |
|--------|----------|--------|-------------------|--------------------------|
| 1 | SET hivevar:colname = 'c' | SUCCESS | SUCCESS | SUCCESS |
| 2 | SELECT IDENTIFIER(${colname} \|\| '_1') FROM VALUES(1) AS T(c_1) | SUCCESS | SUCCESS | SUCCESS |
| 3 | SELECT IDENTIFIER('c1') FROM VALUES(1) AS T(c1) | SUCCESS | SUCCESS | SUCCESS |
| 4 | SELECT IDENTIFIER('t.c1') FROM VALUES(1) AS T(c1) | SUCCESS | SUCCESS | SUCCESS |
| 5 | SELECT IDENTIFIER('`t`.c1') FROM VALUES(1) AS T(c1) | SUCCESS | SUCCESS | SUCCESS |
| 6 | SELECT IDENTIFIER('`c 1`') FROM VALUES(1) AS T(`c 1`) | SUCCESS | SUCCESS | SUCCESS |
| 7 | SELECT IDENTIFIER('``') FROM VALUES(1) AS T(``) | SUCCESS | SUCCESS | SUCCESS |
| 8 | SELECT IDENTIFIER('c' \|\| '1') FROM VALUES(1) AS T(c1) | SUCCESS | SUCCESS | SUCCESS |
| 9 | CREATE SCHEMA IF NOT EXISTS s | SUCCESS | SUCCESS | SUCCESS |
| 10 | CREATE TABLE s.tab(c1 INT) USING CSV | SUCCESS | SUCCESS | SUCCESS |
| 11 | USE SCHEMA s | SUCCESS | SUCCESS | SUCCESS |
| 12 | INSERT INTO IDENTIFIER('ta' \|\| 'b') VALUES(1) | SUCCESS | SUCCESS | SUCCESS |
| 13 | DELETE FROM IDENTIFIER('ta' \|\| 'b') WHERE 1=0 | UNSUPPORTED_FEATURE.TABLE_OPERATION | UNSUPPORTED_FEATURE.TABLE_OPERATION | UNSUPPORTED_FEATURE.TABLE_OPERATION |
| 14 | UPDATE IDENTIFIER('ta' \|\| 'b') SET c1 = 2 | _LEGACY_ERROR_TEMP_2096 | _LEGACY_ERROR_TEMP_2096 | _LEGACY_ERROR_TEMP_2096 |
| 15 | MERGE INTO IDENTIFIER('ta' \|\| 'b') AS t USING IDENTIFIER('ta' \|\| 'b') AS s ON s.c1 = t.c1   WHEN MATCHED THEN UPD... | _LEGACY_ERROR_TEMP_2096 | _LEGACY_ERROR_TEMP_2096 | _LEGACY_ERROR_TEMP_2096 |
| 16 | SELECT * FROM IDENTIFIER('tab') | SUCCESS | SUCCESS | SUCCESS |
| 17 | SELECT * FROM IDENTIFIER('s.tab') | SUCCESS | SUCCESS | SUCCESS |
| 18 | SELECT * FROM IDENTIFIER('`s`.`tab`') | SUCCESS | SUCCESS | SUCCESS |
| 19 | SELECT * FROM IDENTIFIER('t' \|\| 'a' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 20 | USE SCHEMA default | SUCCESS | SUCCESS | SUCCESS |
| 21 | DROP TABLE s.tab | SUCCESS | SUCCESS | SUCCESS |
| 22 | DROP SCHEMA s | SUCCESS | SUCCESS | SUCCESS |
| 23 | SELECT IDENTIFIER('COAL' \|\| 'ESCE')(NULL, 1) | SUCCESS | SUCCESS | SUCCESS |
| 24 | SELECT IDENTIFIER('abs')(c1) FROM VALUES(-1) AS T(c1) | SUCCESS | SUCCESS | SUCCESS |
| 25 | SELECT * FROM IDENTIFIER('ra' \|\| 'nge')(0, 1) | SUCCESS | SUCCESS | SUCCESS |
| 26 | CREATE TABLE IDENTIFIER('tab')(c1 INT) USING CSV | SUCCESS | SUCCESS | SUCCESS |
| 27 | DROP TABLE IF EXISTS IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 28 | CREATE SCHEMA identifier_clauses | SUCCESS | SUCCESS | SUCCESS |
| 29 | USE identifier_clauses | SUCCESS | SUCCESS | SUCCESS |
| 30 | CREATE TABLE IDENTIFIER('ta' \|\| 'b')(c1 INT) USING CSV | SUCCESS | SUCCESS | SUCCESS |
| 31 | DROP TABLE IF EXISTS IDENTIFIER('identifier_clauses.' \|\| 'tab') | SUCCESS | SUCCESS | SUCCESS |
| 32 | CREATE TABLE IDENTIFIER('identifier_clauses.' \|\| 'tab')(c1 INT) USING CSV | SUCCESS | SUCCESS | SUCCESS |
| 33 | REPLACE TABLE IDENTIFIER('identifier_clauses.' \|\| 'tab')(c1 INT) USING CSV | UNSUPPORTED_FEATURE.TABLE_OPERATION | UNSUPPORTED_FEATURE.TABLE_OPERATION | UNSUPPORTED_FEATURE.TABLE_OPERATION |
| 34 | CACHE TABLE IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 35 | UNCACHE TABLE IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 36 | DROP TABLE IF EXISTS IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 37 | USE default | SUCCESS | SUCCESS | SUCCESS |
| 38 | DROP SCHEMA identifier_clauses | SUCCESS | SUCCESS | SUCCESS |
| 39 | CREATE TABLE tab(c1 INT) USING CSV | SUCCESS | SUCCESS | SUCCESS |
| 40 | INSERT INTO tab VALUES (1) | SUCCESS | SUCCESS | SUCCESS |
| 41 | SELECT c1 FROM tab | SUCCESS | SUCCESS | SUCCESS |
| 42 | DESCRIBE IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 43 | ANALYZE TABLE IDENTIFIER('ta' \|\| 'b') COMPUTE STATISTICS | SUCCESS | SUCCESS | SUCCESS |
| 44 | ALTER TABLE IDENTIFIER('ta' \|\| 'b') ADD COLUMN c2 INT | SUCCESS | SUCCESS | SUCCESS |
| 45 | SHOW TBLPROPERTIES IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 46 | SHOW COLUMNS FROM IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 47 | COMMENT ON TABLE IDENTIFIER('ta' \|\| 'b') IS 'hello' | SUCCESS | SUCCESS | SUCCESS |
| 48 | REFRESH TABLE IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 49 | REPAIR TABLE IDENTIFIER('ta' \|\| 'b') | NOT_A_PARTITIONED_TABLE | NOT_A_PARTITIONED_TABLE | NOT_A_PARTITIONED_TABLE |
| 50 | TRUNCATE TABLE IDENTIFIER('ta' \|\| 'b') | SUCCESS | SUCCESS | SUCCESS |
| 51 | DROP TABLE IF EXISTS tab | SUCCESS | SUCCESS | SUCCESS |
| 52 | CREATE OR REPLACE VIEW IDENTIFIER('v')(c1) AS VALUES(1) | SUCCESS | SUCCESS | SUCCESS |
| 53 | SELECT * FROM v | SUCCESS | SUCCESS | SUCCESS |
| 54 | ALTER VIEW IDENTIFIER('v') AS VALUES(2) | SUCCESS | SUCCESS | SUCCESS |
| 55 | DROP VIEW IDENTIFIER('v') | SUCCESS | SUCCESS | SUCCESS |
| 56 | CREATE TEMPORARY VIEW IDENTIFIER('v')(c1) AS VALUES(1) | SUCCESS | SUCCESS | SUCCESS |
| 57 | DROP VIEW IDENTIFIER('v') | SUCCESS | SUCCESS | SUCCESS |
| 58 | CREATE SCHEMA IDENTIFIER('id' \|\| 'ent') | SUCCESS | SUCCESS | SUCCESS |
| 59 | ALTER SCHEMA IDENTIFIER('id' \|\| 'ent') SET PROPERTIES (somekey = 'somevalue') | SUCCESS | SUCCESS | SUCCESS |
| 60 | ALTER SCHEMA IDENTIFIER('id' \|\| 'ent') SET LOCATION 'someloc' | SUCCESS | SUCCESS | SUCCESS |
| 61 | COMMENT ON SCHEMA IDENTIFIER('id' \|\| 'ent') IS 'some comment' | SUCCESS | SUCCESS | SUCCESS |
| 62 | DESCRIBE SCHEMA IDENTIFIER('id' \|\| 'ent') | SUCCESS | SUCCESS | SUCCESS |
| 63 | SHOW TABLES IN IDENTIFIER('id' \|\| 'ent') | SUCCESS | SUCCESS | SUCCESS |
| 64 | SHOW TABLE EXTENDED IN IDENTIFIER('id' \|\| 'ent') LIKE 'hello' | SUCCESS | SUCCESS | SUCCESS |
| 65 | USE IDENTIFIER('id' \|\| 'ent') | SUCCESS | SUCCESS | SUCCESS |
| 66 | SHOW CURRENT SCHEMA | SUCCESS | SUCCESS | SUCCESS |
| 67 | USE SCHEMA IDENTIFIER('id' \|\| 'ent') | SUCCESS | SUCCESS | SUCCESS |
| 68 | USE SCHEMA default | SUCCESS | SUCCESS | SUCCESS |
| 69 | DROP SCHEMA IDENTIFIER('id' \|\| 'ent') | SUCCESS | SUCCESS | SUCCESS |
| 70 | CREATE SCHEMA ident | SUCCESS | SUCCESS | SUCCESS |
| 71 | CREATE FUNCTION IDENTIFIER('ident.' \|\| 'myDoubleAvg') AS 'test.org.apache.spark.sql.MyDoubleAvg' | SUCCESS | SUCCESS | SUCCESS |
| 72 | DESCRIBE FUNCTION IDENTIFIER('ident.' \|\| 'myDoubleAvg') | SUCCESS | SUCCESS | SUCCESS |
| 73 | REFRESH FUNCTION IDENTIFIER('ident.' \|\| 'myDoubleAvg') | SUCCESS | SUCCESS | SUCCESS |
| 74 | DROP FUNCTION IDENTIFIER('ident.' \|\| 'myDoubleAvg') | SUCCESS | SUCCESS | SUCCESS |
| 75 | DROP SCHEMA ident | SUCCESS | SUCCESS | SUCCESS |
| 76 | CREATE TEMPORARY FUNCTION IDENTIFIER('my' \|\| 'DoubleAvg') AS 'test.org.apache.spark.sql.MyDoubleAvg' | SUCCESS | SUCCESS | SUCCESS |
| 77 | DROP TEMPORARY FUNCTION IDENTIFIER('my' \|\| 'DoubleAvg') | SUCCESS | SUCCESS | SUCCESS |
| 78 | DECLARE var = 'sometable' | SUCCESS | SUCCESS | SUCCESS |
| 79 | CREATE TABLE IDENTIFIER(var)(c1 INT) USING CSV | SUCCESS | SUCCESS | SUCCESS |
| 80 | SET VAR var = 'c1' | SUCCESS | SUCCESS | SUCCESS |
| 81 | SELECT IDENTIFIER(var) FROM VALUES(1) AS T(c1) | SUCCESS | SUCCESS | SUCCESS |
| 82 | SET VAR var = 'some' | SUCCESS | SUCCESS | SUCCESS |
| 83 | DROP TABLE IDENTIFIER(var \|\| 'table') | SUCCESS | SUCCESS | SUCCESS |
| 84 | SELECT IDENTIFIER('c 1') FROM VALUES(1) AS T(`c 1`) | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 85 | SELECT IDENTIFIER('') FROM VALUES(1) AS T(``) | PARSE_EMPTY_STATEMENT | PARSE_EMPTY_STATEMENT | PARSE_EMPTY_STATEMENT |
| 86 | VALUES(IDENTIFIER(CAST(NULL AS STRING))) | NOT_A_CONSTANT_STRING.NULL | NOT_A_CONSTANT_STRING.NULL | NOT_A_CONSTANT_STRING.NULL |
| 87 | VALUES(IDENTIFIER(1)) | NOT_A_CONSTANT_STRING.WRONG_TYPE | NOT_A_CONSTANT_STRING.WRONG_TYPE | NOT_A_CONSTANT_STRING.WRONG_TYPE |
| 88 | VALUES(IDENTIFIER(SUBSTR('HELLO', 1, RAND() + 1))) | NOT_A_CONSTANT_STRING.NOT_CONSTANT | NOT_A_CONSTANT_STRING.NOT_CONSTANT | NOT_A_CONSTANT_STRING.NOT_CONSTANT |
| 89 | SELECT `IDENTIFIER`('abs')(c1) FROM VALUES(-1) AS T(c1) | UNRESOLVED_ROUTINE | UNRESOLVED_ROUTINE | UNRESOLVED_ROUTINE |
| 90 | CREATE TABLE IDENTIFIER(1)(c1 INT) USING csv | NOT_A_CONSTANT_STRING.WRONG_TYPE | NOT_A_CONSTANT_STRING.WRONG_TYPE | NOT_A_CONSTANT_STRING.WRONG_TYPE |
| 91 | CREATE TABLE IDENTIFIER('a.b.c')(c1 INT) USING csv | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE |
| 92 | CREATE VIEW IDENTIFIER('a.b.c')(c1) AS VALUES(1) | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE |
| 93 | DROP TABLE IDENTIFIER('a.b.c') | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE |
| 94 | DROP VIEW IDENTIFIER('a.b.c') | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE |
| 95 | COMMENT ON TABLE IDENTIFIER('a.b.c.d') IS 'hello' | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE | REQUIRES_SINGLE_PART_NAMESPACE |
| 96 | VALUES(IDENTIFIER(1)()) | NOT_A_CONSTANT_STRING.WRONG_TYPE | NOT_A_CONSTANT_STRING.WRONG_TYPE | NOT_A_CONSTANT_STRING.WRONG_TYPE |
| 97 | VALUES(IDENTIFIER('a.b.c.d')()) | IDENTIFIER_TOO_MANY_NAME_PARTS | IDENTIFIER_TOO_MANY_NAME_PARTS | IDENTIFIER_TOO_MANY_NAME_PARTS |
| 98 | CREATE TEMPORARY FUNCTION IDENTIFIER('default.my' \|\| 'DoubleAvg') AS 'test.org.apache.spark.sql.MyDoubleAvg' | INVALID_SQL_SYNTAX.CREATE_TEMP_FUNC_WITH_DATABASE | INVALID_SQL_SYNTAX.CREATE_TEMP_FUNC_WITH_DATABASE | INVALID_SQL_SYNTAX.CREATE_TEMP_FUNC_WITH_DATABASE |
| 99 | DROP TEMPORARY FUNCTION IDENTIFIER('default.my' \|\| 'DoubleAvg') | INVALID_SQL_SYNTAX.MULTI_PART_NAME | INVALID_SQL_SYNTAX.MULTI_PART_NAME | INVALID_SQL_SYNTAX.MULTI_PART_NAME |
| 100 | CREATE TEMPORARY VIEW IDENTIFIER('default.v')(c1) AS VALUES(1) | TEMP_VIEW_NAME_TOO_MANY_NAME_PARTS | TEMP_VIEW_NAME_TOO_MANY_NAME_PARTS | TEMP_VIEW_NAME_TOO_MANY_NAME_PARTS |
| 101 | create temporary view identifier('v1') as (select my_col from (values (1), (2), (1) as (my_col)) group by 1) | SUCCESS | SUCCESS | SUCCESS |
| 102 | cache table identifier('t1') as (select my_col from (values (1), (2), (1) as (my_col)) group by 1) | SUCCESS | SUCCESS | SUCCESS |
| 103 | create table identifier('t2') using csv as (select my_col from (values (1), (2), (1) as (my_col)) group by 1) | SUCCESS | SUCCESS | SUCCESS |
| 104 | insert into identifier('t2') select my_col from (values (3) as (my_col)) group by 1 | SUCCESS | SUCCESS | SUCCESS |
| 105 | drop view v1 | SUCCESS | SUCCESS | SUCCESS |
| 106 | drop table t1 | SUCCESS | SUCCESS | SUCCESS |
| 107 | drop table t2 | SUCCESS | SUCCESS | SUCCESS |
| 108 | DECLARE agg = 'max' | SUCCESS | SUCCESS | SUCCESS |
| 109 | DECLARE col = 'c1' | SUCCESS | SUCCESS | SUCCESS |
| 110 | DECLARE tab = 'T' | SUCCESS | SUCCESS | SUCCESS |
| 111 | WITH S(c1, c2) AS (VALUES(1, 2), (2, 3)),      T(c1, c2) AS (VALUES ('a', 'b'), ('c', 'd')) SELECT IDENTIFIER(agg)(ID... | SUCCESS | SUCCESS | SUCCESS |
| 112 | WITH S(c1, c2) AS (VALUES(1, 2), (2, 3)),      T(c1, c2) AS (VALUES ('a', 'b'), ('c', 'd')) SELECT IDENTIFIER('max')(... | SUCCESS | SUCCESS | SUCCESS |
| 113 | WITH ABC(c1, c2) AS (VALUES(1, 2), (2, 3)) SELECT IDENTIFIER('max')(IDENTIFIER('c1')) FROM IDENTIFIER('A' \|\| 'BC') | SUCCESS | SUCCESS | SUCCESS |
| 114 | SELECT row_number() OVER IDENTIFIER('x.win') FROM VALUES(1) AS T(c1) WINDOW win AS (ORDER BY c1) | PARSE_SYNTAX_ERROR | **IDENTIFIER_TOO_MANY_NAME_PARTS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 115 | SELECT T1.c1 FROM VALUES(1) AS T1(c1) JOIN VALUES(1) AS T2(c1) USING (IDENTIFIER('c1')) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 116 | SELECT IDENTIFIER('t').c1 FROM VALUES(1) AS T(c1) | UNRESOLVED_COLUMN.WITH_SUGGESTION | UNRESOLVED_COLUMN.WITH_SUGGESTION | UNRESOLVED_COLUMN.WITH_SUGGESTION |
| 117 | SELECT map('a', 1).IDENTIFIER('a') FROM VALUES(1) AS T(c1) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 118 | SELECT named_struct('a', 1).IDENTIFIER('a') FROM VALUES(1) AS T(c1) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 119 | SELECT * FROM s.IDENTIFIER('tab') | INVALID_SQL_SYNTAX.INVALID_TABLE_VALUED_FUNC_NAME | **TABLE_OR_VIEW_NOT_FOUND** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 120 | SELECT * FROM IDENTIFIER('s').IDENTIFIER('tab') | PARSE_SYNTAX_ERROR | **TABLE_OR_VIEW_NOT_FOUND** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 121 | SELECT * FROM IDENTIFIER('s').tab | PARSE_SYNTAX_ERROR | **TABLE_OR_VIEW_NOT_FOUND** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 122 | SELECT row_number() OVER IDENTIFIER('win') FROM VALUES(1) AS T(c1) WINDOW win AS (ORDER BY c1) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 123 | SELECT row_number() OVER win FROM VALUES(1) AS T(c1) WINDOW IDENTIFIER('win') AS (ORDER BY c1) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 124 | SELECT 1 AS IDENTIFIER('col1') | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 125 | SELECT my_table.* FROM VALUES (1, 2) AS IDENTIFIER('my_table')(IDENTIFIER('c1'), IDENTIFIER('c2')) | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 126 | WITH identifier('v')(identifier('c1')) AS (VALUES(1)) (SELECT c1 FROM v) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 127 | CREATE OR REPLACE VIEW v(IDENTIFIER('c1')) AS VALUES(1) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 128 | SELECT c1 FROM v | **NEW** | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 129 | CREATE TABLE tab(IDENTIFIER('c1') INT) USING CSV | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 130 | INSERT INTO tab(IDENTIFIER('c1')) VALUES(1) | PARSE_SYNTAX_ERROR | **SUCCESS** ⚠️ | **PARSE_SYNTAX_ERROR** |
| 131 | SELECT c1 FROM tab | SUCCESS | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 132 | ALTER TABLE IDENTIFIER('tab') RENAME COLUMN IDENTIFIER('c1') TO IDENTIFIER('col1') | **NEW** | **UNSUPPORTED_FEATURE.TABLE_OPERATION** | **PARSE_SYNTAX_ERROR** |
| 133 | SELECT col1 FROM tab | **NEW** | **UNRESOLVED_COLUMN.WITH_SUGGESTION** | **TABLE_OR_VIEW_NOT_FOUND** |
| 134 | ALTER TABLE IDENTIFIER('tab') ADD COLUMN IDENTIFIER('c2') INT | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 135 | SELECT c2 FROM tab | **NEW** | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 136 | ALTER TABLE IDENTIFIER('tab') DROP COLUMN IDENTIFIER('c2') | **NEW** | **UNSUPPORTED_FEATURE.TABLE_OPERATION** | **PARSE_SYNTAX_ERROR** |
| 137 | ALTER TABLE IDENTIFIER('tab') RENAME TO IDENTIFIER('tab_renamed') | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 138 | SELECT * FROM tab_renamed | **NEW** | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 139 | CREATE TABLE test_col_with_dot(IDENTIFIER('`col.with.dot`') INT) USING CSV | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 140 | DROP TABLE IF EXISTS test_col_with_dot | **NEW** | SUCCESS | SUCCESS |
| 141 | SELECT * FROM VALUES (1, 2) AS IDENTIFIER('schema.table')(c1, c2) | **NEW** | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 142 | SELECT 1 AS IDENTIFIER('col1.col2') | **NEW** | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 143 | CREATE TABLE test_show(c1 INT, c2 STRING) USING CSV | **NEW** | SUCCESS | SUCCESS |
| 144 | SHOW VIEWS IN IDENTIFIER('default') | **NEW** | SUCCESS | SUCCESS |
| 145 | SHOW PARTITIONS IDENTIFIER('test_show') | **NEW** | INVALID_PARTITION_OPERATION.PARTITION_SCHEMA_IS_EMPTY | INVALID_PARTITION_OPERATION.PARTITION_SCHEMA_IS_EMPTY |
| 146 | SHOW CREATE TABLE IDENTIFIER('test_show') | **NEW** | SUCCESS | SUCCESS |
| 147 | DROP TABLE test_show | **NEW** | SUCCESS | SUCCESS |
| 148 | CREATE TABLE test_desc(c1 INT) USING CSV | **NEW** | SUCCESS | SUCCESS |
| 149 | DESCRIBE TABLE IDENTIFIER('test_desc') | **NEW** | SUCCESS | SUCCESS |
| 150 | DESCRIBE FORMATTED IDENTIFIER('test_desc') | **NEW** | SUCCESS | SUCCESS |
| 151 | DESCRIBE EXTENDED IDENTIFIER('test_desc') | **NEW** | SUCCESS | SUCCESS |
| 152 | DESC IDENTIFIER('test_desc') | **NEW** | SUCCESS | SUCCESS |
| 153 | DROP TABLE test_desc | **NEW** | SUCCESS | SUCCESS |
| 154 | CREATE TABLE test_comment(c1 INT, c2 STRING) USING CSV | **NEW** | SUCCESS | SUCCESS |
| 155 | COMMENT ON TABLE IDENTIFIER('test_comment') IS 'table comment' | **NEW** | SUCCESS | SUCCESS |
| 156 | ALTER TABLE test_comment ALTER COLUMN IDENTIFIER('c1') COMMENT 'column comment' | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 157 | DROP TABLE test_comment | **NEW** | SUCCESS | SUCCESS |
| 158 | CREATE SCHEMA test_schema | **NEW** | SUCCESS | SUCCESS |
| 159 | CREATE TABLE test_schema.test_table(c1 INT) USING CSV | **NEW** | SUCCESS | SUCCESS |
| 160 | ANALYZE TABLE IDENTIFIER('test_schema.test_table') COMPUTE STATISTICS | **NEW** | SUCCESS | SUCCESS |
| 161 | REFRESH TABLE IDENTIFIER('test_schema.test_table') | **NEW** | SUCCESS | SUCCESS |
| 162 | DESCRIBE IDENTIFIER('test_schema.test_table') | **NEW** | SUCCESS | SUCCESS |
| 163 | SHOW COLUMNS FROM IDENTIFIER('test_schema.test_table') | **NEW** | SUCCESS | SUCCESS |
| 164 | DROP TABLE IDENTIFIER('test_schema.test_table') | **NEW** | SUCCESS | SUCCESS |
| 165 | DROP SCHEMA test_schema | **NEW** | SUCCESS | SUCCESS |
| 166 | DECLARE IDENTIFIER('my_var') = 'value' | **NEW** | SUCCESS | SUCCESS |
| 167 | SET VAR IDENTIFIER('my_var') = 'new_value' | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 168 | SELECT IDENTIFIER('my_var') | **NEW** | SUCCESS | SUCCESS |
| 169 | DROP TEMPORARY VARIABLE IDENTIFIER('my_var') | **NEW** | SUCCESS | SUCCESS |
| 170 | CREATE TEMPORARY FUNCTION test_udf(IDENTIFIER('param1') INT, IDENTIFIER('param2') STRING) RETURNS INT RETURN IDENTIFI... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 171 | SELECT test_udf(5, 'hello') | **NEW** | **SUCCESS** | **UNRESOLVED_ROUTINE** |
| 172 | DROP TEMPORARY FUNCTION test_udf | **NEW** | **SUCCESS** | **ROUTINE_NOT_FOUND** |
| 173 | CREATE TEMPORARY FUNCTION test_table_udf(IDENTIFIER('input_val') INT) RETURNS TABLE(IDENTIFIER('col1') INT, IDENTIFIE... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 174 | SELECT * FROM test_table_udf(42) | **NEW** | **SUCCESS** | **UNRESOLVABLE_TABLE_VALUED_FUNCTION** |
| 175 | DROP TEMPORARY FUNCTION test_table_udf | **NEW** | **SUCCESS** | **ROUTINE_NOT_FOUND** |
| 176 | BEGIN   IDENTIFIER('loop_label'): LOOP     SELECT 1 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 177 | LEAVE IDENTIFIER('loop_label') | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 178 | END LOOP loop_label | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 179 | END | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 180 | BEGIN   block_label: BEGIN     DECLARE IDENTIFIER('x') INT DEFAULT 1 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 181 | SELECT x | **NEW** | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION |
| 182 | END IDENTIFIER('block_label') | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 183 | END | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 184 | BEGIN   DECLARE IDENTIFIER('counter') INT DEFAULT 0 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 185 | IDENTIFIER('while_label'): WHILE IDENTIFIER('counter') < 3 DO     SET VAR counter = IDENTIFIER('counter') + 1 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 186 | END WHILE while_label | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 187 | SELECT IDENTIFIER('counter') | **NEW** | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION |
| 188 | END | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 189 | BEGIN   DECLARE IDENTIFIER('cnt') INT DEFAULT 0 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 190 | repeat_label: REPEAT     SET VAR IDENTIFIER('cnt') = cnt + 1 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 191 | UNTIL IDENTIFIER('cnt') >= 2   END REPEAT IDENTIFIER('repeat_label') | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 192 | SELECT IDENTIFIER('cnt') | **NEW** | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION |
| 193 | END | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 194 | BEGIN   IDENTIFIER('for_label'): FOR IDENTIFIER('row') AS SELECT 1 AS c1 DO     SELECT row.c1 | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 195 | END FOR IDENTIFIER('for_label') | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 196 | END | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 197 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:tab \'b\').c1 FROM VALUES(1) AS tab(c1)' USING 'ta' AS tab | **NEW** | INVALID_EXTRACT_BASE_FIELD_TYPE | INVALID_EXTRACT_BASE_FIELD_TYPE |
| 198 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:col1 ''.c2'') FROM VALUES(named_struct(''c2'', 42)) AS T(c1)'   USING 'c1' AS col1 | **NEW** | SUCCESS | SUCCESS |
| 199 | CREATE TABLE integration_test(c1 INT, c2 STRING) USING CSV | **NEW** | SUCCESS | SUCCESS |
| 200 | INSERT INTO integration_test VALUES (1, 'a'), (2, 'b') | **NEW** | SUCCESS | SUCCESS |
| 201 | EXECUTE IMMEDIATE 'SELECT * FROM IDENTIFIER(:schema ''.'' :table)'   USING 'default' AS schema, 'integration_test' AS... | **NEW** | SUCCESS | SUCCESS |
| 202 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:prefix ''1''), IDENTIFIER(:prefix ''2'') FROM integration_test'   USING 'c' AS ... | **NEW** | SUCCESS | SUCCESS |
| 203 | EXECUTE IMMEDIATE 'SELECT * FROM integration_test WHERE IDENTIFIER(:col) = :val'   USING 'c1' AS col, 1 AS val | **NEW** | SUCCESS | SUCCESS |
| 204 | CREATE TABLE integration_test2(c1 INT, c3 STRING) USING CSV | **NEW** | SUCCESS | SUCCESS |
| 205 | INSERT INTO integration_test2 VALUES (1, 'x'), (2, 'y') | **NEW** | SUCCESS | SUCCESS |
| 206 | EXECUTE IMMEDIATE 'SELECT t1.*, t2.* FROM IDENTIFIER(:t1) t1 JOIN IDENTIFIER(:t2) t2 USING (IDENTIFIER(:col))'   USIN... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 207 | EXECUTE IMMEDIATE   'SELECT IDENTIFIER(:col1), IDENTIFIER(:col2), row_number() OVER (PARTITION BY IDENTIFIER(:part) O... | **NEW** | SUCCESS | SUCCESS |
| 208 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:prefix ''2''), IDENTIFIER(:agg)(IDENTIFIER(:col)) FROM integration_test GROUP B... | **NEW** | SUCCESS | SUCCESS |
| 209 | EXECUTE IMMEDIATE 'SELECT * FROM integration_test ORDER BY IDENTIFIER(:col1) DESC, IDENTIFIER(:col2)'   USING 'c1' AS... | **NEW** | SUCCESS | SUCCESS |
| 210 | EXECUTE IMMEDIATE 'INSERT INTO integration_test(IDENTIFIER(:col1), IDENTIFIER(:col2)) VALUES (:val1, :val2)'   USING ... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 211 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(concat(:schema, ''.'', :table, ''.c1'')) FROM VALUES(named_struct(''c1'', 100)) ... | **NEW** | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 212 | EXECUTE IMMEDIATE 'WITH IDENTIFIER(:cte_name)(c1) AS (VALUES(1)) SELECT c1 FROM IDENTIFIER(:cte_name)'   USING 'my_ct... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 213 | EXECUTE IMMEDIATE 'CREATE OR REPLACE TEMPORARY VIEW IDENTIFIER(:view_name)(IDENTIFIER(:col_name)) AS VALUES(1)'   USI... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 214 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:col) FROM IDENTIFIER(:view)'   USING 'test_col' AS col, 'test_view' AS view | **NEW** | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 215 | DROP VIEW test_view | **NEW** | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 216 | EXECUTE IMMEDIATE 'ALTER TABLE IDENTIFIER(:tab) ADD COLUMN IDENTIFIER(:new_col) INT'   USING 'integration_test' AS ta... | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 217 | EXECUTE IMMEDIATE 'ALTER TABLE IDENTIFIER(:tab) RENAME COLUMN IDENTIFIER(:old_col) TO IDENTIFIER(:new_col)'   USING '... | **NEW** | **UNSUPPORTED_FEATURE.TABLE_OPERATION** | **PARSE_SYNTAX_ERROR** |
| 218 | EXECUTE IMMEDIATE 'SELECT map(:key, :val).IDENTIFIER(:key) AS result'   USING 'mykey' AS key, 42 AS val | **NEW** | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 219 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:alias ''.c1'') FROM integration_test AS IDENTIFIER(:alias)'   USING 't' AS alias | **NEW** | **UNRESOLVED_COLUMN.WITH_SUGGESTION** | **PARSE_SYNTAX_ERROR** |
| 220 | EXECUTE IMMEDIATE   'SELECT IDENTIFIER(:col1), IDENTIFIER(:p ''2'') FROM IDENTIFIER(:schema ''.'' :tab) WHERE IDENTIF... | **NEW** | SUCCESS | SUCCESS |
| 221 | EXECUTE IMMEDIATE   'BEGIN      DECLARE IDENTIFIER(:var_name) INT DEFAULT :var_value | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 222 | SELECT IDENTIFIER(:var_name) AS result | **NEW** | UNBOUND_SQL_PARAMETER | UNBOUND_SQL_PARAMETER |
| 223 | END'   USING 'my_variable' AS var_name, 100 AS var_value | **NEW** | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 224 | EXECUTE IMMEDIATE 'SELECT * FROM IDENTIFIER(:schema ''.'' :table) WHERE IDENTIFIER(concat(:tab_alias, ''.c1'')) > 0' ... | **NEW** | SUCCESS | SUCCESS |
| 225 | EXECUTE IMMEDIATE 'SELECT 1 AS IDENTIFIER(:schema ''.'' :col)'   USING 'default' AS schema, 'col1' AS col | **NEW** | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 226 | DROP TABLE integration_test | **NEW** | SUCCESS | SUCCESS |
| 227 | DROP TABLE integration_test2 | **NEW** | SUCCESS | SUCCESS |

---

## New Tests Added

### 99 New Tests

| Query# | SQL Text | identifier-clause | identifier-clause-legacy |
|--------|----------|-------------------|--------------------------|
| 124 | SELECT 1 AS IDENTIFIER('col1') | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 125 | SELECT my_table.* FROM VALUES (1, 2) AS IDENTIFIER('my_table')(IDENTIFIER('c1'), IDENTIFIER('c2')) | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 128 | SELECT c1 FROM v | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 132 | ALTER TABLE IDENTIFIER('tab') RENAME COLUMN IDENTIFIER('c1') TO IDENTIFIER('col1') | **UNSUPPORTED_FEATURE.TABLE_OPERATION** | **PARSE_SYNTAX_ERROR** |
| 133 | SELECT col1 FROM tab | **UNRESOLVED_COLUMN.WITH_SUGGESTION** | **TABLE_OR_VIEW_NOT_FOUND** |
| 134 | ALTER TABLE IDENTIFIER('tab') ADD COLUMN IDENTIFIER('c2') INT | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 135 | SELECT c2 FROM tab | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 136 | ALTER TABLE IDENTIFIER('tab') DROP COLUMN IDENTIFIER('c2') | **UNSUPPORTED_FEATURE.TABLE_OPERATION** | **PARSE_SYNTAX_ERROR** |
| 137 | ALTER TABLE IDENTIFIER('tab') RENAME TO IDENTIFIER('tab_renamed') | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 138 | SELECT * FROM tab_renamed | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 139 | CREATE TABLE test_col_with_dot(IDENTIFIER('`col.with.dot`') INT) USING CSV | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 140 | DROP TABLE IF EXISTS test_col_with_dot | SUCCESS | SUCCESS |
| 141 | SELECT * FROM VALUES (1, 2) AS IDENTIFIER('schema.table')(c1, c2) | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 142 | SELECT 1 AS IDENTIFIER('col1.col2') | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 143 | CREATE TABLE test_show(c1 INT, c2 STRING) USING CSV | SUCCESS | SUCCESS |
| 144 | SHOW VIEWS IN IDENTIFIER('default') | SUCCESS | SUCCESS |
| 145 | SHOW PARTITIONS IDENTIFIER('test_show') | INVALID_PARTITION_OPERATION.PARTITION_SCHEMA_IS_EMPTY | INVALID_PARTITION_OPERATION.PARTITION_SCHEMA_IS_EMPTY |
| 146 | SHOW CREATE TABLE IDENTIFIER('test_show') | SUCCESS | SUCCESS |
| 147 | DROP TABLE test_show | SUCCESS | SUCCESS |
| 148 | CREATE TABLE test_desc(c1 INT) USING CSV | SUCCESS | SUCCESS |
| 149 | DESCRIBE TABLE IDENTIFIER('test_desc') | SUCCESS | SUCCESS |
| 150 | DESCRIBE FORMATTED IDENTIFIER('test_desc') | SUCCESS | SUCCESS |
| 151 | DESCRIBE EXTENDED IDENTIFIER('test_desc') | SUCCESS | SUCCESS |
| 152 | DESC IDENTIFIER('test_desc') | SUCCESS | SUCCESS |
| 153 | DROP TABLE test_desc | SUCCESS | SUCCESS |
| 154 | CREATE TABLE test_comment(c1 INT, c2 STRING) USING CSV | SUCCESS | SUCCESS |
| 155 | COMMENT ON TABLE IDENTIFIER('test_comment') IS 'table comment' | SUCCESS | SUCCESS |
| 156 | ALTER TABLE test_comment ALTER COLUMN IDENTIFIER('c1') COMMENT 'column comment' | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 157 | DROP TABLE test_comment | SUCCESS | SUCCESS |
| 158 | CREATE SCHEMA test_schema | SUCCESS | SUCCESS |
| 159 | CREATE TABLE test_schema.test_table(c1 INT) USING CSV | SUCCESS | SUCCESS |
| 160 | ANALYZE TABLE IDENTIFIER('test_schema.test_table') COMPUTE STATISTICS | SUCCESS | SUCCESS |
| 161 | REFRESH TABLE IDENTIFIER('test_schema.test_table') | SUCCESS | SUCCESS |
| 162 | DESCRIBE IDENTIFIER('test_schema.test_table') | SUCCESS | SUCCESS |
| 163 | SHOW COLUMNS FROM IDENTIFIER('test_schema.test_table') | SUCCESS | SUCCESS |
| 164 | DROP TABLE IDENTIFIER('test_schema.test_table') | SUCCESS | SUCCESS |
| 165 | DROP SCHEMA test_schema | SUCCESS | SUCCESS |
| 166 | DECLARE IDENTIFIER('my_var') = 'value' | SUCCESS | SUCCESS |
| 167 | SET VAR IDENTIFIER('my_var') = 'new_value' | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 168 | SELECT IDENTIFIER('my_var') | SUCCESS | SUCCESS |
| 169 | DROP TEMPORARY VARIABLE IDENTIFIER('my_var') | SUCCESS | SUCCESS |
| 170 | CREATE TEMPORARY FUNCTION test_udf(IDENTIFIER('param1') INT, IDENTIFIER('param2') STRING) RETURNS... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 171 | SELECT test_udf(5, 'hello') | **SUCCESS** | **UNRESOLVED_ROUTINE** |
| 172 | DROP TEMPORARY FUNCTION test_udf | **SUCCESS** | **ROUTINE_NOT_FOUND** |
| 173 | CREATE TEMPORARY FUNCTION test_table_udf(IDENTIFIER('input_val') INT) RETURNS TABLE(IDENTIFIER('c... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 174 | SELECT * FROM test_table_udf(42) | **SUCCESS** | **UNRESOLVABLE_TABLE_VALUED_FUNCTION** |
| 175 | DROP TEMPORARY FUNCTION test_table_udf | **SUCCESS** | **ROUTINE_NOT_FOUND** |
| 176 | BEGIN   IDENTIFIER('loop_label'): LOOP     SELECT 1 | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 177 | LEAVE IDENTIFIER('loop_label') | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 178 | END LOOP loop_label | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 179 | END | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 180 | BEGIN   block_label: BEGIN     DECLARE IDENTIFIER('x') INT DEFAULT 1 | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 181 | SELECT x | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION |
| 182 | END IDENTIFIER('block_label') | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 183 | END | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 184 | BEGIN   DECLARE IDENTIFIER('counter') INT DEFAULT 0 | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 185 | IDENTIFIER('while_label'): WHILE IDENTIFIER('counter') < 3 DO     SET VAR counter = IDENTIFIER('c... | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 186 | END WHILE while_label | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 187 | SELECT IDENTIFIER('counter') | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION |
| 188 | END | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 189 | BEGIN   DECLARE IDENTIFIER('cnt') INT DEFAULT 0 | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 190 | repeat_label: REPEAT     SET VAR IDENTIFIER('cnt') = cnt + 1 | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 191 | UNTIL IDENTIFIER('cnt') >= 2   END REPEAT IDENTIFIER('repeat_label') | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 192 | SELECT IDENTIFIER('cnt') | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION | UNRESOLVED_COLUMN.WITHOUT_SUGGESTION |
| 193 | END | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 194 | BEGIN   IDENTIFIER('for_label'): FOR IDENTIFIER('row') AS SELECT 1 AS c1 DO     SELECT row.c1 | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 195 | END FOR IDENTIFIER('for_label') | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 196 | END | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 197 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:tab \'b\').c1 FROM VALUES(1) AS tab(c1)' USING 'ta' AS tab | INVALID_EXTRACT_BASE_FIELD_TYPE | INVALID_EXTRACT_BASE_FIELD_TYPE |
| 198 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:col1 ''.c2'') FROM VALUES(named_struct(''c2'', 42)) AS T(c1... | SUCCESS | SUCCESS |
| 199 | CREATE TABLE integration_test(c1 INT, c2 STRING) USING CSV | SUCCESS | SUCCESS |
| 200 | INSERT INTO integration_test VALUES (1, 'a'), (2, 'b') | SUCCESS | SUCCESS |
| 201 | EXECUTE IMMEDIATE 'SELECT * FROM IDENTIFIER(:schema ''.'' :table)'   USING 'default' AS schema, '... | SUCCESS | SUCCESS |
| 202 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:prefix ''1''), IDENTIFIER(:prefix ''2'') FROM integration_t... | SUCCESS | SUCCESS |
| 203 | EXECUTE IMMEDIATE 'SELECT * FROM integration_test WHERE IDENTIFIER(:col) = :val'   USING 'c1' AS ... | SUCCESS | SUCCESS |
| 204 | CREATE TABLE integration_test2(c1 INT, c3 STRING) USING CSV | SUCCESS | SUCCESS |
| 205 | INSERT INTO integration_test2 VALUES (1, 'x'), (2, 'y') | SUCCESS | SUCCESS |
| 206 | EXECUTE IMMEDIATE 'SELECT t1.*, t2.* FROM IDENTIFIER(:t1) t1 JOIN IDENTIFIER(:t2) t2 USING (IDENT... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 207 | EXECUTE IMMEDIATE   'SELECT IDENTIFIER(:col1), IDENTIFIER(:col2), row_number() OVER (PARTITION BY... | SUCCESS | SUCCESS |
| 208 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:prefix ''2''), IDENTIFIER(:agg)(IDENTIFIER(:col)) FROM inte... | SUCCESS | SUCCESS |
| 209 | EXECUTE IMMEDIATE 'SELECT * FROM integration_test ORDER BY IDENTIFIER(:col1) DESC, IDENTIFIER(:co... | SUCCESS | SUCCESS |
| 210 | EXECUTE IMMEDIATE 'INSERT INTO integration_test(IDENTIFIER(:col1), IDENTIFIER(:col2)) VALUES (:va... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 211 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(concat(:schema, ''.'', :table, ''.c1'')) FROM VALUES(named_s... | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 212 | EXECUTE IMMEDIATE 'WITH IDENTIFIER(:cte_name)(c1) AS (VALUES(1)) SELECT c1 FROM IDENTIFIER(:cte_n... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 213 | EXECUTE IMMEDIATE 'CREATE OR REPLACE TEMPORARY VIEW IDENTIFIER(:view_name)(IDENTIFIER(:col_name))... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 214 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:col) FROM IDENTIFIER(:view)'   USING 'test_col' AS col, 'te... | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 215 | DROP VIEW test_view | **SUCCESS** | **TABLE_OR_VIEW_NOT_FOUND** |
| 216 | EXECUTE IMMEDIATE 'ALTER TABLE IDENTIFIER(:tab) ADD COLUMN IDENTIFIER(:new_col) INT'   USING 'int... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 217 | EXECUTE IMMEDIATE 'ALTER TABLE IDENTIFIER(:tab) RENAME COLUMN IDENTIFIER(:old_col) TO IDENTIFIER(... | **UNSUPPORTED_FEATURE.TABLE_OPERATION** | **PARSE_SYNTAX_ERROR** |
| 218 | EXECUTE IMMEDIATE 'SELECT map(:key, :val).IDENTIFIER(:key) AS result'   USING 'mykey' AS key, 42 ... | **SUCCESS** | **PARSE_SYNTAX_ERROR** |
| 219 | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:alias ''.c1'') FROM integration_test AS IDENTIFIER(:alias)'... | **UNRESOLVED_COLUMN.WITH_SUGGESTION** | **PARSE_SYNTAX_ERROR** |
| 220 | EXECUTE IMMEDIATE   'SELECT IDENTIFIER(:col1), IDENTIFIER(:p ''2'') FROM IDENTIFIER(:schema ''.''... | SUCCESS | SUCCESS |
| 221 | EXECUTE IMMEDIATE   'BEGIN      DECLARE IDENTIFIER(:var_name) INT DEFAULT :var_value | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 222 | SELECT IDENTIFIER(:var_name) AS result | UNBOUND_SQL_PARAMETER | UNBOUND_SQL_PARAMETER |
| 223 | END'   USING 'my_variable' AS var_name, 100 AS var_value | PARSE_SYNTAX_ERROR | PARSE_SYNTAX_ERROR |
| 224 | EXECUTE IMMEDIATE 'SELECT * FROM IDENTIFIER(:schema ''.'' :table) WHERE IDENTIFIER(concat(:tab_al... | SUCCESS | SUCCESS |
| 225 | EXECUTE IMMEDIATE 'SELECT 1 AS IDENTIFIER(:schema ''.'' :col)'   USING 'default' AS schema, 'col1... | **IDENTIFIER_TOO_MANY_NAME_PARTS** | **PARSE_SYNTAX_ERROR** |
| 226 | DROP TABLE integration_test | SUCCESS | SUCCESS |
| 227 | DROP TABLE integration_test2 | SUCCESS | SUCCESS |

---

## Tests Changed from Master

### 13 Tests with Different Behavior from Master

| Query# | SQL Text | Master | identifier-clause | Notes |
|--------|----------|--------|-------------------|-------|
| 114 | SELECT row_number() OVER IDENTIFIER('x.win') FROM VALUES(1) AS T(c1) WINDOW w... | PARSE_SYNTAX_ERROR | **IDENTIFIER_TOO_MANY_NAME_PARTS** | Behavior changed |
| 115 | SELECT T1.c1 FROM VALUES(1) AS T1(c1) JOIN VALUES(1) AS T2(c1) USING (IDENTIF... | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 117 | SELECT map('a', 1).IDENTIFIER('a') FROM VALUES(1) AS T(c1) | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 118 | SELECT named_struct('a', 1).IDENTIFIER('a') FROM VALUES(1) AS T(c1) | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 119 | SELECT * FROM s.IDENTIFIER('tab') | INVALID_SQL_SYNTAX.INVALID_TABLE_VALUED_FUNC_NAME | **TABLE_OR_VIEW_NOT_FOUND** | Behavior changed |
| 120 | SELECT * FROM IDENTIFIER('s').IDENTIFIER('tab') | PARSE_SYNTAX_ERROR | **TABLE_OR_VIEW_NOT_FOUND** | Behavior changed |
| 121 | SELECT * FROM IDENTIFIER('s').tab | PARSE_SYNTAX_ERROR | **TABLE_OR_VIEW_NOT_FOUND** | Behavior changed |
| 122 | SELECT row_number() OVER IDENTIFIER('win') FROM VALUES(1) AS T(c1) WINDOW win... | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 123 | SELECT row_number() OVER win FROM VALUES(1) AS T(c1) WINDOW IDENTIFIER('win')... | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 126 | WITH identifier('v')(identifier('c1')) AS (VALUES(1)) (SELECT c1 FROM v) | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 127 | CREATE OR REPLACE VIEW v(IDENTIFIER('c1')) AS VALUES(1) | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 129 | CREATE TABLE tab(IDENTIFIER('c1') INT) USING CSV | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |
| 130 | INSERT INTO tab(IDENTIFIER('c1')) VALUES(1) | PARSE_SYNTAX_ERROR | **SUCCESS** | Behavior changed |

---

## Legacy Mode Differences

### 47 Tests with Different Behavior in Legacy Mode

| Query# | identifier-clause | identifier-clause-legacy | SQL Text |
|--------|-------------------|--------------------------|----------|
| 114 | IDENTIFIER_TOO_MANY_NAME_PARTS | PARSE_SYNTAX_ERROR | SELECT row_number() OVER IDENTIFIER('x.win') FROM VALUES(1) AS T(c1) WINDOW w... |
| 115 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT T1.c1 FROM VALUES(1) AS T1(c1) JOIN VALUES(1) AS T2(c1) USING (IDENTIF... |
| 117 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT map('a', 1).IDENTIFIER('a') FROM VALUES(1) AS T(c1) |
| 118 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT named_struct('a', 1).IDENTIFIER('a') FROM VALUES(1) AS T(c1) |
| 119 | TABLE_OR_VIEW_NOT_FOUND | PARSE_SYNTAX_ERROR | SELECT * FROM s.IDENTIFIER('tab') |
| 120 | TABLE_OR_VIEW_NOT_FOUND | PARSE_SYNTAX_ERROR | SELECT * FROM IDENTIFIER('s').IDENTIFIER('tab') |
| 121 | TABLE_OR_VIEW_NOT_FOUND | PARSE_SYNTAX_ERROR | SELECT * FROM IDENTIFIER('s').tab |
| 122 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT row_number() OVER IDENTIFIER('win') FROM VALUES(1) AS T(c1) WINDOW win... |
| 123 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT row_number() OVER win FROM VALUES(1) AS T(c1) WINDOW IDENTIFIER('win')... |
| 124 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT 1 AS IDENTIFIER('col1') |
| 125 | SUCCESS | PARSE_SYNTAX_ERROR | SELECT my_table.* FROM VALUES (1, 2) AS IDENTIFIER('my_table')(IDENTIFIER('c1... |
| 126 | SUCCESS | PARSE_SYNTAX_ERROR | WITH identifier('v')(identifier('c1')) AS (VALUES(1)) (SELECT c1 FROM v) |
| 127 | SUCCESS | PARSE_SYNTAX_ERROR | CREATE OR REPLACE VIEW v(IDENTIFIER('c1')) AS VALUES(1) |
| 128 | SUCCESS | TABLE_OR_VIEW_NOT_FOUND | SELECT c1 FROM v |
| 129 | SUCCESS | PARSE_SYNTAX_ERROR | CREATE TABLE tab(IDENTIFIER('c1') INT) USING CSV |
| 130 | SUCCESS | PARSE_SYNTAX_ERROR | INSERT INTO tab(IDENTIFIER('c1')) VALUES(1) |
| 131 | SUCCESS | TABLE_OR_VIEW_NOT_FOUND | SELECT c1 FROM tab |
| 132 | UNSUPPORTED_FEATURE.TABLE_OPERATION | PARSE_SYNTAX_ERROR | ALTER TABLE IDENTIFIER('tab') RENAME COLUMN IDENTIFIER('c1') TO IDENTIFIER('c... |
| 133 | UNRESOLVED_COLUMN.WITH_SUGGESTION | TABLE_OR_VIEW_NOT_FOUND | SELECT col1 FROM tab |
| 134 | SUCCESS | PARSE_SYNTAX_ERROR | ALTER TABLE IDENTIFIER('tab') ADD COLUMN IDENTIFIER('c2') INT |
| 135 | SUCCESS | TABLE_OR_VIEW_NOT_FOUND | SELECT c2 FROM tab |
| 136 | UNSUPPORTED_FEATURE.TABLE_OPERATION | PARSE_SYNTAX_ERROR | ALTER TABLE IDENTIFIER('tab') DROP COLUMN IDENTIFIER('c2') |
| 137 | SUCCESS | PARSE_SYNTAX_ERROR | ALTER TABLE IDENTIFIER('tab') RENAME TO IDENTIFIER('tab_renamed') |
| 138 | SUCCESS | TABLE_OR_VIEW_NOT_FOUND | SELECT * FROM tab_renamed |
| 139 | SUCCESS | PARSE_SYNTAX_ERROR | CREATE TABLE test_col_with_dot(IDENTIFIER('`col.with.dot`') INT) USING CSV |
| 141 | IDENTIFIER_TOO_MANY_NAME_PARTS | PARSE_SYNTAX_ERROR | SELECT * FROM VALUES (1, 2) AS IDENTIFIER('schema.table')(c1, c2) |
| 142 | IDENTIFIER_TOO_MANY_NAME_PARTS | PARSE_SYNTAX_ERROR | SELECT 1 AS IDENTIFIER('col1.col2') |
| 156 | SUCCESS | PARSE_SYNTAX_ERROR | ALTER TABLE test_comment ALTER COLUMN IDENTIFIER('c1') COMMENT 'column comment' |
| 167 | SUCCESS | PARSE_SYNTAX_ERROR | SET VAR IDENTIFIER('my_var') = 'new_value' |
| 170 | SUCCESS | PARSE_SYNTAX_ERROR | CREATE TEMPORARY FUNCTION test_udf(IDENTIFIER('param1') INT, IDENTIFIER('para... |
| 171 | SUCCESS | UNRESOLVED_ROUTINE | SELECT test_udf(5, 'hello') |
| 172 | SUCCESS | ROUTINE_NOT_FOUND | DROP TEMPORARY FUNCTION test_udf |
| 173 | SUCCESS | PARSE_SYNTAX_ERROR | CREATE TEMPORARY FUNCTION test_table_udf(IDENTIFIER('input_val') INT) RETURNS... |
| 174 | SUCCESS | UNRESOLVABLE_TABLE_VALUED_FUNCTION | SELECT * FROM test_table_udf(42) |
| 175 | SUCCESS | ROUTINE_NOT_FOUND | DROP TEMPORARY FUNCTION test_table_udf |
| 206 | SUCCESS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'SELECT t1.*, t2.* FROM IDENTIFIER(:t1) t1 JOIN IDENTIFIER(... |
| 210 | SUCCESS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'INSERT INTO integration_test(IDENTIFIER(:col1), IDENTIFIER... |
| 211 | IDENTIFIER_TOO_MANY_NAME_PARTS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(concat(:schema, ''.'', :table, ''.c1''))... |
| 212 | SUCCESS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'WITH IDENTIFIER(:cte_name)(c1) AS (VALUES(1)) SELECT c1 FR... |
| 213 | SUCCESS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'CREATE OR REPLACE TEMPORARY VIEW IDENTIFIER(:view_name)(ID... |
| 214 | SUCCESS | TABLE_OR_VIEW_NOT_FOUND | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:col) FROM IDENTIFIER(:view)'   USING 't... |
| 215 | SUCCESS | TABLE_OR_VIEW_NOT_FOUND | DROP VIEW test_view |
| 216 | SUCCESS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'ALTER TABLE IDENTIFIER(:tab) ADD COLUMN IDENTIFIER(:new_co... |
| 217 | UNSUPPORTED_FEATURE.TABLE_OPERATION | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'ALTER TABLE IDENTIFIER(:tab) RENAME COLUMN IDENTIFIER(:old... |
| 218 | SUCCESS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'SELECT map(:key, :val).IDENTIFIER(:key) AS result'   USING... |
| 219 | UNRESOLVED_COLUMN.WITH_SUGGESTION | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'SELECT IDENTIFIER(:alias ''.c1'') FROM integration_test AS... |
| 225 | IDENTIFIER_TOO_MANY_NAME_PARTS | PARSE_SYNTAX_ERROR | EXECUTE IMMEDIATE 'SELECT 1 AS IDENTIFIER(:schema ''.'' :col)'   USING 'defau... |

---

## Summary Statistics

- **Regression Check**: 13 tests changed from master
- **New Functionality**: 99 new tests added
- **Legacy Compatibility**: 47 tests differ between modes (20.7%)
- **Stability**: 115 existing tests unchanged (50.7%)
